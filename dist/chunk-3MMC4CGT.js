import{A as ut,B as lt,a as Ee,b as ft,c as Re,d as Ve,e as Ce,f as rt,h as ne,i as xe,j as nt,k as Q,l as ot,m as it,o as ve,s as Te,t as st,u as ct,x as at,y as dt}from"./chunk-TQUSZLZ3.js";import{a as ee,b as re}from"./chunk-GAL4ENT6.js";var We=BigInt(0),ze=BigInt(1);function ae(f,e=""){if(typeof f!="boolean")throw Error((e&&`"${e}"`)+"expected boolean, got type="+typeof f);return f}function _(f,e,r=""){let t=Ee(f),n=f?.length,o=e!==void 0;if(!t||o&&n!==e)throw Error((r&&`"${r}" `)+"expected Uint8Array"+(o?" of length "+e:"")+", got "+(t?"length="+n:"type="+typeof f));return f}function Fe(f){let e=f.toString(16);return 1&e.length?"0"+e:e}function qt(f){if(typeof f!="string")throw Error("hex string expected, got "+typeof f);return f===""?We:BigInt("0x"+f)}function Ue(f){return qt(ne(f))}function de(f){return Re(f),qt(ne(Uint8Array.from(f).reverse()))}function Je(f,e){return xe(f.toString(16).padStart(2*e,"0"))}function Qe(f,e){return Je(f,e).reverse()}function Y(f,e,r){let t;if(typeof e=="string")try{t=xe(e)}catch(o){throw Error(f+" must be hex string or Uint8Array, cause: "+o)}else{if(!Ee(e))throw Error(f+" must be hex string or Uint8Array");t=Uint8Array.from(e)}let n=t.length;if(typeof r=="number"&&n!==r)throw Error(f+" of length "+r+" expected, got "+n);return t}function ht(f){return Uint8Array.from(f)}var ke=f=>typeof f=="bigint"&&We<=f;function Oe(f,e,r,t){if(!(function(n,o,c){return ke(n)&&ke(o)&&ke(c)&&o<=n&&n<c})(e,r,t))throw Error("expected valid "+f+": "+r+" <= n < "+t+", got "+e)}function Zt(f){let e;for(e=0;f>We;f>>=ze,e+=1);return e}var Se=f=>(ze<<BigInt(f))-ze;function me(f,e,r={}){if(!f||typeof f!="object")throw Error("expected valid options object");function t(n,o,c){let d=f[n];if(c&&d===void 0)return;let i=typeof d;if(i!==o||d===null)throw Error(`param "${n}" is invalid: expected ${o}, got ${i}`)}Object.entries(e).forEach(([n,o])=>t(n,o,!1)),Object.entries(r).forEach(([n,o])=>t(n,o,!0))}function Ze(f){let e=new WeakMap;return(r,...t)=>{let n=e.get(r);if(n!==void 0)return n;let o=f(r,...t);return e.set(r,o),o}}var W=BigInt(0),$=BigInt(1),ie=BigInt(2),Kt=BigInt(3),Nt=BigInt(4),Pt=BigInt(5),ef=BigInt(7),Ut=BigInt(8),tf=BigInt(9),bt=BigInt(16);function D(f,e){let r=f%e;return r>=W?r:e+r}function H(f,e,r){let t=f;for(;e-- >W;)t*=t,t%=r;return t}function gt(f,e){if(f===W)throw Error("invert: expected non-zero number");if(e<=W)throw Error("invert: expected positive modulus, got "+e);let r=D(f,e),t=e,n=W,o=$;for(;r!==W;){let c=t%r,d=n-o*(t/r);t=r,r=c,n=o,o=d}if(t!==$)throw Error("invert: does not exist");return D(n,e)}function _e(f,e,r){if(!f.eql(f.sqr(e),r))throw Error("Cannot find square root")}function Vt(f,e){let r=(f.ORDER+$)/Nt,t=f.pow(e,r);return _e(f,t,e),t}function ff(f,e){let r=(f.ORDER-Pt)/Ut,t=f.mul(e,ie),n=f.pow(t,r),o=f.mul(e,n),c=f.mul(f.mul(o,ie),n),d=f.mul(o,f.sub(c,f.ONE));return _e(f,d,e),d}function pt(f){if(f<Kt)throw Error("sqrt is not defined for small field");let e=f-$,r=0;for(;e%ie===W;)e/=ie,r++;let t=ie,n=J(f);for(;yt(n,t)===1;)if(t++>1e3)throw Error("Cannot find square root: probably non-prime P");if(r===1)return Vt;let o=n.pow(t,e),c=(e+$)/ie;return function(d,i){if(d.is0(i))return i;if(yt(d,i)!==1)throw Error("Cannot find square root");let N=r,E=d.mul(d.ONE,o),w=d.pow(i,e),a=d.pow(i,c);for(;!d.eql(w,d.ONE);){if(d.is0(w))return d.ZERO;let O=1,b=d.sqr(w);for(;!d.eql(b,d.ONE);)if(O++,b=d.sqr(b),O===N)throw Error("Cannot find square root");let V=$<<BigInt(N-O-1),q=d.pow(E,V);N=O,E=d.sqr(q),w=d.mul(w,E),a=d.mul(a,q)}return a}}function rf(f){return f%Nt===Kt?Vt:f%Ut===Pt?ff:f%bt===tf?(function(e){let r=J(e),t=pt(e),n=t(r,r.neg(r.ONE)),o=t(r,n),c=t(r,r.neg(n)),d=(e+ef)/bt;return(i,N)=>{let E=i.pow(N,d),w=i.mul(E,n),a=i.mul(E,o),O=i.mul(E,c),b=i.eql(i.sqr(w),N),V=i.eql(i.sqr(a),N);E=i.cmov(E,w,b),w=i.cmov(O,a,V);let q=i.eql(i.sqr(w),N),u=i.cmov(E,w,q);return _e(i,u,N),u}})(f):pt(f)}var nf=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ct(f,e,r=!1){let t=Array(e.length).fill(r?f.ZERO:void 0),n=e.reduce((c,d,i)=>f.is0(d)?c:(t[i]=c,f.mul(c,d)),f.ONE),o=f.inv(n);return e.reduceRight((c,d,i)=>f.is0(d)?c:(t[i]=f.mul(c,t[i]),f.mul(c,d)),o),t}function yt(f,e){let r=(f.ORDER-$)/ie,t=f.pow(e,r),n=f.eql(t,f.ONE),o=f.eql(t,f.ZERO),c=f.eql(t,f.neg(f.ONE));if(!n&&!o&&!c)throw Error("invalid Legendre symbol result");return n?1:o?0:-1}function Tt(f,e){e!==void 0&&ft(e);let r=e!==void 0?e:f.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function J(f,e,r=!1,t={}){if(f<=W)throw Error("invalid field: expected ORDER > 0, got "+f);let n,o,c,d=!1;if(typeof e=="object"&&e!=null){if(t.sqrt||r)throw Error("cannot specify opts in two arguments");let a=e;a.BITS&&(n=a.BITS),a.sqrt&&(o=a.sqrt),typeof a.isLE=="boolean"&&(r=a.isLE),typeof a.modFromBytes=="boolean"&&(d=a.modFromBytes),c=a.allowedLengths}else typeof e=="number"&&(n=e),t.sqrt&&(o=t.sqrt);let{nBitLength:i,nByteLength:N}=Tt(f,n);if(N>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let E,w=Object.freeze({ORDER:f,isLE:r,BITS:i,BYTES:N,MASK:Se(i),ZERO:W,ONE:$,allowedLengths:c,create:a=>D(a,f),isValid:a=>{if(typeof a!="bigint")throw Error("invalid field element: expected bigint, got "+typeof a);return W<=a&&a<f},is0:a=>a===W,isValidNot0:a=>!w.is0(a)&&w.isValid(a),isOdd:a=>(a&$)===$,neg:a=>D(-a,f),eql:(a,O)=>a===O,sqr:a=>D(a*a,f),add:(a,O)=>D(a+O,f),sub:(a,O)=>D(a-O,f),mul:(a,O)=>D(a*O,f),pow:(a,O)=>(function(b,V,q){if(q<W)throw Error("invalid exponent, negatives unsupported");if(q===W)return b.ONE;if(q===$)return V;let u=b.ONE,v=V;for(;q>W;)q&$&&(u=b.mul(u,v)),v=b.sqr(v),q>>=$;return u})(w,a,O),div:(a,O)=>D(a*gt(O,f),f),sqrN:a=>a*a,addN:(a,O)=>a+O,subN:(a,O)=>a-O,mulN:(a,O)=>a*O,inv:a=>gt(a,f),sqrt:o||(a=>(E||(E=rf(f)),E(w,a))),toBytes:a=>r?Qe(a,N):Je(a,N),fromBytes:(a,O=!0)=>{if(c){if(!c.includes(a.length)||a.length>N)throw Error("Field.fromBytes: expected "+c+" bytes, got "+a.length);let V=new Uint8Array(N);V.set(a,r?0:V.length-a.length),a=V}if(a.length!==N)throw Error("Field.fromBytes: expected "+N+" bytes, got "+a.length);let b=r?de(a):Ue(a);if(d&&(b=D(b,f)),!O&&!w.isValid(b))throw Error("invalid field element: outside of range 0..ORDER");return b},invertBatch:a=>Ct(w,a),cmov:(a,O,b)=>b?O:a});return Object.freeze(w)}function kt(f){if(typeof f!="bigint")throw Error("field order must be bigint");let e=f.toString(2).length;return Math.ceil(e/8)}function mt(f){let e=kt(f);return e+Math.ceil(e/2)}var Ke=class extends ot{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,Ve(e);let t=nt(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let n=this.blockLen,o=new Uint8Array(n);o.set(t.length>n?e.create().update(t).digest():t);for(let c=0;c<o.length;c++)o[c]^=54;this.iHash.update(o),this.oHash=e.create();for(let c=0;c<o.length;c++)o[c]^=106;this.oHash.update(o),rt(o)}update(e){return Ce(this),this.iHash.update(e),this}digestInto(e){Ce(this),Re(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:t,finished:n,destroyed:o,blockLen:c,outputLen:d}=this;return e.finished=n,e.destroyed=o,e.blockLen=c,e.outputLen=d,e.oHash=r._cloneInto(e.oHash),e.iHash=t._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},jt=(f,e,r)=>new Ke(f,e).update(r).digest();jt.create=(f,e)=>new Ke(f,e);var ye=BigInt(0),se=BigInt(1);function Ne(f,e){let r=e.negate();return f?r:e}function ce(f,e){let r=Ct(f.Fp,e.map(t=>t.Z));return e.map((t,n)=>f.fromAffine(t.toAffine(r[n])))}function Lt(f,e){if(!Number.isSafeInteger(f)||f<=0||f>e)throw Error("invalid window size, expected [1.."+e+"], got W="+f)}function je(f,e){Lt(f,e);let r=2**f;return{windows:Math.ceil(e/f)+1,windowSize:2**(f-1),mask:Se(f),maxNumber:r,shiftBy:BigInt(f)}}function Bt(f,e,r){let{windowSize:t,mask:n,maxNumber:o,shiftBy:c}=r,d=Number(f&n),i=f>>c;d>t&&(d-=o,i+=se);let N=e*t;return{nextN:i,offset:N+Math.abs(d)-1,isZero:d===0,isNeg:d<0,isNegF:e%2!=0,offsetF:N}}var Le=new WeakMap,Gt=new WeakMap;function Ge(f){return Gt.get(f)||1}function wt(f){if(f!==ye)throw Error("invalid wNAF")}var Pe=class{constructor(e,r){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=r}_unsafeLadder(e,r,t=this.ZERO){let n=e;for(;r>ye;)r&se&&(t=t.add(n)),n=n.double(),r>>=se;return t}precomputeWindow(e,r){let{windows:t,windowSize:n}=je(r,this.bits),o=[],c=e,d=c;for(let i=0;i<t;i++){d=c,o.push(d);for(let N=1;N<n;N++)d=d.add(c),o.push(d);c=d.double()}return o}wNAF(e,r,t){if(!this.Fn.isValid(t))throw Error("invalid scalar");let n=this.ZERO,o=this.BASE,c=je(e,this.bits);for(let d=0;d<c.windows;d++){let{nextN:i,offset:N,isZero:E,isNeg:w,isNegF:a,offsetF:O}=Bt(t,d,c);t=i,E?o=o.add(Ne(a,r[O])):n=n.add(Ne(w,r[N]))}return wt(t),{p:n,f:o}}wNAFUnsafe(e,r,t,n=this.ZERO){let o=je(e,this.bits);for(let c=0;c<o.windows&&t!==ye;c++){let{nextN:d,offset:i,isZero:N,isNeg:E}=Bt(t,c,o);if(t=d,!N){let w=r[i];n=n.add(E?w.negate():w)}}return wt(t),n}getPrecomputes(e,r,t){let n=Le.get(r);return n||(n=this.precomputeWindow(r,e),e!==1&&(typeof t=="function"&&(n=t(n)),Le.set(r,n))),n}cached(e,r,t){let n=Ge(e);return this.wNAF(n,this.getPrecomputes(n,e,t),r)}unsafe(e,r,t,n){let o=Ge(e);return o===1?this._unsafeLadder(e,r,n):this.wNAFUnsafe(o,this.getPrecomputes(o,e,t),r,n)}createCache(e,r){Lt(r,this.bits),Gt.set(e,r),Le.delete(e)}hasCache(e){return Ge(e)!==1}};function Ht(f,e,r,t){(function(a,O){if(!Array.isArray(a))throw Error("array expected");a.forEach((b,V)=>{if(!(b instanceof O))throw Error("invalid point at index "+V)})})(r,f),(function(a,O){if(!Array.isArray(a))throw Error("array of scalars expected");a.forEach((b,V)=>{if(!O.isValid(b))throw Error("invalid scalar at index "+V)})})(t,e);let n=r.length,o=t.length;if(n!==o)throw Error("arrays of points and scalars must have equal length");let c=f.ZERO,d=Zt(BigInt(n)),i=1;d>12?i=d-3:d>4?i=d-2:d>0&&(i=2);let N=Se(i),E=Array(Number(N)+1).fill(c),w=c;for(let a=Math.floor((e.BITS-1)/i)*i;a>=0;a-=i){E.fill(c);for(let b=0;b<o;b++){let V=t[b],q=Number(V>>BigInt(a)&N);E[q]=E[q].add(r[b])}let O=c;for(let b=E.length-1,V=c;b>0;b--)V=V.add(E[b]),O=O.add(V);if(w=w.add(O),a!==0)for(let b=0;b<i;b++)w=w.double()}return w}function Et(f,e,r){if(e){if(e.ORDER!==f)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return(function(t){me(t,nf.reduce((n,o)=>(n[o]="function",n),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"}))})(e),e}return J(f,{isLE:r})}function Yt(f,e,r={},t){if(t===void 0&&(t=f==="edwards"),!e||typeof e!="object")throw Error(`expected valid ${f} CURVE object`);for(let d of["p","n","h"]){let i=e[d];if(!(typeof i=="bigint"&&i>ye))throw Error(`CURVE.${d} must be positive bigint`)}let n=Et(e.p,r.Fp,t),o=Et(e.n,r.Fn,t),c=["Gx","Gy","a",f==="weierstrass"?"b":"d"];for(let d of c)if(!n.isValid(e[d]))throw Error(`CURVE.${d} must be valid field element of CURVE.Fp`);return{CURVE:e=Object.freeze(Object.assign({},e)),Fp:n,Fn:o}}var xt=(f,e)=>(f+(f>=0?e:-e)/zt)/e;function De(f){if(!["compact","recovered","der"].includes(f))throw Error('Signature format must be "compact", "recovered", or "der"');return f}function He(f,e){let r={};for(let t of Object.keys(e))r[t]=f[t]===void 0?e[t]:f[t];return ae(r.lowS,"lowS"),ae(r.prehash,"prehash"),r.format!==void 0&&De(r.format),r}var te={Err:class extends Error{constructor(f=""){super(f)}},_tlv:{encode:(f,e)=>{let{Err:r}=te;if(f<0||f>256)throw new r("tlv.encode: wrong tag");if(1&e.length)throw new r("tlv.encode: unpadded data");let t=e.length/2,n=Fe(t);if(n.length/2&128)throw new r("tlv.encode: long form length too big");let o=t>127?Fe(n.length/2|128):"";return Fe(f)+o+n+e},decode(f,e){let{Err:r}=te,t=0;if(f<0||f>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[t++]!==f)throw new r("tlv.decode: wrong tlv");let n=e[t++],o=0;if(128&n){let d=127&n;if(!d)throw new r("tlv.decode(long): indefinite length not supported");if(d>4)throw new r("tlv.decode(long): byte length is too big");let i=e.subarray(t,t+d);if(i.length!==d)throw new r("tlv.decode: length bytes not complete");if(i[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(let N of i)o=o<<8|N;if(t+=d,o<128)throw new r("tlv.decode(long): not minimal encoding")}else o=n;let c=e.subarray(t,t+o);if(c.length!==o)throw new r("tlv.decode: wrong value length");return{v:c,l:e.subarray(t+o)}}},_int:{encode(f){let{Err:e}=te;if(f<fe)throw new e("integer: negative integers are not allowed");let r=Fe(f);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(f){let{Err:e}=te;if(128&f[0])throw new e("invalid signature integer: negative");if(f[0]===0&&!(128&f[1]))throw new e("invalid signature integer: unnecessary leading zero");return Ue(f)}},toSig(f){let{Err:e,_int:r,_tlv:t}=te,n=Y("signature",f),{v:o,l:c}=t.decode(48,n);if(c.length)throw new e("invalid signature: left bytes after parsing");let{v:d,l:i}=t.decode(2,o),{v:N,l:E}=t.decode(2,i);if(E.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(d),s:r.decode(N)}},hexFromSig(f){let{_tlv:e,_int:r}=te,t=e.encode(2,r.encode(f.r))+e.encode(2,r.encode(f.s));return e.encode(48,t)}},fe=BigInt(0),ge=BigInt(1),zt=BigInt(2),Ae=BigInt(3),of=BigInt(4);function pe(f,e){let{BYTES:r}=f,t;if(typeof e=="bigint")t=e;else{let n=Y("private key",e);try{t=f.fromBytes(n)}catch{throw Error(`invalid private key: expected ui8a of size ${r}, got ${typeof e}`)}}if(!f.isValidNot0(t))throw Error("invalid private key: out of range [1..N-1]");return t}function sf(f,e={}){let r=Yt("weierstrass",f,e),{Fp:t,Fn:n}=r,o=r.CURVE,{h:c,n:d}=o;me(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:i}=e;if(i&&(!t.is0(o.a)||typeof i.beta!="bigint"||!Array.isArray(i.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');let N=Xt(t,n);function E(){if(!t.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let w=e.toBytes||function(g,s,h){let{x:y,y:I}=s.toAffine(),K=t.toBytes(y);if(ae(h,"isCompressed"),h){E();let m=!t.isOdd(I);return Q(Dt(m),K)}return Q(Uint8Array.of(4),K,t.toBytes(I))},a=e.fromBytes||function(g){_(g,void 0,"Point");let{publicKey:s,publicKeyUncompressed:h}=N,y=g.length,I=g[0],K=g.subarray(1);if(y!==s||I!==2&&I!==3){if(y===h&&I===4){let m=t.BYTES,x=t.fromBytes(K.subarray(0,m)),B=t.fromBytes(K.subarray(m,2*m));if(!b(x,B))throw Error("bad point: is not on curve");return{x,y:B}}throw Error(`bad point: got length ${y}, expected compressed=${s} or uncompressed=${h}`)}{let m=t.fromBytes(K);if(!t.isValid(m))throw Error("bad point: is not on curve, wrong x");let x=O(m),B;try{B=t.sqrt(x)}catch(Z){let F=Z instanceof Error?": "+Z.message:"";throw Error("bad point: is not on curve, sqrt error"+F)}return E(),!(1&~I)!==t.isOdd(B)&&(B=t.neg(B)),{x:m,y:B}}};function O(g){let s=t.sqr(g),h=t.mul(s,g);return t.add(t.add(h,t.mul(g,o.a)),o.b)}function b(g,s){let h=t.sqr(s),y=O(g);return t.eql(h,y)}if(!b(o.Gx,o.Gy))throw Error("bad curve params: generator point");let V=t.mul(t.pow(o.a,Ae),of),q=t.mul(t.sqr(o.b),BigInt(27));if(t.is0(t.add(V,q)))throw Error("bad curve params: a or b");function u(g,s,h=!1){if(!t.isValid(s)||h&&t.is0(s))throw Error("bad point coordinate "+g);return s}function v(g){if(!(g instanceof R))throw Error("ProjectivePoint expected")}function p(g){if(!i||!i.basises)throw Error("no endo");return(function(s,h,y){let[[I,K],[m,x]]=h,B=xt(x*s,y),Z=xt(-K*s,y),F=s-B*I-Z*m,j=-B*K-Z*x,T=F<fe,U=j<fe;T&&(F=-F),U&&(j=-j);let L=Se(Math.ceil(Zt(y)/2))+ge;if(F<fe||F>=L||j<fe||j>=L)throw Error("splitScalar (endomorphism): failed, k="+s);return{k1neg:T,k1:F,k2neg:U,k2:j}})(g,i.basises,n.ORDER)}let S=Ze((g,s)=>{let{X:h,Y:y,Z:I}=g;if(t.eql(I,t.ONE))return{x:h,y};let K=g.is0();s==null&&(s=K?t.ONE:t.inv(I));let m=t.mul(h,s),x=t.mul(y,s),B=t.mul(I,s);if(K)return{x:t.ZERO,y:t.ZERO};if(!t.eql(B,t.ONE))throw Error("invZ was invalid");return{x:m,y:x}}),P=Ze(g=>{if(g.is0()){if(e.allowInfinityPoint&&!t.is0(g.Y))return;throw Error("bad point: ZERO")}let{x:s,y:h}=g.toAffine();if(!t.isValid(s)||!t.isValid(h))throw Error("bad point: x or y not field elements");if(!b(s,h))throw Error("bad point: equation left != right");if(!g.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function C(g,s,h,y,I){return h=new R(t.mul(h.X,g),h.Y,h.Z),s=Ne(y,s),h=Ne(I,h),s.add(h)}class R{constructor(s,h,y){this.X=u("x",s),this.Y=u("y",h,!0),this.Z=u("z",y),Object.freeze(this)}static CURVE(){return o}static fromAffine(s){let{x:h,y}=s||{};if(!s||!t.isValid(h)||!t.isValid(y))throw Error("invalid affine point");if(s instanceof R)throw Error("projective point not allowed");return t.is0(h)&&t.is0(y)?R.ZERO:new R(h,y,t.ONE)}static fromBytes(s){let h=R.fromAffine(a(_(s,void 0,"point")));return h.assertValidity(),h}static fromHex(s){return R.fromBytes(Y("pointHex",s))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(s=8,h=!0){return l.createCache(this,s),h||this.multiply(Ae),this}assertValidity(){P(this)}hasEvenY(){let{y:s}=this.toAffine();if(!t.isOdd)throw Error("Field doesn't support isOdd");return!t.isOdd(s)}equals(s){v(s);let{X:h,Y:y,Z:I}=this,{X:K,Y:m,Z:x}=s,B=t.eql(t.mul(h,x),t.mul(K,I)),Z=t.eql(t.mul(y,x),t.mul(m,I));return B&&Z}negate(){return new R(this.X,t.neg(this.Y),this.Z)}double(){let{a:s,b:h}=o,y=t.mul(h,Ae),{X:I,Y:K,Z:m}=this,x=t.ZERO,B=t.ZERO,Z=t.ZERO,F=t.mul(I,I),j=t.mul(K,K),T=t.mul(m,m),U=t.mul(I,K);return U=t.add(U,U),Z=t.mul(I,m),Z=t.add(Z,Z),x=t.mul(s,Z),B=t.mul(y,T),B=t.add(x,B),x=t.sub(j,B),B=t.add(j,B),B=t.mul(x,B),x=t.mul(U,x),Z=t.mul(y,Z),T=t.mul(s,T),U=t.sub(F,T),U=t.mul(s,U),U=t.add(U,Z),Z=t.add(F,F),F=t.add(Z,F),F=t.add(F,T),F=t.mul(F,U),B=t.add(B,F),T=t.mul(K,m),T=t.add(T,T),F=t.mul(T,U),x=t.sub(x,F),Z=t.mul(T,j),Z=t.add(Z,Z),Z=t.add(Z,Z),new R(x,B,Z)}add(s){v(s);let{X:h,Y:y,Z:I}=this,{X:K,Y:m,Z:x}=s,B=t.ZERO,Z=t.ZERO,F=t.ZERO,j=o.a,T=t.mul(o.b,Ae),U=t.mul(h,K),L=t.mul(y,m),k=t.mul(I,x),z=t.add(h,y),G=t.add(K,m);z=t.mul(z,G),G=t.add(U,L),z=t.sub(z,G),G=t.add(h,I);let X=t.add(K,x);return G=t.mul(G,X),X=t.add(U,k),G=t.sub(G,X),X=t.add(y,I),B=t.add(m,x),X=t.mul(X,B),B=t.add(L,k),X=t.sub(X,B),F=t.mul(j,G),B=t.mul(T,k),F=t.add(B,F),B=t.sub(L,F),F=t.add(L,F),Z=t.mul(B,F),L=t.add(U,U),L=t.add(L,U),k=t.mul(j,k),G=t.mul(T,G),L=t.add(L,k),k=t.sub(U,k),k=t.mul(j,k),G=t.add(G,k),U=t.mul(L,G),Z=t.add(Z,U),U=t.mul(X,G),B=t.mul(z,B),B=t.sub(B,U),U=t.mul(z,L),F=t.mul(X,F),F=t.add(F,U),new R(B,Z,F)}subtract(s){return this.add(s.negate())}is0(){return this.equals(R.ZERO)}multiply(s){let{endo:h}=e;if(!n.isValidNot0(s))throw Error("invalid scalar: out of range");let y,I,K=m=>l.cached(this,m,x=>ce(R,x));if(h){let{k1neg:m,k1:x,k2neg:B,k2:Z}=p(s),{p:F,f:j}=K(x),{p:T,f:U}=K(Z);I=j.add(U),y=C(h.beta,F,T,m,B)}else{let{p:m,f:x}=K(s);y=m,I=x}return ce(R,[y,I])[0]}multiplyUnsafe(s){let{endo:h}=e,y=this;if(!n.isValid(s))throw Error("invalid scalar: out of range");if(s===fe||y.is0())return R.ZERO;if(s===ge)return y;if(l.hasCache(this))return this.multiply(s);if(h){let{k1neg:I,k1:K,k2neg:m,k2:x}=p(s),{p1:B,p2:Z}=(function(F,j,T,U){let L=j,k=F.ZERO,z=F.ZERO;for(;T>ye||U>ye;)T&se&&(k=k.add(L)),U&se&&(z=z.add(L)),L=L.double(),T>>=se,U>>=se;return{p1:k,p2:z}})(R,y,K,x);return C(h.beta,B,Z,I,m)}return l.unsafe(y,s)}multiplyAndAddUnsafe(s,h,y){let I=this.multiplyUnsafe(h).add(s.multiplyUnsafe(y));return I.is0()?void 0:I}toAffine(s){return S(this,s)}isTorsionFree(){let{isTorsionFree:s}=e;return c===ge||(s?s(R,this):l.unsafe(this,d).is0())}clearCofactor(){let{clearCofactor:s}=e;return c===ge?this:s?s(R,this):this.multiplyUnsafe(c)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}toBytes(s=!0){return ae(s,"isCompressed"),this.assertValidity(),w(R,this,s)}toHex(s=!0){return ne(this.toBytes(s))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(s=!0){return this.toBytes(s)}_setWindowSize(s){this.precompute(s)}static normalizeZ(s){return ce(R,s)}static msm(s,h){return Ht(R,n,s,h)}static fromPrivateKey(s){return R.BASE.multiply(pe(n,s))}}R.BASE=new R(o.Gx,o.Gy,t.ONE),R.ZERO=new R(t.ZERO,t.ONE,t.ZERO),R.Fp=t,R.Fn=n;let A=n.BITS,l=new Pe(R,e.endo?Math.ceil(A/2):A);return R.BASE.precompute(8),R}function Dt(f){return Uint8Array.of(f?2:3)}function Xt(f,e){return{secretKey:e.BYTES,publicKey:1+f.BYTES,publicKeyUncompressed:1+2*f.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function cf(f,e={}){let{Fn:r}=f,t=e.randomBytes||ve,n=Object.assign(Xt(f.Fp,r),{seed:mt(r.ORDER)});function o(E){try{return!!pe(r,E)}catch{return!1}}function c(E=t(n.seed)){return(function(w,a,O=!1){let b=w.length,V=kt(a),q=mt(a);if(b<16||b<q||b>1024)throw Error("expected "+q+"-1024 bytes of input, got "+b);let u=D(O?de(w):Ue(w),a-$)+$;return O?Qe(u,V):Je(u,V)})(_(E,n.seed,"seed"),r.ORDER)}function d(E,w=!0){return f.BASE.multiply(pe(r,E)).toBytes(w)}function i(E){if(typeof E=="bigint")return!1;if(E instanceof f)return!0;let{secretKey:w,publicKey:a,publicKeyUncompressed:O}=n;if(r.allowedLengths||w===a)return;let b=Y("key",E).length;return b===a||b===O}return Object.freeze({getPublicKey:d,getSharedSecret:function(E,w,a=!0){if(i(E)===!0)throw Error("first arg must be private key");if(i(w)===!1)throw Error("second arg must be public key");let O=pe(r,E);return f.fromHex(w).multiply(O).toBytes(a)},keygen:function(E){let w=c(E);return{secretKey:w,publicKey:d(w)}},Point:f,utils:{isValidSecretKey:o,isValidPublicKey:function(E,w){let{publicKey:a,publicKeyUncompressed:O}=n;try{let b=E.length;return(w!==!0||b===a)&&(w!==!1||b===O)&&!!f.fromBytes(E)}catch{return!1}},randomSecretKey:c,isValidPrivateKey:o,randomPrivateKey:c,normPrivateKeyToScalar:E=>pe(r,E),precompute:(E=8,w=f.BASE)=>w.precompute(E,!1)},lengths:n})}function af(f,e,r={}){Ve(e),me(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let t=r.randomBytes||ve,n=r.hmac||((A,...l)=>jt(e,A,Q(...l))),{Fp:o,Fn:c}=f,{ORDER:d,BITS:i}=c,{keygen:N,getPublicKey:E,getSharedSecret:w,utils:a,lengths:O}=cf(f,r),b={prehash:!1,lowS:typeof r.lowS=="boolean"&&r.lowS,format:void 0,extraEntropy:!1},V="compact";function q(A){return A>d>>ge}function u(A,l){if(!c.isValidNot0(l))throw Error(`invalid signature ${A}: out of range 1..Point.Fn.ORDER`);return l}class v{constructor(l,g,s){this.r=u("r",l),this.s=u("s",g),s!=null&&(this.recovery=s),Object.freeze(this)}static fromBytes(l,g=V){let s;if((function(K,m){De(m);let x=O.signature;_(K,m==="compact"?x:m==="recovered"?x+1:void 0,m+" signature")})(l,g),g==="der"){let{r:K,s:m}=te.toSig(_(l));return new v(K,m)}g==="recovered"&&(s=l[0],g="compact",l=l.subarray(1));let h=c.BYTES,y=l.subarray(0,h),I=l.subarray(h,2*h);return new v(c.fromBytes(y),c.fromBytes(I),s)}static fromHex(l,g){return this.fromBytes(xe(l),g)}addRecoveryBit(l){return new v(this.r,this.s,l)}recoverPublicKey(l){let g=o.ORDER,{r:s,s:h,recovery:y}=this;if(y==null||![0,1,2,3].includes(y))throw Error("recovery id invalid");if(d*zt<g&&y>1)throw Error("recovery id is ambiguous for h>1 curve");let I=y===2||y===3?s+d:s;if(!o.isValid(I))throw Error("recovery id 2 or 3 invalid");let K=o.toBytes(I),m=f.fromBytes(Q(Dt(!(1&y)),K)),x=c.inv(I),B=S(Y("msgHash",l)),Z=c.create(-B*x),F=c.create(h*x),j=f.BASE.multiplyUnsafe(Z).add(m.multiplyUnsafe(F));if(j.is0())throw Error("point at infinify");return j.assertValidity(),j}hasHighS(){return q(this.s)}toBytes(l=V){if(De(l),l==="der")return xe(te.hexFromSig(this));let g=c.toBytes(this.r),s=c.toBytes(this.s);if(l==="recovered"){if(this.recovery==null)throw Error("recovery bit must be present");return Q(Uint8Array.of(this.recovery),g,s)}return Q(g,s)}toHex(l){return ne(this.toBytes(l))}assertValidity(){}static fromCompact(l){return v.fromBytes(Y("sig",l),"compact")}static fromDER(l){return v.fromBytes(Y("sig",l),"der")}normalizeS(){return this.hasHighS()?new v(this.r,c.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return ne(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return ne(this.toBytes("compact"))}}let p=r.bits2int||function(A){if(A.length>8192)throw Error("input is too large");let l=Ue(A),g=8*A.length-i;return g>0?l>>BigInt(g):l},S=r.bits2int_modN||function(A){return c.create(p(A))},P=Se(i);function C(A){return Oe("num < 2^"+i,A,fe,P),c.toBytes(A)}function R(A,l){return _(A,void 0,"message"),l?_(e(A),void 0,"prehashed message"):A}return Object.freeze({keygen:N,getPublicKey:E,getSharedSecret:w,utils:a,lengths:O,Point:f,sign:function(A,l,g={}){A=Y("message",A);let{seed:s,k2sig:h}=(function(y,I,K){if(["recovered","canonical"].some(L=>L in K))throw Error("sign() legacy options not supported");let{lowS:m,prehash:x,extraEntropy:B}=He(K,b);y=R(y,x);let Z=S(y),F=pe(c,I),j=[C(F),C(Z)];if(B!=null&&B!==!1){let L=B===!0?t(O.secretKey):B;j.push(Y("extraEntropy",L))}let T=Q(...j),U=Z;return{seed:T,k2sig:function(L){let k=p(L);if(!c.isValidNot0(k))return;let z=c.inv(k),G=f.BASE.multiply(k).toAffine(),X=c.create(G.x);if(X===fe)return;let he=c.create(z*c.create(U+X*F));if(he===fe)return;let Be=(G.x===X?0:2)|Number(G.y&ge),we=he;return m&&q(he)&&(we=c.neg(he),Be^=1),new v(X,we,Be)}}})(A,l,g);return(function(y,I,K){if(typeof y!="number"||y<2)throw Error("hashLen must be a number");if(typeof I!="number"||I<2)throw Error("qByteLen must be a number");if(typeof K!="function")throw Error("hmacFn must be a function");let m=k=>new Uint8Array(k),x=k=>Uint8Array.of(k),B=m(y),Z=m(y),F=0,j=()=>{B.fill(1),Z.fill(0),F=0},T=(...k)=>K(Z,B,...k),U=(k=m(0))=>{Z=T(x(0),k),B=T(),k.length!==0&&(Z=T(x(1),k),B=T())},L=()=>{if(F++>=1e3)throw Error("drbg: tried 1000 values");let k=0,z=[];for(;k<I;){B=T();let G=B.slice();z.push(G),k+=B.length}return Q(...z)};return(k,z)=>{let G;for(j(),U(k);!(G=z(L()));)U();return j(),G}})(e.outputLen,c.BYTES,n)(s,h)},verify:function(A,l,g,s={}){let{lowS:h,prehash:y,format:I}=He(s,b);if(g=Y("publicKey",g),l=R(Y("message",l),y),"strict"in s)throw Error("options.strict was renamed to lowS");let K=I===void 0?(function(m){let x,B=typeof m=="string"||Ee(m),Z=!B&&m!==null&&typeof m=="object"&&typeof m.r=="bigint"&&typeof m.s=="bigint";if(!B&&!Z)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(Z)x=new v(m.r,m.s);else if(B){try{x=v.fromBytes(Y("sig",m),"der")}catch(F){if(!(F instanceof te.Err))throw F}if(!x)try{x=v.fromBytes(Y("sig",m),"compact")}catch{return!1}}return x||!1})(A):v.fromBytes(Y("sig",A),I);if(K===!1)return!1;try{let m=f.fromBytes(g);if(h&&K.hasHighS())return!1;let{r:x,s:B}=K,Z=S(l),F=c.inv(B),j=c.create(Z*F),T=c.create(x*F),U=f.BASE.multiplyUnsafe(j).add(m.multiplyUnsafe(T));return U.is0()?!1:c.create(U.x)===x}catch{return!1}},recoverPublicKey:function(A,l,g={}){let{prehash:s}=He(g,b);return l=R(l,s),v.fromBytes(A,"recovered").recoverPublicKey(l).toBytes()},Signature:v,hash:e})}function df(f){let{CURVE:e,curveOpts:r}=(function(n){let o={a:n.a,b:n.b,p:n.Fp.ORDER,n:n.n,h:n.h,Gx:n.Gx,Gy:n.Gy},c=n.Fp,d=n.allowedPrivateKeyLengths?Array.from(new Set(n.allowedPrivateKeyLengths.map(i=>Math.ceil(i/2)))):void 0;return{CURVE:o,curveOpts:{Fp:c,Fn:J(o.n,{BITS:n.nBitLength,allowedLengths:d,modFromBytes:n.wrapPrivateKey}),allowInfinityPoint:n.allowInfinityPoint,endo:n.endo,isTorsionFree:n.isTorsionFree,clearCofactor:n.clearCofactor,fromBytes:n.fromBytes,toBytes:n.toBytes}}})(f),t={hmac:f.hmac,randomBytes:f.randomBytes,lowS:f.lowS,bits2int:f.bits2int,bits2int_modN:f.bits2int_modN};return{CURVE:e,curveOpts:r,hash:f.hash,ecdsaOpts:t}}function uf(f){let{CURVE:e,curveOpts:r,hash:t,ecdsaOpts:n}=df(f);return(function(o,c){let d=c.Point;return Object.assign({},c,{ProjectivePoint:d,CURVE:Object.assign({},o,Tt(d.Fn.ORDER,d.Fn.BITS))})})(f,af(sf(e,r),t,n))}function ue(f,e){let r=t=>uf(re(ee({},f),{hash:t}));return re(ee({},r(e)),{create:r})}var Mt={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},$t={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},Wt={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},lf=J(Mt.p),hf=J($t.p),bf=J(Wt.p),gf=ue(re(ee({},Mt),{Fp:lf,lowS:!1}),Te),pf=ue(re(ee({},$t),{Fp:hf,lowS:!1}),ct),yf=ue(re(ee({},Wt),{Fp:bf,lowS:!1,allowedPrivateKeyLengths:[130,131,132]}),st),oe=BigInt(0),M=BigInt(1),Ye=BigInt(2),mf=BigInt(8);function Jt(f,e={}){let r=Yt("edwards",f,e,e.FpFnLE),{Fp:t,Fn:n}=r,o=r.CURVE,{h:c}=o;me(e,{},{uvRatio:"function"});let d=Ye<<BigInt(8*n.BYTES)-M,i=q=>t.create(q),N=e.uvRatio||((q,u)=>{try{return{isValid:!0,value:t.sqrt(t.div(q,u))}}catch{return{isValid:!1,value:oe}}});if(!(function(q,u,v,p){let S=q.sqr(v),P=q.sqr(p),C=q.add(q.mul(u.a,S),P),R=q.add(q.ONE,q.mul(u.d,q.mul(S,P)));return q.eql(C,R)})(t,o,o.Gx,o.Gy))throw Error("bad curve params: generator point");function E(q,u,v=!1){return Oe("coordinate "+q,u,v?M:oe,d),u}function w(q){if(!(q instanceof b))throw Error("ExtendedPoint expected")}let a=Ze((q,u)=>{let{X:v,Y:p,Z:S}=q,P=q.is0();u==null&&(u=P?mf:t.inv(S));let C=i(v*u),R=i(p*u),A=t.mul(S,u);if(P)return{x:oe,y:M};if(A!==M)throw Error("invZ was invalid");return{x:C,y:R}}),O=Ze(q=>{let{a:u,d:v}=o;if(q.is0())throw Error("bad point: ZERO");let{X:p,Y:S,Z:P,T:C}=q,R=i(p*p),A=i(S*S),l=i(P*P),g=i(l*l),s=i(R*u);if(i(l*i(s+A))!==i(g+i(v*i(R*A))))throw Error("bad point: equation left != right (1)");if(i(p*S)!==i(P*C))throw Error("bad point: equation left != right (2)");return!0});class b{constructor(u,v,p,S){this.X=E("x",u),this.Y=E("y",v),this.Z=E("z",p,!0),this.T=E("t",S),Object.freeze(this)}static CURVE(){return o}static fromAffine(u){if(u instanceof b)throw Error("extended point not allowed");let{x:v,y:p}=u||{};return E("x",v),E("y",p),new b(v,p,M,i(v*p))}static fromBytes(u,v=!1){let p=t.BYTES,{a:S,d:P}=o;u=ht(_(u,p,"point")),ae(v,"zip215");let C=ht(u),R=u[p-1];C[p-1]=-129&R;let A=de(C),l=v?d:t.ORDER;Oe("point.y",A,oe,l);let g=i(A*A),s=i(g-M),h=i(P*g-S),{isValid:y,value:I}=N(s,h);if(!y)throw Error("bad point: invalid y coordinate");let K=(I&M)===M,m=!!(128&R);if(!v&&I===oe&&m)throw Error("bad point: x=0 and x_0=1");return m!==K&&(I=i(-I)),b.fromAffine({x:I,y:A})}static fromHex(u,v=!1){return b.fromBytes(Y("point",u),v)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(u=8,v=!0){return V.createCache(this,u),v||this.multiply(Ye),this}assertValidity(){O(this)}equals(u){w(u);let{X:v,Y:p,Z:S}=this,{X:P,Y:C,Z:R}=u,A=i(v*R),l=i(P*S),g=i(p*R),s=i(C*S);return A===l&&g===s}is0(){return this.equals(b.ZERO)}negate(){return new b(i(-this.X),this.Y,this.Z,i(-this.T))}double(){let{a:u}=o,{X:v,Y:p,Z:S}=this,P=i(v*v),C=i(p*p),R=i(Ye*i(S*S)),A=i(u*P),l=v+p,g=i(i(l*l)-P-C),s=A+C,h=s-R,y=A-C,I=i(g*h),K=i(s*y),m=i(g*y),x=i(h*s);return new b(I,K,x,m)}add(u){w(u);let{a:v,d:p}=o,{X:S,Y:P,Z:C,T:R}=this,{X:A,Y:l,Z:g,T:s}=u,h=i(S*A),y=i(P*l),I=i(R*p*s),K=i(C*g),m=i((S+P)*(A+l)-h-y),x=K-I,B=K+I,Z=i(y-v*h),F=i(m*x),j=i(B*Z),T=i(m*Z),U=i(x*B);return new b(F,j,U,T)}subtract(u){return this.add(u.negate())}multiply(u){if(!n.isValidNot0(u))throw Error("invalid scalar: expected 1 <= sc < curve.n");let{p:v,f:p}=V.cached(this,u,S=>ce(b,S));return ce(b,[v,p])[0]}multiplyUnsafe(u,v=b.ZERO){if(!n.isValid(u))throw Error("invalid scalar: expected 0 <= sc < curve.n");return u===oe?b.ZERO:this.is0()||u===M?this:V.unsafe(this,u,p=>ce(b,p),v)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return V.unsafe(this,o.n).is0()}toAffine(u){return a(this,u)}clearCofactor(){return c===M?this:this.multiplyUnsafe(c)}toBytes(){let{x:u,y:v}=this.toAffine(),p=t.toBytes(v);return p[p.length-1]|=u&M?128:0,p}toHex(){return ne(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(u){return ce(b,u)}static msm(u,v){return Ht(b,n,u,v)}_setWindowSize(u){this.precompute(u)}toRawBytes(){return this.toBytes()}}b.BASE=new b(o.Gx,o.Gy,M,i(o.Gx*o.Gy)),b.ZERO=new b(oe,M,M,oe),b.Fp=t,b.Fn=n;let V=new Pe(b,n.BITS);return b.BASE.precompute(8),b}function Bf(f,e,r={}){if(typeof e!="function")throw Error('"hash" function param is required');me(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:t}=r,{BASE:n,Fp:o,Fn:c}=f,d=r.randomBytes||ve,i=r.adjustScalarBytes||(p=>p),N=r.domain||((p,S,P)=>{if(ae(P,"phflag"),S.length||P)throw Error("Contexts/pre-hash are not supported");return p});function E(p){return c.create(de(p))}function w(p){let{head:S,prefix:P,scalar:C}=(function(l){let g=q.secretKey;l=Y("private key",l,g);let s=Y("hashed private key",e(l),2*g),h=i(s.slice(0,g));return{head:h,prefix:s.slice(g,2*g),scalar:E(h)}})(p),R=n.multiply(C),A=R.toBytes();return{head:S,prefix:P,scalar:C,point:R,pointBytes:A}}function a(p){return w(p).pointBytes}function O(p=Uint8Array.of(),...S){let P=Q(...S);return E(e(N(P,Y("context",p),!!t)))}let b={zip215:!0},V=o.BYTES,q={secretKey:V,publicKey:V,signature:2*V,seed:V};function u(p=d(q.seed)){return _(p,q.seed,"seed")}let v={getExtendedPublicKey:w,randomSecretKey:u,isValidSecretKey:function(p){return Ee(p)&&p.length===c.BYTES},isValidPublicKey:function(p,S){try{return!!f.fromBytes(p,S)}catch{return!1}},toMontgomery(p){let{y:S}=f.fromBytes(p),P=q.publicKey,C=P===32;if(!C&&P!==57)throw Error("only defined for 25519 and 448");let R=C?o.div(M+S,M-S):o.div(S-M,S+M);return o.toBytes(R)},toMontgomerySecret(p){let S=q.secretKey;_(p,S);let P=e(p.subarray(0,S));return i(P).subarray(0,S)},randomPrivateKey:u,precompute:(p=8,S=f.BASE)=>S.precompute(p,!1)};return Object.freeze({keygen:function(p){let S=v.randomSecretKey(p);return{secretKey:S,publicKey:a(S)}},getPublicKey:a,sign:function(p,S,P={}){p=Y("message",p),t&&(p=t(p));let{prefix:C,scalar:R,pointBytes:A}=w(S),l=O(P.context,C,p),g=n.multiply(l).toBytes(),s=O(P.context,g,A,p),h=c.create(l+s*R);if(!c.isValid(h))throw Error("sign failed: invalid s");return _(Q(g,c.toBytes(h)),q.signature,"result")},verify:function(p,S,P,C=b){let{context:R,zip215:A}=C,l=q.signature;p=Y("signature",p,l),S=Y("message",S),P=Y("publicKey",P,q.publicKey),A!==void 0&&ae(A,"zip215"),t&&(S=t(S));let g=l/2,s=p.subarray(0,g),h=de(p.subarray(g,l)),y,I,K;try{y=f.fromBytes(P,A),I=f.fromBytes(s,A),K=n.multiplyUnsafe(h)}catch{return!1}if(!A&&y.isSmallOrder())return!1;let m=O(R,I.toBytes(),y.toBytes(),S);return I.add(y.multiplyUnsafe(m)).subtract(K).clearCofactor().is0()},utils:v,Point:f,lengths:q})}var Ie=BigInt(0),be=BigInt(1),qe=BigInt(2);function wf(f){let e=(me(r=f,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze(ee({},r)));var r;let{P:t,type:n,adjustScalarBytes:o,powPminus2:c,randomBytes:d}=e,i=n==="x25519";if(!i&&n!=="x448")throw Error("invalid type");let N=d||ve,E=i?255:448,w=i?32:56,a=BigInt(i?9:5),O=BigInt(i?121665:39081),b=i?qe**BigInt(254):qe**BigInt(447),V=i?BigInt(8)*qe**BigInt(251)-be:BigInt(4)*qe**BigInt(445)-be,q=b+V+be,u=l=>D(l,t),v=p(a);function p(l){return Qe(u(l),w)}function S(l,g){let s=(function(h,y){Oe("u",h,Ie,t),Oe("scalar",y,b,q);let I=y,K=h,m=be,x=Ie,B=h,Z=be,F=Ie;for(let T=BigInt(E-1);T>=Ie;T--){let U=I>>T&be;F^=U,{x_2:m,x_3:B}=C(F,m,B),{x_2:x,x_3:Z}=C(F,x,Z),F=U;let L=m+x,k=u(L*L),z=m-x,G=u(z*z),X=k-G,he=B+Z,Be=u((B-Z)*L),we=u(he*z),et=Be+we,tt=Be-we;B=u(et*et),Z=u(K*u(tt*tt)),m=u(k*G),x=u(X*(k+u(O*X)))}({x_2:m,x_3:B}=C(F,m,B)),{x_2:x,x_3:Z}=C(F,x,Z);let j=c(x);return u(m*j)})((function(h){let y=Y("u coordinate",h,w);return i&&(y[31]&=127),u(de(y))})(g),(function(h){return de(o(Y("scalar",h,w)))})(l));if(s===Ie)throw Error("invalid private or public key received");return p(s)}function P(l){return S(l,v)}function C(l,g,s){let h=u(l*(g-s));return{x_2:g=u(g-h),x_3:s=u(s+h)}}let R={secretKey:w,publicKey:w,seed:w},A=(l=N(w))=>(Re(l,R.seed),l);return{keygen:function(l){let g=A(l);return{secretKey:g,publicKey:P(g)}},getSharedSecret:(l,g)=>S(l,g),getPublicKey:l=>P(l),scalarMult:S,scalarMultBase:P,utils:{randomSecretKey:A,randomPrivateKey:A},GuBytes:v.slice(),lengths:R}}var le={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")},Ef=Object.assign({},le,{d:BigInt("0xd78b4bdc7f0daf19f24f38c29373a2ccad46157242a50f37809b1da3412a12e79ccc9c81264cfe9ad080997058fb61c4243cc32dbaa156b9"),Gx:BigInt("0x79a70b2b70400553ae7c9df416c792c61128751ac92969240c25a07d728bdc93e21f7787ed6972249de732f38496cd11698713093e9c04fc"),Gy:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000001")}),xf=it(()=>at.create({dkLen:114})),vf=BigInt(1),Xe=BigInt(2),vt=BigInt(3);BigInt(4);var If=BigInt(11),Of=BigInt(22),It=BigInt(44),Sf=BigInt(88),Rf=BigInt(223);function Qt(f){let e=le.p,r=f*f*f%e,t=r*r*f%e,n=H(t,vt,e)*t%e,o=H(n,vt,e)*t%e,c=H(o,Xe,e)*r%e,d=H(c,If,e)*c%e,i=H(d,Of,e)*d%e,N=H(i,It,e)*i%e,E=H(N,Sf,e)*N%e,w=H(E,It,e)*i%e,a=H(w,Xe,e)*r%e,O=H(a,vf,e)*f%e;return H(O,Rf,e)*a%e}function _t(f){return f[0]&=252,f[55]|=128,f[56]=0,f}function Ff(f,e){let r=le.p,t=D(f*f*e,r),n=D(t*f,r),o=D(n*t*e,r),c=D(n*Qt(o),r),d=D(c*c,r);return{isValid:D(d*e,r)===f,value:c}}var Af=J(le.p,{BITS:456,isLE:!0}),Ot=J(le.n,{BITS:456,isLE:!0});function qf(f,e,r){if(e.length>255)throw Error("context must be smaller than 255, got: "+e.length);return Q((t="SigEd448",Uint8Array.from(t,(n,o)=>{let c=n.charCodeAt(0);if(n.length!==1||c>127)throw Error(`string contains non-ASCII character "${t[o]}" with code ${c} at position ${o}`);return c})),new Uint8Array([r?1:0,e.length]),e,f);var t}var Zf=(function(f){let{CURVE:e,curveOpts:r,hash:t,eddsaOpts:n}=(function(o){let c={a:o.a,d:o.d,p:o.Fp.ORDER,n:o.n,h:o.h,Gx:o.Gx,Gy:o.Gy},d={Fp:o.Fp,Fn:J(c.n,o.nBitLength,!0),uvRatio:o.uvRatio},i={randomBytes:o.randomBytes,adjustScalarBytes:o.adjustScalarBytes,domain:o.domain,prehash:o.prehash,mapToCurve:o.mapToCurve};return{CURVE:c,curveOpts:d,hash:o.hash,eddsaOpts:i}})(f);return(function(o,c){let d=c.Point;return Object.assign({},c,{ExtendedPoint:d,CURVE:o,nBitLength:d.Fn.BITS,nByteLength:d.Fn.BYTES})})(f,Bf(Jt(e,r),t,n))})(re(ee({},le),{Fp:Af,Fn:Ot,nBitLength:Ot.BITS,hash:xf,adjustScalarBytes:_t,domain:qf,uvRatio:Ff}));Jt(Ef);var Kf=(()=>{let f=le.p;return wf({P:f,type:"x448",powPminus2:e=>D(H(Qt(e),Xe,f)*e,f),adjustScalarBytes:_t})})(),Me={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},Nf={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},St=BigInt(2);var $e=J(Me.p,{sqrt:function(f){let e=Me.p,r=BigInt(3),t=BigInt(6),n=BigInt(11),o=BigInt(22),c=BigInt(23),d=BigInt(44),i=BigInt(88),N=f*f*f%e,E=N*N*f%e,w=H(E,r,e)*E%e,a=H(w,r,e)*E%e,O=H(a,St,e)*N%e,b=H(O,n,e)*O%e,V=H(b,o,e)*b%e,q=H(V,d,e)*V%e,u=H(q,i,e)*q%e,v=H(u,d,e)*V%e,p=H(v,r,e)*E%e,S=H(p,c,e)*b%e,P=H(S,t,e)*N%e,C=H(P,St,e);if(!$e.eql($e.sqr(C),f))throw Error("Cannot find square root");return C}}),Pf=ue(re(ee({},Me),{Fp:$e,lowS:!0,endo:Nf}),Te),Rt=J(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),Uf=ue({a:Rt.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:Rt,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},dt),Ft=J(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),Vf=ue({a:Ft.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:Ft,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},lt),At=J(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),Cf=ue({a:At.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:At,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},ut),kf=new Map(Object.entries({nistP256:gf,nistP384:pf,nistP521:yf,brainpoolP256r1:Uf,brainpoolP384r1:Vf,brainpoolP512r1:Cf,secp256k1:Pf,x448:Kf,ed448:Zf}));export{kf as nobleCurves};
