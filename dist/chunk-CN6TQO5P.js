import{a as ae,b as c1,c as Pr,g as x}from"./chunk-GAL4ENT6.js";var De=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},En=Symbol("doneWritingPromise"),V0=Symbol("doneWritingResolve"),$0=Symbol("doneWritingReject"),Nn=Symbol("readingIndex"),Re=class extends Array{constructor(){super(),this[En]=new Promise((e,t)=>{this[V0]=e,this[$0]=t}),this[En].catch(()=>{})}};function re(r){return r&&r.getReader&&Array.isArray(r)}function qn(r){if(!re(r)){let e=r.getWriter(),t=e.releaseLock;return e.releaseLock=()=>{e.closed.catch(function(){}),t.call(e)},e}this.stream=r}Re.prototype.getReader=function(){return this[Nn]===void 0&&(this[Nn]=0),{read:()=>x(this,null,function*(){return yield this[En],this[Nn]===this.length?{value:void 0,done:!0}:{value:this[this[Nn]++],done:!1}})}},Re.prototype.readToEnd=function(r){return x(this,null,function*(){yield this[En];let e=r(this.slice(this[Nn]));return this.length=0,e})},Re.prototype.clone=function(){let r=new Re;return r[En]=this[En].then(()=>{r.push(...this)}),r},qn.prototype.write=function(r){return x(this,null,function*(){this.stream.push(r)})},qn.prototype.close=function(){return x(this,null,function*(){this.stream[V0]()})},qn.prototype.abort=function(r){return x(this,null,function*(){return this.stream[$0](r),r})},qn.prototype.releaseLock=function(){};var za=typeof De.process=="object"&&typeof De.process.versions=="object",h1=za&&void 0;function Se(r){return re(r)?"array":De.ReadableStream&&De.ReadableStream.prototype.isPrototypeOf(r)?"web":Er&&Er.prototype.isPrototypeOf(r)?"ponyfill":h1&&h1.prototype.isPrototypeOf(r)?"node":!(!r||!r.getReader)&&"web-like"}function Ra(r){return Uint8Array.prototype.isPrototypeOf(r)}function Z0(r){if(r.length===1)return r[0];let e=0;for(let i=0;i<r.length;i++){if(!Ra(r[i]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");e+=r[i].length}let t=new Uint8Array(e),n=0;return r.forEach(function(i){t.set(i,n),n+=i.length}),t}var co=za&&void 0,u1=za&&void 0,Ma,qs;if(u1){Ma=function(e){let t=!1;return new Er({start(n){e.pause(),e.on("data",i=>{t||(co.isBuffer(i)&&(i=new Uint8Array(i.buffer,i.byteOffset,i.byteLength)),n.enqueue(i),e.pause())}),e.on("end",()=>{t||n.close()}),e.on("error",i=>n.error(i))},pull(){e.resume()},cancel(n){t=!0,e.destroy(n)}})};class r extends u1{constructor(t,n){super(n),this._reader=yr(t)}_read(t){return x(this,null,function*(){try{for(;;){let{done:n,value:i}=yield this._reader.read();if(n){this.push(null);break}if(!this.push(i))break}}catch(n){this.destroy(n)}})}_destroy(t,n){return x(this,null,function*(){this._reader.cancel(t).then(n,n)})}}qs=function(e,t){return new r(e,t)}}var l1=new WeakSet,$t=Symbol("externalBuffer");function Xe(r){if(this.stream=r,r[$t]&&(this[$t]=r[$t].slice()),re(r)){let n=r.getReader();return this._read=n.read.bind(n),this._releaseLock=()=>{},void(this._cancel=()=>x(this,null,function*(){}))}let e=Se(r);if(e==="node"&&(r=Ma(r)),e){let n=r.getReader();return this._read=n.read.bind(n),this._releaseLock=()=>{n.closed.catch(function(){}),n.releaseLock()},void(this._cancel=n.cancel.bind(n))}let t=!1;this._read=()=>x(this,null,function*(){return t||l1.has(r)?{value:void 0,done:!0}:(t=!0,{value:r,done:!1})}),this._releaseLock=()=>{if(t)try{l1.add(r)}catch{}}}Xe.prototype.read=function(){return x(this,null,function*(){return this[$t]&&this[$t].length?{done:!1,value:this[$t].shift()}:this._read()})},Xe.prototype.releaseLock=function(){this[$t]&&(this.stream[$t]=this[$t]),this._releaseLock()},Xe.prototype.cancel=function(r){return this._cancel(r)},Xe.prototype.readLine=function(){return x(this,null,function*(){let r,e=[];for(;!r;){let{done:t,value:n}=yield this.read();if(n+="",t)return e.length?Ke(e):void 0;let i=n.indexOf(`
`)+1;i&&(r=Ke(e.concat(n.substr(0,i))),e=[]),i!==n.length&&e.push(n.substr(i))}return this.unshift(...e),r})},Xe.prototype.readByte=function(){return x(this,null,function*(){let{done:r,value:e}=yield this.read();if(r)return;let t=e[0];return this.unshift(fe(e,1)),t})},Xe.prototype.readBytes=function(r){return x(this,null,function*(){let e=[],t=0;for(;;){let{done:n,value:i}=yield this.read();if(n)return e.length?Ke(e):void 0;if(e.push(i),t+=i.length,t>=r){let a=Ke(e);return this.unshift(fe(a,r)),fe(a,0,r)}}})},Xe.prototype.peekBytes=function(r){return x(this,null,function*(){let e=yield this.readBytes(r);return this.unshift(e),e})},Xe.prototype.unshift=function(...r){this[$t]||(this[$t]=[]),r.length===1&&Ra(r[0])&&this[$t].length&&r[0].length&&this[$t][0].byteOffset>=r[0].length?this[$t][0]=new Uint8Array(this[$t][0].buffer,this[$t][0].byteOffset-r[0].length,this[$t][0].byteLength+r[0].length):this[$t].unshift(...r.filter(e=>e&&e.length))},Xe.prototype.readToEnd=function(){return x(this,arguments,function*(r=Ke){let e=[];for(;;){let{done:t,value:n}=yield this.read();if(t)break;e.push(n)}return r(e)})};var vs,X0,{ReadableStream:Er,WritableStream:Q0,TransformStream:Dn}=De;function Y0(){return x(this,null,function*(){if(Dn)return;let[r,e]=yield Promise.all([import("./chunk-I254DYM4.js"),import("./chunk-5LPZZSSW.js")]);({ReadableStream:Er,WritableStream:Q0,TransformStream:Dn}=r);let{createReadableStreamWrapper:t}=e;De.ReadableStream&&Er!==De.ReadableStream&&(vs=t(Er),X0=t(De.ReadableStream))})}var ei=za&&void 0;function Pi(r){let e=Se(r);return e==="node"?Ma(r):e==="web"&&vs?vs(r):e?r:new Er({start(t){t.enqueue(r),t.close()}})}function J0(r){if(Se(r))return r;let e=new Re;return x(this,null,function*(){let t=xe(e);yield t.write(r),yield t.close()}),e}function Ke(r){return r.some(e=>Se(e)&&!re(e))?function(e){e=e.map(Pi);let t=e2(function(a){return x(this,null,function*(){yield Promise.all(i.map(o=>As(o,a)))})}),n=Promise.resolve(),i=e.map((a,o)=>_r(a,(s,h)=>(n=n.then(()=>Hr(s,t.writable,{preventClose:o!==e.length-1})),n)));return t.readable}(r):r.some(e=>re(e))?function(e){let t=new Re,n=Promise.resolve();return e.forEach((i,a)=>(n=n.then(()=>Hr(i,t,{preventClose:a!==e.length-1})),n)),t}(r):typeof r[0]=="string"?r.join(""):ei&&ei.isBuffer(r[0])?ei.concat(r):Z0(r)}function yr(r){return new Xe(r)}function xe(r){return new qn(r)}function Hr(a,o){return x(this,arguments,function*(r,e,{preventClose:t=!1,preventAbort:n=!1,preventCancel:i=!1}={}){if(Se(r)&&!re(r)){r=Pi(r);try{if(r[$t]){let c=xe(e);for(let u=0;u<r[$t].length;u++)yield c.ready,yield c.write(r[$t][u]);c.releaseLock()}yield r.pipeTo(e,{preventClose:t,preventAbort:n,preventCancel:i})}catch{}return}let s=yr(r=J0(r)),h=xe(e);try{for(;;){yield h.ready;let{done:c,value:u}=yield s.read();if(c){t||(yield h.close());break}yield h.write(u)}}catch(c){n||(yield h.abort(c))}finally{s.releaseLock(),h.releaseLock()}})}function t2(r,e){let t=new Dn(e);return Hr(r,t.writable),t.readable}function e2(r){let e,t,n,i=!1,a=!1;return{readable:new Er({start(s){n=s},pull(){e?e():i=!0},cancel(s){return x(this,null,function*(){a=!0,r&&(yield r(s)),t&&t(s)})}},{highWaterMark:0}),writable:new Q0({write:function(s){return x(this,null,function*(){if(a)throw Error("Stream is cancelled");n.enqueue(s),i?i=!1:(yield new Promise((h,c)=>{e=h,t=c}),e=null,t=null)})},close:n.close.bind(n),abort:n.error.bind(n)})}}function ee(r,e=()=>{},t=()=>{}){if(re(r)){let o=new Re;return x(this,null,function*(){let s=xe(o);try{let h=yield ie(r),c=e(h),u=t(),y;y=c!==void 0&&u!==void 0?Ke([c,u]):c!==void 0?c:u,yield s.write(y),yield s.close()}catch(h){yield s.abort(h)}}),o}if(Se(r))return t2(r,{transform(o,s){return x(this,null,function*(){try{let h=yield e(o);h!==void 0&&s.enqueue(h)}catch(h){s.error(h)}})},flush(o){return x(this,null,function*(){try{let s=yield t();s!==void 0&&o.enqueue(s)}catch(s){o.error(s)}})}});let n=e(r),i=t();return n!==void 0&&i!==void 0?Ke([n,i]):n!==void 0?n:i}function _r(r,e){if(Se(r)&&!re(r)){let n,i=new Dn({start(s){n=s}}),a=Hr(r,i.writable),o=e2(function(s){return x(this,null,function*(){n.error(s),yield a,yield new Promise(setTimeout)})});return e(i.readable,o.writable),o.readable}r=J0(r);let t=new Re;return e(r,t),t}function La(r,e){let t,n=_r(r,(i,a)=>{let o=yr(i);o.remainder=()=>(o.releaseLock(),Hr(i,a),n),t=e(o)});return t}function an(r){if(re(r))return r.clone();if(Se(r)){let e=function(t){if(re(t))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(Se(t)){let n=Pi(t).tee();return n[0][$t]=n[1][$t]=t[$t],n}return[fe(t),fe(t)]}(r);return r2(r,e[0]),e[1]}return fe(r)}function xn(r){return re(r)?an(r):Se(r)?new Er({start(e){let t=_r(r,(n,i)=>x(this,null,function*(){let a=yr(n),o=xe(i);try{for(;;){yield o.ready;let{done:s,value:h}=yield a.read();if(s){try{e.close()}catch{}return void(yield o.close())}try{e.enqueue(h)}catch{}yield o.write(h)}}catch(s){e.error(s),yield o.abort(s)}}));r2(r,t)}}):fe(r)}function r2(r,e){Object.entries(Object.getOwnPropertyDescriptors(r.constructor.prototype)).forEach(([t,n])=>{t!=="constructor"&&(n.value?n.value=n.value.bind(e):n.get=n.get.bind(e),Object.defineProperty(r,t,n))})}function fe(r,e=0,t=1/0){if(re(r))throw Error("Not implemented");if(Se(r)){if(e>=0&&t>=0){let n=0;return t2(r,{transform(i,a){n<t?(n+i.length>=e&&a.enqueue(fe(i,Math.max(e-n,0),t-n)),n+=i.length):a.terminate()}})}if(e<0&&(t<0||t===1/0)){let n=[];return ee(r,i=>{i.length>=-e?n=[i]:n.push(i)},()=>fe(Ke(n),e,t))}if(e===0&&t<0){let n;return ee(r,i=>{let a=n?Ke([n,i]):i;if(a.length>=-t)return n=fe(a,t),fe(a,e,t);n=a})}return console.warn(`stream.slice(input, ${e}, ${t}) not implemented efficiently.`),Gr(()=>x(this,null,function*(){return fe(yield ie(r),e,t)}))}return r[$t]&&(r=Ke(r[$t].concat([r]))),!Ra(r)||ei&&ei.isBuffer(r)?r.slice(e,t):(t===1/0&&(t=r.length),r.subarray(e,t))}function ie(t){return x(this,arguments,function*(r,e=Ke){return re(r)?r.readToEnd(e):Se(r)?yr(r).readToEnd(e):r})}function As(r,e){return x(this,null,function*(){if(Se(r)){if(r.cancel)return r.cancel(e);if(r.destroy)return r.destroy(e),yield new Promise(setTimeout),e}})}function Gr(r){let e=new Re;return x(this,null,function*(){let t=xe(e);try{yield t.write(yield r()),yield t.close()}catch(n){yield t.abort(n)}}),e}var Es=class r{constructor(e){if(e===void 0)throw Error("Invalid BigInteger input");if(e instanceof Uint8Array){let t=e,n=Array(t.length);for(let i=0;i<t.length;i++){let a=t[i].toString(16);n[i]=t[i]<=15?"0"+a:a}this.value=BigInt("0x0"+n.join(""))}else this.value=BigInt(e)}clone(){return new r(this.value)}iinc(){return this.value++,this}inc(){return this.clone().iinc()}idec(){return this.value--,this}dec(){return this.clone().idec()}iadd(e){return this.value+=e.value,this}add(e){return this.clone().iadd(e)}isub(e){return this.value-=e.value,this}sub(e){return this.clone().isub(e)}imul(e){return this.value*=e.value,this}mul(e){return this.clone().imul(e)}imod(e){return this.value%=e.value,this.isNegative()&&this.iadd(e),this}mod(e){return this.clone().imod(e)}modExp(e,t){if(t.isZero())throw Error("Modulo cannot be zero");if(t.isOne())return new r(0);if(e.isNegative())throw Error("Unsopported negative exponent");let n=e.value,i=this.value;i%=t.value;let a=BigInt(1);for(;n>BigInt(0);){let o=n&BigInt(1);n>>=BigInt(1);let s=a*i%t.value;a=o?s:a,i=i*i%t.value}return new r(a)}modInv(e){let{gcd:t,x:n}=this._egcd(e);if(!t.isOne())throw Error("Inverse does not exist");return n.add(e).mod(e)}_egcd(e){let t=BigInt(0),n=BigInt(1),i=BigInt(1),a=BigInt(0),o=this.value;for(e=e.value;e!==BigInt(0);){let s=o/e,h=t;t=i-s*t,i=h,h=n,n=a-s*n,a=h,h=e,e=o%e,o=h}return{x:new r(i),y:new r(a),gcd:new r(o)}}gcd(e){let t=this.value;for(e=e.value;e!==BigInt(0);){let n=e;e=t%e,t=n}return new r(t)}ileftShift(e){return this.value<<=e.value,this}leftShift(e){return this.clone().ileftShift(e)}irightShift(e){return this.value>>=e.value,this}rightShift(e){return this.clone().irightShift(e)}equal(e){return this.value===e.value}lt(e){return this.value<e.value}lte(e){return this.value<=e.value}gt(e){return this.value>e.value}gte(e){return this.value>=e.value}isZero(){return this.value===BigInt(0)}isOne(){return this.value===BigInt(1)}isNegative(){return this.value<BigInt(0)}isEven(){return!(this.value&BigInt(1))}abs(){let e=this.clone();return this.isNegative()&&(e.value=-e.value),e}toString(){return this.value.toString()}toNumber(){let e=Number(this.value);if(e>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return e}getBit(e){return(this.value>>BigInt(e)&BigInt(1))===BigInt(0)?0:1}bitLength(){let e=new r(0),t=new r(1),n=new r(-1),i=this.isNegative()?n:e,a=1,o=this.clone();for(;!o.irightShift(t).equal(i);)a++;return a}byteLength(){let e=new r(0),t=new r(-1),n=this.isNegative()?t:e,i=new r(8),a=1,o=this.clone();for(;!o.irightShift(i).equal(n);)a++;return a}toUint8Array(e="be",t){let n=this.value.toString(16);n.length%2==1&&(n="0"+n);let i=n.length/2,a=new Uint8Array(t||i),o=t?t-i:0,s=0;for(;s<i;)a[s+o]=parseInt(n.slice(2*s,2*s+2),16),s++;return e!=="be"&&a.reverse(),a}},ho=()=>typeof BigInt<"u",On=Symbol("byValue"),d={curve:{p256:"p256","P-256":"p256",secp256r1:"p256",prime256v1:"p256","1.2.840.10045.3.1.7":"p256","2a8648ce3d030107":"p256","2A8648CE3D030107":"p256",p384:"p384","P-384":"p384",secp384r1:"p384","1.3.132.0.34":"p384","2b81040022":"p384","2B81040022":"p384",p521:"p521","P-521":"p521",secp521r1:"p521","1.3.132.0.35":"p521","2b81040023":"p521","2B81040023":"p521",secp256k1:"secp256k1","1.3.132.0.10":"secp256k1","2b8104000a":"secp256k1","2B8104000A":"secp256k1",ed25519Legacy:"ed25519",ED25519:"ed25519",ed25519:"ed25519",Ed25519:"ed25519","1.3.6.1.4.1.11591.15.1":"ed25519","2b06010401da470f01":"ed25519","2B06010401DA470F01":"ed25519",curve25519Legacy:"curve25519",X25519:"curve25519",cv25519:"curve25519",curve25519:"curve25519",Curve25519:"curve25519","1.3.6.1.4.1.3029.1.5.1":"curve25519","2b060104019755010501":"curve25519","2B060104019755010501":"curve25519",brainpoolP256r1:"brainpoolP256r1","1.3.36.3.3.2.8.1.1.7":"brainpoolP256r1","2b2403030208010107":"brainpoolP256r1","2B2403030208010107":"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1","1.3.36.3.3.2.8.1.1.11":"brainpoolP384r1","2b240303020801010b":"brainpoolP384r1","2B240303020801010B":"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1","1.3.36.3.3.2.8.1.1.13":"brainpoolP512r1","2b240303020801010d":"brainpoolP512r1","2B240303020801010D":"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsaLegacy:22,ed25519Legacy:22,eddsa:22,aedh:23,aedsa:24,x25519:25,x448:26,ed25519:27,ed448:28},symmetric:{plaintext:0,idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuer:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4},write:function(r,e){if(typeof e=="number"&&(e=this.read(r,e)),r[e]!==void 0)return r[e];throw Error("Invalid enum value.")},read:function(r,e){if(r[On]||(r[On]=[],Object.entries(r).forEach(([t,n])=>{r[On][n]=t})),r[On][e]!==void 0)return r[On][e];throw Error("Invalid enum value.")}},y1=(()=>{try{return!1}catch{}return!1})(),b={isString:function(r){return typeof r=="string"||r instanceof String},isArray:function(r){return r instanceof Array},isUint8Array:Ra,isStream:Se,readNumber:function(r){let e=0;for(let t=0;t<r.length;t++)e+=256**t*r[r.length-1-t];return e},writeNumber:function(r,e){let t=new Uint8Array(e);for(let n=0;n<e;n++)t[n]=r>>8*(e-n-1)&255;return t},readDate:function(r){let e=b.readNumber(r);return new Date(1e3*e)},writeDate:function(r){let e=Math.floor(r.getTime()/1e3);return b.writeNumber(e,4)},normalizeDate:function(r=Date.now()){return r===null||r===1/0?r:new Date(1e3*Math.floor(+r/1e3))},readMPI:function(r){let e=(r[0]<<8|r[1])+7>>>3;return r.subarray(2,2+e)},leftPad(r,e){let t=new Uint8Array(e),n=e-r.length;return t.set(r,n),t},uint8ArrayToMPI:function(r){let e=b.uint8ArrayBitLength(r);if(e===0)throw Error("Zero MPI");let t=r.subarray(r.length-Math.ceil(e/8)),n=new Uint8Array([(65280&e)>>8,255&e]);return b.concatUint8Array([n,t])},uint8ArrayBitLength:function(r){let e;for(e=0;e<r.length&&r[e]===0;e++);if(e===r.length)return 0;let t=r.subarray(e);return 8*(t.length-1)+b.nbits(t[0])},hexToUint8Array:function(r){let e=new Uint8Array(r.length>>1);for(let t=0;t<r.length>>1;t++)e[t]=parseInt(r.substr(t<<1,2),16);return e},uint8ArrayToHex:function(r){let e=[],t=r.length,n,i=0;for(;i<t;){for(n=r[i++].toString(16);n.length<2;)n="0"+n;e.push(""+n)}return e.join("")},stringToUint8Array:function(r){return ee(r,e=>{if(!b.isString(e))throw Error("stringToUint8Array: Data must be in the form of a string");let t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})},uint8ArrayToString:function(r){let e=[],n=(r=new Uint8Array(r)).length;for(let i=0;i<n;i+=16384)e.push(String.fromCharCode.apply(String,r.subarray(i,i+16384<n?i+16384:n)));return e.join("")},encodeUTF8:function(r){let e=new TextEncoder("utf-8");function t(n,i=!1){return e.encode(n,{stream:!i})}return ee(r,t,()=>t("",!0))},decodeUTF8:function(r){let e=new TextDecoder("utf-8");function t(n,i=!1){return e.decode(n,{stream:!i})}return ee(r,t,()=>t(new Uint8Array,!0))},concat:Ke,concatUint8Array:Z0,equalsUint8Array:function(r,e){if(!b.isUint8Array(r)||!b.isUint8Array(e))throw Error("Data must be in the form of a Uint8Array");if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0},writeChecksum:function(r){let e=0;for(let t=0;t<r.length;t++)e=e+r[t]&65535;return b.writeNumber(e,2)},printDebug:function(r){y1&&console.log("[OpenPGP.js debug]",r)},printDebugError:function(r){y1&&console.error("[OpenPGP.js debug]",r)},nbits:function(r){let e=1,t=r>>>16;return t!==0&&(r=t,e+=16),t=r>>8,t!==0&&(r=t,e+=8),t=r>>4,t!==0&&(r=t,e+=4),t=r>>2,t!==0&&(r=t,e+=2),t=r>>1,t!==0&&(r=t,e+=1),e},double:function(r){let e=new Uint8Array(r.length),t=r.length-1;for(let n=0;n<t;n++)e[n]=r[n]<<1^r[n+1]>>7;return e[t]=r[t]<<1^135*(r[0]>>7),e},shiftRight:function(r,e){if(e)for(let t=r.length-1;t>=0;t--)r[t]>>=e,t>0&&(r[t]|=r[t-1]<<8-e);return r},getWebCrypto:function(){return De!==void 0&&De.crypto&&De.crypto.subtle},getBigInteger:function(){return x(this,null,function*(){if(ho())return Es;{let{default:r}=yield import("./chunk-HS6GM2BW.js");return r}})},getNodeCrypto:function(){},getNodeZlib:function(){},getNodeBuffer:function(){return{}.Buffer},getHardwareConcurrency:function(){return typeof navigator<"u"?navigator.hardwareConcurrency||1:(void 0).cpus().length},isEmailAddress:function(r){return b.isString(r)?/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+([a-zA-Z]{2,}[0-9]*|xn--[a-zA-Z\-0-9]+)))$/.test(r):!1},canonicalizeEOL:function(r){let e=!1;return ee(r,t=>{let n;e&&(t=b.concatUint8Array([new Uint8Array([13]),t])),t[t.length-1]===13?(e=!0,t=t.subarray(0,-1)):e=!1;let i=[];for(let s=0;n=t.indexOf(10,s)+1,n;s=n)t[n-2]!==13&&i.push(n);if(!i.length)return t;let a=new Uint8Array(t.length+i.length),o=0;for(let s=0;s<i.length;s++){let h=t.subarray(i[s-1]||0,i[s]);a.set(h,o),o+=h.length,a[o-1]=13,a[o]=10,o++}return a.set(t.subarray(i[i.length-1]||0),o),a},()=>e?new Uint8Array([13]):void 0)},nativeEOL:function(r){let e=!1;return ee(r,t=>{let n;(t=e&&t[0]!==10?b.concatUint8Array([new Uint8Array([13]),t]):new Uint8Array(t))[t.length-1]===13?(e=!0,t=t.subarray(0,-1)):e=!1;let i=0;for(let a=0;a!==t.length;a=n){n=t.indexOf(13,a)+1,n||(n=t.length);let o=n-(t[n]===10?1:0);a&&t.copyWithin(i,a,o),i+=o-a}return t.subarray(0,i)},()=>e?new Uint8Array([13]):void 0)},removeTrailingSpaces:function(r){return r.split(`
`).map(e=>{let t=e.length-1;for(;t>=0&&(e[t]===" "||e[t]==="	"||e[t]==="\r");t--);return e.substr(0,t+1)}).join(`
`)},wrapError:function(r,e){if(!e)return Error(r);try{e.message=r+": "+e.message}catch{}return e},constructAllowedPackets:function(r){let e={};return r.forEach(t=>{if(!t.tag)throw Error("Invalid input: expected a packet class");e[t.tag]=t}),e},anyPromise:function(r){return new Promise((e,t)=>x(this,null,function*(){let n;yield Promise.all(r.map(i=>x(this,null,function*(){try{e(yield i)}catch(a){n=a}}))),t(n)}))},selectUint8Array:function(r,e,t){let n=Math.max(e.length,t.length),i=new Uint8Array(n),a=0;for(let o=0;o<i.length;o++)i[o]=e[o]&256-r|t[o]&255+r,a+=r&o<e.length|1-r&o<t.length;return i.subarray(0,a)},selectUint8:function(r,e,t){return e&256-r|t&255+r},isAES:function(r){return r===d.symmetric.aes128||r===d.symmetric.aes192||r===d.symmetric.aes256}},Xa=b.getNodeBuffer(),sa,oa;function gr(r){let e=new Uint8Array;return ee(r,t=>{e=b.concatUint8Array([e,t]);let n=[],i=Math.floor(e.length/45),a=45*i,o=sa(e.subarray(0,a));for(let s=0;s<i;s++)n.push(o.substr(60*s,60)),n.push(`
`);return e=e.subarray(a),n.join("")},()=>e.length?sa(e)+`
`:"")}function n2(r){let e="";return ee(r,t=>{e+=t;let n=0,i=[" ","	","\r",`
`];for(let s=0;s<i.length;s++){let h=i[s];for(let c=e.indexOf(h);c!==-1;c=e.indexOf(h,c+1))n++}let a=e.length;for(;a>0&&(a-n)%4!=0;a--)i.includes(e[a])&&n--;let o=oa(e.substr(0,a));return e=e.substr(a),o},()=>oa(e))}function br(r){return n2(r.replace(/-/g,"+").replace(/_/g,"/"))}function Pe(r,e){let t=gr(r).replace(/[\r\n]/g,"");return e&&(t=t.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,"")),t}Xa?(sa=r=>Xa.from(r).toString("base64"),oa=r=>{let e=Xa.from(r,"base64");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}):(sa=r=>btoa(b.uint8ArrayToString(r)),oa=r=>b.stringToUint8Array(atob(r)));var dt={preferredHashAlgorithm:d.hash.sha256,preferredSymmetricAlgorithm:d.symmetric.aes256,preferredCompressionAlgorithm:d.compression.uncompressed,deflateLevel:6,aeadProtect:!1,preferredAEADAlgorithm:d.aead.eax,aeadChunkSizeByte:12,v5Keys:!1,s2kIterationCountByte:224,allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,checksumRequired:!1,minRSABits:2047,passwordCollisionCheck:!1,revocationsExpire:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([d.symmetric.aes128,d.symmetric.aes192,d.symmetric.aes256]),minBytesForWebCrypto:1e3,ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,additionalAllowedPackets:[],showVersion:!1,showComment:!1,versionString:"OpenPGP.js 5.11.2",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:[],useIndutnyElliptic:!0,rejectHashAlgorithms:new Set([d.hash.md5,d.hash.ripemd]),rejectMessageHashAlgorithms:new Set([d.hash.md5,d.hash.ripemd,d.hash.sha1]),rejectPublicKeyAlgorithms:new Set([d.publicKey.elgamal,d.publicKey.dsa]),rejectCurves:new Set([d.curve.secp256k1])};function uo(r){let e=r.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!e)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(e[1])?d.armor.multipartSection:/MESSAGE, PART \d+/.test(e[1])?d.armor.multipartLast:/SIGNED MESSAGE/.test(e[1])?d.armor.signed:/MESSAGE/.test(e[1])?d.armor.message:/PUBLIC KEY BLOCK/.test(e[1])?d.armor.publicKey:/PRIVATE KEY BLOCK/.test(e[1])?d.armor.privateKey:/SIGNATURE/.test(e[1])?d.armor.signature:void 0}function Wr(r,e){let t="";return e.showVersion&&(t+="Version: "+e.versionString+`
`),e.showComment&&(t+="Comment: "+e.commentString+`
`),r&&(t+="Comment: "+r+`
`),t+=`
`,t}function Cr(r){return gr(function(e){let t=13501623;return ee(e,n=>{let i=lo?Math.floor(n.length/4):0,a=new Uint32Array(n.buffer,n.byteOffset,i);for(let o=0;o<i;o++)t^=a[o],t=le[0][t>>24&255]^le[1][t>>16&255]^le[2][t>>8&255]^le[3][t>>0&255];for(let o=4*i;o<n.length;o++)t=t>>8^le[0][255&t^n[o]]},()=>new Uint8Array([t,t>>8,t>>16]))}(r))}var le=[Array(255),Array(255),Array(255),Array(255)];for(let r=0;r<=255;r++){let e=r<<16;for(let t=0;t<8;t++)e=e<<1^(8388608&e?8801531:0);le[0][r]=(16711680&e)>>16|65280&e|(255&e)<<16}for(let r=0;r<=255;r++)le[1][r]=le[0][r]>>8^le[0][255&le[0][r]];for(let r=0;r<=255;r++)le[2][r]=le[1][r]>>8^le[0][255&le[1][r]];for(let r=0;r<=255;r++)le[3][r]=le[2][r]>>8^le[0][255&le[2][r]];var lo=function(){let r=new ArrayBuffer(2);return new DataView(r).setInt16(0,255,!0),new Int16Array(r)[0]===255}();function d1(r){for(let e=0;e<r.length;e++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(r[e])||b.printDebugError(Error("Improperly formatted armor header: "+r[e])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(r[e])||b.printDebugError(Error("Unknown header: "+r[e]))}function yo(r){let e=r,t="",n=r.lastIndexOf("=");return n>=0&&n!==r.length-1&&(e=r.slice(0,n),t=r.slice(n+1).substr(0,4)),{body:e,checksum:t}}function Ui(r,e=dt){return new Promise((t,n)=>x(this,null,function*(){try{let i=/^-----[^-]+-----$/m,a=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/,o,s=[],h,c,u,y=s,m=[],p=n2(_r(r,(_,S)=>x(this,null,function*(){let L=yr(_);try{for(;;){let X=yield L.readLine();if(X===void 0)throw Error("Misformed armored text");if(X=b.removeTrailingSpaces(X.replace(/[\r\n]/g,"")),o)if(h)c||o!==2||(i.test(X)?(m=m.join(`\r
`),c=!0,d1(y),y=[],h=!1):m.push(X.replace(/^- /,"")));else if(i.test(X)&&n(Error("Mandatory blank line missing between armor headers and armor data")),a.test(X)){if(d1(y),h=!0,c||o!==2){t({text:m,data:p,headers:s,type:o});break}}else y.push(X);else i.test(X)&&(o=uo(X))}}catch(X){return void n(X)}let O=xe(S);try{for(;;){yield O.ready;let{done:X,value:N}=yield L.read();if(X)throw Error("Misformed armored text");let K=N+"";if(K.indexOf("=")!==-1||K.indexOf("-")!==-1){let $=yield L.readToEnd();$.length||($=""),$=K+$,$=b.removeTrailingSpaces($.replace(/\r/g,""));let q=$.split(i);if(q.length===1)throw Error("Misformed armored text");let j=yo(q[0].slice(0,-1));u=j.checksum,yield O.write(j.body);break}yield O.write(K)}yield O.ready,yield O.close()}catch(X){yield O.abort(X)}})));p=_r(p,(_,S)=>x(this,null,function*(){let L=ie(Cr(xn(_)));L.catch(()=>{}),yield Hr(_,S,{preventClose:!0});let O=xe(S);try{let X=(yield L).replace(`
`,"");if(u!==X&&(u||e.checksumRequired))throw Error("Ascii armor integrity check failed");yield O.ready,yield O.close()}catch(X){yield O.abort(X)}}))}catch(i){n(i)}})).then(t=>x(this,null,function*(){return re(t.data)&&(t.data=yield ie(t.data)),t}))}function Di(r,e,t,n,i,a=dt){let o,s;r===d.armor.signed&&(o=e.text,s=e.hash,e=e.data);let h=xn(e),c=[];switch(r){case d.armor.multipartSection:c.push("-----BEGIN PGP MESSAGE, PART "+t+"/"+n+`-----
`),c.push(Wr(i,a)),c.push(gr(e)),c.push("=",Cr(h)),c.push("-----END PGP MESSAGE, PART "+t+"/"+n+`-----
`);break;case d.armor.multipartLast:c.push("-----BEGIN PGP MESSAGE, PART "+t+`-----
`),c.push(Wr(i,a)),c.push(gr(e)),c.push("=",Cr(h)),c.push("-----END PGP MESSAGE, PART "+t+`-----
`);break;case d.armor.signed:c.push(`-----BEGIN PGP SIGNED MESSAGE-----
`),c.push("Hash: "+s+`

`),c.push(o.replace(/^-/gm,"- -")),c.push(`
-----BEGIN PGP SIGNATURE-----
`),c.push(Wr(i,a)),c.push(gr(e)),c.push("=",Cr(h)),c.push(`-----END PGP SIGNATURE-----
`);break;case d.armor.message:c.push(`-----BEGIN PGP MESSAGE-----
`),c.push(Wr(i,a)),c.push(gr(e)),c.push("=",Cr(h)),c.push(`-----END PGP MESSAGE-----
`);break;case d.armor.publicKey:c.push(`-----BEGIN PGP PUBLIC KEY BLOCK-----
`),c.push(Wr(i,a)),c.push(gr(e)),c.push("=",Cr(h)),c.push(`-----END PGP PUBLIC KEY BLOCK-----
`);break;case d.armor.privateKey:c.push(`-----BEGIN PGP PRIVATE KEY BLOCK-----
`),c.push(Wr(i,a)),c.push(gr(e)),c.push("=",Cr(h)),c.push(`-----END PGP PRIVATE KEY BLOCK-----
`);break;case d.armor.signature:c.push(`-----BEGIN PGP SIGNATURE-----
`),c.push(Wr(i,a)),c.push(gr(e)),c.push("=",Cr(h)),c.push(`-----END PGP SIGNATURE-----
`)}return b.concat(c)}var sn=class r{constructor(){this.bytes=""}read(e){return this.bytes=b.uint8ArrayToString(e.subarray(0,8)),this.bytes.length}write(){return b.stringToUint8Array(this.bytes)}toHex(){return b.uint8ArrayToHex(b.stringToUint8Array(this.bytes))}equals(e,t=!1){return t&&(e.isWildcard()||this.isWildcard())||this.bytes===e.bytes}isNull(){return this.bytes===""}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(e){return e.toHex()}static fromID(e){let t=new r;return t.read(b.hexToUint8Array(e)),t}static wildcard(){let e=new r;return e.read(new Uint8Array(8)),e}},Ut=function(){var r,e,t=!1;function n(y,m){var p=r[(e[y]+e[m])%255];return y!==0&&m!==0||(p=0),p}var i,a,o,s,h=!1;function c(){function y(S){var L,O,X;for(O=X=function(N){var K=r[255-e[N]];return N===0&&(K=0),K}(S),L=0;L<4;L++)X^=O=255&(O<<1|O>>>7);return X^=99}t||function(){r=[],e=[];var S,L,O=1;for(S=0;S<255;S++)r[S]=O,L=128&O,O<<=1,O&=255,L===128&&(O^=27),O^=r[S],e[r[S]]=S;r[255]=r[0],e[0]=0,t=!0}(),i=[],a=[],o=[[],[],[],[]],s=[[],[],[],[]];for(var m=0;m<256;m++){var p=y(m);i[m]=p,a[p]=m,o[0][m]=n(2,p)<<24|p<<16|p<<8|n(3,p),s[0][p]=n(14,m)<<24|n(9,m)<<16|n(13,m)<<8|n(11,m);for(var _=1;_<4;_++)o[_][m]=o[_-1][m]>>>8|o[_-1][m]<<24,s[_][p]=s[_-1][p]>>>8|s[_-1][p]<<24}h=!0}var u=function(y,m){h||c();var p=new Uint32Array(m);p.set(i,512),p.set(a,768);for(var _=0;_<4;_++)p.set(o[_],4096+1024*_>>2),p.set(s[_],8192+1024*_>>2);var S=function(L,O,X){var N=0,K=0,$=0,q=0,j=0,Z=0,J=0,rt=0,yt=0,pt=0,kt=0,at=0,W=0,Dt=0,G=0,nt=0,mt=0,bt=0,gt=0,ft=0,vt=0,st=new L.Uint32Array(X),U=new L.Uint8Array(X);function F(v,k,E,it,xt,Bt,Mt,It){v=v|0,k=k|0,E=E|0,it=it|0,xt=xt|0,Bt=Bt|0,Mt=Mt|0,It=It|0;var Zt=0,te=0,ne=0,ce=0,Ct=0,Ot=0,Lt=0,St=0;for(Zt=E|1024,te=E|2048,ne=E|3072,xt=xt^st[(v|0)>>2],Bt=Bt^st[(v|4)>>2],Mt=Mt^st[(v|8)>>2],It=It^st[(v|12)>>2],St=16;(St|0)<=it<<4;St=St+16|0)ce=st[(E|xt>>22&1020)>>2]^st[(Zt|Bt>>14&1020)>>2]^st[(te|Mt>>6&1020)>>2]^st[(ne|It<<2&1020)>>2]^st[(v|St|0)>>2],Ct=st[(E|Bt>>22&1020)>>2]^st[(Zt|Mt>>14&1020)>>2]^st[(te|It>>6&1020)>>2]^st[(ne|xt<<2&1020)>>2]^st[(v|St|4)>>2],Ot=st[(E|Mt>>22&1020)>>2]^st[(Zt|It>>14&1020)>>2]^st[(te|xt>>6&1020)>>2]^st[(ne|Bt<<2&1020)>>2]^st[(v|St|8)>>2],Lt=st[(E|It>>22&1020)>>2]^st[(Zt|xt>>14&1020)>>2]^st[(te|Bt>>6&1020)>>2]^st[(ne|Mt<<2&1020)>>2]^st[(v|St|12)>>2],xt=ce,Bt=Ct,Mt=Ot,It=Lt;N=st[(k|xt>>22&1020)>>2]<<24^st[(k|Bt>>14&1020)>>2]<<16^st[(k|Mt>>6&1020)>>2]<<8^st[(k|It<<2&1020)>>2]^st[(v|St|0)>>2],K=st[(k|Bt>>22&1020)>>2]<<24^st[(k|Mt>>14&1020)>>2]<<16^st[(k|It>>6&1020)>>2]<<8^st[(k|xt<<2&1020)>>2]^st[(v|St|4)>>2],$=st[(k|Mt>>22&1020)>>2]<<24^st[(k|It>>14&1020)>>2]<<16^st[(k|xt>>6&1020)>>2]<<8^st[(k|Bt<<2&1020)>>2]^st[(v|St|8)>>2],q=st[(k|It>>22&1020)>>2]<<24^st[(k|xt>>14&1020)>>2]<<16^st[(k|Bt>>6&1020)>>2]<<8^st[(k|Mt<<2&1020)>>2]^st[(v|St|12)>>2]}function H(v,k,E,it){v=v|0,k=k|0,E=E|0,it=it|0,F(0,2048,4096,vt,v,k,E,it)}function l(v,k,E,it){v=v|0,k=k|0,E=E|0,it=it|0;var xt=0;F(1024,3072,8192,vt,v,it,E,k),xt=K,K=q,q=xt}function P(v,k,E,it){v=v|0,k=k|0,E=E|0,it=it|0,F(0,2048,4096,vt,j^v,Z^k,J^E,rt^it),j=N,Z=K,J=$,rt=q}function V(v,k,E,it){v=v|0,k=k|0,E=E|0,it=it|0;var xt=0;F(1024,3072,8192,vt,v,it,E,k),xt=K,K=q,q=xt,N=N^j,K=K^Z,$=$^J,q=q^rt,j=v,Z=k,J=E,rt=it}function Q(v,k,E,it){v=v|0,k=k|0,E=E|0,it=it|0,F(0,2048,4096,vt,j,Z,J,rt),j=N=N^v,Z=K=K^k,J=$=$^E,rt=q=q^it}function Y(v,k,E,it){v=v|0,k=k|0,E=E|0,it=it|0,F(0,2048,4096,vt,j,Z,J,rt),N=N^v,K=K^k,$=$^E,q=q^it,j=v,Z=k,J=E,rt=it}function g(v,k,E,it){v=v|0,k=k|0,E=E|0,it=it|0,F(0,2048,4096,vt,j,Z,J,rt),j=N,Z=K,J=$,rt=q,N=N^v,K=K^k,$=$^E,q=q^it}function f(v,k,E,it){v=v|0,k=k|0,E=E|0,it=it|0,F(0,2048,4096,vt,yt,pt,kt,at),at=~nt&at|nt&at+1,kt=~G&kt|G&kt+((at|0)==0),pt=~Dt&pt|Dt&pt+((kt|0)==0),yt=~W&yt|W&yt+((pt|0)==0),N=N^v,K=K^k,$=$^E,q=q^it}function w(v,k,E,it){v=v|0,k=k|0,E=E|0,it=it|0;var xt=0,Bt=0,Mt=0,It=0,Zt=0,te=0,ne=0,ce=0,Ct=0,Ot=0;for(v=v^j,k=k^Z,E=E^J,it=it^rt,xt=mt|0,Bt=bt|0,Mt=gt|0,It=ft|0;(Ct|0)<128;Ct=Ct+1|0)xt>>>31&&(Zt=Zt^v,te=te^k,ne=ne^E,ce=ce^it),xt=xt<<1|Bt>>>31,Bt=Bt<<1|Mt>>>31,Mt=Mt<<1|It>>>31,It=It<<1,Ot=it&1,it=it>>>1|E<<31,E=E>>>1|k<<31,k=k>>>1|v<<31,v=v>>>1,Ot&&(v=v^3774873600);j=Zt,Z=te,J=ne,rt=ce}function A(v){v=v|0,vt=v}function T(v,k,E,it){v=v|0,k=k|0,E=E|0,it=it|0,N=v,K=k,$=E,q=it}function D(v,k,E,it){v=v|0,k=k|0,E=E|0,it=it|0,j=v,Z=k,J=E,rt=it}function M(v,k,E,it){v=v|0,k=k|0,E=E|0,it=it|0,yt=v,pt=k,kt=E,at=it}function lt(v,k,E,it){v=v|0,k=k|0,E=E|0,it=it|0,W=v,Dt=k,G=E,nt=it}function ot(v,k,E,it){v=v|0,k=k|0,E=E|0,it=it|0,at=~nt&at|nt&it,kt=~G&kt|G&E,pt=~Dt&pt|Dt&k,yt=~W&yt|W&v}function ut(v){return v=v|0,v&15?-1:(U[v|0]=N>>>24,U[v|1]=N>>>16&255,U[v|2]=N>>>8&255,U[v|3]=N&255,U[v|4]=K>>>24,U[v|5]=K>>>16&255,U[v|6]=K>>>8&255,U[v|7]=K&255,U[v|8]=$>>>24,U[v|9]=$>>>16&255,U[v|10]=$>>>8&255,U[v|11]=$&255,U[v|12]=q>>>24,U[v|13]=q>>>16&255,U[v|14]=q>>>8&255,U[v|15]=q&255,16)}function ct(v){return v=v|0,v&15?-1:(U[v|0]=j>>>24,U[v|1]=j>>>16&255,U[v|2]=j>>>8&255,U[v|3]=j&255,U[v|4]=Z>>>24,U[v|5]=Z>>>16&255,U[v|6]=Z>>>8&255,U[v|7]=Z&255,U[v|8]=J>>>24,U[v|9]=J>>>16&255,U[v|10]=J>>>8&255,U[v|11]=J&255,U[v|12]=rt>>>24,U[v|13]=rt>>>16&255,U[v|14]=rt>>>8&255,U[v|15]=rt&255,16)}function C(){H(0,0,0,0),mt=N,bt=K,gt=$,ft=q}function I(v,k,E){v=v|0,k=k|0,E=E|0;var it=0;if(k&15)return-1;for(;(E|0)>=16;)z[v&7](U[k|0]<<24|U[k|1]<<16|U[k|2]<<8|U[k|3],U[k|4]<<24|U[k|5]<<16|U[k|6]<<8|U[k|7],U[k|8]<<24|U[k|9]<<16|U[k|10]<<8|U[k|11],U[k|12]<<24|U[k|13]<<16|U[k|14]<<8|U[k|15]),U[k|0]=N>>>24,U[k|1]=N>>>16&255,U[k|2]=N>>>8&255,U[k|3]=N&255,U[k|4]=K>>>24,U[k|5]=K>>>16&255,U[k|6]=K>>>8&255,U[k|7]=K&255,U[k|8]=$>>>24,U[k|9]=$>>>16&255,U[k|10]=$>>>8&255,U[k|11]=$&255,U[k|12]=q>>>24,U[k|13]=q>>>16&255,U[k|14]=q>>>8&255,U[k|15]=q&255,it=it+16|0,k=k+16|0,E=E-16|0;return it|0}function B(v,k,E){v=v|0,k=k|0,E=E|0;var it=0;if(k&15)return-1;for(;(E|0)>=16;)R[v&1](U[k|0]<<24|U[k|1]<<16|U[k|2]<<8|U[k|3],U[k|4]<<24|U[k|5]<<16|U[k|6]<<8|U[k|7],U[k|8]<<24|U[k|9]<<16|U[k|10]<<8|U[k|11],U[k|12]<<24|U[k|13]<<16|U[k|14]<<8|U[k|15]),it=it+16|0,k=k+16|0,E=E-16|0;return it|0}var z=[H,l,P,V,Q,Y,g,f],R=[P,w];return{set_rounds:A,set_state:T,set_iv:D,set_nonce:M,set_mask:lt,set_counter:ot,get_state:ut,get_iv:ct,gcm_init:C,cipher:I,mac:B}}({Uint8Array,Uint32Array},y,m);return S.set_key=function(L,O,X,N,K,$,q,j,Z){var J=p.subarray(0,60),rt=p.subarray(256,316);J.set([O,X,N,K,$,q,j,Z]);for(var yt=L,pt=1;yt<4*L+28;yt++){var kt=J[yt-1];(yt%L==0||L===8&&yt%L==4)&&(kt=i[kt>>>24]<<24^i[kt>>>16&255]<<16^i[kt>>>8&255]<<8^i[255&kt]),yt%L==0&&(kt=kt<<8^kt>>>24^pt<<24,pt=pt<<1^(128&pt?27:0)),J[yt]=J[yt-L]^kt}for(var at=0;at<yt;at+=4)for(var W=0;W<4;W++)kt=J[yt-(4+at)+(4-W)%4],rt[at+W]=at<4||at>=yt-4?kt:s[0][i[kt>>>24]]^s[1][i[kt>>>16&255]]^s[2][i[kt>>>8&255]]^s[3][i[255&kt]];S.set_rounds(L+5)},S};return u.ENC={ECB:0,CBC:2,CFB:4,OFB:6,CTR:7},u.DEC={ECB:1,CBC:3,CFB:5,OFB:6,CTR:7},u.MAC={CBC:0,GCM:1},u.HEAP_DATA=16384,u}();function p1(r){return r instanceof Uint8Array}function Gs(r,e){let t=r?r.byteLength:e||65536;if(4095&t||t<=0)throw Error("heap size must be a positive integer and a multiple of 4096");return r=r||new Uint8Array(new ArrayBuffer(t))}function Qr(r,e,t,n,i){let a=r.length-e,o=a<i?a:i;return r.set(t.subarray(n,n+o),e),o}function jr(...r){let e=r.reduce((i,a)=>i+a.length,0),t=new Uint8Array(e),n=0;for(let i=0;i<r.length;i++)t.set(r[i],n),n+=r[i].length;return t}var ui=class extends Error{constructor(...e){super(...e)}},qe=class extends Error{constructor(...e){super(...e)}},li=class extends Error{constructor(...e){super(...e)}},f1=[],g1=[],on=class{constructor(e,t,n=!0,i,a,o){this.pos=0,this.len=0,this.mode=i,this.pos=0,this.len=0,this.key=e,this.iv=t,this.padding=n,this.acquire_asm(a,o)}acquire_asm(e,t){return this.heap!==void 0&&this.asm!==void 0||(this.heap=e||f1.pop()||Gs().subarray(Ut.HEAP_DATA),this.asm=t||g1.pop()||new Ut(null,this.heap.buffer),this.reset(this.key,this.iv)),{heap:this.heap,asm:this.asm}}release_asm(){this.heap!==void 0&&this.asm!==void 0&&(f1.push(this.heap),g1.push(this.asm)),this.heap=void 0,this.asm=void 0}reset(e,t){let{asm:n}=this.acquire_asm(),i=e.length;if(i!==16&&i!==24&&i!==32)throw new qe("illegal key size");let a=new DataView(e.buffer,e.byteOffset,e.byteLength);if(n.set_key(i>>2,a.getUint32(0),a.getUint32(4),a.getUint32(8),a.getUint32(12),i>16?a.getUint32(16):0,i>16?a.getUint32(20):0,i>24?a.getUint32(24):0,i>24?a.getUint32(28):0),t!==void 0){if(t.length!==16)throw new qe("illegal iv size");let o=new DataView(t.buffer,t.byteOffset,t.byteLength);n.set_iv(o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12))}else n.set_iv(0,0,0,0)}AES_Encrypt_process(e){if(!p1(e))throw new TypeError("data isn't of expected type");let{heap:t,asm:n}=this.acquire_asm(),i=Ut.ENC[this.mode],a=Ut.HEAP_DATA,o=this.pos,s=this.len,h=0,c=e.length||0,u=0,y=0,m=new Uint8Array(s+c&-16);for(;c>0;)y=Qr(t,o+s,e,h,c),s+=y,h+=y,c-=y,y=n.cipher(i,a+o,s),y&&m.set(t.subarray(o,o+y),u),u+=y,y<s?(o+=y,s-=y):(o=0,s=0);return this.pos=o,this.len=s,m}AES_Encrypt_finish(){let{heap:e,asm:t}=this.acquire_asm(),n=Ut.ENC[this.mode],i=Ut.HEAP_DATA,a=this.pos,o=this.len,s=16-o%16,h=o;if(this.hasOwnProperty("padding")){if(this.padding){for(let u=0;u<s;++u)e[a+o+u]=s;o+=s,h=o}else if(o%16)throw new qe("data length must be a multiple of the block size")}else o+=s;let c=new Uint8Array(h);return o&&t.cipher(n,i+a,o),h&&c.set(e.subarray(a,a+h)),this.pos=0,this.len=0,this.release_asm(),c}AES_Decrypt_process(e){if(!p1(e))throw new TypeError("data isn't of expected type");let{heap:t,asm:n}=this.acquire_asm(),i=Ut.DEC[this.mode],a=Ut.HEAP_DATA,o=this.pos,s=this.len,h=0,c=e.length||0,u=0,y=s+c&-16,m=0,p=0;this.padding&&(m=s+c-y||16,y-=m);let _=new Uint8Array(y);for(;c>0;)p=Qr(t,o+s,e,h,c),s+=p,h+=p,c-=p,p=n.cipher(i,a+o,s-(c?0:m)),p&&_.set(t.subarray(o,o+p),u),u+=p,p<s?(o+=p,s-=p):(o=0,s=0);return this.pos=o,this.len=s,_}AES_Decrypt_finish(){let{heap:e,asm:t}=this.acquire_asm(),n=Ut.DEC[this.mode],i=Ut.HEAP_DATA,a=this.pos,o=this.len,s=o;if(o>0){if(o%16){if(this.hasOwnProperty("padding"))throw new qe("data length must be a multiple of the block size");o+=16-o%16}if(t.cipher(n,i+a,o),this.hasOwnProperty("padding")&&this.padding){let c=e[a+s-1];if(c<1||c>16||c>s)throw new li("bad padding");let u=0;for(let y=c;y>1;y--)u|=c^e[a+s-y];if(u)throw new li("bad padding");s-=c}}let h=new Uint8Array(s);return s>0&&h.set(e.subarray(a,a+s)),this.pos=0,this.len=0,this.release_asm(),h}},_s=class r{static encrypt(e,t,n=!1){return new r(t,n).encrypt(e)}static decrypt(e,t,n=!1){return new r(t,n).decrypt(e)}constructor(e,t=!1,n){this.aes=n||new on(e,void 0,t,"ECB")}encrypt(e){return jr(this.aes.AES_Encrypt_process(e),this.aes.AES_Encrypt_finish())}decrypt(e){return jr(this.aes.AES_Decrypt_process(e),this.aes.AES_Decrypt_finish())}};function Ws(r){let e=function(t){let n=new _s(t);this.encrypt=function(i){return n.encrypt(i)},this.decrypt=function(i){return n.decrypt(i)}};return e.blockSize=e.prototype.blockSize=16,e.keySize=e.prototype.keySize=r/8,e}function ri(r,e,t,n,i,a){let o=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],s=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],h=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],c=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],u=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],y=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],m=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],p=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696],_,S,L,O,X,N,K,$,q,j,Z,J,rt,yt,pt=0,kt=e.length,at=r.length===32?3:9;$=at===3?t?[0,32,2]:[30,-2,-2]:t?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],t&&(e=function(G,nt){let mt=8-G.length%8,bt;if(nt===2&&mt<8)bt=32;else if(nt===1)bt=mt;else{if(nt||!(mt<8)){if(mt===8)return G;throw Error("des: invalid padding")}bt=0}let gt=new Uint8Array(G.length+mt);for(let ft=0;ft<G.length;ft++)gt[ft]=G[ft];for(let ft=0;ft<mt;ft++)gt[G.length+ft]=bt;return gt}(e,a),kt=e.length);let W=new Uint8Array(kt),Dt=0;for(n===1&&(q=i[pt++]<<24|i[pt++]<<16|i[pt++]<<8|i[pt++],Z=i[pt++]<<24|i[pt++]<<16|i[pt++]<<8|i[pt++],pt=0);pt<kt;){for(N=e[pt++]<<24|e[pt++]<<16|e[pt++]<<8|e[pt++],K=e[pt++]<<24|e[pt++]<<16|e[pt++]<<8|e[pt++],n===1&&(t?(N^=q,K^=Z):(j=q,J=Z,q=N,Z=K)),L=252645135&(N>>>4^K),K^=L,N^=L<<4,L=65535&(N>>>16^K),K^=L,N^=L<<16,L=858993459&(K>>>2^N),N^=L,K^=L<<2,L=16711935&(K>>>8^N),N^=L,K^=L<<8,L=1431655765&(N>>>1^K),K^=L,N^=L<<1,N=N<<1|N>>>31,K=K<<1|K>>>31,S=0;S<at;S+=3){for(rt=$[S+1],yt=$[S+2],_=$[S];_!==rt;_+=yt)O=K^r[_],X=(K>>>4|K<<28)^r[_+1],L=N,N=K,K=L^(s[O>>>24&63]|c[O>>>16&63]|y[O>>>8&63]|p[63&O]|o[X>>>24&63]|h[X>>>16&63]|u[X>>>8&63]|m[63&X]);L=N,N=K,K=L}N=N>>>1|N<<31,K=K>>>1|K<<31,L=1431655765&(N>>>1^K),K^=L,N^=L<<1,L=16711935&(K>>>8^N),N^=L,K^=L<<8,L=858993459&(K>>>2^N),N^=L,K^=L<<2,L=65535&(N>>>16^K),K^=L,N^=L<<16,L=252645135&(N>>>4^K),K^=L,N^=L<<4,n===1&&(t?(q=N,Z=K):(N^=j,K^=J)),W[Dt++]=N>>>24,W[Dt++]=N>>>16&255,W[Dt++]=N>>>8&255,W[Dt++]=255&N,W[Dt++]=K>>>24,W[Dt++]=K>>>16&255,W[Dt++]=K>>>8&255,W[Dt++]=255&K}return t||(W=function(G,nt){let mt,bt=null;if(nt===2)mt=32;else if(nt===1)bt=G[G.length-1];else{if(nt)throw Error("des: invalid padding");mt=0}if(!bt){for(bt=1;G[G.length-bt]===mt;)bt++;bt--}return G.subarray(0,G.length-bt)}(W,a)),W}function ni(r){let e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],t=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],s=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],h=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],y=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],m=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],_=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],S=r.length>8?3:1,L=Array(32*S),O=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],X,N,K,$=0,q=0;for(let j=0;j<S;j++){let Z=r[$++]<<24|r[$++]<<16|r[$++]<<8|r[$++],J=r[$++]<<24|r[$++]<<16|r[$++]<<8|r[$++];K=252645135&(Z>>>4^J),J^=K,Z^=K<<4,K=65535&(J>>>-16^Z),Z^=K,J^=K<<-16,K=858993459&(Z>>>2^J),J^=K,Z^=K<<2,K=65535&(J>>>-16^Z),Z^=K,J^=K<<-16,K=1431655765&(Z>>>1^J),J^=K,Z^=K<<1,K=16711935&(J>>>8^Z),Z^=K,J^=K<<8,K=1431655765&(Z>>>1^J),J^=K,Z^=K<<1,K=Z<<8|J>>>20&240,Z=J<<24|J<<8&16711680|J>>>8&65280|J>>>24&240,J=K;for(let rt=0;rt<16;rt++)O[rt]?(Z=Z<<2|Z>>>26,J=J<<2|J>>>26):(Z=Z<<1|Z>>>27,J=J<<1|J>>>27),Z&=-15,J&=-15,X=e[Z>>>28]|t[Z>>>24&15]|n[Z>>>20&15]|i[Z>>>16&15]|a[Z>>>12&15]|o[Z>>>8&15]|s[Z>>>4&15],N=h[J>>>28]|c[J>>>24&15]|u[J>>>20&15]|y[J>>>16&15]|m[J>>>12&15]|p[J>>>8&15]|_[J>>>4&15],K=65535&(N>>>16^X),L[q++]=X^K,L[q++]=N^K<<16}return L}function Gn(r){this.key=[];for(let e=0;e<3;e++)this.key.push(new Uint8Array(r.subarray(8*e,8*e+8)));this.encrypt=function(e){return ri(ni(this.key[2]),ri(ni(this.key[1]),ri(ni(this.key[0]),e,!0,0,null,null),!1,0,null,null),!0,0,null,null)}}function po(){this.BlockSize=8,this.KeySize=16,this.setKey=function(o){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),o.length!==this.KeySize)throw Error("CAST-128: keys must be 16 bytes");return this.keySchedule(o),!0},this.reset=function(){for(let o=0;o<16;o++)this.masking[o]=0,this.rotate[o]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(o){let s=Array(o.length);for(let h=0;h<o.length;h+=8){let c,u=o[h]<<24|o[h+1]<<16|o[h+2]<<8|o[h+3],y=o[h+4]<<24|o[h+5]<<16|o[h+6]<<8|o[h+7];c=y,y=u^t(y,this.masking[0],this.rotate[0]),u=c,c=y,y=u^n(y,this.masking[1],this.rotate[1]),u=c,c=y,y=u^i(y,this.masking[2],this.rotate[2]),u=c,c=y,y=u^t(y,this.masking[3],this.rotate[3]),u=c,c=y,y=u^n(y,this.masking[4],this.rotate[4]),u=c,c=y,y=u^i(y,this.masking[5],this.rotate[5]),u=c,c=y,y=u^t(y,this.masking[6],this.rotate[6]),u=c,c=y,y=u^n(y,this.masking[7],this.rotate[7]),u=c,c=y,y=u^i(y,this.masking[8],this.rotate[8]),u=c,c=y,y=u^t(y,this.masking[9],this.rotate[9]),u=c,c=y,y=u^n(y,this.masking[10],this.rotate[10]),u=c,c=y,y=u^i(y,this.masking[11],this.rotate[11]),u=c,c=y,y=u^t(y,this.masking[12],this.rotate[12]),u=c,c=y,y=u^n(y,this.masking[13],this.rotate[13]),u=c,c=y,y=u^i(y,this.masking[14],this.rotate[14]),u=c,c=y,y=u^t(y,this.masking[15],this.rotate[15]),u=c,s[h]=y>>>24&255,s[h+1]=y>>>16&255,s[h+2]=y>>>8&255,s[h+3]=255&y,s[h+4]=u>>>24&255,s[h+5]=u>>>16&255,s[h+6]=u>>>8&255,s[h+7]=255&u}return s},this.decrypt=function(o){let s=Array(o.length);for(let h=0;h<o.length;h+=8){let c,u=o[h]<<24|o[h+1]<<16|o[h+2]<<8|o[h+3],y=o[h+4]<<24|o[h+5]<<16|o[h+6]<<8|o[h+7];c=y,y=u^t(y,this.masking[15],this.rotate[15]),u=c,c=y,y=u^i(y,this.masking[14],this.rotate[14]),u=c,c=y,y=u^n(y,this.masking[13],this.rotate[13]),u=c,c=y,y=u^t(y,this.masking[12],this.rotate[12]),u=c,c=y,y=u^i(y,this.masking[11],this.rotate[11]),u=c,c=y,y=u^n(y,this.masking[10],this.rotate[10]),u=c,c=y,y=u^t(y,this.masking[9],this.rotate[9]),u=c,c=y,y=u^i(y,this.masking[8],this.rotate[8]),u=c,c=y,y=u^n(y,this.masking[7],this.rotate[7]),u=c,c=y,y=u^t(y,this.masking[6],this.rotate[6]),u=c,c=y,y=u^i(y,this.masking[5],this.rotate[5]),u=c,c=y,y=u^n(y,this.masking[4],this.rotate[4]),u=c,c=y,y=u^t(y,this.masking[3],this.rotate[3]),u=c,c=y,y=u^i(y,this.masking[2],this.rotate[2]),u=c,c=y,y=u^n(y,this.masking[1],this.rotate[1]),u=c,c=y,y=u^t(y,this.masking[0],this.rotate[0]),u=c,s[h]=y>>>24&255,s[h+1]=y>>>16&255,s[h+2]=y>>>8&255,s[h+3]=255&y,s[h+4]=u>>>24&255,s[h+5]=u>>16&255,s[h+6]=u>>8&255,s[h+7]=255&u}return s};let r=[,,,,];r[0]=[,,,,],r[0][0]=[4,0,13,15,12,14,8],r[0][1]=[5,2,16,18,17,19,10],r[0][2]=[6,3,23,22,21,20,9],r[0][3]=[7,1,26,25,27,24,11],r[1]=[,,,,],r[1][0]=[0,6,21,23,20,22,16],r[1][1]=[1,4,0,2,1,3,18],r[1][2]=[2,5,7,6,5,4,17],r[1][3]=[3,7,10,9,11,8,19],r[2]=[,,,,],r[2][0]=[4,0,13,15,12,14,8],r[2][1]=[5,2,16,18,17,19,10],r[2][2]=[6,3,23,22,21,20,9],r[2][3]=[7,1,26,25,27,24,11],r[3]=[,,,,],r[3][0]=[0,6,21,23,20,22,16],r[3][1]=[1,4,0,2,1,3,18],r[3][2]=[2,5,7,6,5,4,17],r[3][3]=[3,7,10,9,11,8,19];let e=[,,,,];function t(o,s,h){let c=s+o,u=c<<h|c>>>32-h;return(a[0][u>>>24]^a[1][u>>>16&255])-a[2][u>>>8&255]+a[3][255&u]}function n(o,s,h){let c=s^o,u=c<<h|c>>>32-h;return a[0][u>>>24]-a[1][u>>>16&255]+a[2][u>>>8&255]^a[3][255&u]}function i(o,s,h){let c=s-o,u=c<<h|c>>>32-h;return(a[0][u>>>24]+a[1][u>>>16&255]^a[2][u>>>8&255])-a[3][255&u]}e[0]=[,,,,],e[0][0]=[24,25,23,22,18],e[0][1]=[26,27,21,20,22],e[0][2]=[28,29,19,18,25],e[0][3]=[30,31,17,16,28],e[1]=[,,,,],e[1][0]=[3,2,12,13,8],e[1][1]=[1,0,14,15,13],e[1][2]=[7,6,8,9,3],e[1][3]=[5,4,10,11,7],e[2]=[,,,,],e[2][0]=[19,18,28,29,25],e[2][1]=[17,16,30,31,28],e[2][2]=[23,22,24,25,18],e[2][3]=[21,20,26,27,22],e[3]=[,,,,],e[3][0]=[8,9,7,6,3],e[3][1]=[10,11,5,4,7],e[3][2]=[12,13,3,2,8],e[3][3]=[14,15,1,0,13],this.keySchedule=function(o){let s=[,,,,,,,,],h=Array(32),c;for(let p=0;p<4;p++)c=4*p,s[p]=o[c]<<24|o[c+1]<<16|o[c+2]<<8|o[c+3];let u=[6,7,4,5],y,m=0;for(let p=0;p<2;p++)for(let _=0;_<4;_++){for(c=0;c<4;c++){let S=r[_][c];y=s[S[1]],y^=a[4][s[S[2]>>>2]>>>24-8*(3&S[2])&255],y^=a[5][s[S[3]>>>2]>>>24-8*(3&S[3])&255],y^=a[6][s[S[4]>>>2]>>>24-8*(3&S[4])&255],y^=a[7][s[S[5]>>>2]>>>24-8*(3&S[5])&255],y^=a[u[c]][s[S[6]>>>2]>>>24-8*(3&S[6])&255],s[S[0]]=y}for(c=0;c<4;c++){let S=e[_][c];y=a[4][s[S[0]>>>2]>>>24-8*(3&S[0])&255],y^=a[5][s[S[1]>>>2]>>>24-8*(3&S[1])&255],y^=a[6][s[S[2]>>>2]>>>24-8*(3&S[2])&255],y^=a[7][s[S[3]>>>2]>>>24-8*(3&S[3])&255],y^=a[4+c][s[S[4]>>>2]>>>24-8*(3&S[4])&255],h[m]=y,m++}}for(let p=0;p<16;p++)this.masking[p]=h[p],this.rotate[p]=31&h[16+p]};let a=[,,,,,,,,];a[0]=[821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063],a[1]=[522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321],a[2]=[2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027],a[3]=[2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730],a[4]=[2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860],a[5]=[4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975],a[6]=[2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875],a[7]=[3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926]}function Wn(r){this.cast5=new po,this.cast5.setKey(r),this.encrypt=function(e){return this.cast5.encrypt(e)}}Gn.keySize=Gn.prototype.keySize=24,Gn.blockSize=Gn.prototype.blockSize=8,Wn.blockSize=Wn.prototype.blockSize=8,Wn.keySize=Wn.prototype.keySize=16;var Te=4294967295;function $e(r,e){return(r<<e|r>>>32-e)&Te}function dr(r,e){return r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24}function Ur(r,e,t){r.splice(e,4,255&t,t>>>8&255,t>>>16&255,t>>>24&255)}function Kt(r,e){return r>>>8*e&255}function Vn(r){this.tf=function(){let e=null,t=null,n=-1,i=[],a=[[],[],[],[]];function o(u){return a[0][Kt(u,0)]^a[1][Kt(u,1)]^a[2][Kt(u,2)]^a[3][Kt(u,3)]}function s(u){return a[0][Kt(u,3)]^a[1][Kt(u,0)]^a[2][Kt(u,1)]^a[3][Kt(u,2)]}function h(u,y){let m=o(y[0]),p=s(y[1]);y[2]=$e(y[2]^m+p+i[4*u+8]&Te,31),y[3]=$e(y[3],1)^m+2*p+i[4*u+9]&Te,m=o(y[2]),p=s(y[3]),y[0]=$e(y[0]^m+p+i[4*u+10]&Te,31),y[1]=$e(y[1],1)^m+2*p+i[4*u+11]&Te}function c(u,y){let m=o(y[0]),p=s(y[1]);y[2]=$e(y[2],1)^m+p+i[4*u+10]&Te,y[3]=$e(y[3]^m+2*p+i[4*u+11]&Te,31),m=o(y[2]),p=s(y[3]),y[0]=$e(y[0],1)^m+p+i[4*u+8]&Te,y[1]=$e(y[1]^m+2*p+i[4*u+9]&Te,31)}return{name:"twofish",blocksize:16,open:function(u){let y,m,p,_,S;e=u;let L=[],O=[],X=[],N,K=[],$,q,j,Z=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],J=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],rt=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],yt=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],pt=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],kt=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],at=[[],[]],W=[[],[],[],[]];function Dt(gt){return gt^gt>>2^[0,90,180,238][3&gt]}function G(gt){return gt^gt>>1^gt>>2^[0,238,180,90][3&gt]}function nt(gt,ft){let vt,st,U;for(vt=0;vt<8;vt++)st=ft>>>24,ft=ft<<8&Te|gt>>>24,gt=gt<<8&Te,U=st<<1,128&st&&(U^=333),ft^=st^U<<16,U^=st>>>1,1&st&&(U^=166),ft^=U<<24|U<<8;return ft}function mt(gt,ft){let vt=ft>>4,st=15&ft,U=Z[gt][vt^st],F=J[gt][pt[st]^kt[vt]];return yt[gt][pt[F]^kt[U]]<<4|rt[gt][U^F]}function bt(gt,ft){let vt=Kt(gt,0),st=Kt(gt,1),U=Kt(gt,2),F=Kt(gt,3);switch(N){case 4:vt=at[1][vt]^Kt(ft[3],0),st=at[0][st]^Kt(ft[3],1),U=at[0][U]^Kt(ft[3],2),F=at[1][F]^Kt(ft[3],3);case 3:vt=at[1][vt]^Kt(ft[2],0),st=at[1][st]^Kt(ft[2],1),U=at[0][U]^Kt(ft[2],2),F=at[0][F]^Kt(ft[2],3);case 2:vt=at[0][at[0][vt]^Kt(ft[1],0)]^Kt(ft[0],0),st=at[0][at[1][st]^Kt(ft[1],1)]^Kt(ft[0],1),U=at[1][at[0][U]^Kt(ft[1],2)]^Kt(ft[0],2),F=at[1][at[1][F]^Kt(ft[1],3)]^Kt(ft[0],3)}return W[0][vt]^W[1][st]^W[2][U]^W[3][F]}for(e=e.slice(0,32),y=e.length;y!==16&&y!==24&&y!==32;)e[y++]=0;for(y=0;y<e.length;y+=4)X[y>>2]=dr(e,y);for(y=0;y<256;y++)at[0][y]=mt(0,y),at[1][y]=mt(1,y);for(y=0;y<256;y++)$=at[1][y],q=Dt($),j=G($),W[0][y]=$+(q<<8)+(j<<16)+(j<<24),W[2][y]=q+(j<<8)+($<<16)+(j<<24),$=at[0][y],q=Dt($),j=G($),W[1][y]=j+(j<<8)+(q<<16)+($<<24),W[3][y]=q+($<<8)+(j<<16)+(q<<24);for(N=X.length/2,y=0;y<N;y++)m=X[y+y],L[y]=m,p=X[y+y+1],O[y]=p,K[N-y-1]=nt(m,p);for(y=0;y<40;y+=2)m=16843009*y,p=m+16843009,m=bt(m,L),p=$e(bt(p,O),8),i[y]=m+p&Te,i[y+1]=$e(m+2*p,9);for(y=0;y<256;y++)switch(m=p=_=S=y,N){case 4:m=at[1][m]^Kt(K[3],0),p=at[0][p]^Kt(K[3],1),_=at[0][_]^Kt(K[3],2),S=at[1][S]^Kt(K[3],3);case 3:m=at[1][m]^Kt(K[2],0),p=at[1][p]^Kt(K[2],1),_=at[0][_]^Kt(K[2],2),S=at[0][S]^Kt(K[2],3);case 2:a[0][y]=W[0][at[0][at[0][m]^Kt(K[1],0)]^Kt(K[0],0)],a[1][y]=W[1][at[0][at[1][p]^Kt(K[1],1)]^Kt(K[0],1)],a[2][y]=W[2][at[1][at[0][_]^Kt(K[1],2)]^Kt(K[0],2)],a[3][y]=W[3][at[1][at[1][S]^Kt(K[1],3)]^Kt(K[0],3)]}},close:function(){i=[],a=[[],[],[],[]]},encrypt:function(u,y){t=u,n=y;let m=[dr(t,n)^i[0],dr(t,n+4)^i[1],dr(t,n+8)^i[2],dr(t,n+12)^i[3]];for(let p=0;p<8;p++)h(p,m);return Ur(t,n,m[2]^i[4]),Ur(t,n+4,m[3]^i[5]),Ur(t,n+8,m[0]^i[6]),Ur(t,n+12,m[1]^i[7]),n+=16,t},decrypt:function(u,y){t=u,n=y;let m=[dr(t,n)^i[4],dr(t,n+4)^i[5],dr(t,n+8)^i[6],dr(t,n+12)^i[7]];for(let p=7;p>=0;p--)c(p,m);Ur(t,n,m[2]^i[0]),Ur(t,n+4,m[3]^i[1]),Ur(t,n+8,m[0]^i[2]),Ur(t,n+12,m[1]^i[3]),n+=16},finalize:function(){return t}}}(),this.tf.open(Array.from(r),0),this.encrypt=function(e){return this.tf.encrypt(Array.from(e),0)}}function He(){}function $n(r){this.bf=new He,this.bf.init(r),this.encrypt=function(e){return this.bf.encryptBlock(e)}}Vn.keySize=Vn.prototype.keySize=32,Vn.blockSize=Vn.prototype.blockSize=16,He.prototype.BLOCKSIZE=8,He.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],He.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],He.prototype.NN=16,He.prototype._clean=function(r){return r<0&&(r=(2147483647&r)+2147483648),r},He.prototype._F=function(r){let e,t=255&r,n=255&(r>>>=8),i=255&(r>>>=8),a=255&(r>>>=8);return e=this.sboxes[0][a]+this.sboxes[1][i],e^=this.sboxes[2][n],e+=this.sboxes[3][t],e},He.prototype._encryptBlock=function(r){let e,t=r[0],n=r[1];for(e=0;e<this.NN;++e){t^=this.parray[e],n=this._F(t)^n;let i=t;t=n,n=i}t^=this.parray[this.NN+0],n^=this.parray[this.NN+1],r[0]=this._clean(n),r[1]=this._clean(t)},He.prototype.encryptBlock=function(r){let e,t=[0,0],n=this.BLOCKSIZE/2;for(e=0;e<this.BLOCKSIZE/2;++e)t[0]=t[0]<<8|255&r[e+0],t[1]=t[1]<<8|255&r[e+n];this._encryptBlock(t);let i=[];for(e=0;e<this.BLOCKSIZE/2;++e)i[e+0]=t[0]>>>24-8*e&255,i[e+n]=t[1]>>>24-8*e&255;return i},He.prototype._decryptBlock=function(r){let e,t=r[0],n=r[1];for(e=this.NN+1;e>1;--e){t^=this.parray[e],n=this._F(t)^n;let i=t;t=n,n=i}t^=this.parray[1],n^=this.parray[0],r[0]=this._clean(n),r[1]=this._clean(t)},He.prototype.init=function(r){let e,t=0;for(this.parray=[],e=0;e<this.NN+2;++e){let i=0;for(let a=0;a<4;++a)i=i<<8|255&r[t],++t>=r.length&&(t=0);this.parray[e]=this.PARRAY[e]^i}for(this.sboxes=[],e=0;e<4;++e)for(this.sboxes[e]=[],t=0;t<256;++t)this.sboxes[e][t]=this.SBOXES[e][t];let n=[0,0];for(e=0;e<this.NN+2;e+=2)this._encryptBlock(n),this.parray[e+0]=n[0],this.parray[e+1]=n[1];for(e=0;e<4;++e)for(t=0;t<256;t+=2)this._encryptBlock(n),this.sboxes[e][t+0]=n[0],this.sboxes[e][t+1]=n[1]},$n.keySize=$n.prototype.keySize=16,$n.blockSize=$n.prototype.blockSize=8;var fo=Ws(128),go=Ws(192),mo=Ws(256),Ci=Object.freeze({__proto__:null,aes128:fo,aes192:go,aes256:mo,des:function(r){this.key=r,this.encrypt=function(e,t){return ri(ni(this.key),e,!0,0,null,t)},this.decrypt=function(e,t){return ri(ni(this.key),e,!1,0,null,t)}},tripledes:Gn,cast5:Wn,twofish:Vn,blowfish:$n,idea:function(){throw Error("IDEA symmetric-key algorithm not implemented")}}),i2=function(r,e,t){var n=0,i=0,a=0,o=0,s=0,h=0,c=0,u=0,y=0,m=0,p=0,_=0,S=0,L=0,O=0,X=0,N=0,K=new r.Uint8Array(t);function $(G,nt,mt,bt,gt,ft,vt,st,U,F,H,l,P,V,Q,Y){G=G|0,nt=nt|0,mt=mt|0,bt=bt|0,gt=gt|0,ft=ft|0,vt=vt|0,st=st|0,U=U|0,F=F|0,H=H|0,l=l|0,P=P|0,V=V|0,Q=Q|0,Y=Y|0;var g=0,f=0,w=0,A=0,T=0,D=0,M=0,lt=0,ot=0,ut=0,ct=0,C=0,I=0,B=0,z=0,R=0,v=0,k=0,E=0,it=0,xt=0,Bt=0,Mt=0,It=0,Zt=0,te=0,ne=0,ce=0,Ct=0,Ot=0,Lt=0,St=0,Wt=0,Ht=0,qt=0,tt=0,et=0,ht=0,At=0,Et=0,Pt=0,_t=0,Ft=0,Vt=0,Le=0,Ne=0,Oe=0,Ve=0,un=0,ln=0,yn=0,dn=0,pn=0,fn=0,gn=0,Mn=0,Ln=0,Ri=0,Mi=0,Li=0,Ni=0,Oi=0,Fi=0,Ga=0,Wa=0,Va=0,$a=0,Za=0,a1=0,s1=0,o1=0;g=n,f=i,w=a,A=o,T=s,M=G+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=nt+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=mt+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=bt+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=gt+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=ft+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=vt+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=st+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=U+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=F+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=H+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=l+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=P+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=V+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=Q+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,M=Y+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=V^U^mt^G,lt=D<<1|D>>>31,M=lt+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Q^F^bt^nt,ot=D<<1|D>>>31,M=ot+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Y^H^gt^mt,ut=D<<1|D>>>31,M=ut+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=lt^l^ft^bt,ct=D<<1|D>>>31,M=ct+(g<<5|g>>>27)+T+(f&w|~f&A)+1518500249|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=ot^P^vt^gt,C=D<<1|D>>>31,M=C+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=ut^V^st^ft,I=D<<1|D>>>31,M=I+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=ct^Q^U^vt,B=D<<1|D>>>31,M=B+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=C^Y^F^st,z=D<<1|D>>>31,M=z+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=I^lt^H^U,R=D<<1|D>>>31,M=R+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=B^ot^l^F,v=D<<1|D>>>31,M=v+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=z^ut^P^H,k=D<<1|D>>>31,M=k+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=R^ct^V^l,E=D<<1|D>>>31,M=E+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=v^C^Q^P,it=D<<1|D>>>31,M=it+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=k^I^Y^V,xt=D<<1|D>>>31,M=xt+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=E^B^lt^Q,Bt=D<<1|D>>>31,M=Bt+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=it^z^ot^Y,Mt=D<<1|D>>>31,M=Mt+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=xt^R^ut^lt,It=D<<1|D>>>31,M=It+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Bt^v^ct^ot,Zt=D<<1|D>>>31,M=Zt+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Mt^k^C^ut,te=D<<1|D>>>31,M=te+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=It^E^I^ct,ne=D<<1|D>>>31,M=ne+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Zt^it^B^C,ce=D<<1|D>>>31,M=ce+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=te^xt^z^I,Ct=D<<1|D>>>31,M=Ct+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=ne^Bt^R^B,Ot=D<<1|D>>>31,M=Ot+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=ce^Mt^v^z,Lt=D<<1|D>>>31,M=Lt+(g<<5|g>>>27)+T+(f^w^A)+1859775393|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Ct^It^k^R,St=D<<1|D>>>31,M=St+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Ot^Zt^E^v,Wt=D<<1|D>>>31,M=Wt+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Lt^te^it^k,Ht=D<<1|D>>>31,M=Ht+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=St^ne^xt^E,qt=D<<1|D>>>31,M=qt+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Wt^ce^Bt^it,tt=D<<1|D>>>31,M=tt+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Ht^Ct^Mt^xt,et=D<<1|D>>>31,M=et+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=qt^Ot^It^Bt,ht=D<<1|D>>>31,M=ht+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=tt^Lt^Zt^Mt,At=D<<1|D>>>31,M=At+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=et^St^te^It,Et=D<<1|D>>>31,M=Et+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=ht^Wt^ne^Zt,Pt=D<<1|D>>>31,M=Pt+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=At^Ht^ce^te,_t=D<<1|D>>>31,M=_t+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Et^qt^Ct^ne,Ft=D<<1|D>>>31,M=Ft+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Pt^tt^Ot^ce,Vt=D<<1|D>>>31,M=Vt+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=_t^et^Lt^Ct,Le=D<<1|D>>>31,M=Le+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Ft^ht^St^Ot,Ne=D<<1|D>>>31,M=Ne+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Vt^At^Wt^Lt,Oe=D<<1|D>>>31,M=Oe+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Le^Et^Ht^St,Ve=D<<1|D>>>31,M=Ve+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Ne^Pt^qt^Wt,un=D<<1|D>>>31,M=un+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Oe^_t^tt^Ht,ln=D<<1|D>>>31,M=ln+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Ve^Ft^et^qt,yn=D<<1|D>>>31,M=yn+(g<<5|g>>>27)+T+(f&w|f&A|w&A)-1894007588|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=un^Vt^ht^tt,dn=D<<1|D>>>31,M=dn+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=ln^Le^At^et,pn=D<<1|D>>>31,M=pn+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=yn^Ne^Et^ht,fn=D<<1|D>>>31,M=fn+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=dn^Oe^Pt^At,gn=D<<1|D>>>31,M=gn+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=pn^Ve^_t^Et,Mn=D<<1|D>>>31,M=Mn+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=fn^un^Ft^Pt,Ln=D<<1|D>>>31,M=Ln+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=gn^ln^Vt^_t,Ri=D<<1|D>>>31,M=Ri+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Mn^yn^Le^Ft,Mi=D<<1|D>>>31,M=Mi+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Ln^dn^Ne^Vt,Li=D<<1|D>>>31,M=Li+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Ri^pn^Oe^Le,Ni=D<<1|D>>>31,M=Ni+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Mi^fn^Ve^Ne,Oi=D<<1|D>>>31,M=Oi+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Li^gn^un^Oe,Fi=D<<1|D>>>31,M=Fi+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Ni^Mn^ln^Ve,Ga=D<<1|D>>>31,M=Ga+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Oi^Ln^yn^un,Wa=D<<1|D>>>31,M=Wa+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Fi^Ri^dn^ln,Va=D<<1|D>>>31,M=Va+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Ga^Mi^pn^yn,$a=D<<1|D>>>31,M=$a+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Wa^Li^fn^dn,Za=D<<1|D>>>31,M=Za+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Va^Ni^gn^pn,a1=D<<1|D>>>31,M=a1+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=$a^Oi^Mn^fn,s1=D<<1|D>>>31,M=s1+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,D=Za^Fi^Ln^gn,o1=D<<1|D>>>31,M=o1+(g<<5|g>>>27)+T+(f^w^A)-899497514|0,T=A,A=w,w=f<<30|f>>>2,f=g,g=M,n=n+g|0,i=i+f|0,a=a+w|0,o=o+A|0,s=s+T|0}function q(G){G=G|0,$(K[G|0]<<24|K[G|1]<<16|K[G|2]<<8|K[G|3],K[G|4]<<24|K[G|5]<<16|K[G|6]<<8|K[G|7],K[G|8]<<24|K[G|9]<<16|K[G|10]<<8|K[G|11],K[G|12]<<24|K[G|13]<<16|K[G|14]<<8|K[G|15],K[G|16]<<24|K[G|17]<<16|K[G|18]<<8|K[G|19],K[G|20]<<24|K[G|21]<<16|K[G|22]<<8|K[G|23],K[G|24]<<24|K[G|25]<<16|K[G|26]<<8|K[G|27],K[G|28]<<24|K[G|29]<<16|K[G|30]<<8|K[G|31],K[G|32]<<24|K[G|33]<<16|K[G|34]<<8|K[G|35],K[G|36]<<24|K[G|37]<<16|K[G|38]<<8|K[G|39],K[G|40]<<24|K[G|41]<<16|K[G|42]<<8|K[G|43],K[G|44]<<24|K[G|45]<<16|K[G|46]<<8|K[G|47],K[G|48]<<24|K[G|49]<<16|K[G|50]<<8|K[G|51],K[G|52]<<24|K[G|53]<<16|K[G|54]<<8|K[G|55],K[G|56]<<24|K[G|57]<<16|K[G|58]<<8|K[G|59],K[G|60]<<24|K[G|61]<<16|K[G|62]<<8|K[G|63])}function j(G){G=G|0,K[G|0]=n>>>24,K[G|1]=n>>>16&255,K[G|2]=n>>>8&255,K[G|3]=n&255,K[G|4]=i>>>24,K[G|5]=i>>>16&255,K[G|6]=i>>>8&255,K[G|7]=i&255,K[G|8]=a>>>24,K[G|9]=a>>>16&255,K[G|10]=a>>>8&255,K[G|11]=a&255,K[G|12]=o>>>24,K[G|13]=o>>>16&255,K[G|14]=o>>>8&255,K[G|15]=o&255,K[G|16]=s>>>24,K[G|17]=s>>>16&255,K[G|18]=s>>>8&255,K[G|19]=s&255}function Z(){n=1732584193,i=4023233417,a=2562383102,o=271733878,s=3285377520,h=c=0}function J(G,nt,mt,bt,gt,ft,vt){G=G|0,nt=nt|0,mt=mt|0,bt=bt|0,gt=gt|0,ft=ft|0,vt=vt|0,n=G,i=nt,a=mt,o=bt,s=gt,h=ft,c=vt}function rt(G,nt){G=G|0,nt=nt|0;var mt=0;if(G&63)return-1;for(;(nt|0)>=64;)q(G),G=G+64|0,nt=nt-64|0,mt=mt+64|0;return h=h+mt|0,h>>>0<mt>>>0&&(c=c+1|0),mt|0}function yt(G,nt,mt){G=G|0,nt=nt|0,mt=mt|0;var bt=0,gt=0;if(G&63||~mt&&mt&31)return-1;if((nt|0)>=64){if(bt=rt(G,nt)|0,(bt|0)==-1)return-1;G=G+bt|0,nt=nt-bt|0}if(bt=bt+nt|0,h=h+nt|0,h>>>0<nt>>>0&&(c=c+1|0),K[G|nt]=128,(nt|0)>=56){for(gt=nt+1|0;(gt|0)<64;gt=gt+1|0)K[G|gt]=0;q(G),nt=0,K[G|0]=0}for(gt=nt+1|0;(gt|0)<59;gt=gt+1|0)K[G|gt]=0;return K[G|56]=c>>>21&255,K[G|57]=c>>>13&255,K[G|58]=c>>>5&255,K[G|59]=c<<3&255|h>>>29,K[G|60]=h>>>21&255,K[G|61]=h>>>13&255,K[G|62]=h>>>5&255,K[G|63]=h<<3&255,q(G),~mt&&j(mt),bt|0}function pt(){n=u,i=y,a=m,o=p,s=_,h=64,c=0}function kt(){n=S,i=L,a=O,o=X,s=N,h=64,c=0}function at(G,nt,mt,bt,gt,ft,vt,st,U,F,H,l,P,V,Q,Y){G=G|0,nt=nt|0,mt=mt|0,bt=bt|0,gt=gt|0,ft=ft|0,vt=vt|0,st=st|0,U=U|0,F=F|0,H=H|0,l=l|0,P=P|0,V=V|0,Q=Q|0,Y=Y|0,Z(),$(G^1549556828,nt^1549556828,mt^1549556828,bt^1549556828,gt^1549556828,ft^1549556828,vt^1549556828,st^1549556828,U^1549556828,F^1549556828,H^1549556828,l^1549556828,P^1549556828,V^1549556828,Q^1549556828,Y^1549556828),S=n,L=i,O=a,X=o,N=s,Z(),$(G^909522486,nt^909522486,mt^909522486,bt^909522486,gt^909522486,ft^909522486,vt^909522486,st^909522486,U^909522486,F^909522486,H^909522486,l^909522486,P^909522486,V^909522486,Q^909522486,Y^909522486),u=n,y=i,m=a,p=o,_=s,h=64,c=0}function W(G,nt,mt){G=G|0,nt=nt|0,mt=mt|0;var bt=0,gt=0,ft=0,vt=0,st=0,U=0;return G&63||~mt&&mt&31?-1:(U=yt(G,nt,-1)|0,bt=n,gt=i,ft=a,vt=o,st=s,kt(),$(bt,gt,ft,vt,st,2147483648,0,0,0,0,0,0,0,0,0,672),~mt&&j(mt),U|0)}function Dt(G,nt,mt,bt,gt){G=G|0,nt=nt|0,mt=mt|0,bt=bt|0,gt=gt|0;var ft=0,vt=0,st=0,U=0,F=0,H=0,l=0,P=0,V=0,Q=0;if(G&63||~gt&&gt&31)return-1;for(K[G+nt|0]=mt>>>24,K[G+nt+1|0]=mt>>>16&255,K[G+nt+2|0]=mt>>>8&255,K[G+nt+3|0]=mt&255,W(G,nt+4|0,-1)|0,ft=H=n,vt=l=i,st=P=a,U=V=o,F=Q=s,bt=bt-1|0;(bt|0)>0;)pt(),$(H,l,P,V,Q,2147483648,0,0,0,0,0,0,0,0,0,672),H=n,l=i,P=a,V=o,Q=s,kt(),$(H,l,P,V,Q,2147483648,0,0,0,0,0,0,0,0,0,672),H=n,l=i,P=a,V=o,Q=s,ft=ft^n,vt=vt^i,st=st^a,U=U^o,F=F^s,bt=bt-1|0;return n=ft,i=vt,a=st,o=U,s=F,~gt&&j(gt),0}return{reset:Z,init:J,process:rt,finish:yt,hmac_reset:pt,hmac_init:at,hmac_finish:W,pbkdf2_generate_block:Dt}},ca=class{constructor(){this.pos=0,this.len=0}reset(){let{asm:e}=this.acquire_asm();return this.result=null,this.pos=0,this.len=0,e.reset(),this}process(e){if(this.result!==null)throw new ui("state must be reset before processing new data");let{asm:t,heap:n}=this.acquire_asm(),i=this.pos,a=this.len,o=0,s=e.length,h=0;for(;s>0;)h=Qr(n,i+a,e,o,s),a+=h,o+=h,s-=h,h=t.process(i,a),i+=h,a-=h,a||(i=0);return this.pos=i,this.len=a,this}finish(){if(this.result!==null)throw new ui("state must be reset before processing new data");let{asm:e,heap:t}=this.acquire_asm();return e.finish(this.pos,this.len,0),this.result=new Uint8Array(this.HASH_SIZE),this.result.set(t.subarray(0,this.HASH_SIZE)),this.pos=0,this.len=0,this.release_asm(),this}},m1=[],w1=[],Yr=class r extends ca{constructor(){super(),this.NAME="sha1",this.BLOCK_SIZE=64,this.HASH_SIZE=20,this.acquire_asm()}acquire_asm(){return this.heap!==void 0&&this.asm!==void 0||(this.heap=m1.pop()||Gs(),this.asm=w1.pop()||i2({Uint8Array},null,this.heap.buffer),this.reset()),{heap:this.heap,asm:this.asm}}release_asm(){this.heap!==void 0&&this.asm!==void 0&&(m1.push(this.heap),w1.push(this.asm)),this.heap=void 0,this.asm=void 0}static bytes(e){return new r().process(e).finish().result}};Yr.NAME="sha1",Yr.heap_pool=[],Yr.asm_pool=[],Yr.asm_function=i2;var b1=[],k1=[],wo=(()=>{class r extends ca{constructor(){super(),this.NAME="sha256",this.BLOCK_SIZE=64,this.HASH_SIZE=32,this.acquire_asm()}acquire_asm(){return this.heap!==void 0&&this.asm!==void 0||(this.heap=b1.pop()||Gs(),this.asm=k1.pop()||function(t,n,i){var a=0,o=0,s=0,h=0,c=0,u=0,y=0,m=0,p=0,_=0,S=0,L=0,O=0,X=0,N=0,K=0,$=0,q=0,j=0,Z=0,J=0,rt=0,yt=0,pt=0,kt=0,at=0,W=new t.Uint8Array(i);function Dt(l,P,V,Q,Y,g,f,w,A,T,D,M,lt,ot,ut,ct){l=l|0,P=P|0,V=V|0,Q=Q|0,Y=Y|0,g=g|0,f=f|0,w=w|0,A=A|0,T=T|0,D=D|0,M=M|0,lt=lt|0,ot=ot|0,ut=ut|0,ct=ct|0;var C=0,I=0,B=0,z=0,R=0,v=0,k=0,E=0;C=a,I=o,B=s,z=h,R=c,v=u,k=y,E=m,E=l+E+(R>>>6^R>>>11^R>>>25^R<<26^R<<21^R<<7)+(k^R&(v^k))+1116352408|0,z=z+E|0,E=E+(C&I^B&(C^I))+(C>>>2^C>>>13^C>>>22^C<<30^C<<19^C<<10)|0,k=P+k+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(v^z&(R^v))+1899447441|0,B=B+k|0,k=k+(E&C^I&(E^C))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,v=V+v+(B>>>6^B>>>11^B>>>25^B<<26^B<<21^B<<7)+(R^B&(z^R))+3049323471|0,I=I+v|0,v=v+(k&E^C&(k^E))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,R=Q+R+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(B^z))+3921009573|0,C=C+R|0,R=R+(v&k^E&(v^k))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0,z=Y+z+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(B^C&(I^B))+961987163|0,E=E+z|0,z=z+(R&v^k&(R^v))+(R>>>2^R>>>13^R>>>22^R<<30^R<<19^R<<10)|0,B=g+B+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(I^E&(C^I))+1508970993|0,k=k+B|0,B=B+(z&R^v&(z^R))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,I=f+I+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(C^k&(E^C))+2453635748|0,v=v+I|0,I=I+(B&z^R&(B^z))+(B>>>2^B>>>13^B>>>22^B<<30^B<<19^B<<10)|0,C=w+C+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(E^v&(k^E))+2870763221|0,R=R+C|0,C=C+(I&B^z&(I^B))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,E=A+E+(R>>>6^R>>>11^R>>>25^R<<26^R<<21^R<<7)+(k^R&(v^k))+3624381080|0,z=z+E|0,E=E+(C&I^B&(C^I))+(C>>>2^C>>>13^C>>>22^C<<30^C<<19^C<<10)|0,k=T+k+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(v^z&(R^v))+310598401|0,B=B+k|0,k=k+(E&C^I&(E^C))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,v=D+v+(B>>>6^B>>>11^B>>>25^B<<26^B<<21^B<<7)+(R^B&(z^R))+607225278|0,I=I+v|0,v=v+(k&E^C&(k^E))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,R=M+R+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(B^z))+1426881987|0,C=C+R|0,R=R+(v&k^E&(v^k))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0,z=lt+z+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(B^C&(I^B))+1925078388|0,E=E+z|0,z=z+(R&v^k&(R^v))+(R>>>2^R>>>13^R>>>22^R<<30^R<<19^R<<10)|0,B=ot+B+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(I^E&(C^I))+2162078206|0,k=k+B|0,B=B+(z&R^v&(z^R))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,I=ut+I+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(C^k&(E^C))+2614888103|0,v=v+I|0,I=I+(B&z^R&(B^z))+(B>>>2^B>>>13^B>>>22^B<<30^B<<19^B<<10)|0,C=ct+C+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(E^v&(k^E))+3248222580|0,R=R+C|0,C=C+(I&B^z&(I^B))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,l=(P>>>7^P>>>18^P>>>3^P<<25^P<<14)+(ut>>>17^ut>>>19^ut>>>10^ut<<15^ut<<13)+l+T|0,E=l+E+(R>>>6^R>>>11^R>>>25^R<<26^R<<21^R<<7)+(k^R&(v^k))+3835390401|0,z=z+E|0,E=E+(C&I^B&(C^I))+(C>>>2^C>>>13^C>>>22^C<<30^C<<19^C<<10)|0,P=(V>>>7^V>>>18^V>>>3^V<<25^V<<14)+(ct>>>17^ct>>>19^ct>>>10^ct<<15^ct<<13)+P+D|0,k=P+k+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(v^z&(R^v))+4022224774|0,B=B+k|0,k=k+(E&C^I&(E^C))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,V=(Q>>>7^Q>>>18^Q>>>3^Q<<25^Q<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+V+M|0,v=V+v+(B>>>6^B>>>11^B>>>25^B<<26^B<<21^B<<7)+(R^B&(z^R))+264347078|0,I=I+v|0,v=v+(k&E^C&(k^E))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,Q=(Y>>>7^Y>>>18^Y>>>3^Y<<25^Y<<14)+(P>>>17^P>>>19^P>>>10^P<<15^P<<13)+Q+lt|0,R=Q+R+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(B^z))+604807628|0,C=C+R|0,R=R+(v&k^E&(v^k))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0,Y=(g>>>7^g>>>18^g>>>3^g<<25^g<<14)+(V>>>17^V>>>19^V>>>10^V<<15^V<<13)+Y+ot|0,z=Y+z+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(B^C&(I^B))+770255983|0,E=E+z|0,z=z+(R&v^k&(R^v))+(R>>>2^R>>>13^R>>>22^R<<30^R<<19^R<<10)|0,g=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(Q>>>17^Q>>>19^Q>>>10^Q<<15^Q<<13)+g+ut|0,B=g+B+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(I^E&(C^I))+1249150122|0,k=k+B|0,B=B+(z&R^v&(z^R))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,f=(w>>>7^w>>>18^w>>>3^w<<25^w<<14)+(Y>>>17^Y>>>19^Y>>>10^Y<<15^Y<<13)+f+ct|0,I=f+I+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(C^k&(E^C))+1555081692|0,v=v+I|0,I=I+(B&z^R&(B^z))+(B>>>2^B>>>13^B>>>22^B<<30^B<<19^B<<10)|0,w=(A>>>7^A>>>18^A>>>3^A<<25^A<<14)+(g>>>17^g>>>19^g>>>10^g<<15^g<<13)+w+l|0,C=w+C+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(E^v&(k^E))+1996064986|0,R=R+C|0,C=C+(I&B^z&(I^B))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,A=(T>>>7^T>>>18^T>>>3^T<<25^T<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+A+P|0,E=A+E+(R>>>6^R>>>11^R>>>25^R<<26^R<<21^R<<7)+(k^R&(v^k))+2554220882|0,z=z+E|0,E=E+(C&I^B&(C^I))+(C>>>2^C>>>13^C>>>22^C<<30^C<<19^C<<10)|0,T=(D>>>7^D>>>18^D>>>3^D<<25^D<<14)+(w>>>17^w>>>19^w>>>10^w<<15^w<<13)+T+V|0,k=T+k+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(v^z&(R^v))+2821834349|0,B=B+k|0,k=k+(E&C^I&(E^C))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,D=(M>>>7^M>>>18^M>>>3^M<<25^M<<14)+(A>>>17^A>>>19^A>>>10^A<<15^A<<13)+D+Q|0,v=D+v+(B>>>6^B>>>11^B>>>25^B<<26^B<<21^B<<7)+(R^B&(z^R))+2952996808|0,I=I+v|0,v=v+(k&E^C&(k^E))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,M=(lt>>>7^lt>>>18^lt>>>3^lt<<25^lt<<14)+(T>>>17^T>>>19^T>>>10^T<<15^T<<13)+M+Y|0,R=M+R+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(B^z))+3210313671|0,C=C+R|0,R=R+(v&k^E&(v^k))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0,lt=(ot>>>7^ot>>>18^ot>>>3^ot<<25^ot<<14)+(D>>>17^D>>>19^D>>>10^D<<15^D<<13)+lt+g|0,z=lt+z+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(B^C&(I^B))+3336571891|0,E=E+z|0,z=z+(R&v^k&(R^v))+(R>>>2^R>>>13^R>>>22^R<<30^R<<19^R<<10)|0,ot=(ut>>>7^ut>>>18^ut>>>3^ut<<25^ut<<14)+(M>>>17^M>>>19^M>>>10^M<<15^M<<13)+ot+f|0,B=ot+B+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(I^E&(C^I))+3584528711|0,k=k+B|0,B=B+(z&R^v&(z^R))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,ut=(ct>>>7^ct>>>18^ct>>>3^ct<<25^ct<<14)+(lt>>>17^lt>>>19^lt>>>10^lt<<15^lt<<13)+ut+w|0,I=ut+I+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(C^k&(E^C))+113926993|0,v=v+I|0,I=I+(B&z^R&(B^z))+(B>>>2^B>>>13^B>>>22^B<<30^B<<19^B<<10)|0,ct=(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(ot>>>17^ot>>>19^ot>>>10^ot<<15^ot<<13)+ct+A|0,C=ct+C+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(E^v&(k^E))+338241895|0,R=R+C|0,C=C+(I&B^z&(I^B))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,l=(P>>>7^P>>>18^P>>>3^P<<25^P<<14)+(ut>>>17^ut>>>19^ut>>>10^ut<<15^ut<<13)+l+T|0,E=l+E+(R>>>6^R>>>11^R>>>25^R<<26^R<<21^R<<7)+(k^R&(v^k))+666307205|0,z=z+E|0,E=E+(C&I^B&(C^I))+(C>>>2^C>>>13^C>>>22^C<<30^C<<19^C<<10)|0,P=(V>>>7^V>>>18^V>>>3^V<<25^V<<14)+(ct>>>17^ct>>>19^ct>>>10^ct<<15^ct<<13)+P+D|0,k=P+k+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(v^z&(R^v))+773529912|0,B=B+k|0,k=k+(E&C^I&(E^C))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,V=(Q>>>7^Q>>>18^Q>>>3^Q<<25^Q<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+V+M|0,v=V+v+(B>>>6^B>>>11^B>>>25^B<<26^B<<21^B<<7)+(R^B&(z^R))+1294757372|0,I=I+v|0,v=v+(k&E^C&(k^E))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,Q=(Y>>>7^Y>>>18^Y>>>3^Y<<25^Y<<14)+(P>>>17^P>>>19^P>>>10^P<<15^P<<13)+Q+lt|0,R=Q+R+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(B^z))+1396182291|0,C=C+R|0,R=R+(v&k^E&(v^k))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0,Y=(g>>>7^g>>>18^g>>>3^g<<25^g<<14)+(V>>>17^V>>>19^V>>>10^V<<15^V<<13)+Y+ot|0,z=Y+z+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(B^C&(I^B))+1695183700|0,E=E+z|0,z=z+(R&v^k&(R^v))+(R>>>2^R>>>13^R>>>22^R<<30^R<<19^R<<10)|0,g=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(Q>>>17^Q>>>19^Q>>>10^Q<<15^Q<<13)+g+ut|0,B=g+B+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(I^E&(C^I))+1986661051|0,k=k+B|0,B=B+(z&R^v&(z^R))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,f=(w>>>7^w>>>18^w>>>3^w<<25^w<<14)+(Y>>>17^Y>>>19^Y>>>10^Y<<15^Y<<13)+f+ct|0,I=f+I+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(C^k&(E^C))+2177026350|0,v=v+I|0,I=I+(B&z^R&(B^z))+(B>>>2^B>>>13^B>>>22^B<<30^B<<19^B<<10)|0,w=(A>>>7^A>>>18^A>>>3^A<<25^A<<14)+(g>>>17^g>>>19^g>>>10^g<<15^g<<13)+w+l|0,C=w+C+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(E^v&(k^E))+2456956037|0,R=R+C|0,C=C+(I&B^z&(I^B))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,A=(T>>>7^T>>>18^T>>>3^T<<25^T<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+A+P|0,E=A+E+(R>>>6^R>>>11^R>>>25^R<<26^R<<21^R<<7)+(k^R&(v^k))+2730485921|0,z=z+E|0,E=E+(C&I^B&(C^I))+(C>>>2^C>>>13^C>>>22^C<<30^C<<19^C<<10)|0,T=(D>>>7^D>>>18^D>>>3^D<<25^D<<14)+(w>>>17^w>>>19^w>>>10^w<<15^w<<13)+T+V|0,k=T+k+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(v^z&(R^v))+2820302411|0,B=B+k|0,k=k+(E&C^I&(E^C))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,D=(M>>>7^M>>>18^M>>>3^M<<25^M<<14)+(A>>>17^A>>>19^A>>>10^A<<15^A<<13)+D+Q|0,v=D+v+(B>>>6^B>>>11^B>>>25^B<<26^B<<21^B<<7)+(R^B&(z^R))+3259730800|0,I=I+v|0,v=v+(k&E^C&(k^E))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,M=(lt>>>7^lt>>>18^lt>>>3^lt<<25^lt<<14)+(T>>>17^T>>>19^T>>>10^T<<15^T<<13)+M+Y|0,R=M+R+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(B^z))+3345764771|0,C=C+R|0,R=R+(v&k^E&(v^k))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0,lt=(ot>>>7^ot>>>18^ot>>>3^ot<<25^ot<<14)+(D>>>17^D>>>19^D>>>10^D<<15^D<<13)+lt+g|0,z=lt+z+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(B^C&(I^B))+3516065817|0,E=E+z|0,z=z+(R&v^k&(R^v))+(R>>>2^R>>>13^R>>>22^R<<30^R<<19^R<<10)|0,ot=(ut>>>7^ut>>>18^ut>>>3^ut<<25^ut<<14)+(M>>>17^M>>>19^M>>>10^M<<15^M<<13)+ot+f|0,B=ot+B+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(I^E&(C^I))+3600352804|0,k=k+B|0,B=B+(z&R^v&(z^R))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,ut=(ct>>>7^ct>>>18^ct>>>3^ct<<25^ct<<14)+(lt>>>17^lt>>>19^lt>>>10^lt<<15^lt<<13)+ut+w|0,I=ut+I+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(C^k&(E^C))+4094571909|0,v=v+I|0,I=I+(B&z^R&(B^z))+(B>>>2^B>>>13^B>>>22^B<<30^B<<19^B<<10)|0,ct=(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(ot>>>17^ot>>>19^ot>>>10^ot<<15^ot<<13)+ct+A|0,C=ct+C+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(E^v&(k^E))+275423344|0,R=R+C|0,C=C+(I&B^z&(I^B))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,l=(P>>>7^P>>>18^P>>>3^P<<25^P<<14)+(ut>>>17^ut>>>19^ut>>>10^ut<<15^ut<<13)+l+T|0,E=l+E+(R>>>6^R>>>11^R>>>25^R<<26^R<<21^R<<7)+(k^R&(v^k))+430227734|0,z=z+E|0,E=E+(C&I^B&(C^I))+(C>>>2^C>>>13^C>>>22^C<<30^C<<19^C<<10)|0,P=(V>>>7^V>>>18^V>>>3^V<<25^V<<14)+(ct>>>17^ct>>>19^ct>>>10^ct<<15^ct<<13)+P+D|0,k=P+k+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(v^z&(R^v))+506948616|0,B=B+k|0,k=k+(E&C^I&(E^C))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,V=(Q>>>7^Q>>>18^Q>>>3^Q<<25^Q<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+V+M|0,v=V+v+(B>>>6^B>>>11^B>>>25^B<<26^B<<21^B<<7)+(R^B&(z^R))+659060556|0,I=I+v|0,v=v+(k&E^C&(k^E))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,Q=(Y>>>7^Y>>>18^Y>>>3^Y<<25^Y<<14)+(P>>>17^P>>>19^P>>>10^P<<15^P<<13)+Q+lt|0,R=Q+R+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(B^z))+883997877|0,C=C+R|0,R=R+(v&k^E&(v^k))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0,Y=(g>>>7^g>>>18^g>>>3^g<<25^g<<14)+(V>>>17^V>>>19^V>>>10^V<<15^V<<13)+Y+ot|0,z=Y+z+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(B^C&(I^B))+958139571|0,E=E+z|0,z=z+(R&v^k&(R^v))+(R>>>2^R>>>13^R>>>22^R<<30^R<<19^R<<10)|0,g=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(Q>>>17^Q>>>19^Q>>>10^Q<<15^Q<<13)+g+ut|0,B=g+B+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(I^E&(C^I))+1322822218|0,k=k+B|0,B=B+(z&R^v&(z^R))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,f=(w>>>7^w>>>18^w>>>3^w<<25^w<<14)+(Y>>>17^Y>>>19^Y>>>10^Y<<15^Y<<13)+f+ct|0,I=f+I+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(C^k&(E^C))+1537002063|0,v=v+I|0,I=I+(B&z^R&(B^z))+(B>>>2^B>>>13^B>>>22^B<<30^B<<19^B<<10)|0,w=(A>>>7^A>>>18^A>>>3^A<<25^A<<14)+(g>>>17^g>>>19^g>>>10^g<<15^g<<13)+w+l|0,C=w+C+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(E^v&(k^E))+1747873779|0,R=R+C|0,C=C+(I&B^z&(I^B))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,A=(T>>>7^T>>>18^T>>>3^T<<25^T<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+A+P|0,E=A+E+(R>>>6^R>>>11^R>>>25^R<<26^R<<21^R<<7)+(k^R&(v^k))+1955562222|0,z=z+E|0,E=E+(C&I^B&(C^I))+(C>>>2^C>>>13^C>>>22^C<<30^C<<19^C<<10)|0,T=(D>>>7^D>>>18^D>>>3^D<<25^D<<14)+(w>>>17^w>>>19^w>>>10^w<<15^w<<13)+T+V|0,k=T+k+(z>>>6^z>>>11^z>>>25^z<<26^z<<21^z<<7)+(v^z&(R^v))+2024104815|0,B=B+k|0,k=k+(E&C^I&(E^C))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,D=(M>>>7^M>>>18^M>>>3^M<<25^M<<14)+(A>>>17^A>>>19^A>>>10^A<<15^A<<13)+D+Q|0,v=D+v+(B>>>6^B>>>11^B>>>25^B<<26^B<<21^B<<7)+(R^B&(z^R))+2227730452|0,I=I+v|0,v=v+(k&E^C&(k^E))+(k>>>2^k>>>13^k>>>22^k<<30^k<<19^k<<10)|0,M=(lt>>>7^lt>>>18^lt>>>3^lt<<25^lt<<14)+(T>>>17^T>>>19^T>>>10^T<<15^T<<13)+M+Y|0,R=M+R+(I>>>6^I>>>11^I>>>25^I<<26^I<<21^I<<7)+(z^I&(B^z))+2361852424|0,C=C+R|0,R=R+(v&k^E&(v^k))+(v>>>2^v>>>13^v>>>22^v<<30^v<<19^v<<10)|0,lt=(ot>>>7^ot>>>18^ot>>>3^ot<<25^ot<<14)+(D>>>17^D>>>19^D>>>10^D<<15^D<<13)+lt+g|0,z=lt+z+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(B^C&(I^B))+2428436474|0,E=E+z|0,z=z+(R&v^k&(R^v))+(R>>>2^R>>>13^R>>>22^R<<30^R<<19^R<<10)|0,ot=(ut>>>7^ut>>>18^ut>>>3^ut<<25^ut<<14)+(M>>>17^M>>>19^M>>>10^M<<15^M<<13)+ot+f|0,B=ot+B+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(I^E&(C^I))+2756734187|0,k=k+B|0,B=B+(z&R^v&(z^R))+(z>>>2^z>>>13^z>>>22^z<<30^z<<19^z<<10)|0,ut=(ct>>>7^ct>>>18^ct>>>3^ct<<25^ct<<14)+(lt>>>17^lt>>>19^lt>>>10^lt<<15^lt<<13)+ut+w|0,I=ut+I+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(C^k&(E^C))+3204031479|0,v=v+I|0,I=I+(B&z^R&(B^z))+(B>>>2^B>>>13^B>>>22^B<<30^B<<19^B<<10)|0,ct=(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(ot>>>17^ot>>>19^ot>>>10^ot<<15^ot<<13)+ct+A|0,C=ct+C+(v>>>6^v>>>11^v>>>25^v<<26^v<<21^v<<7)+(E^v&(k^E))+3329325298|0,R=R+C|0,C=C+(I&B^z&(I^B))+(I>>>2^I>>>13^I>>>22^I<<30^I<<19^I<<10)|0,a=a+C|0,o=o+I|0,s=s+B|0,h=h+z|0,c=c+R|0,u=u+v|0,y=y+k|0,m=m+E|0}function G(l){l=l|0,Dt(W[l|0]<<24|W[l|1]<<16|W[l|2]<<8|W[l|3],W[l|4]<<24|W[l|5]<<16|W[l|6]<<8|W[l|7],W[l|8]<<24|W[l|9]<<16|W[l|10]<<8|W[l|11],W[l|12]<<24|W[l|13]<<16|W[l|14]<<8|W[l|15],W[l|16]<<24|W[l|17]<<16|W[l|18]<<8|W[l|19],W[l|20]<<24|W[l|21]<<16|W[l|22]<<8|W[l|23],W[l|24]<<24|W[l|25]<<16|W[l|26]<<8|W[l|27],W[l|28]<<24|W[l|29]<<16|W[l|30]<<8|W[l|31],W[l|32]<<24|W[l|33]<<16|W[l|34]<<8|W[l|35],W[l|36]<<24|W[l|37]<<16|W[l|38]<<8|W[l|39],W[l|40]<<24|W[l|41]<<16|W[l|42]<<8|W[l|43],W[l|44]<<24|W[l|45]<<16|W[l|46]<<8|W[l|47],W[l|48]<<24|W[l|49]<<16|W[l|50]<<8|W[l|51],W[l|52]<<24|W[l|53]<<16|W[l|54]<<8|W[l|55],W[l|56]<<24|W[l|57]<<16|W[l|58]<<8|W[l|59],W[l|60]<<24|W[l|61]<<16|W[l|62]<<8|W[l|63])}function nt(l){l=l|0,W[l|0]=a>>>24,W[l|1]=a>>>16&255,W[l|2]=a>>>8&255,W[l|3]=a&255,W[l|4]=o>>>24,W[l|5]=o>>>16&255,W[l|6]=o>>>8&255,W[l|7]=o&255,W[l|8]=s>>>24,W[l|9]=s>>>16&255,W[l|10]=s>>>8&255,W[l|11]=s&255,W[l|12]=h>>>24,W[l|13]=h>>>16&255,W[l|14]=h>>>8&255,W[l|15]=h&255,W[l|16]=c>>>24,W[l|17]=c>>>16&255,W[l|18]=c>>>8&255,W[l|19]=c&255,W[l|20]=u>>>24,W[l|21]=u>>>16&255,W[l|22]=u>>>8&255,W[l|23]=u&255,W[l|24]=y>>>24,W[l|25]=y>>>16&255,W[l|26]=y>>>8&255,W[l|27]=y&255,W[l|28]=m>>>24,W[l|29]=m>>>16&255,W[l|30]=m>>>8&255,W[l|31]=m&255}function mt(){a=1779033703,o=3144134277,s=1013904242,h=2773480762,c=1359893119,u=2600822924,y=528734635,m=1541459225,p=_=0}function bt(l,P,V,Q,Y,g,f,w,A,T){l=l|0,P=P|0,V=V|0,Q=Q|0,Y=Y|0,g=g|0,f=f|0,w=w|0,A=A|0,T=T|0,a=l,o=P,s=V,h=Q,c=Y,u=g,y=f,m=w,p=A,_=T}function gt(l,P){l=l|0,P=P|0;var V=0;if(l&63)return-1;for(;(P|0)>=64;)G(l),l=l+64|0,P=P-64|0,V=V+64|0;return p=p+V|0,p>>>0<V>>>0&&(_=_+1|0),V|0}function ft(l,P,V){l=l|0,P=P|0,V=V|0;var Q=0,Y=0;if(l&63||~V&&V&31)return-1;if((P|0)>=64){if(Q=gt(l,P)|0,(Q|0)==-1)return-1;l=l+Q|0,P=P-Q|0}if(Q=Q+P|0,p=p+P|0,p>>>0<P>>>0&&(_=_+1|0),W[l|P]=128,(P|0)>=56){for(Y=P+1|0;(Y|0)<64;Y=Y+1|0)W[l|Y]=0;G(l),P=0,W[l|0]=0}for(Y=P+1|0;(Y|0)<59;Y=Y+1|0)W[l|Y]=0;return W[l|56]=_>>>21&255,W[l|57]=_>>>13&255,W[l|58]=_>>>5&255,W[l|59]=_<<3&255|p>>>29,W[l|60]=p>>>21&255,W[l|61]=p>>>13&255,W[l|62]=p>>>5&255,W[l|63]=p<<3&255,G(l),~V&&nt(V),Q|0}function vt(){a=S,o=L,s=O,h=X,c=N,u=K,y=$,m=q,p=64,_=0}function st(){a=j,o=Z,s=J,h=rt,c=yt,u=pt,y=kt,m=at,p=64,_=0}function U(l,P,V,Q,Y,g,f,w,A,T,D,M,lt,ot,ut,ct){l=l|0,P=P|0,V=V|0,Q=Q|0,Y=Y|0,g=g|0,f=f|0,w=w|0,A=A|0,T=T|0,D=D|0,M=M|0,lt=lt|0,ot=ot|0,ut=ut|0,ct=ct|0,mt(),Dt(l^1549556828,P^1549556828,V^1549556828,Q^1549556828,Y^1549556828,g^1549556828,f^1549556828,w^1549556828,A^1549556828,T^1549556828,D^1549556828,M^1549556828,lt^1549556828,ot^1549556828,ut^1549556828,ct^1549556828),j=a,Z=o,J=s,rt=h,yt=c,pt=u,kt=y,at=m,mt(),Dt(l^909522486,P^909522486,V^909522486,Q^909522486,Y^909522486,g^909522486,f^909522486,w^909522486,A^909522486,T^909522486,D^909522486,M^909522486,lt^909522486,ot^909522486,ut^909522486,ct^909522486),S=a,L=o,O=s,X=h,N=c,K=u,$=y,q=m,p=64,_=0}function F(l,P,V){l=l|0,P=P|0,V=V|0;var Q=0,Y=0,g=0,f=0,w=0,A=0,T=0,D=0,M=0;return l&63||~V&&V&31?-1:(M=ft(l,P,-1)|0,Q=a,Y=o,g=s,f=h,w=c,A=u,T=y,D=m,st(),Dt(Q,Y,g,f,w,A,T,D,2147483648,0,0,0,0,0,0,768),~V&&nt(V),M|0)}function H(l,P,V,Q,Y){l=l|0,P=P|0,V=V|0,Q=Q|0,Y=Y|0;var g=0,f=0,w=0,A=0,T=0,D=0,M=0,lt=0,ot=0,ut=0,ct=0,C=0,I=0,B=0,z=0,R=0;if(l&63||~Y&&Y&31)return-1;for(W[l+P|0]=V>>>24,W[l+P+1|0]=V>>>16&255,W[l+P+2|0]=V>>>8&255,W[l+P+3|0]=V&255,F(l,P+4|0,-1)|0,g=ot=a,f=ut=o,w=ct=s,A=C=h,T=I=c,D=B=u,M=z=y,lt=R=m,Q=Q-1|0;(Q|0)>0;)vt(),Dt(ot,ut,ct,C,I,B,z,R,2147483648,0,0,0,0,0,0,768),ot=a,ut=o,ct=s,C=h,I=c,B=u,z=y,R=m,st(),Dt(ot,ut,ct,C,I,B,z,R,2147483648,0,0,0,0,0,0,768),ot=a,ut=o,ct=s,C=h,I=c,B=u,z=y,R=m,g=g^a,f=f^o,w=w^s,A=A^h,T=T^c,D=D^u,M=M^y,lt=lt^m,Q=Q-1|0;return a=g,o=f,s=w,h=A,c=T,u=D,y=M,m=lt,~Y&&nt(Y),0}return{reset:mt,init:bt,process:gt,finish:ft,hmac_reset:vt,hmac_init:U,hmac_finish:F,pbkdf2_generate_block:H}}({Uint8Array},null,this.heap.buffer),this.reset()),{heap:this.heap,asm:this.asm}}release_asm(){this.heap!==void 0&&this.asm!==void 0&&(b1.push(this.heap),k1.push(this.asm)),this.heap=void 0,this.asm=void 0}static bytes(t){return new r().process(t).finish().result}}return r.NAME="sha256",r})(),Na=a2;function a2(r,e){if(!r)throw Error(e||"Assertion failed")}a2.equal=function(r,e,t){if(r!=e)throw Error(t||"Assertion failed: "+r+" != "+e)};var Hc=De!==void 0?De:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vs(r,e){return r(e={exports:{}},e.exports),e.exports}function bo(){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var ko=Vs(function(r){r.exports=typeof Object.create=="function"?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),vo=function(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r=="string")if(e){if(e==="hex")for((r=r.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(r="0"+r),n=0;n<r.length;n+=2)t.push(parseInt(r[n]+r[n+1],16))}else for(var n=0;n<r.length;n++){var i=r.charCodeAt(n),a=i>>8,o=255&i;a?t.push(a,o):t.push(o)}else for(n=0;n<r.length;n++)t[n]=0|r[n];return t},Ao=function(r){for(var e="",t=0;t<r.length;t++)e+=o2(r[t].toString(16));return e};function s2(r){return(r>>>24|r>>>8&65280|r<<8&16711680|(255&r)<<24)>>>0}var Eo=function(r,e){for(var t="",n=0;n<r.length;n++){var i=r[n];e==="little"&&(i=s2(i)),t+=c2(i.toString(16))}return t};function o2(r){return r.length===1?"0"+r:r}function c2(r){return r.length===7?"0"+r:r.length===6?"00"+r:r.length===5?"000"+r:r.length===4?"0000"+r:r.length===3?"00000"+r:r.length===2?"000000"+r:r.length===1?"0000000"+r:r}var _o=function(r,e,t,n){var i=t-e;Na(i%4==0);for(var a=Array(i/4),o=0,s=e;o<a.length;o++,s+=4){var h;h=n==="big"?r[s]<<24|r[s+1]<<16|r[s+2]<<8|r[s+3]:r[s+3]<<24|r[s+2]<<16|r[s+1]<<8|r[s],a[o]=h>>>0}return a},Ko=function(r,e){for(var t=Array(4*r.length),n=0,i=0;n<r.length;n++,i+=4){var a=r[n];e==="big"?(t[i]=a>>>24,t[i+1]=a>>>16&255,t[i+2]=a>>>8&255,t[i+3]=255&a):(t[i+3]=a>>>24,t[i+2]=a>>>16&255,t[i+1]=a>>>8&255,t[i]=255&a)}return t},Tt={inherits:ko,toArray:vo,toHex:Ao,htonl:s2,toHex32:Eo,zero2:o2,zero8:c2,join32:_o,split32:Ko,rotr32:function(r,e){return r>>>e|r<<32-e},rotl32:function(r,e){return r<<e|r>>>32-e},sum32:function(r,e){return r+e>>>0},sum32_3:function(r,e,t){return r+e+t>>>0},sum32_4:function(r,e,t,n){return r+e+t+n>>>0},sum32_5:function(r,e,t,n,i){return r+e+t+n+i>>>0},sum64:function(r,e,t,n){var i=r[e],a=n+r[e+1]>>>0,o=(a<n?1:0)+t+i;r[e]=o>>>0,r[e+1]=a},sum64_hi:function(r,e,t,n){return(e+n>>>0<e?1:0)+r+t>>>0},sum64_lo:function(r,e,t,n){return e+n>>>0},sum64_4_hi:function(r,e,t,n,i,a,o,s){var h=0,c=e;return h+=(c=c+n>>>0)<e?1:0,h+=(c=c+a>>>0)<a?1:0,r+t+i+o+(h+=(c=c+s>>>0)<s?1:0)>>>0},sum64_4_lo:function(r,e,t,n,i,a,o,s){return e+n+a+s>>>0},sum64_5_hi:function(r,e,t,n,i,a,o,s,h,c){var u=0,y=e;return u+=(y=y+n>>>0)<e?1:0,u+=(y=y+a>>>0)<a?1:0,u+=(y=y+s>>>0)<s?1:0,r+t+i+o+h+(u+=(y=y+c>>>0)<c?1:0)>>>0},sum64_5_lo:function(r,e,t,n,i,a,o,s,h,c){return e+n+a+s+c>>>0},rotr64_hi:function(r,e,t){return(e<<32-t|r>>>t)>>>0},rotr64_lo:function(r,e,t){return(r<<32-t|e>>>t)>>>0},shr64_hi:function(r,e,t){return r>>>t},shr64_lo:function(r,e,t){return(r<<32-t|e>>>t)>>>0}};function Ji(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var So=Ji;Ji.prototype.update=function(r,e){if(r=Tt.toArray(r,e),this.pending?this.pending=this.pending.concat(r):this.pending=r,this.pendingTotal+=r.length,this.pending.length>=this._delta8){var t=(r=this.pending).length%this._delta8;this.pending=r.slice(r.length-t,r.length),this.pending.length===0&&(this.pending=null),r=Tt.join32(r,0,r.length-t,this.endian);for(var n=0;n<r.length;n+=this._delta32)this._update(r,n,n+this._delta32)}return this},Ji.prototype.digest=function(r){return this.update(this._pad()),Na(this.pending===null),this._digest(r)},Ji.prototype._pad=function(){var r=this.pendingTotal,e=this._delta8,t=e-(r+this.padLength)%e,n=Array(t+this.padLength);n[0]=128;for(var i=1;i<t;i++)n[i]=0;if(r<<=3,this.endian==="big"){for(var a=8;a<this.padLength;a++)n[i++]=0;n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=r>>>24&255,n[i++]=r>>>16&255,n[i++]=r>>>8&255,n[i++]=255&r}else for(n[i++]=255&r,n[i++]=r>>>8&255,n[i++]=r>>>16&255,n[i++]=r>>>24&255,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,a=8;a<this.padLength;a++)n[i++]=0;return n};var $s={BlockHash:So},Ze=Tt.rotr32,xo=function(r,e,t,n){return r===0?h2(e,t,n):r===1||r===3?l2(e,t,n):r===2?u2(e,t,n):void 0};function h2(r,e,t){return r&e^~r&t}function u2(r,e,t){return r&e^r&t^e&t}function l2(r,e,t){return r^e^t}var Tn={ft_1:xo,ch32:h2,maj32:u2,p32:l2,s0_256:function(r){return Ze(r,2)^Ze(r,13)^Ze(r,22)},s1_256:function(r){return Ze(r,6)^Ze(r,11)^Ze(r,25)},g0_256:function(r){return Ze(r,7)^Ze(r,18)^r>>>3},g1_256:function(r){return Ze(r,17)^Ze(r,19)^r>>>10}},Fe=Tt.sum32,Po=Tt.sum32_4,Uo=Tt.sum32_5,Do=Tn.ch32,Co=Tn.maj32,Io=Tn.s0_256,To=Tn.s1_256,Bo=Tn.g0_256,zo=Tn.g1_256,y2=$s.BlockHash,Ro=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Je(){if(!(this instanceof Je))return new Je;y2.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=Ro,this.W=Array(64)}Tt.inherits(Je,y2);var d2=Je;function kr(){if(!(this instanceof kr))return new kr;d2.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}Je.blockSize=512,Je.outSize=256,Je.hmacStrength=192,Je.padLength=64,Je.prototype._update=function(r,e){for(var t=this.W,n=0;n<16;n++)t[n]=r[e+n];for(;n<t.length;n++)t[n]=Po(zo(t[n-2]),t[n-7],Bo(t[n-15]),t[n-16]);var i=this.h[0],a=this.h[1],o=this.h[2],s=this.h[3],h=this.h[4],c=this.h[5],u=this.h[6],y=this.h[7];for(Na(this.k.length===t.length),n=0;n<t.length;n++){var m=Uo(y,To(h),Do(h,c,u),this.k[n],t[n]),p=Fe(Io(i),Co(i,a,o));y=u,u=c,c=h,h=Fe(s,m),s=o,o=a,a=i,i=Fe(m,p)}this.h[0]=Fe(this.h[0],i),this.h[1]=Fe(this.h[1],a),this.h[2]=Fe(this.h[2],o),this.h[3]=Fe(this.h[3],s),this.h[4]=Fe(this.h[4],h),this.h[5]=Fe(this.h[5],c),this.h[6]=Fe(this.h[6],u),this.h[7]=Fe(this.h[7],y)},Je.prototype._digest=function(r){return r==="hex"?Tt.toHex32(this.h,"big"):Tt.split32(this.h,"big")},Tt.inherits(kr,d2);var Mo=kr;kr.blockSize=512,kr.outSize=224,kr.hmacStrength=192,kr.padLength=64,kr.prototype._digest=function(r){return r==="hex"?Tt.toHex32(this.h.slice(0,7),"big"):Tt.split32(this.h.slice(0,7),"big")};var sr=Tt.rotr64_hi,or=Tt.rotr64_lo,p2=Tt.shr64_hi,f2=Tt.shr64_lo,Dr=Tt.sum64,Qa=Tt.sum64_hi,Ya=Tt.sum64_lo,Lo=Tt.sum64_4_hi,No=Tt.sum64_4_lo,Oo=Tt.sum64_5_hi,Fo=Tt.sum64_5_lo,g2=$s.BlockHash,Ho=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function je(){if(!(this instanceof je))return new je;g2.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=Ho,this.W=Array(160)}Tt.inherits(je,g2);var Ii=je;function jo(r,e,t,n,i){var a=r&t^~r&i;return a<0&&(a+=4294967296),a}function qo(r,e,t,n,i,a){var o=e&n^~e&a;return o<0&&(o+=4294967296),o}function Go(r,e,t,n,i){var a=r&t^r&i^t&i;return a<0&&(a+=4294967296),a}function Wo(r,e,t,n,i,a){var o=e&n^e&a^n&a;return o<0&&(o+=4294967296),o}function Vo(r,e){var t=sr(r,e,28)^sr(e,r,2)^sr(e,r,7);return t<0&&(t+=4294967296),t}function $o(r,e){var t=or(r,e,28)^or(e,r,2)^or(e,r,7);return t<0&&(t+=4294967296),t}function Zo(r,e){var t=sr(r,e,14)^sr(r,e,18)^sr(e,r,9);return t<0&&(t+=4294967296),t}function Xo(r,e){var t=or(r,e,14)^or(r,e,18)^or(e,r,9);return t<0&&(t+=4294967296),t}function Qo(r,e){var t=sr(r,e,1)^sr(r,e,8)^p2(r,e,7);return t<0&&(t+=4294967296),t}function Yo(r,e){var t=or(r,e,1)^or(r,e,8)^f2(r,e,7);return t<0&&(t+=4294967296),t}function Jo(r,e){var t=sr(r,e,19)^sr(e,r,29)^p2(r,e,6);return t<0&&(t+=4294967296),t}function t3(r,e){var t=or(r,e,19)^or(e,r,29)^f2(r,e,6);return t<0&&(t+=4294967296),t}function vr(){if(!(this instanceof vr))return new vr;Ii.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}je.blockSize=1024,je.outSize=512,je.hmacStrength=192,je.padLength=128,je.prototype._prepareBlock=function(r,e){for(var t=this.W,n=0;n<32;n++)t[n]=r[e+n];for(;n<t.length;n+=2){var i=Jo(t[n-4],t[n-3]),a=t3(t[n-4],t[n-3]),o=t[n-14],s=t[n-13],h=Qo(t[n-30],t[n-29]),c=Yo(t[n-30],t[n-29]),u=t[n-32],y=t[n-31];t[n]=Lo(i,a,o,s,h,c,u,y),t[n+1]=No(i,a,o,s,h,c,u,y)}},je.prototype._update=function(r,e){this._prepareBlock(r,e);var t=this.W,n=this.h[0],i=this.h[1],a=this.h[2],o=this.h[3],s=this.h[4],h=this.h[5],c=this.h[6],u=this.h[7],y=this.h[8],m=this.h[9],p=this.h[10],_=this.h[11],S=this.h[12],L=this.h[13],O=this.h[14],X=this.h[15];Na(this.k.length===t.length);for(var N=0;N<t.length;N+=2){var K=O,$=X,q=Zo(y,m),j=Xo(y,m),Z=jo(y,m,p,_,S),J=qo(y,m,p,_,S,L),rt=this.k[N],yt=this.k[N+1],pt=t[N],kt=t[N+1],at=Oo(K,$,q,j,Z,J,rt,yt,pt,kt),W=Fo(K,$,q,j,Z,J,rt,yt,pt,kt);K=Vo(n,i),$=$o(n,i),q=Go(n,i,a,o,s),j=Wo(n,i,a,o,s,h);var Dt=Qa(K,$,q,j),G=Ya(K,$,q,j);O=S,X=L,S=p,L=_,p=y,_=m,y=Qa(c,u,at,W),m=Ya(u,u,at,W),c=s,u=h,s=a,h=o,a=n,o=i,n=Qa(at,W,Dt,G),i=Ya(at,W,Dt,G)}Dr(this.h,0,n,i),Dr(this.h,2,a,o),Dr(this.h,4,s,h),Dr(this.h,6,c,u),Dr(this.h,8,y,m),Dr(this.h,10,p,_),Dr(this.h,12,S,L),Dr(this.h,14,O,X)},je.prototype._digest=function(r){return r==="hex"?Tt.toHex32(this.h,"big"):Tt.split32(this.h,"big")},Tt.inherits(vr,Ii);var e3=vr;vr.blockSize=1024,vr.outSize=384,vr.hmacStrength=192,vr.padLength=128,vr.prototype._digest=function(r){return r==="hex"?Tt.toHex32(this.h.slice(0,12),"big"):Tt.split32(this.h.slice(0,12),"big")};var Hi=Tt.rotl32,v1=Tt.sum32,Fn=Tt.sum32_3,A1=Tt.sum32_4,m2=$s.BlockHash;function tr(){if(!(this instanceof tr))return new tr;m2.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Tt.inherits(tr,m2);var w2=tr;function E1(r,e,t,n){return r<=15?e^t^n:r<=31?e&t|~e&n:r<=47?(e|~t)^n:r<=63?e&n|t&~n:e^(t|~n)}function r3(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function n3(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}tr.blockSize=512,tr.outSize=160,tr.hmacStrength=192,tr.padLength=64,tr.prototype._update=function(r,e){for(var t=this.h[0],n=this.h[1],i=this.h[2],a=this.h[3],o=this.h[4],s=t,h=n,c=i,u=a,y=o,m=0;m<80;m++){var p=v1(Hi(A1(t,E1(m,n,i,a),r[i3[m]+e],r3(m)),s3[m]),o);t=o,o=a,a=Hi(i,10),i=n,n=p,p=v1(Hi(A1(s,E1(79-m,h,c,u),r[a3[m]+e],n3(m)),o3[m]),y),s=y,y=u,u=Hi(c,10),c=h,h=p}p=Fn(this.h[1],i,u),this.h[1]=Fn(this.h[2],a,y),this.h[2]=Fn(this.h[3],o,s),this.h[3]=Fn(this.h[4],t,h),this.h[4]=Fn(this.h[0],n,c),this.h[0]=p},tr.prototype._digest=function(r){return r==="hex"?Tt.toHex32(this.h,"little"):Tt.split32(this.h,"little")};var i3=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],a3=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],s3=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],o3=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],jc={ripemd160:w2};function Ja(r,e){let t=r[0],n=r[1],i=r[2],a=r[3];t=ge(t,n,i,a,e[0],7,-680876936),a=ge(a,t,n,i,e[1],12,-389564586),i=ge(i,a,t,n,e[2],17,606105819),n=ge(n,i,a,t,e[3],22,-1044525330),t=ge(t,n,i,a,e[4],7,-176418897),a=ge(a,t,n,i,e[5],12,1200080426),i=ge(i,a,t,n,e[6],17,-1473231341),n=ge(n,i,a,t,e[7],22,-45705983),t=ge(t,n,i,a,e[8],7,1770035416),a=ge(a,t,n,i,e[9],12,-1958414417),i=ge(i,a,t,n,e[10],17,-42063),n=ge(n,i,a,t,e[11],22,-1990404162),t=ge(t,n,i,a,e[12],7,1804603682),a=ge(a,t,n,i,e[13],12,-40341101),i=ge(i,a,t,n,e[14],17,-1502002290),n=ge(n,i,a,t,e[15],22,1236535329),t=me(t,n,i,a,e[1],5,-165796510),a=me(a,t,n,i,e[6],9,-1069501632),i=me(i,a,t,n,e[11],14,643717713),n=me(n,i,a,t,e[0],20,-373897302),t=me(t,n,i,a,e[5],5,-701558691),a=me(a,t,n,i,e[10],9,38016083),i=me(i,a,t,n,e[15],14,-660478335),n=me(n,i,a,t,e[4],20,-405537848),t=me(t,n,i,a,e[9],5,568446438),a=me(a,t,n,i,e[14],9,-1019803690),i=me(i,a,t,n,e[3],14,-187363961),n=me(n,i,a,t,e[8],20,1163531501),t=me(t,n,i,a,e[13],5,-1444681467),a=me(a,t,n,i,e[2],9,-51403784),i=me(i,a,t,n,e[7],14,1735328473),n=me(n,i,a,t,e[12],20,-1926607734),t=we(t,n,i,a,e[5],4,-378558),a=we(a,t,n,i,e[8],11,-2022574463),i=we(i,a,t,n,e[11],16,1839030562),n=we(n,i,a,t,e[14],23,-35309556),t=we(t,n,i,a,e[1],4,-1530992060),a=we(a,t,n,i,e[4],11,1272893353),i=we(i,a,t,n,e[7],16,-155497632),n=we(n,i,a,t,e[10],23,-1094730640),t=we(t,n,i,a,e[13],4,681279174),a=we(a,t,n,i,e[0],11,-358537222),i=we(i,a,t,n,e[3],16,-722521979),n=we(n,i,a,t,e[6],23,76029189),t=we(t,n,i,a,e[9],4,-640364487),a=we(a,t,n,i,e[12],11,-421815835),i=we(i,a,t,n,e[15],16,530742520),n=we(n,i,a,t,e[2],23,-995338651),t=be(t,n,i,a,e[0],6,-198630844),a=be(a,t,n,i,e[7],10,1126891415),i=be(i,a,t,n,e[14],15,-1416354905),n=be(n,i,a,t,e[5],21,-57434055),t=be(t,n,i,a,e[12],6,1700485571),a=be(a,t,n,i,e[3],10,-1894986606),i=be(i,a,t,n,e[10],15,-1051523),n=be(n,i,a,t,e[1],21,-2054922799),t=be(t,n,i,a,e[8],6,1873313359),a=be(a,t,n,i,e[15],10,-30611744),i=be(i,a,t,n,e[6],15,-1560198380),n=be(n,i,a,t,e[13],21,1309151649),t=be(t,n,i,a,e[4],6,-145523070),a=be(a,t,n,i,e[11],10,-1120210379),i=be(i,a,t,n,e[2],15,718787259),n=be(n,i,a,t,e[9],21,-343485551),r[0]=Mr(t,r[0]),r[1]=Mr(n,r[1]),r[2]=Mr(i,r[2]),r[3]=Mr(a,r[3])}function Oa(r,e,t,n,i,a){return e=Mr(Mr(e,r),Mr(n,a)),Mr(e<<i|e>>>32-i,t)}function ge(r,e,t,n,i,a,o){return Oa(e&t|~e&n,r,e,i,a,o)}function me(r,e,t,n,i,a,o){return Oa(e&n|t&~n,r,e,i,a,o)}function we(r,e,t,n,i,a,o){return Oa(e^t^n,r,e,i,a,o)}function be(r,e,t,n,i,a,o){return Oa(t^(e|~n),r,e,i,a,o)}function c3(r){let e=[],t;for(t=0;t<64;t+=4)e[t>>2]=r.charCodeAt(t)+(r.charCodeAt(t+1)<<8)+(r.charCodeAt(t+2)<<16)+(r.charCodeAt(t+3)<<24);return e}var _1="0123456789abcdef".split("");function h3(r){let e="",t=0;for(;t<4;t++)e+=_1[r>>8*t+4&15]+_1[r>>8*t&15];return e}function Mr(r,e){return r+e&4294967295}var ha=b.getWebCrypto(),ua=b.getNodeCrypto(),u3=ua&&ua.getHashes();function Vr(r){if(ua&&u3.includes(r))return function(e){return x(this,null,function*(){let t=ua.createHash(r);return ee(e,n=>{t.update(n)},()=>new Uint8Array(t.digest()))})}}function ji(r,e){return function(i){return x(this,arguments,function*(t,n=dt){if(re(t)&&(t=yield ie(t)),!b.isStream(t)&&ha&&e&&t.length>=n.minBytesForWebCrypto)return new Uint8Array(yield ha.digest(e,t));let a=r();return ee(t,o=>{a.update(o)},()=>new Uint8Array(a.digest()))})}}function K1(r,e){return function(i){return x(this,arguments,function*(t,n=dt){if(re(t)&&(t=yield ie(t)),b.isStream(t)){let a=new r;return ee(t,o=>{a.process(o)},()=>a.finish().result)}return ha&&e&&t.length>=n.minBytesForWebCrypto?new Uint8Array(yield ha.digest(e,t)):r.bytes(t)})}}var $r={md5:Vr("md5")||function(r){return x(this,null,function*(){let e=function(t){let n=t.length,i=[1732584193,-271733879,-1732584194,271733878],a;for(a=64;a<=t.length;a+=64)Ja(i,c3(t.substring(a-64,a)));t=t.substring(a-64);let o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(a=0;a<t.length;a++)o[a>>2]|=t.charCodeAt(a)<<(a%4<<3);if(o[a>>2]|=128<<(a%4<<3),a>55)for(Ja(i,o),a=0;a<16;a++)o[a]=0;return o[14]=8*n,Ja(i,o),i}(b.uint8ArrayToString(r));return b.hexToUint8Array(function(t){for(let n=0;n<t.length;n++)t[n]=h3(t[n]);return t.join("")}(e))})},sha1:Vr("sha1")||K1(Yr,"SHA-1"),sha224:Vr("sha224")||ji(Mo),sha256:Vr("sha256")||K1(wo,"SHA-256"),sha384:Vr("sha384")||ji(e3,"SHA-384"),sha512:Vr("sha512")||ji(Ii,"SHA-512"),ripemd:Vr("ripemd160")||ji(w2)},Me={md5:$r.md5,sha1:$r.sha1,sha224:$r.sha224,sha256:$r.sha256,sha384:$r.sha384,sha512:$r.sha512,ripemd:$r.ripemd,digest:function(r,e){switch(r){case d.hash.md5:return this.md5(e);case d.hash.sha1:return this.sha1(e);case d.hash.ripemd:return this.ripemd(e);case d.hash.sha256:return this.sha256(e);case d.hash.sha384:return this.sha384(e);case d.hash.sha512:return this.sha512(e);case d.hash.sha224:return this.sha224(e);default:throw Error("Invalid hash function.")}},getHashByteLength:function(r){switch(r){case d.hash.md5:return 16;case d.hash.sha1:case d.hash.ripemd:return 20;case d.hash.sha256:return 32;case d.hash.sha384:return 48;case d.hash.sha512:return 64;case d.hash.sha224:return 28;default:throw Error("Invalid hash algorithm.")}}},ii=class r{static encrypt(e,t,n){return new r(t,n).encrypt(e)}static decrypt(e,t,n){return new r(t,n).decrypt(e)}constructor(e,t,n){this.aes=n||new on(e,t,!0,"CFB"),delete this.aes.padding}encrypt(e){return jr(this.aes.AES_Encrypt_process(e),this.aes.AES_Encrypt_finish())}decrypt(e){return jr(this.aes.AES_Decrypt_process(e),this.aes.AES_Decrypt_finish())}};function cr(r){let e=d.read(d.symmetric,r);return Ci[e]}var S1=b.getWebCrypto(),la=b.getNodeCrypto(),Zr=la?la.getCiphers():[],qi={idea:Zr.includes("idea-cfb")?"idea-cfb":void 0,tripledes:Zr.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:Zr.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:Zr.includes("bf-cfb")?"bf-cfb":void 0,aes128:Zr.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:Zr.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:Zr.includes("aes-256-cfb")?"aes-256-cfb":void 0},l3=Object.freeze({__proto__:null,encrypt:function(r,e,t,n,i){return x(this,null,function*(){let a=d.read(d.symmetric,r);if(b.getNodeCrypto()&&qi[a])return function(y,m,p,_){let S=d.read(d.symmetric,y),L=new la.createCipheriv(qi[S],m,_);return ee(p,O=>new Uint8Array(L.update(O)))}(r,e,t,n);if(b.isAES(r))return function(y,m,p,_,S){if(b.getWebCrypto()&&m.length!==24&&!b.isStream(p)&&p.length>=3e3*S.minBytesForWebCrypto)return function(O,X,N,K){return x(this,null,function*(){let $="AES-CBC",q=yield S1.importKey("raw",X,{name:$},!1,["encrypt"]),{blockSize:j}=cr(O),Z=b.concatUint8Array([new Uint8Array(j),N]),J=new Uint8Array(yield S1.encrypt({name:$,iv:K},q,Z)).subarray(0,N.length);return function(rt,yt){for(let pt=0;pt<rt.length;pt++)rt[pt]=rt[pt]^yt[pt]}(J,N),J})}(y,m,p,_);let L=new ii(m,_);return ee(p,O=>L.aes.AES_Encrypt_process(O),()=>L.aes.AES_Encrypt_finish())}(r,e,t,n,i);let o=new(cr(r))(e),s=o.blockSize,h=n.slice(),c=new Uint8Array,u=y=>{y&&(c=b.concatUint8Array([c,y]));let m=new Uint8Array(c.length),p,_=0;for(;y?c.length>=s:c.length;){let S=o.encrypt(h);for(p=0;p<s;p++)h[p]=c[p]^S[p],m[_++]=h[p];c=c.subarray(s)}return m.subarray(0,_)};return ee(t,u,u)})},decrypt:function(r,e,t,n){return x(this,null,function*(){let i=d.read(d.symmetric,r);if(b.getNodeCrypto()&&qi[i])return function(u,y,m,p){let _=d.read(d.symmetric,u),S=new la.createDecipheriv(qi[_],y,p);return ee(m,L=>new Uint8Array(S.update(L)))}(r,e,t,n);if(b.isAES(r))return function(u,y,m,p){if(b.isStream(m)){let _=new ii(y,p);return ee(m,S=>_.aes.AES_Decrypt_process(S),()=>_.aes.AES_Decrypt_finish())}return ii.decrypt(m,y,p)}(0,e,t,n);let a=new(cr(r))(e),o=a.blockSize,s=n,h=new Uint8Array,c=u=>{u&&(h=b.concatUint8Array([h,u]));let y=new Uint8Array(h.length),m,p=0;for(;u?h.length>=o:h.length;){let _=a.encrypt(s);for(s=h.subarray(0,o),m=0;m<o;m++)y[p++]=s[m]^_[m];h=h.subarray(o)}return y.subarray(0,p)};return ee(t,c,c)})}}),Ks=class r{static encrypt(e,t,n){return new r(t,n).encrypt(e)}static decrypt(e,t,n){return new r(t,n).encrypt(e)}constructor(e,t,n){this.aes=n||new on(e,void 0,!1,"CTR"),delete this.aes.padding,this.AES_CTR_set_options(t)}encrypt(e){return jr(this.aes.AES_Encrypt_process(e),this.aes.AES_Encrypt_finish())}decrypt(e){return jr(this.aes.AES_Encrypt_process(e),this.aes.AES_Encrypt_finish())}AES_CTR_set_options(e,t,n){let{asm:i}=this.aes.acquire_asm();if(n!==void 0){if(n<8||n>48)throw new qe("illegal counter size");let a=Math.pow(2,n)-1;i.set_mask(0,0,a/4294967296|0,0|a)}else n=48,i.set_mask(0,0,65535,4294967295);if(e===void 0)throw Error("nonce is required");{let a=e.length;if(!a||a>16)throw new qe("illegal nonce size");let o=new DataView(new ArrayBuffer(16));new Uint8Array(o.buffer).set(e),i.set_nonce(o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12))}if(t!==void 0){if(t<0||t>=Math.pow(2,n))throw new qe("illegal counter value");i.set_counter(0,0,t/4294967296|0,0|t)}}},Ss=class r{static encrypt(e,t,n=!0,i){return new r(t,i,n).encrypt(e)}static decrypt(e,t,n=!0,i){return new r(t,i,n).decrypt(e)}constructor(e,t,n=!0,i){this.aes=i||new on(e,t,n,"CBC")}encrypt(e){return jr(this.aes.AES_Encrypt_process(e),this.aes.AES_Encrypt_finish())}decrypt(e){return jr(this.aes.AES_Decrypt_process(e),this.aes.AES_Decrypt_finish())}},x1=b.getWebCrypto(),y3=b.getNodeCrypto(),mr=16;function P1(r,e){let t=r.length-mr;for(let n=0;n<mr;n++)r[n+t]^=e[n];return r}var Gi=new Uint8Array(mr);function d3(r){return x(this,null,function*(){let e=yield function(i){return x(this,null,function*(){return b.getWebCrypto()&&i.length!==24?(i=yield x1.importKey("raw",i,{name:"AES-CBC",length:8*i.length},!1,["encrypt"]),function(a){return x(this,null,function*(){let o=yield x1.encrypt({name:"AES-CBC",iv:Gi,length:8*mr},i,a);return new Uint8Array(o).subarray(0,o.byteLength-mr)})}):b.getNodeCrypto()?function(a){return x(this,null,function*(){let o=new y3.createCipheriv("aes-"+8*i.length+"-cbc",i,Gi).update(a);return new Uint8Array(o)})}:function(a){return x(this,null,function*(){return Ss.encrypt(a,i,!1,Gi)})}})}(r),t=b.double(yield e(Gi)),n=b.double(t);return function(i){return x(this,null,function*(){return(yield e(function(a,o,s){if(a.length&&a.length%mr==0)return P1(a,o);let h=new Uint8Array(a.length+(mr-a.length%mr));return h.set(a),h[a.length]=128,P1(h,s)}(i,t,n))).subarray(-mr)})}})}var U1=b.getWebCrypto(),p3=b.getNodeCrypto(),f3=b.getNodeBuffer(),Kr=16,g3=Kr,vn=Kr,D1=new Uint8Array(Kr),xs=new Uint8Array(Kr);xs[Kr-1]=1;var Ps=new Uint8Array(Kr);function m3(r){return x(this,null,function*(){let e=yield d3(r);return function(t,n){return e(b.concatUint8Array([t,n]))}})}function w3(r){return x(this,null,function*(){return b.getWebCrypto()&&r.length!==24?(r=yield U1.importKey("raw",r,{name:"AES-CTR",length:8*r.length},!1,["encrypt"]),function(e,t){return x(this,null,function*(){let n=yield U1.encrypt({name:"AES-CTR",counter:t,length:8*Kr},r,e);return new Uint8Array(n)})}):b.getNodeCrypto()?function(e,t){return x(this,null,function*(){let n=new p3.createCipheriv("aes-"+8*r.length+"-ctr",r,t),i=f3.concat([n.update(e),n.final()]);return new Uint8Array(i)})}:function(e,t){return x(this,null,function*(){return Ks.encrypt(e,r,t)})}})}function Zn(r,e){return x(this,null,function*(){if(r!==d.symmetric.aes128&&r!==d.symmetric.aes192&&r!==d.symmetric.aes256)throw Error("EAX mode supports only AES cipher");let[t,n]=yield Promise.all([m3(e),w3(e)]);return{encrypt:function(i,a,o){return x(this,null,function*(){let[s,h]=yield Promise.all([t(D1,a),t(xs,o)]),c=yield n(i,s),u=yield t(Ps,c);for(let y=0;y<vn;y++)u[y]^=h[y]^s[y];return b.concatUint8Array([c,u])})},decrypt:function(i,a,o){return x(this,null,function*(){if(i.length<vn)throw Error("Invalid EAX ciphertext");let s=i.subarray(0,-vn),h=i.subarray(-vn),[c,u,y]=yield Promise.all([t(D1,a),t(xs,o),t(Ps,s)]),m=y;for(let p=0;p<vn;p++)m[p]^=u[p]^c[p];if(!b.equalsUint8Array(h,m))throw Error("Authentication tag mismatch");return yield n(s,c)})}}})}Ps[Kr-1]=2,Zn.getNonce=function(r,e){let t=r.slice();for(let n=0;n<e.length;n++)t[8+n]^=e[n];return t},Zn.blockLength=Kr,Zn.ivLength=g3,Zn.tagLength=vn;var ve=16,b2=15,Ir=16;function C1(r){let e=0;for(let t=1;!(r&t);t<<=1)e++;return e}function Ee(r,e){for(let t=0;t<r.length;t++)r[t]^=e[t];return r}function Wi(r,e){return Ee(r.slice(),e)}var ts=new Uint8Array(ve),b3=new Uint8Array([1]);function Xn(r,e){return x(this,null,function*(){let t,n,i,a=0;function o(s,h,c,u){let y=h.length/ve|0;(function(q,j){let Z=b.nbits(Math.max(q.length,j.length)/ve|0)-1;for(let J=a+1;J<=Z;J++)i[J]=b.double(i[J-1]);a=Z})(h,u);let m=b.concatUint8Array([ts.subarray(0,b2-c.length),b3,c]),p=63&m[ve-1];m[ve-1]&=192;let _=t(m),S=b.concatUint8Array([_,Wi(_.subarray(0,8),_.subarray(1,9))]),L=b.shiftRight(S.subarray(0+(p>>3),17+(p>>3)),8-(7&p)).subarray(1),O=new Uint8Array(ve),X=new Uint8Array(h.length+Ir),N,K=0;for(N=0;N<y;N++)Ee(L,i[C1(N+1)]),X.set(Ee(s(Wi(L,h)),L),K),Ee(O,s===t?h:X.subarray(K)),h=h.subarray(ve),K+=ve;if(h.length){Ee(L,i.x);let q=t(L);X.set(Wi(h,q),K);let j=new Uint8Array(ve);j.set(s===t?h:X.subarray(K,-Ir),0),j[h.length]=128,Ee(O,j),K+=h.length}let $=Ee(t(Ee(Ee(O,L),i.$)),function(q){if(!q.length)return ts;let j=q.length/ve|0,Z=new Uint8Array(ve),J=new Uint8Array(ve);for(let rt=0;rt<j;rt++)Ee(Z,i[C1(rt+1)]),Ee(J,t(Wi(Z,q))),q=q.subarray(ve);if(q.length){Ee(Z,i.x);let rt=new Uint8Array(ve);rt.set(q,0),rt[q.length]=128,Ee(rt,Z),Ee(J,t(rt))}return J}(u));return X.set($,K),X}return function(s,h){let c=d.read(d.symmetric,s),u=new Ci[c](h);t=u.encrypt.bind(u),n=u.decrypt.bind(u);let y=t(ts),m=b.double(y);i=[],i[0]=b.double(m),i.x=y,i.$=m}(r,e),{encrypt:function(s,h,c){return x(this,null,function*(){return o(t,s,h,c)})},decrypt:function(s,h,c){return x(this,null,function*(){if(s.length<Ir)throw Error("Invalid OCB ciphertext");let u=s.subarray(-Ir);s=s.subarray(0,-Ir);let y=o(n,s,h,c);if(b.equalsUint8Array(u,y.subarray(-Ir)))return y.subarray(0,-Ir);throw Error("Authentication tag mismatch")})}}})}Xn.getNonce=function(r,e){let t=r.slice();for(let n=0;n<e.length;n++)t[7+n]^=e[n];return t},Xn.blockLength=ve,Xn.ivLength=b2,Xn.tagLength=Ir;var es=68719476704,_n=class r{constructor(e,t,n,i=16,a){this.tagSize=i,this.gamma0=0,this.counter=1,this.aes=a||new on(e,void 0,!1,"CTR");let{asm:o,heap:s}=this.aes.acquire_asm();if(o.gcm_init(),this.tagSize<4||this.tagSize>16)throw new qe("illegal tagSize value");let h=t.length||0,c=new Uint8Array(16);h!==12?(this._gcm_mac_process(t),s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=0,s[11]=h>>>29,s[12]=h>>>21&255,s[13]=h>>>13&255,s[14]=h>>>5&255,s[15]=h<<3&255,o.mac(Ut.MAC.GCM,Ut.HEAP_DATA,16),o.get_iv(Ut.HEAP_DATA),o.set_iv(0,0,0,0),c.set(s.subarray(0,16))):(c.set(t),c[15]=1);let u=new DataView(c.buffer);if(this.gamma0=u.getUint32(12),o.set_nonce(u.getUint32(0),u.getUint32(4),u.getUint32(8),0),o.set_mask(0,0,0,4294967295),n!==void 0){if(n.length>es)throw new qe("illegal adata length");n.length?(this.adata=n,this._gcm_mac_process(n)):this.adata=void 0}else this.adata=void 0;if(this.counter<1||this.counter>4294967295)throw new RangeError("counter must be a positive 32-bit integer");o.set_counter(0,0,0,this.gamma0+this.counter|0)}static encrypt(e,t,n,i,a){return new r(t,n,i,a).encrypt(e)}static decrypt(e,t,n,i,a){return new r(t,n,i,a).decrypt(e)}encrypt(e){return this.AES_GCM_encrypt(e)}decrypt(e){return this.AES_GCM_decrypt(e)}AES_GCM_Encrypt_process(e){let t=0,n=e.length||0,{asm:i,heap:a}=this.aes.acquire_asm(),o=this.counter,s=this.aes.pos,h=this.aes.len,c=0,u=h+n&-16,y=0;if((o-1<<4)+h+n>es)throw new RangeError("counter overflow");let m=new Uint8Array(u);for(;n>0;)y=Qr(a,s+h,e,t,n),h+=y,t+=y,n-=y,y=i.cipher(Ut.ENC.CTR,Ut.HEAP_DATA+s,h),y=i.mac(Ut.MAC.GCM,Ut.HEAP_DATA+s,y),y&&m.set(a.subarray(s,s+y),c),o+=y>>>4,c+=y,y<h?(s+=y,h-=y):(s=0,h=0);return this.counter=o,this.aes.pos=s,this.aes.len=h,m}AES_GCM_Encrypt_finish(){let{asm:e,heap:t}=this.aes.acquire_asm(),n=this.counter,i=this.tagSize,a=this.adata,o=this.aes.pos,s=this.aes.len,h=new Uint8Array(s+i);e.cipher(Ut.ENC.CTR,Ut.HEAP_DATA+o,s+15&-16),s&&h.set(t.subarray(o,o+s));let c=s;for(;15&c;c++)t[o+c]=0;e.mac(Ut.MAC.GCM,Ut.HEAP_DATA+o,c);let u=a!==void 0?a.length:0,y=(n-1<<4)+s;return t[0]=0,t[1]=0,t[2]=0,t[3]=u>>>29,t[4]=u>>>21,t[5]=u>>>13&255,t[6]=u>>>5&255,t[7]=u<<3&255,t[8]=t[9]=t[10]=0,t[11]=y>>>29,t[12]=y>>>21&255,t[13]=y>>>13&255,t[14]=y>>>5&255,t[15]=y<<3&255,e.mac(Ut.MAC.GCM,Ut.HEAP_DATA,16),e.get_iv(Ut.HEAP_DATA),e.set_counter(0,0,0,this.gamma0),e.cipher(Ut.ENC.CTR,Ut.HEAP_DATA,16),h.set(t.subarray(0,i),s),this.counter=1,this.aes.pos=0,this.aes.len=0,h}AES_GCM_Decrypt_process(e){let t=0,n=e.length||0,{asm:i,heap:a}=this.aes.acquire_asm(),o=this.counter,s=this.tagSize,h=this.aes.pos,c=this.aes.len,u=0,y=c+n>s?c+n-s&-16:0,m=c+n-y,p=0;if((o-1<<4)+c+n>es)throw new RangeError("counter overflow");let _=new Uint8Array(y);for(;n>m;)p=Qr(a,h+c,e,t,n-m),c+=p,t+=p,n-=p,p=i.mac(Ut.MAC.GCM,Ut.HEAP_DATA+h,p),p=i.cipher(Ut.DEC.CTR,Ut.HEAP_DATA+h,p),p&&_.set(a.subarray(h,h+p),u),o+=p>>>4,u+=p,h=0,c=0;return n>0&&(c+=Qr(a,0,e,t,n)),this.counter=o,this.aes.pos=h,this.aes.len=c,_}AES_GCM_Decrypt_finish(){let{asm:e,heap:t}=this.aes.acquire_asm(),n=this.tagSize,i=this.adata,a=this.counter,o=this.aes.pos,s=this.aes.len,h=s-n;if(s<n)throw new ui("authentication tag not found");let c=new Uint8Array(h),u=new Uint8Array(t.subarray(o+h,o+s)),y=h;for(;15&y;y++)t[o+y]=0;e.mac(Ut.MAC.GCM,Ut.HEAP_DATA+o,y),e.cipher(Ut.DEC.CTR,Ut.HEAP_DATA+o,y),h&&c.set(t.subarray(o,o+h));let m=i!==void 0?i.length:0,p=(a-1<<4)+s-n;t[0]=0,t[1]=0,t[2]=0,t[3]=m>>>29,t[4]=m>>>21,t[5]=m>>>13&255,t[6]=m>>>5&255,t[7]=m<<3&255,t[8]=t[9]=t[10]=0,t[11]=p>>>29,t[12]=p>>>21&255,t[13]=p>>>13&255,t[14]=p>>>5&255,t[15]=p<<3&255,e.mac(Ut.MAC.GCM,Ut.HEAP_DATA,16),e.get_iv(Ut.HEAP_DATA),e.set_counter(0,0,0,this.gamma0),e.cipher(Ut.ENC.CTR,Ut.HEAP_DATA,16);let _=0;for(let S=0;S<n;++S)_|=u[S]^t[S];if(_)throw new li("data integrity check failed");return this.counter=1,this.aes.pos=0,this.aes.len=0,c}AES_GCM_decrypt(e){let t=this.AES_GCM_Decrypt_process(e),n=this.AES_GCM_Decrypt_finish(),i=new Uint8Array(t.length+n.length);return t.length&&i.set(t),n.length&&i.set(n,t.length),i}AES_GCM_encrypt(e){let t=this.AES_GCM_Encrypt_process(e),n=this.AES_GCM_Encrypt_finish(),i=new Uint8Array(t.length+n.length);return t.length&&i.set(t),n.length&&i.set(n,t.length),i}_gcm_mac_process(e){let{asm:t,heap:n}=this.aes.acquire_asm(),i=0,a=e.length||0,o=0;for(;a>0;){for(o=Qr(n,0,e,i,a),i+=o,a-=o;15&o;)n[o++]=0;t.mac(Ut.MAC.GCM,Ut.HEAP_DATA,o)}}},rs=b.getWebCrypto(),I1=b.getNodeCrypto(),T1=b.getNodeBuffer(),An=16,ns="AES-GCM";function Kn(r,e){return x(this,null,function*(){if(r!==d.symmetric.aes128&&r!==d.symmetric.aes192&&r!==d.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(b.getNodeCrypto())return{encrypt:function(a,o){return x(this,arguments,function*(t,n,i=new Uint8Array){let s=new I1.createCipheriv("aes-"+8*e.length+"-gcm",e,n);s.setAAD(i);let h=T1.concat([s.update(t),s.final(),s.getAuthTag()]);return new Uint8Array(h)})},decrypt:function(a,o){return x(this,arguments,function*(t,n,i=new Uint8Array){let s=new I1.createDecipheriv("aes-"+8*e.length+"-gcm",e,n);s.setAAD(i),s.setAuthTag(t.slice(t.length-An,t.length));let h=T1.concat([s.update(t.slice(0,t.length-An)),s.final()]);return new Uint8Array(h)})}};if(b.getWebCrypto()&&e.length!==24){let t=yield rs.importKey("raw",e,{name:ns},!1,["encrypt","decrypt"]);return{encrypt:function(o,s){return x(this,arguments,function*(n,i,a=new Uint8Array){if(!n.length)return _n.encrypt(n,e,i,a);let h=yield rs.encrypt({name:ns,iv:i,additionalData:a,tagLength:8*An},t,n);return new Uint8Array(h)})},decrypt:function(o,s){return x(this,arguments,function*(n,i,a=new Uint8Array){if(n.length===An)return _n.decrypt(n,e,i,a);let h=yield rs.decrypt({name:ns,iv:i,additionalData:a,tagLength:8*An},t,n);return new Uint8Array(h)})}}}return{encrypt:function(t,n,i){return x(this,null,function*(){return _n.encrypt(t,e,n,i)})},decrypt:function(t,n,i){return x(this,null,function*(){return _n.decrypt(t,e,n,i)})}}})}Kn.getNonce=function(r,e){let t=r.slice();for(let n=0;n<e.length;n++)t[4+n]^=e[n];return t},Kn.blockLength=16,Kn.ivLength=12,Kn.tagLength=An;var k2={cfb:l3,gcm:Kn,experimentalGCM:Kn,eax:Zn,ocb:Xn},oe=Vs(function(r){(function(e){var t=function(U){var F,H=new Float64Array(16);if(U)for(F=0;F<U.length;F++)H[F]=U[F];return H},n=function(){throw Error("no PRNG")},i=new Uint8Array(32);i[0]=9;var a=t(),o=t([1]),s=t([56129,1]),h=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),y=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),m=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(U,F,H,l){return function(P,V,Q,Y,g){var f,w=0;for(f=0;f<g;f++)w|=P[V+f]^Q[Y+f];return(1&w-1>>>8)-1}(U,F,H,l,32)}function _(U,F){var H;for(H=0;H<16;H++)U[H]=0|F[H]}function S(U){var F,H,l=1;for(F=0;F<16;F++)H=U[F]+l+65535,l=Math.floor(H/65536),U[F]=H-65536*l;U[0]+=l-1+37*(l-1)}function L(U,F,H){for(var l,P=~(H-1),V=0;V<16;V++)l=P&(U[V]^F[V]),U[V]^=l,F[V]^=l}function O(U,F){var H,l,P,V=t(),Q=t();for(H=0;H<16;H++)Q[H]=F[H];for(S(Q),S(Q),S(Q),l=0;l<2;l++){for(V[0]=Q[0]-65517,H=1;H<15;H++)V[H]=Q[H]-65535-(V[H-1]>>16&1),V[H-1]&=65535;V[15]=Q[15]-32767-(V[14]>>16&1),P=V[15]>>16&1,V[14]&=65535,L(Q,V,1-P)}for(H=0;H<16;H++)U[2*H]=255&Q[H],U[2*H+1]=Q[H]>>8}function X(U,F){var H=new Uint8Array(32),l=new Uint8Array(32);return O(H,U),O(l,F),p(H,0,l,0)}function N(U){var F=new Uint8Array(32);return O(F,U),1&F[0]}function K(U,F){var H;for(H=0;H<16;H++)U[H]=F[2*H]+(F[2*H+1]<<8);U[15]&=32767}function $(U,F,H){for(var l=0;l<16;l++)U[l]=F[l]+H[l]}function q(U,F,H){for(var l=0;l<16;l++)U[l]=F[l]-H[l]}function j(U,F,H){var l,P,V=0,Q=0,Y=0,g=0,f=0,w=0,A=0,T=0,D=0,M=0,lt=0,ot=0,ut=0,ct=0,C=0,I=0,B=0,z=0,R=0,v=0,k=0,E=0,it=0,xt=0,Bt=0,Mt=0,It=0,Zt=0,te=0,ne=0,ce=0,Ct=H[0],Ot=H[1],Lt=H[2],St=H[3],Wt=H[4],Ht=H[5],qt=H[6],tt=H[7],et=H[8],ht=H[9],At=H[10],Et=H[11],Pt=H[12],_t=H[13],Ft=H[14],Vt=H[15];V+=(l=F[0])*Ct,Q+=l*Ot,Y+=l*Lt,g+=l*St,f+=l*Wt,w+=l*Ht,A+=l*qt,T+=l*tt,D+=l*et,M+=l*ht,lt+=l*At,ot+=l*Et,ut+=l*Pt,ct+=l*_t,C+=l*Ft,I+=l*Vt,Q+=(l=F[1])*Ct,Y+=l*Ot,g+=l*Lt,f+=l*St,w+=l*Wt,A+=l*Ht,T+=l*qt,D+=l*tt,M+=l*et,lt+=l*ht,ot+=l*At,ut+=l*Et,ct+=l*Pt,C+=l*_t,I+=l*Ft,B+=l*Vt,Y+=(l=F[2])*Ct,g+=l*Ot,f+=l*Lt,w+=l*St,A+=l*Wt,T+=l*Ht,D+=l*qt,M+=l*tt,lt+=l*et,ot+=l*ht,ut+=l*At,ct+=l*Et,C+=l*Pt,I+=l*_t,B+=l*Ft,z+=l*Vt,g+=(l=F[3])*Ct,f+=l*Ot,w+=l*Lt,A+=l*St,T+=l*Wt,D+=l*Ht,M+=l*qt,lt+=l*tt,ot+=l*et,ut+=l*ht,ct+=l*At,C+=l*Et,I+=l*Pt,B+=l*_t,z+=l*Ft,R+=l*Vt,f+=(l=F[4])*Ct,w+=l*Ot,A+=l*Lt,T+=l*St,D+=l*Wt,M+=l*Ht,lt+=l*qt,ot+=l*tt,ut+=l*et,ct+=l*ht,C+=l*At,I+=l*Et,B+=l*Pt,z+=l*_t,R+=l*Ft,v+=l*Vt,w+=(l=F[5])*Ct,A+=l*Ot,T+=l*Lt,D+=l*St,M+=l*Wt,lt+=l*Ht,ot+=l*qt,ut+=l*tt,ct+=l*et,C+=l*ht,I+=l*At,B+=l*Et,z+=l*Pt,R+=l*_t,v+=l*Ft,k+=l*Vt,A+=(l=F[6])*Ct,T+=l*Ot,D+=l*Lt,M+=l*St,lt+=l*Wt,ot+=l*Ht,ut+=l*qt,ct+=l*tt,C+=l*et,I+=l*ht,B+=l*At,z+=l*Et,R+=l*Pt,v+=l*_t,k+=l*Ft,E+=l*Vt,T+=(l=F[7])*Ct,D+=l*Ot,M+=l*Lt,lt+=l*St,ot+=l*Wt,ut+=l*Ht,ct+=l*qt,C+=l*tt,I+=l*et,B+=l*ht,z+=l*At,R+=l*Et,v+=l*Pt,k+=l*_t,E+=l*Ft,it+=l*Vt,D+=(l=F[8])*Ct,M+=l*Ot,lt+=l*Lt,ot+=l*St,ut+=l*Wt,ct+=l*Ht,C+=l*qt,I+=l*tt,B+=l*et,z+=l*ht,R+=l*At,v+=l*Et,k+=l*Pt,E+=l*_t,it+=l*Ft,xt+=l*Vt,M+=(l=F[9])*Ct,lt+=l*Ot,ot+=l*Lt,ut+=l*St,ct+=l*Wt,C+=l*Ht,I+=l*qt,B+=l*tt,z+=l*et,R+=l*ht,v+=l*At,k+=l*Et,E+=l*Pt,it+=l*_t,xt+=l*Ft,Bt+=l*Vt,lt+=(l=F[10])*Ct,ot+=l*Ot,ut+=l*Lt,ct+=l*St,C+=l*Wt,I+=l*Ht,B+=l*qt,z+=l*tt,R+=l*et,v+=l*ht,k+=l*At,E+=l*Et,it+=l*Pt,xt+=l*_t,Bt+=l*Ft,Mt+=l*Vt,ot+=(l=F[11])*Ct,ut+=l*Ot,ct+=l*Lt,C+=l*St,I+=l*Wt,B+=l*Ht,z+=l*qt,R+=l*tt,v+=l*et,k+=l*ht,E+=l*At,it+=l*Et,xt+=l*Pt,Bt+=l*_t,Mt+=l*Ft,It+=l*Vt,ut+=(l=F[12])*Ct,ct+=l*Ot,C+=l*Lt,I+=l*St,B+=l*Wt,z+=l*Ht,R+=l*qt,v+=l*tt,k+=l*et,E+=l*ht,it+=l*At,xt+=l*Et,Bt+=l*Pt,Mt+=l*_t,It+=l*Ft,Zt+=l*Vt,ct+=(l=F[13])*Ct,C+=l*Ot,I+=l*Lt,B+=l*St,z+=l*Wt,R+=l*Ht,v+=l*qt,k+=l*tt,E+=l*et,it+=l*ht,xt+=l*At,Bt+=l*Et,Mt+=l*Pt,It+=l*_t,Zt+=l*Ft,te+=l*Vt,C+=(l=F[14])*Ct,I+=l*Ot,B+=l*Lt,z+=l*St,R+=l*Wt,v+=l*Ht,k+=l*qt,E+=l*tt,it+=l*et,xt+=l*ht,Bt+=l*At,Mt+=l*Et,It+=l*Pt,Zt+=l*_t,te+=l*Ft,ne+=l*Vt,I+=(l=F[15])*Ct,Q+=38*(z+=l*Lt),Y+=38*(R+=l*St),g+=38*(v+=l*Wt),f+=38*(k+=l*Ht),w+=38*(E+=l*qt),A+=38*(it+=l*tt),T+=38*(xt+=l*et),D+=38*(Bt+=l*ht),M+=38*(Mt+=l*At),lt+=38*(It+=l*Et),ot+=38*(Zt+=l*Pt),ut+=38*(te+=l*_t),ct+=38*(ne+=l*Ft),C+=38*(ce+=l*Vt),V=(l=(V+=38*(B+=l*Ot))+(P=1)+65535)-65536*(P=Math.floor(l/65536)),Q=(l=Q+P+65535)-65536*(P=Math.floor(l/65536)),Y=(l=Y+P+65535)-65536*(P=Math.floor(l/65536)),g=(l=g+P+65535)-65536*(P=Math.floor(l/65536)),f=(l=f+P+65535)-65536*(P=Math.floor(l/65536)),w=(l=w+P+65535)-65536*(P=Math.floor(l/65536)),A=(l=A+P+65535)-65536*(P=Math.floor(l/65536)),T=(l=T+P+65535)-65536*(P=Math.floor(l/65536)),D=(l=D+P+65535)-65536*(P=Math.floor(l/65536)),M=(l=M+P+65535)-65536*(P=Math.floor(l/65536)),lt=(l=lt+P+65535)-65536*(P=Math.floor(l/65536)),ot=(l=ot+P+65535)-65536*(P=Math.floor(l/65536)),ut=(l=ut+P+65535)-65536*(P=Math.floor(l/65536)),ct=(l=ct+P+65535)-65536*(P=Math.floor(l/65536)),C=(l=C+P+65535)-65536*(P=Math.floor(l/65536)),I=(l=I+P+65535)-65536*(P=Math.floor(l/65536)),V=(l=(V+=P-1+37*(P-1))+(P=1)+65535)-65536*(P=Math.floor(l/65536)),Q=(l=Q+P+65535)-65536*(P=Math.floor(l/65536)),Y=(l=Y+P+65535)-65536*(P=Math.floor(l/65536)),g=(l=g+P+65535)-65536*(P=Math.floor(l/65536)),f=(l=f+P+65535)-65536*(P=Math.floor(l/65536)),w=(l=w+P+65535)-65536*(P=Math.floor(l/65536)),A=(l=A+P+65535)-65536*(P=Math.floor(l/65536)),T=(l=T+P+65535)-65536*(P=Math.floor(l/65536)),D=(l=D+P+65535)-65536*(P=Math.floor(l/65536)),M=(l=M+P+65535)-65536*(P=Math.floor(l/65536)),lt=(l=lt+P+65535)-65536*(P=Math.floor(l/65536)),ot=(l=ot+P+65535)-65536*(P=Math.floor(l/65536)),ut=(l=ut+P+65535)-65536*(P=Math.floor(l/65536)),ct=(l=ct+P+65535)-65536*(P=Math.floor(l/65536)),C=(l=C+P+65535)-65536*(P=Math.floor(l/65536)),I=(l=I+P+65535)-65536*(P=Math.floor(l/65536)),V+=P-1+37*(P-1),U[0]=V,U[1]=Q,U[2]=Y,U[3]=g,U[4]=f,U[5]=w,U[6]=A,U[7]=T,U[8]=D,U[9]=M,U[10]=lt,U[11]=ot,U[12]=ut,U[13]=ct,U[14]=C,U[15]=I}function Z(U,F){j(U,F,F)}function J(U,F){var H,l=t();for(H=0;H<16;H++)l[H]=F[H];for(H=253;H>=0;H--)Z(l,l),H!==2&&H!==4&&j(l,l,F);for(H=0;H<16;H++)U[H]=l[H]}function rt(U,F,H){var l,P,V=new Uint8Array(32),Q=new Float64Array(80),Y=t(),g=t(),f=t(),w=t(),A=t(),T=t();for(P=0;P<31;P++)V[P]=F[P];for(V[31]=127&F[31]|64,V[0]&=248,K(Q,H),P=0;P<16;P++)g[P]=Q[P],w[P]=Y[P]=f[P]=0;for(Y[0]=w[0]=1,P=254;P>=0;--P)L(Y,g,l=V[P>>>3]>>>(7&P)&1),L(f,w,l),$(A,Y,f),q(Y,Y,f),$(f,g,w),q(g,g,w),Z(w,A),Z(T,Y),j(Y,f,Y),j(f,g,A),$(A,Y,f),q(Y,Y,f),Z(g,Y),q(f,w,T),j(Y,f,s),$(Y,Y,w),j(f,f,Y),j(Y,w,T),j(w,g,Q),Z(g,A),L(Y,g,l),L(f,w,l);for(P=0;P<16;P++)Q[P+16]=Y[P],Q[P+32]=f[P],Q[P+48]=g[P],Q[P+64]=w[P];var D=Q.subarray(32),M=Q.subarray(16);return J(D,D),j(M,M,D),O(U,M),0}function yt(U,F){return rt(U,F,i)}function pt(U,F){var H=t(),l=t(),P=t(),V=t(),Q=t(),Y=t(),g=t(),f=t(),w=t();q(H,U[1],U[0]),q(w,F[1],F[0]),j(H,H,w),$(l,U[0],U[1]),$(w,F[0],F[1]),j(l,l,w),j(P,U[3],F[3]),j(P,P,c),j(V,U[2],F[2]),$(V,V,V),q(Q,l,H),q(Y,V,P),$(g,V,P),$(f,l,H),j(U[0],Q,Y),j(U[1],f,g),j(U[2],g,Y),j(U[3],Q,f)}function kt(U,F,H){var l;for(l=0;l<4;l++)L(U[l],F[l],H)}function at(U,F){var H=t(),l=t(),P=t();J(P,F[2]),j(H,F[0],P),j(l,F[1],P),O(U,l),U[31]^=N(H)<<7}function W(U,F,H){var l,P;for(_(U[0],a),_(U[1],o),_(U[2],o),_(U[3],a),P=255;P>=0;--P)kt(U,F,l=H[P/8|0]>>(7&P)&1),pt(F,U),pt(U,U),kt(U,F,l)}function Dt(U,F){var H=[t(),t(),t(),t()];_(H[0],u),_(H[1],y),_(H[2],o),j(H[3],u,y),W(U,H,F)}function G(U,F,H){var l,P,V=[t(),t(),t(),t()];for(H||n(F,32),(l=e.hash(F.subarray(0,32)))[0]&=248,l[31]&=127,l[31]|=64,Dt(V,l),at(U,V),P=0;P<32;P++)F[P+32]=U[P];return 0}var nt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function mt(U,F){var H,l,P,V;for(l=63;l>=32;--l){for(H=0,P=l-32,V=l-12;P<V;++P)F[P]+=H-16*F[l]*nt[P-(l-32)],H=Math.floor((F[P]+128)/256),F[P]-=256*H;F[P]+=H,F[l]=0}for(H=0,P=0;P<32;P++)F[P]+=H-(F[31]>>4)*nt[P],H=F[P]>>8,F[P]&=255;for(P=0;P<32;P++)F[P]-=H*nt[P];for(l=0;l<32;l++)F[l+1]+=F[l]>>8,U[l]=255&F[l]}function bt(U){var F,H=new Float64Array(64);for(F=0;F<64;F++)H[F]=U[F];for(F=0;F<64;F++)U[F]=0;mt(U,H)}function gt(U,F){var H=t(),l=t(),P=t(),V=t(),Q=t(),Y=t(),g=t();return _(U[2],o),K(U[1],F),Z(P,U[1]),j(V,P,h),q(P,P,U[2]),$(V,U[2],V),Z(Q,V),Z(Y,Q),j(g,Y,Q),j(H,g,P),j(H,H,V),function(f,w){var A,T=t();for(A=0;A<16;A++)T[A]=w[A];for(A=250;A>=0;A--)Z(T,T),A!==1&&j(T,T,w);for(A=0;A<16;A++)f[A]=T[A]}(H,H),j(H,H,P),j(H,H,V),j(H,H,V),j(U[0],H,V),Z(l,U[0]),j(l,l,V),X(l,P)&&j(U[0],U[0],m),Z(l,U[0]),j(l,l,V),X(l,P)?-1:(N(U[0])===F[31]>>7&&q(U[0],a,U[0]),j(U[3],U[0],U[1]),0)}var ft=64;function vt(){for(var U=0;U<arguments.length;U++)if(!(arguments[U]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function st(U){for(var F=0;F<U.length;F++)U[F]=0}e.scalarMult=function(U,F){if(vt(U,F),U.length!==32)throw Error("bad n size");if(F.length!==32)throw Error("bad p size");var H=new Uint8Array(32);return rt(H,U,F),H},e.box={},e.box.keyPair=function(){var U,F,H=new Uint8Array(32),l=new Uint8Array(32);return U=H,n(F=l,32),yt(U,F),{publicKey:H,secretKey:l}},e.box.keyPair.fromSecretKey=function(U){if(vt(U),U.length!==32)throw Error("bad secret key size");var F=new Uint8Array(32);return yt(F,U),{publicKey:F,secretKey:new Uint8Array(U)}},e.sign=function(U,F){if(vt(U,F),F.length!==64)throw Error("bad secret key size");var H=new Uint8Array(ft+U.length);return function(l,P,V,Q){var Y,g,f,w,A,T=new Float64Array(64),D=[t(),t(),t(),t()];(Y=e.hash(Q.subarray(0,32)))[0]&=248,Y[31]&=127,Y[31]|=64;var M=V+64;for(w=0;w<V;w++)l[64+w]=P[w];for(w=0;w<32;w++)l[32+w]=Y[32+w];for(bt(f=e.hash(l.subarray(32,M))),Dt(D,f),at(l,D),w=32;w<64;w++)l[w]=Q[w];for(bt(g=e.hash(l.subarray(0,M))),w=0;w<64;w++)T[w]=0;for(w=0;w<32;w++)T[w]=f[w];for(w=0;w<32;w++)for(A=0;A<32;A++)T[w+A]+=g[w]*Y[A];mt(l.subarray(32),T)}(H,U,U.length,F),H},e.sign.detached=function(U,F){for(var H=e.sign(U,F),l=new Uint8Array(ft),P=0;P<l.length;P++)l[P]=H[P];return l},e.sign.detached.verify=function(U,F,H){if(vt(U,F,H),F.length!==ft)throw Error("bad signature size");if(H.length!==32)throw Error("bad public key size");var l,P=new Uint8Array(ft+U.length),V=new Uint8Array(ft+U.length);for(l=0;l<ft;l++)P[l]=F[l];for(l=0;l<U.length;l++)P[l+ft]=U[l];return function(Q,Y,g,f){var w,A,T=new Uint8Array(32),D=[t(),t(),t(),t()],M=[t(),t(),t(),t()];if(g<64||gt(M,f))return-1;for(w=0;w<g;w++)Q[w]=Y[w];for(w=0;w<32;w++)Q[w+32]=f[w];if(bt(A=e.hash(Q.subarray(0,g))),W(D,M,A),Dt(M,Y.subarray(32)),pt(D,M),at(T,D),g-=64,p(Y,0,T,0)){for(w=0;w<g;w++)Q[w]=0;return-1}for(w=0;w<g;w++)Q[w]=Y[w+64];return g}(V,P,P.length,H)>=0},e.sign.keyPair=function(){var U=new Uint8Array(32),F=new Uint8Array(64);return G(U,F),{publicKey:U,secretKey:F}},e.sign.keyPair.fromSecretKey=function(U){if(vt(U),U.length!==64)throw Error("bad secret key size");for(var F=new Uint8Array(32),H=0;H<F.length;H++)F[H]=U[32+H];return{publicKey:F,secretKey:new Uint8Array(U)}},e.sign.keyPair.fromSeed=function(U){if(vt(U),U.length!==32)throw Error("bad seed size");for(var F=new Uint8Array(32),H=new Uint8Array(64),l=0;l<32;l++)H[l]=U[l];return G(F,H,!0),{publicKey:F,secretKey:H}},e.setPRNG=function(U){n=U},function(){var U=typeof self<"u"?self.crypto||self.msCrypto:null;U&&U.getRandomValues?e.setPRNG(function(F,H){var l,P=new Uint8Array(H);for(l=0;l<H;l+=65536)U.getRandomValues(P.subarray(l,l+Math.min(H-l,65536)));for(l=0;l<H;l++)F[l]=P[l];st(P)}):bo!==void 0&&(U=void 0)&&U.randomBytes&&e.setPRNG(function(F,H){var l,P=U.randomBytes(H);for(l=0;l<H;l++)F[l]=P[l];st(P)})}()})(r.exports?r.exports:self.nacl=self.nacl||{})}),B1=b.getNodeCrypto();function Ce(r){let e=new Uint8Array(r);if(B1){let t=B1.randomBytes(e.length);e.set(t)}else{if(typeof crypto>"u"||!crypto.getRandomValues)throw Error("No secure random number generator available.");crypto.getRandomValues(e)}return e}function Sr(r,e){return x(this,null,function*(){let t=yield b.getBigInteger();if(e.lt(r))throw Error("Illegal parameter value: max <= min");let n=e.sub(r),i=n.byteLength();return new t(yield Ce(i+8)).mod(n).add(r)})}var k3=Object.freeze({__proto__:null,getRandomBytes:Ce,getRandomBigInteger:Sr});function z1(r,e,t){return x(this,null,function*(){let n=yield b.getBigInteger(),i=new n(1),a=i.leftShift(new n(r-1)),o=new n(30),s=[1,6,5,4,3,2,1,4,3,2,1,2,1,4,3,2,1,2,1,4,3,2,1,6,5,4,3,2,1,2],h=yield Sr(a,a.leftShift(i)),c=h.mod(o).toNumber();do h.iadd(new n(s[c])),c=(c+s[c])%s.length,h.bitLength()>r&&(h.imod(a.leftShift(i)).iadd(a),c=h.mod(o).toNumber());while(!(yield v2(h,e,t)));return h})}function v2(r,e,t){return x(this,null,function*(){return!(e&&!r.dec().gcd(e).isOne())&&!!(yield function(n){return x(this,null,function*(){let i=yield b.getBigInteger();return v3.every(a=>n.mod(new i(a))!==0)})}(r))&&!!(yield function(n,i){return x(this,null,function*(){let a=yield b.getBigInteger();return i=i||new a(2),i.modExp(n.dec(),n).isOne()})}(r))&&!!(yield function(n,i,a){return x(this,null,function*(){let o=yield b.getBigInteger(),s=n.bitLength();i||(i=Math.max(1,s/48|0));let h=n.dec(),c=0;for(;!h.getBit(c);)c++;let u=n.rightShift(new o(c));for(;i>0;i--){let y,m=(a?a():yield Sr(new o(2),h)).modExp(u,n);if(!m.isOne()&&!m.equal(h)){for(y=1;y<c;y++){if(m=m.mul(m).mod(n),m.isOne())return!1;if(m.equal(h))break}if(y===c)return!1}}return!0})}(r,t))})}var v3=[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999],Qe=[];function Zs(r,e){let t=r.length;if(t>e-11)throw Error("Message too long");let n=function(a){let o=new Uint8Array(a),s=0;for(;s<a;){let h=Ce(a-s);for(let c=0;c<h.length;c++)h[c]!==0&&(o[s++]=h[c])}return o}(e-t-3),i=new Uint8Array(e);return i[1]=2,i.set(n,2),i.set(r,e-t),i}function Xs(r,e){let t=2,n=1;for(let s=t;s<r.length;s++)n&=r[s]!==0,t+=n;let i=t-2,a=r.subarray(t+1),o=r[0]===0&r[1]===2&i>=8&!n;if(e)return b.selectUint8Array(o,a,e);if(o)return a;throw Error("Decryption error")}function Us(r,e,t){return x(this,null,function*(){let n;if(e.length!==Me.getHashByteLength(r))throw Error("Invalid hash length");let i=new Uint8Array(Qe[r].length);for(n=0;n<Qe[r].length;n++)i[n]=Qe[r][n];let a=i.length+e.length;if(t<a+11)throw Error("Intended encoded message length too short");let o=new Uint8Array(t-a-3).fill(255),s=new Uint8Array(t);return s[1]=1,s.set(o,2),s.set(i,t-a),s.set(e,t-e.length),s})}Qe[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],Qe[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],Qe[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],Qe[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],Qe[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],Qe[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],Qe[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];var A3=Object.freeze({__proto__:null,emeEncode:Zs,emeDecode:Xs,emsaEncode:Us}),mn=b.getWebCrypto(),ke=b.getNodeCrypto(),A2=void 0,wn=ke?A2.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}):void 0,Vi=ke?A2.define("RSAPubliceKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}):void 0,E3=Object.freeze({__proto__:null,sign:function(r,e,t,n,i,a,o,s,h){return x(this,null,function*(){if(e&&!b.isStream(e)){if(b.getWebCrypto())try{return yield function(c,u,y,m,p,_,S,L){return x(this,null,function*(){let O=yield function(K,$,q,j,Z,J){return x(this,null,function*(){let rt=yield b.getBigInteger(),yt=new rt(j),pt=new rt(Z),kt=new rt(q),at=kt.mod(pt.dec()),W=kt.mod(yt.dec());return W=W.toUint8Array(),at=at.toUint8Array(),{kty:"RSA",n:Pe(K,!0),e:Pe($,!0),d:Pe(q,!0),p:Pe(Z,!0),q:Pe(j,!0),dp:Pe(at,!0),dq:Pe(W,!0),qi:Pe(J,!0),ext:!0}})}(y,m,p,_,S,L),X={name:"RSASSA-PKCS1-v1_5",hash:{name:c}},N=yield mn.importKey("jwk",O,X,!1,["sign"]);return new Uint8Array(yield mn.sign("RSASSA-PKCS1-v1_5",N,u))})}(d.read(d.webHash,r),e,t,n,i,a,o,s)}catch(c){b.printDebugError(c)}else if(b.getNodeCrypto())return function(c,u,y,m,p,_,S,L){return x(this,null,function*(){let{default:O}=yield import("./chunk-GILONDBT.js"),X=new O(_),N=new O(S),K=new O(p),$=K.mod(N.subn(1)),q=K.mod(X.subn(1)),j=ke.createSign(d.read(d.hash,c));j.write(u),j.end();let Z={version:0,modulus:new O(y),publicExponent:new O(m),privateExponent:new O(p),prime1:new O(S),prime2:new O(_),exponent1:$,exponent2:q,coefficient:new O(L)};if(ke.createPrivateKey!==void 0){let rt=wn.encode(Z,"der");return new Uint8Array(j.sign({key:rt,format:"der",type:"pkcs1"}))}let J=wn.encode(Z,"pem",{label:"RSA PRIVATE KEY"});return new Uint8Array(j.sign(J))})}(r,e,t,n,i,a,o,s)}return function(c,u,y,m){return x(this,null,function*(){let p=yield b.getBigInteger();u=new p(u);let _=new p(yield Us(c,m,u.byteLength()));if(y=new p(y),_.gte(u))throw Error("Message size cannot exceed modulus size");return _.modExp(y,u).toUint8Array("be",u.byteLength())})}(r,t,i,h)})},verify:function(r,e,t,n,i,a){return x(this,null,function*(){if(e&&!b.isStream(e)){if(b.getWebCrypto())try{return yield function(o,s,h,c,u){return x(this,null,function*(){let y=function(p,_){return{kty:"RSA",n:Pe(p,!0),e:Pe(_,!0),ext:!0}}(c,u),m=yield mn.importKey("jwk",y,{name:"RSASSA-PKCS1-v1_5",hash:{name:o}},!1,["verify"]);return mn.verify("RSASSA-PKCS1-v1_5",m,h,s)})}(d.read(d.webHash,r),e,t,n,i)}catch(o){b.printDebugError(o)}else if(b.getNodeCrypto())return function(o,s,h,c,u){return x(this,null,function*(){let{default:y}=yield import("./chunk-GILONDBT.js"),m=ke.createVerify(d.read(d.hash,o));m.write(s),m.end();let p={modulus:new y(c),publicExponent:new y(u)},_;ke.createPrivateKey!==void 0?_={key:Vi.encode(p,"der"),format:"der",type:"pkcs1"}:_=Vi.encode(p,"pem",{label:"RSA PUBLIC KEY"});try{return yield m.verify(_,h)}catch{return!1}})}(r,e,t,n,i)}return function(o,s,h,c,u){return x(this,null,function*(){let y=yield b.getBigInteger();if(h=new y(h),s=new y(s),c=new y(c),s.gte(h))throw Error("Signature size cannot exceed modulus size");let m=s.modExp(c,h).toUint8Array("be",h.byteLength()),p=yield Us(o,u,h.byteLength());return b.equalsUint8Array(m,p)})}(r,t,n,i,a)})},encrypt:function(r,e,t){return x(this,null,function*(){return b.getNodeCrypto()?function(n,i,a){return x(this,null,function*(){let{default:o}=yield import("./chunk-GILONDBT.js"),s={modulus:new o(i),publicExponent:new o(a)},h;return ke.createPrivateKey!==void 0?h={key:Vi.encode(s,"der"),format:"der",type:"pkcs1",padding:ke.constants.RSA_PKCS1_PADDING}:h={key:Vi.encode(s,"pem",{label:"RSA PUBLIC KEY"}),padding:ke.constants.RSA_PKCS1_PADDING},new Uint8Array(ke.publicEncrypt(h,n))})}(r,e,t):function(n,i,a){return x(this,null,function*(){let o=yield b.getBigInteger();if(i=new o(i),n=new o(Zs(n,i.byteLength())),a=new o(a),n.gte(i))throw Error("Message size cannot exceed modulus size");return n.modExp(a,i).toUint8Array("be",i.byteLength())})}(r,e,t)})},decrypt:function(r,e,t,n,i,a,o,s){return x(this,null,function*(){if(b.getNodeCrypto()&&!s)try{return yield function(h,c,u,y,m,p,_){return x(this,null,function*(){let{default:S}=yield import("./chunk-GILONDBT.js"),L=new S(m),O=new S(p),X=new S(y),N=X.mod(O.subn(1)),K=X.mod(L.subn(1)),$={version:0,modulus:new S(c),publicExponent:new S(u),privateExponent:new S(y),prime1:new S(p),prime2:new S(m),exponent1:N,exponent2:K,coefficient:new S(_)},q;ke.createPrivateKey!==void 0?q={key:wn.encode($,"der"),format:"der",type:"pkcs1",padding:ke.constants.RSA_PKCS1_PADDING}:q={key:wn.encode($,"pem",{label:"RSA PRIVATE KEY"}),padding:ke.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(ke.privateDecrypt(q,h))}catch{throw Error("Decryption error")}})}(r,e,t,n,i,a,o)}catch(h){b.printDebugError(h)}return function(h,c,u,y,m,p,_,S){return x(this,null,function*(){let L=yield b.getBigInteger();if(h=new L(h),c=new L(c),u=new L(u),y=new L(y),m=new L(m),p=new L(p),_=new L(_),h.gte(c))throw Error("Data too large.");let O=y.mod(p.dec()),X=y.mod(m.dec()),N=(yield Sr(new L(2),c)).mod(c),K=N.modInv(c).modExp(u,c);h=h.mul(K).mod(c);let $=h.modExp(X,m),q=h.modExp(O,p),Z=_.mul(q.sub($)).mod(p).mul(m).add($);return Z=Z.mul(N).mod(c),Xs(Z.toUint8Array("be",c.byteLength()),S)})}(r,e,t,n,i,a,o,s)})},generate:function(r,e){return x(this,null,function*(){if(e=new(yield b.getBigInteger())(e),b.getWebCrypto()){let o={name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:e.toUint8Array(),hash:{name:"SHA-1"}},s=yield mn.generateKey(o,!0,["sign","verify"]),h=yield mn.exportKey("jwk",s.privateKey);return{n:br(h.n),e:e.toUint8Array(),d:br(h.d),p:br(h.q),q:br(h.p),u:br(h.qi)}}if(b.getNodeCrypto()&&ke.generateKeyPair&&wn){let o={modulusLength:r,publicExponent:e.toNumber(),publicKeyEncoding:{type:"pkcs1",format:"der"},privateKeyEncoding:{type:"pkcs1",format:"der"}},s=yield new Promise((h,c)=>{ke.generateKeyPair("rsa",o,(u,y,m)=>{u?c(u):h(wn.decode(m,"der"))})});return{n:s.modulus.toArrayLike(Uint8Array),e:s.publicExponent.toArrayLike(Uint8Array),d:s.privateExponent.toArrayLike(Uint8Array),p:s.prime2.toArrayLike(Uint8Array),q:s.prime1.toArrayLike(Uint8Array),u:s.coefficient.toArrayLike(Uint8Array)}}let t,n,i;do n=yield z1(r-(r>>1),e,40),t=yield z1(r>>1,e,40),i=t.mul(n);while(i.bitLength()!==r);let a=t.dec().imul(n.dec());return n.lt(t)&&([t,n]=[n,t]),{n:i.toUint8Array(),e:e.toUint8Array(),d:e.modInv(a).toUint8Array(),p:t.toUint8Array(),q:n.toUint8Array(),u:t.modInv(n).toUint8Array()}})},validateParams:function(r,e,t,n,i,a){return x(this,null,function*(){let o=yield b.getBigInteger();if(r=new o(r),n=new o(n),i=new o(i),!n.mul(i).equal(r))return!1;let s=new o(2);if(a=new o(a),!n.mul(a).mod(i).isOne())return!1;e=new o(e),t=new o(t);let h=new o(Math.floor(r.bitLength()/3)),c=yield Sr(s,s.leftShift(h)),u=c.mul(t).mul(e);return!(!u.mod(n.dec()).equal(c)||!u.mod(i.dec()).equal(c))})}}),_3=Object.freeze({__proto__:null,encrypt:function(r,e,t,n){return x(this,null,function*(){let i=yield b.getBigInteger();e=new i(e),t=new i(t),n=new i(n);let a=new i(Zs(r,e.byteLength())),o=yield Sr(new i(1),e.dec());return{c1:t.modExp(o,e).toUint8Array(),c2:n.modExp(o,e).imul(a).imod(e).toUint8Array()}})},decrypt:function(r,e,t,n,i){return x(this,null,function*(){let a=yield b.getBigInteger();return r=new a(r),e=new a(e),t=new a(t),n=new a(n),Xs(r.modExp(n,t).modInv(t).imul(e).imod(t).toUint8Array("be",t.byteLength()),i)})},validateParams:function(r,e,t,n){return x(this,null,function*(){let i=yield b.getBigInteger();r=new i(r),e=new i(e),t=new i(t);let a=new i(1);if(e.lte(a)||e.gte(r))return!1;let o=new i(r.bitLength()),s=new i(1023);if(o.lt(s)||!e.modExp(r.dec(),r).isOne())return!1;let h=e,c=new i(1),u=new i(2).leftShift(new i(17));for(;c.lt(u);){if(h=h.mul(e).imod(r),h.isOne())return!1;c.iinc()}n=new i(n);let y=new i(2),m=yield Sr(y.leftShift(o.dec()),y.leftShift(o)),p=r.dec().imul(m).iadd(n);return!!t.equal(e.modExp(p,r))})}}),er=class r{constructor(e){if(e instanceof r)this.oid=e.oid;else if(b.isArray(e)||b.isUint8Array(e)){if((e=new Uint8Array(e))[0]===6){if(e[1]!==e.length-2)throw Error("Length mismatch in DER encoded oid");e=e.subarray(2)}this.oid=e}else this.oid=""}read(e){if(e.length>=1){let t=e[0];if(e.length>=1+t)return this.oid=e.subarray(1,1+t),1+this.oid.length}throw Error("Invalid oid")}write(){return b.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return b.uint8ArrayToHex(this.oid)}getName(){let e=this.toHex();if(d.curve[e])return d.write(d.curve,e);throw Error("Unknown curve object identifier.")}};function Fa(r,e){return r.keyPair({priv:e})}function Ha(r,e){let t=r.keyPair({pub:e});if(t.validate().result!==!0)throw Error("Invalid elliptic public key");return t}function Bn(r){return x(this,null,function*(){if(!dt.useIndutnyElliptic)throw Error("This curve is only supported in the full build of OpenPGP.js");let{default:e}=yield import("./chunk-S7OKEQRN.js");return new e.ec(r)})}function E2(r){let e,t=0,n=r[0];return n<192?([t]=r,e=1):n<255?(t=(r[0]-192<<8)+r[1]+192,e=2):n===255&&(t=b.readNumber(r.subarray(1,5)),e=5),{len:t,offset:e}}function Ti(r){return r<192?new Uint8Array([r]):r>191&&r<8384?new Uint8Array([192+(r-192>>8),r-192&255]):b.concatUint8Array([new Uint8Array([255]),b.writeNumber(r,4)])}function K3(r){if(r<0||r>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+r])}function _2(r){return new Uint8Array([192|r])}function R1(r,e){return b.concatUint8Array([_2(r),Ti(e)])}function ta(r){return[d.packet.literalData,d.packet.compressedData,d.packet.symmetricallyEncryptedData,d.packet.symEncryptedIntegrityProtectedData,d.packet.aeadEncryptedData].includes(r)}function S3(r,e){return x(this,null,function*(){let t=yr(r),n,i;try{let a=yield t.peekBytes(2);if(!a||a.length<2||!(128&a[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");let o=yield t.readByte(),s,h,c=-1,u=-1;u=0,64&o&&(u=1),u?c=63&o:(c=(63&o)>>2,h=3&o);let y=ta(c),m,p=null;if(y){if(b.isStream(r)==="array"){let S=new Re;n=xe(S),p=S}else{let S=new Dn;n=xe(S.writable),p=S.readable}i=e({tag:c,packet:p})}else p=[];do{if(u){let S=yield t.readByte();if(m=!1,S<192)s=S;else if(S>=192&&S<224)s=(S-192<<8)+(yield t.readByte())+192;else if(S>223&&S<255){if(s=1<<(31&S),m=!0,!y)throw new TypeError("This packet type does not support partial lengths.")}else s=(yield t.readByte())<<24|(yield t.readByte())<<16|(yield t.readByte())<<8|(yield t.readByte())}else switch(h){case 0:s=yield t.readByte();break;case 1:s=(yield t.readByte())<<8|(yield t.readByte());break;case 2:s=(yield t.readByte())<<24|(yield t.readByte())<<16|(yield t.readByte())<<8|(yield t.readByte());break;default:s=1/0}if(s>0){let S=0;for(;;){n&&(yield n.ready);let{done:L,value:O}=yield t.read();if(L){if(s===1/0)break;throw Error("Unexpected end of packet")}let X=s===1/0?O:O.subarray(0,s-S);if(n?yield n.write(X):p.push(X),S+=O.length,S>=s){t.unshift(O.subarray(s-S+O.length));break}}}}while(m);let _=yield t.peekBytes(y?1/0:2);return n?(yield n.ready,yield n.close()):(p=b.concatUint8Array(p),yield e({tag:c,packet:p})),!_||!_.length}catch(a){if(n)return yield n.abort(a),!0;throw a}finally{n&&(yield i),t.releaseLock()}})}var Jt=class r extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,r),this.name="UnsupportedError"}},yi=class{constructor(e,t){this.tag=e,this.rawContent=t}write(){return this.rawContent}},is=b.getWebCrypto(),ya=b.getNodeCrypto(),hr={p256:"P-256",p384:"P-384",p521:"P-521"},pr=ya?ya.getCurves():[],Tr=ya?{secp256k1:pr.includes("secp256k1")?"secp256k1":void 0,p256:pr.includes("prime256v1")?"prime256v1":void 0,p384:pr.includes("secp384r1")?"secp384r1":void 0,p521:pr.includes("secp521r1")?"secp521r1":void 0,ed25519:pr.includes("ED25519")?"ED25519":void 0,curve25519:pr.includes("X25519")?"X25519":void 0,brainpoolP256r1:pr.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,brainpoolP384r1:pr.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,brainpoolP512r1:pr.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},ea={p256:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:d.publicKey.ecdsa,hash:d.hash.sha256,cipher:d.symmetric.aes128,node:Tr.p256,web:hr.p256,payloadSize:32,sharedSize:256},p384:{oid:[6,5,43,129,4,0,34],keyType:d.publicKey.ecdsa,hash:d.hash.sha384,cipher:d.symmetric.aes192,node:Tr.p384,web:hr.p384,payloadSize:48,sharedSize:384},p521:{oid:[6,5,43,129,4,0,35],keyType:d.publicKey.ecdsa,hash:d.hash.sha512,cipher:d.symmetric.aes256,node:Tr.p521,web:hr.p521,payloadSize:66,sharedSize:528},secp256k1:{oid:[6,5,43,129,4,0,10],keyType:d.publicKey.ecdsa,hash:d.hash.sha256,cipher:d.symmetric.aes128,node:Tr.secp256k1,payloadSize:32},ed25519:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:d.publicKey.eddsaLegacy,hash:d.hash.sha512,node:!1,payloadSize:32},curve25519:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:d.publicKey.ecdh,hash:d.hash.sha256,cipher:d.symmetric.aes128,node:!1,payloadSize:32},brainpoolP256r1:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:d.publicKey.ecdsa,hash:d.hash.sha256,cipher:d.symmetric.aes128,node:Tr.brainpoolP256r1,payloadSize:32},brainpoolP384r1:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:d.publicKey.ecdsa,hash:d.hash.sha384,cipher:d.symmetric.aes192,node:Tr.brainpoolP384r1,payloadSize:48},brainpoolP512r1:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:d.publicKey.ecdsa,hash:d.hash.sha512,cipher:d.symmetric.aes256,node:Tr.brainpoolP512r1,payloadSize:64}},We=class{constructor(e,t){try{(b.isArray(e)||b.isUint8Array(e))&&(e=new er(e)),e instanceof er&&(e=e.getName()),this.name=d.write(d.curve,e)}catch{throw new Jt("Unknown curve")}t=t||ea[this.name],this.keyType=t.keyType,this.oid=t.oid,this.hash=t.hash,this.cipher=t.cipher,this.node=t.node&&ea[this.name],this.web=t.web&&ea[this.name],this.payloadSize=t.payloadSize,this.web&&b.getWebCrypto()?this.type="web":this.node&&b.getNodeCrypto()?this.type="node":this.name==="curve25519"?this.type="curve25519":this.name==="ed25519"&&(this.type="ed25519")}genKeyPair(){return x(this,null,function*(){let e;switch(this.type){case"web":try{return yield function(n){return x(this,null,function*(){let i=yield is.generateKey({name:"ECDSA",namedCurve:hr[n]},!0,["sign","verify"]),a=yield is.exportKey("jwk",i.privateKey),o=yield is.exportKey("jwk",i.publicKey);return{publicKey:S2(o),privateKey:br(a.d)}})}(this.name)}catch(n){b.printDebugError("Browser did not support generating ec key "+n.message);break}case"node":return function(n){return x(this,null,function*(){let i=ya.createECDH(Tr[n]);return yield i.generateKeys(),{publicKey:new Uint8Array(i.getPublicKey()),privateKey:new Uint8Array(i.getPrivateKey())}})}(this.name);case"curve25519":{let n=Ce(32);n[0]=127&n[0]|64,n[31]&=248;let i=n.slice().reverse();return e=oe.box.keyPair.fromSecretKey(i),{publicKey:b.concatUint8Array([new Uint8Array([64]),e.publicKey]),privateKey:n}}case"ed25519":{let n=Ce(32),i=oe.sign.keyPair.fromSeed(n);return{publicKey:b.concatUint8Array([new Uint8Array([64]),i.publicKey]),privateKey:n}}}return e=yield(yield Bn(this.name)).genKeyPair({entropy:b.uint8ArrayToString(Ce(32))}),{publicKey:new Uint8Array(e.getPublic("array",!1)),privateKey:e.getPrivate().toArrayLike(Uint8Array)}})}};function K2(r,e,t,n){return x(this,null,function*(){let i={p256:!0,p384:!0,p521:!0,secp256k1:!0,curve25519:r===d.publicKey.ecdh,brainpoolP256r1:!0,brainpoolP384r1:!0,brainpoolP512r1:!0},a=e.getName();if(!i[a])return!1;if(a==="curve25519"){n=n.slice().reverse();let{publicKey:s}=oe.box.keyPair.fromSecretKey(n);t=new Uint8Array(t);let h=new Uint8Array([64,...s]);return!!b.equalsUint8Array(h,t)}let o=yield Bn(a);try{t=Ha(o,t).getPublic()}catch{return!1}return!!Fa(o,n).getPublic().eq(t)})}function S2(r){let e=br(r.x),t=br(r.y),n=new Uint8Array(e.length+t.length+1);return n[0]=4,n.set(e,1),n.set(t,e.length+1),n}function ja(r,e,t){let n=r,i=t.slice(1,n+1),a=t.slice(n+1,2*n+1);return{kty:"EC",crv:e,x:Pe(i,!0),y:Pe(a,!0),ext:!0}}function x2(r,e,t,n){let i=ja(r,e,t);return i.d=Pe(n,!0),i}var da=b.getWebCrypto(),zn=b.getNodeCrypto();function M1(r,e,t,n,i,a){return x(this,null,function*(){let o=new We(r);if(t&&!b.isStream(t)){let s={publicKey:n,privateKey:i};switch(o.type){case"web":try{return yield function(h,c,u,y){return x(this,null,function*(){let m=h.payloadSize,p=x2(h.payloadSize,hr[h.name],y.publicKey,y.privateKey),_=yield da.importKey("jwk",p,{name:"ECDSA",namedCurve:hr[h.name],hash:{name:d.read(d.webHash,h.hash)}},!1,["sign"]),S=new Uint8Array(yield da.sign({name:"ECDSA",namedCurve:hr[h.name],hash:{name:d.read(d.webHash,c)}},_,u));return{r:S.slice(0,m),s:S.slice(m,m<<1)}})}(o,e,t,s)}catch(h){if(o.name!=="p521"&&(h.name==="DataError"||h.name==="OperationError"))throw h;b.printDebugError("Browser did not support signing: "+h.message)}break;case"node":{let h=yield function(c,u,y,m){return x(this,null,function*(){let p=zn.createSign(d.read(d.hash,u));p.write(y),p.end();let _=x3.encode({version:1,parameters:c.oid,privateKey:Array.from(m.privateKey),publicKey:{unused:0,data:Array.from(m.publicKey)}},"pem",{label:"EC PRIVATE KEY"});return P2.decode(p.sign(_),"der")})}(o,e,t,s);return{r:h.r.toArrayLike(Uint8Array),s:h.s.toArrayLike(Uint8Array)}}}}return function(s,h,c){return x(this,null,function*(){let u=yield Bn(s.name),y=Fa(u,c),m=y.sign(h);return{r:m.r.toArrayLike(Uint8Array),s:m.s.toArrayLike(Uint8Array)}})}(o,a,i)})}function L1(r,e,t,n,i,a){return x(this,null,function*(){let o=new We(r);if(n&&!b.isStream(n))switch(o.type){case"web":try{return yield function(p,_,S,L,O){return x(this,arguments,function*(s,h,{r:c,s:u},y,m){let X=ja(s.payloadSize,hr[s.name],m),N=yield da.importKey("jwk",X,{name:"ECDSA",namedCurve:hr[s.name],hash:{name:d.read(d.webHash,s.hash)}},!1,["verify"]),K=b.concatUint8Array([c,u]).buffer;return da.verify({name:"ECDSA",namedCurve:hr[s.name],hash:{name:d.read(d.webHash,h)}},N,K,y)})}(o,e,t,n,i)}catch(s){if(o.name!=="p521"&&(s.name==="DataError"||s.name==="OperationError"))throw s;b.printDebugError("Browser did not support verifying: "+s.message)}break;case"node":return function(p,_,S,L,O){return x(this,arguments,function*(s,h,{r:c,s:u},y,m){let{default:X}=yield import("./chunk-GILONDBT.js"),N=zn.createVerify(d.read(d.hash,h));N.write(y),N.end();let K=U3.encode({algorithm:{algorithm:[1,2,840,10045,2,1],parameters:s.oid},subjectPublicKey:{unused:0,data:Array.from(m)}},"pem",{label:"PUBLIC KEY"}),$=P2.encode({r:new X(c),s:new X(u)},"der");try{return N.verify(K,$)}catch{return!1}})}(o,e,t,n,i)}return function(s,h,c,u){return x(this,null,function*(){let y=yield Bn(s.name);return Ha(y,u).verify(c,h)})}(o,t,e===void 0?n:a,i)})}var qa=void 0,P2=zn?qa.define("ECDSASignature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())}):void 0,x3=zn?qa.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").explicit(0).optional().any(),this.key("publicKey").explicit(1).optional().bitstr())}):void 0,P3=zn?qa.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional().any())}):void 0,U3=zn?qa.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(P3),this.key("subjectPublicKey").bitstr())}):void 0,D3=Object.freeze({__proto__:null,sign:M1,verify:L1,validateParams:function(r,e,t){return x(this,null,function*(){let n=new We(r);if(n.keyType!==d.publicKey.ecdsa)return!1;switch(n.type){case"web":case"node":{let i=Ce(8),a=d.hash.sha256,o=yield Me.digest(a,i);try{let s=yield M1(r,a,i,e,t,o);return yield L1(r,a,s,i,e,o)}catch{return!1}}default:return K2(d.publicKey.ecdsa,r,e,t)}})}});oe.hash=r=>new Uint8Array(Ii().update(r).digest());var C3=Object.freeze({__proto__:null,sign:function(r,e,t,n,i,a){return x(this,null,function*(){if(Me.getHashByteLength(e)<Me.getHashByteLength(d.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");let o=b.concatUint8Array([i,n.subarray(1)]),s=oe.sign.detached(a,o);return{r:s.subarray(0,32),s:s.subarray(32)}})},verify:function(s,h,c,u,y,m){return x(this,arguments,function*(r,e,{r:t,s:n},i,a,o){if(Me.getHashByteLength(e)<Me.getHashByteLength(d.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");let p=b.concatUint8Array([t,n]);return oe.sign.detached.verify(o,p,a.subarray(1))})},validateParams:function(r,e,t){return x(this,null,function*(){if(r.getName()!=="ed25519")return!1;let{publicKey:n}=oe.sign.keyPair.fromSeed(t),i=new Uint8Array([64,...n]);return b.equalsUint8Array(e,i)})}});function as(r){if(r===d.publicKey.ed25519)return d.hash.sha256;throw Error("Unknown EdDSA algo")}oe.hash=r=>new Uint8Array(Ii().update(r).digest());var I3=Object.freeze({__proto__:null,generate:function(r){return x(this,null,function*(){if(r===d.publicKey.ed25519){let e=Ce(32),{publicKey:t}=oe.sign.keyPair.fromSeed(e);return{A:t,seed:e}}throw Error("Unsupported EdDSA algorithm")})},sign:function(r,e,t,n,i,a){return x(this,null,function*(){if(Me.getHashByteLength(e)<Me.getHashByteLength(as(r)))throw Error("Hash algorithm too weak for EdDSA.");switch(r){case d.publicKey.ed25519:{let o=b.concatUint8Array([i,n]);return{RS:oe.sign.detached(a,o)}}case d.publicKey.ed448:default:throw Error("Unsupported EdDSA algorithm")}})},verify:function(o,s,h,c,u,y){return x(this,arguments,function*(r,e,{RS:t},n,i,a){if(Me.getHashByteLength(e)<Me.getHashByteLength(as(r)))throw Error("Hash algorithm too weak for EdDSA.");switch(r){case d.publicKey.ed25519:return oe.sign.detached.verify(a,t,i);case d.publicKey.ed448:default:throw Error("Unsupported EdDSA algorithm")}})},validateParams:function(r,e,t){return x(this,null,function*(){switch(r){case d.publicKey.ed25519:{let{publicKey:n}=oe.sign.keyPair.fromSeed(t);return b.equalsUint8Array(e,n)}case d.publicKey.ed448:default:return!1}})},getPreferredHashAlgo:as});function Qs(r,e){let t=new Ci["aes"+8*r.length](r),n=new Uint32Array([2795939494,2795939494]),i=pa(e),a=n,o=i,s=i.length/2,h=new Uint32Array([0,0]),c=new Uint32Array(4);for(let u=0;u<=5;++u)for(let y=0;y<s;++y)h[1]=s*u+(1+y),c[0]=a[0],c[1]=a[1],c[2]=o[2*y],c[3]=o[2*y+1],c=pa(t.encrypt(fa(c))),a=c.subarray(0,2),a[0]^=h[0],a[1]^=h[1],o[2*y]=c[2],o[2*y+1]=c[3];return fa(a,o)}function Ys(r,e){let t=new Ci["aes"+8*r.length](r),n=new Uint32Array([2795939494,2795939494]),i=pa(e),a=i.subarray(0,2),o=i.subarray(2),s=i.length/2-1,h=new Uint32Array([0,0]),c=new Uint32Array(4);for(let u=5;u>=0;--u)for(let y=s-1;y>=0;--y)h[1]=s*u+(y+1),c[0]=a[0]^h[0],c[1]=a[1]^h[1],c[2]=o[2*y],c[3]=o[2*y+1],c=pa(t.decrypt(fa(c))),a=c.subarray(0,2),o[2*y]=c[2],o[2*y+1]=c[3];if(a[0]===n[0]&&a[1]===n[1])return fa(o);throw Error("Key Data Integrity failed")}function pa(r){let{length:e}=r,t=function(a){if(b.isString(a)){let{length:o}=a,s=new ArrayBuffer(o),h=new Uint8Array(s);for(let c=0;c<o;++c)h[c]=a.charCodeAt(c);return s}return new Uint8Array(a).buffer}(r),n=new DataView(t),i=new Uint32Array(e/4);for(let a=0;a<e/4;++a)i[a]=n.getUint32(4*a);return i}function fa(){let r=0;for(let i=0;i<arguments.length;++i)r+=4*arguments[i].length;let e=new ArrayBuffer(r),t=new DataView(e),n=0;for(let i=0;i<arguments.length;++i){for(let a=0;a<arguments[i].length;++a)t.setUint32(n+4*a,arguments[i][a]);n+=4*arguments[i].length}return new Uint8Array(e)}var T3=Object.freeze({__proto__:null,wrap:Qs,unwrap:Ys});function U2(r){let e=8-r.length%8,t=new Uint8Array(r.length+e).fill(e);return t.set(r),t}function D2(r){let e=r.length;if(e>0){let t=r[e-1];if(t>=1){let n=r.subarray(e-t),i=new Uint8Array(t).fill(t);if(b.equalsUint8Array(n,i))return r.subarray(0,e-t)}}throw Error("Invalid padding")}var B3=Object.freeze({__proto__:null,encode:U2,decode:D2}),Lr=b.getWebCrypto(),C2=b.getNodeCrypto();function N1(r,e,t,n){return b.concatUint8Array([e.write(),new Uint8Array([r]),t.write(),b.stringToUint8Array("Anonymous Sender    "),n.subarray(0,20)])}function O1(r,e,t,n,i=!1,a=!1){return x(this,null,function*(){let o;if(i){for(o=0;o<e.length&&e[o]===0;o++);e=e.subarray(o)}if(a){for(o=e.length-1;o>=0&&e[o]===0;o--);e=e.subarray(0,o+1)}return(yield Me.digest(r,b.concatUint8Array([new Uint8Array([0,0,0,1]),e,n]))).subarray(0,t)})}function z3(r,e){return x(this,null,function*(){switch(r.type){case"curve25519":{let t=Ce(32),{secretKey:n,sharedKey:i}=yield I2(r,e,null,t),{publicKey:a}=oe.box.keyPair.fromSecretKey(n);return a=b.concatUint8Array([new Uint8Array([64]),a]),{publicKey:a,sharedKey:i}}case"web":if(r.web&&b.getWebCrypto())try{return yield function(t,n){return x(this,null,function*(){let i=ja(t.payloadSize,t.web.web,n),a=Lr.generateKey({name:"ECDH",namedCurve:t.web.web},!0,["deriveKey","deriveBits"]),o=Lr.importKey("jwk",i,{name:"ECDH",namedCurve:t.web.web},!1,[]);[a,o]=yield Promise.all([a,o]);let s=Lr.deriveBits({name:"ECDH",namedCurve:t.web.web,public:o},a.privateKey,t.web.sharedSize),h=Lr.exportKey("jwk",a.publicKey);[s,h]=yield Promise.all([s,h]);let c=new Uint8Array(s);return{publicKey:new Uint8Array(S2(h)),sharedKey:c}})}(r,e)}catch(t){b.printDebugError(t)}break;case"node":return function(t,n){return x(this,null,function*(){let i=C2.createECDH(t.node.node);i.generateKeys();let a=new Uint8Array(i.computeSecret(n));return{publicKey:new Uint8Array(i.getPublicKey()),sharedKey:a}})}(r,e)}return function(t,n){return x(this,null,function*(){let i=yield Bn(t.name),a=yield t.genKeyPair();n=Ha(i,n);let o=Fa(i,a.privateKey),s=a.publicKey,h=o.derive(n.getPublic()),c=i.curve.p.byteLength(),u=h.toArrayLike(Uint8Array,"be",c);return{publicKey:s,sharedKey:u}})}(r,e)})}function I2(r,e,t,n){return x(this,null,function*(){if(n.length!==r.payloadSize){let i=new Uint8Array(r.payloadSize);i.set(n,r.payloadSize-n.length),n=i}switch(r.type){case"curve25519":{let i=n.slice().reverse();return{secretKey:i,sharedKey:oe.scalarMult(i,e.subarray(1))}}case"web":if(r.web&&b.getWebCrypto())try{return yield function(i,a,o,s){return x(this,null,function*(){let h=x2(i.payloadSize,i.web.web,o,s),c=Lr.importKey("jwk",h,{name:"ECDH",namedCurve:i.web.web},!0,["deriveKey","deriveBits"]),u=ja(i.payloadSize,i.web.web,a),y=Lr.importKey("jwk",u,{name:"ECDH",namedCurve:i.web.web},!0,[]);[c,y]=yield Promise.all([c,y]);let m=Lr.deriveBits({name:"ECDH",namedCurve:i.web.web,public:y},c,i.web.sharedSize),p=Lr.exportKey("jwk",c);[m,p]=yield Promise.all([m,p]);let _=new Uint8Array(m);return{secretKey:br(p.d),sharedKey:_}})}(r,e,t,n)}catch(i){b.printDebugError(i)}break;case"node":return function(i,a,o){return x(this,null,function*(){let s=C2.createECDH(i.node.node);s.setPrivateKey(o);let h=new Uint8Array(s.computeSecret(a));return{secretKey:new Uint8Array(s.getPrivateKey()),sharedKey:h}})}(r,e,n)}return function(i,a,o){return x(this,null,function*(){let s=yield Bn(i.name);a=Ha(s,a),o=Fa(s,o);let h=new Uint8Array(o.getPrivate()),c=o.derive(a.getPublic()),u=s.curve.p.byteLength(),y=c.toArrayLike(Uint8Array,"be",u);return{secretKey:h,sharedKey:y}})}(r,e,n)})}var R3=Object.freeze({__proto__:null,validateParams:function(r,e,t){return x(this,null,function*(){return K2(d.publicKey.ecdh,r,e,t)})},encrypt:function(r,e,t,n,i){return x(this,null,function*(){let a=U2(t),o=new We(r),{publicKey:s,sharedKey:h}=yield z3(o,n),c=N1(d.publicKey.ecdh,r,e,i),{keySize:u}=cr(e.cipher);return{publicKey:s,wrappedKey:Qs(yield O1(e.hash,h,u,c),a)}})},decrypt:function(r,e,t,n,i,a,o){return x(this,null,function*(){let s=new We(r),{sharedKey:h}=yield I2(s,t,i,a),c=N1(d.publicKey.ecdh,r,e,o),{keySize:u}=cr(e.cipher),y;for(let m=0;m<3;m++)try{return D2(Ys(yield O1(e.hash,h,u,c,m===1,m===2),n))}catch(p){y=p}throw y})}}),F1=b.getWebCrypto(),ai=b.getNodeCrypto(),H1=ai&&ai.webcrypto&&ai.webcrypto.subtle;function j1(r,e,t,n,i){return x(this,null,function*(){let a=d.read(d.webHash,r);if(!a)throw Error("Hash algo not supported with HKDF");if(F1||H1){let o=F1||H1,s=yield o.importKey("raw",e,"HKDF",!1,["deriveBits"]),h=yield o.deriveBits({name:"HKDF",hash:a,salt:t,info:n},s,8*i);return new Uint8Array(h)}if(ai){let o=d.read(d.hash,r),s=(p,_)=>ai.createHmac(o,p).update(_).digest(),h=s(t,e),c=h.length,u=Math.ceil(i/c),y=new Uint8Array(u*c),m=new Uint8Array(c+n.length+1);m.set(n,c);for(let p=0;p<u;p++){m[m.length-1]=p+1;let _=s(h,p>0?m:m.subarray(c));m.set(_,0),y.set(_,p*c)}return y.subarray(0,i)}throw Error("No HKDF implementation available")})}var q1={x25519:b.encodeUTF8("OpenPGP X25519")},M3=Object.freeze({__proto__:null,generate:function(r){return x(this,null,function*(){if(r===d.publicKey.x25519){let e=Ce(32),{publicKey:t}=oe.box.keyPair.fromSecretKey(e);return{A:t,k:e}}throw Error("Unsupported ECDH algorithm")})},validateParams:function(r,e,t){return x(this,null,function*(){if(r===d.publicKey.x25519){let{publicKey:n}=oe.box.keyPair.fromSecretKey(t);return b.equalsUint8Array(e,n)}return!1})},encrypt:function(r,e,t){return x(this,null,function*(){if(r===d.publicKey.x25519){let n=Ce(32),i=oe.scalarMult(n,t),{publicKey:a}=oe.box.keyPair.fromSecretKey(n),o=b.concatUint8Array([a,t,i]),{keySize:s}=cr(d.symmetric.aes128);return{ephemeralPublicKey:a,wrappedKey:Qs(yield j1(d.hash.sha256,o,new Uint8Array,q1.x25519,s),e)}}throw Error("Unsupported ECDH algorithm")})},decrypt:function(r,e,t,n,i){return x(this,null,function*(){if(r===d.publicKey.x25519){let a=oe.scalarMult(i,e),o=b.concatUint8Array([e,n,a]),{keySize:s}=cr(d.symmetric.aes128);return Ys(yield j1(d.hash.sha256,o,new Uint8Array,q1.x25519,s),t)}throw Error("Unsupported ECDH algorithm")})}}),L3=Object.freeze({__proto__:null,CurveWithOID:We,ecdh:R3,ecdhX:M3,ecdsa:D3,eddsaLegacy:C3,eddsa:I3,generate:function(r){return x(this,null,function*(){let e=yield b.getBigInteger();r=new We(r);let t=yield r.genKeyPair(),n=new e(t.publicKey).toUint8Array(),i=new e(t.privateKey).toUint8Array("be",r.payloadSize);return{oid:r.oid,Q:n,secret:i,hash:r.hash,cipher:r.cipher}})},getPreferredHashAlgo:function(r){return ea[d.write(d.curve,r.toHex())].hash}}),N3=Object.freeze({__proto__:null,sign:function(r,e,t,n,i,a){return x(this,null,function*(){let o=yield b.getBigInteger(),s=new o(1),h,c,u,y;n=new o(n),i=new o(i),t=new o(t),a=new o(a),t=t.mod(n),a=a.mod(i);let m=new o(e.subarray(0,i.byteLength())).mod(i);for(;;){if(h=yield Sr(s,i),c=t.modExp(h,n).imod(i),c.isZero())continue;let p=a.mul(c).imod(i);if(y=m.add(p).imod(i),u=h.modInv(i).imul(y).imod(i),!u.isZero())break}return{r:c.toUint8Array("be",i.byteLength()),s:u.toUint8Array("be",i.byteLength())}})},verify:function(r,e,t,n,i,a,o,s){return x(this,null,function*(){let h=yield b.getBigInteger(),c=new h(0);if(e=new h(e),t=new h(t),a=new h(a),o=new h(o),i=new h(i),s=new h(s),e.lte(c)||e.gte(o)||t.lte(c)||t.gte(o))return b.printDebug("invalid DSA Signature"),!1;let u=new h(n.subarray(0,o.byteLength())).imod(o),y=t.modInv(o);if(y.isZero())return b.printDebug("invalid DSA Signature"),!1;i=i.mod(a),s=s.mod(a);let m=u.mul(y).imod(o),p=e.mul(y).imod(o),_=i.modExp(m,a),S=s.modExp(p,a);return _.mul(S).imod(a).imod(o).equal(e)})},validateParams:function(r,e,t,n,i){return x(this,null,function*(){let a=yield b.getBigInteger();r=new a(r),e=new a(e),t=new a(t),n=new a(n);let o=new a(1);if(t.lte(o)||t.gte(r)||!r.dec().mod(e).isZero()||!t.modExp(e,r).isOne())return!1;let s=new a(e.bitLength()),h=new a(150);if(s.lt(h)||!(yield v2(e,null,32)))return!1;i=new a(i);let c=new a(2),u=yield Sr(c.leftShift(s.dec()),c.leftShift(s)),y=e.mul(u).add(i);return!!n.equal(t.modExp(y,r))})}}),zt={rsa:E3,elgamal:_3,elliptic:L3,dsa:N3,nacl:oe},O3=Object.freeze({__proto__:null,parseSignatureParams:function(r,e){let t=0;switch(r){case d.publicKey.rsaEncryptSign:case d.publicKey.rsaEncrypt:case d.publicKey.rsaSign:return{s:b.readMPI(e.subarray(t))};case d.publicKey.dsa:case d.publicKey.ecdsa:{let n=b.readMPI(e.subarray(t));return t+=n.length+2,{r:n,s:b.readMPI(e.subarray(t))}}case d.publicKey.eddsaLegacy:{let n=b.readMPI(e.subarray(t));t+=n.length+2,n=b.leftPad(n,32);let i=b.readMPI(e.subarray(t));return i=b.leftPad(i,32),{r:n,s:i}}case d.publicKey.ed25519:{let n=e.subarray(t,t+64);return t+=n.length,{RS:n}}default:throw new Jt("Unknown signature algorithm.")}},verify:function(r,e,t,n,i,a){return x(this,null,function*(){switch(r){case d.publicKey.rsaEncryptSign:case d.publicKey.rsaEncrypt:case d.publicKey.rsaSign:{let{n:o,e:s}=n,h=b.leftPad(t.s,o.length);return zt.rsa.verify(e,i,h,o,s,a)}case d.publicKey.dsa:{let{g:o,p:s,q:h,y:c}=n,{r:u,s:y}=t;return zt.dsa.verify(e,u,y,a,o,s,h,c)}case d.publicKey.ecdsa:{let{oid:o,Q:s}=n,h=new zt.elliptic.CurveWithOID(o).payloadSize,c=b.leftPad(t.r,h),u=b.leftPad(t.s,h);return zt.elliptic.ecdsa.verify(o,e,{r:c,s:u},i,s,a)}case d.publicKey.eddsaLegacy:{let{oid:o,Q:s}=n;return zt.elliptic.eddsaLegacy.verify(o,e,t,i,s,a)}case d.publicKey.ed25519:{let{A:o}=n;return zt.elliptic.eddsa.verify(r,e,t,i,o,a)}default:throw Error("Unknown signature algorithm.")}})},sign:function(r,e,t,n,i,a){return x(this,null,function*(){if(!t||!n)throw Error("Missing key parameters");switch(r){case d.publicKey.rsaEncryptSign:case d.publicKey.rsaEncrypt:case d.publicKey.rsaSign:{let{n:o,e:s}=t,{d:h,p:c,q:u,u:y}=n;return{s:yield zt.rsa.sign(e,i,o,s,h,c,u,y,a)}}case d.publicKey.dsa:{let{g:o,p:s,q:h}=t,{x:c}=n;return zt.dsa.sign(e,a,o,s,h,c)}case d.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case d.publicKey.ecdsa:{let{oid:o,Q:s}=t,{d:h}=n;return zt.elliptic.ecdsa.sign(o,e,i,s,h,a)}case d.publicKey.eddsaLegacy:{let{oid:o,Q:s}=t,{seed:h}=n;return zt.elliptic.eddsaLegacy.sign(o,e,i,s,h,a)}case d.publicKey.ed25519:{let{A:o}=t,{seed:s}=n;return zt.elliptic.eddsa.sign(r,e,i,o,s,a)}default:throw Error("Unknown signature algorithm.")}})}}),ga=class{constructor(e){e&&(this.data=e)}read(e){if(e.length>=1){let t=e[0];if(e.length>=1+t)return this.data=e.subarray(1,1+t),1+this.data.length}throw Error("Invalid symmetric key")}write(){return b.concatUint8Array([new Uint8Array([this.data.length]),this.data])}},ma=class{constructor(e){if(e){let{hash:t,cipher:n}=e;this.hash=t,this.cipher=n}else this.hash=null,this.cipher=null}read(e){if(e.length<4||e[0]!==3||e[1]!==1)throw new Jt("Cannot read KDFParams");return this.hash=e[2],this.cipher=e[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}},wa=class r{static fromObject({wrappedKey:e,algorithm:t}){let n=new r;return n.wrappedKey=e,n.algorithm=t,n}read(e){let t=0,n=e[t++];this.algorithm=n%2?e[t++]:null,n-=n%2,this.wrappedKey=e.subarray(t,t+n),t+=n}write(){return b.concatUint8Array([this.algorithm?new Uint8Array([this.wrappedKey.length+1,this.algorithm]):new Uint8Array([this.wrappedKey.length]),this.wrappedKey])}};function ss(r){try{r.getName()}catch{throw new Jt("Unknown curve OID")}}var F3=Object.freeze({__proto__:null,publicKeyEncrypt:function(r,e,t,n,i){return x(this,null,function*(){switch(r){case d.publicKey.rsaEncrypt:case d.publicKey.rsaEncryptSign:{let{n:a,e:o}=t;return{c:yield zt.rsa.encrypt(n,a,o)}}case d.publicKey.elgamal:{let{p:a,g:o,y:s}=t;return zt.elgamal.encrypt(n,a,o,s)}case d.publicKey.ecdh:{let{oid:a,Q:o,kdfParams:s}=t,{publicKey:h,wrappedKey:c}=yield zt.elliptic.ecdh.encrypt(a,s,n,o,i);return{V:h,C:new ga(c)}}case d.publicKey.x25519:{if(!b.isAES(e))throw Error("X25519 keys can only encrypt AES session keys");let{A:a}=t,{ephemeralPublicKey:o,wrappedKey:s}=yield zt.elliptic.ecdhX.encrypt(r,n,a);return{ephemeralPublicKey:o,C:wa.fromObject({algorithm:e,wrappedKey:s})}}default:return[]}})},publicKeyDecrypt:function(r,e,t,n,i,a){return x(this,null,function*(){switch(r){case d.publicKey.rsaEncryptSign:case d.publicKey.rsaEncrypt:{let{c:o}=n,{n:s,e:h}=e,{d:c,p:u,q:y,u:m}=t;return zt.rsa.decrypt(o,s,h,c,u,y,m,a)}case d.publicKey.elgamal:{let{c1:o,c2:s}=n,h=e.p,c=t.x;return zt.elgamal.decrypt(o,s,h,c,a)}case d.publicKey.ecdh:{let{oid:o,Q:s,kdfParams:h}=e,{d:c}=t,{V:u,C:y}=n;return zt.elliptic.ecdh.decrypt(o,h,u,y.data,s,c,i)}case d.publicKey.x25519:{let{A:o}=e,{k:s}=t,{ephemeralPublicKey:h,C:c}=n;if(!b.isAES(c.algorithm))throw Error("AES session key expected");return zt.elliptic.ecdhX.decrypt(r,h,c.wrappedKey,o,s)}default:throw Error("Unknown public key encryption algorithm.")}})},parsePublicKeyParams:function(r,e){let t=0;switch(r){case d.publicKey.rsaEncrypt:case d.publicKey.rsaEncryptSign:case d.publicKey.rsaSign:{let n=b.readMPI(e.subarray(t));t+=n.length+2;let i=b.readMPI(e.subarray(t));return t+=i.length+2,{read:t,publicParams:{n,e:i}}}case d.publicKey.dsa:{let n=b.readMPI(e.subarray(t));t+=n.length+2;let i=b.readMPI(e.subarray(t));t+=i.length+2;let a=b.readMPI(e.subarray(t));t+=a.length+2;let o=b.readMPI(e.subarray(t));return t+=o.length+2,{read:t,publicParams:{p:n,q:i,g:a,y:o}}}case d.publicKey.elgamal:{let n=b.readMPI(e.subarray(t));t+=n.length+2;let i=b.readMPI(e.subarray(t));t+=i.length+2;let a=b.readMPI(e.subarray(t));return t+=a.length+2,{read:t,publicParams:{p:n,g:i,y:a}}}case d.publicKey.ecdsa:{let n=new er;t+=n.read(e),ss(n);let i=b.readMPI(e.subarray(t));return t+=i.length+2,{read:t,publicParams:{oid:n,Q:i}}}case d.publicKey.eddsaLegacy:{let n=new er;t+=n.read(e),ss(n);let i=b.readMPI(e.subarray(t));return t+=i.length+2,i=b.leftPad(i,33),{read:t,publicParams:{oid:n,Q:i}}}case d.publicKey.ecdh:{let n=new er;t+=n.read(e),ss(n);let i=b.readMPI(e.subarray(t));t+=i.length+2;let a=new ma;return t+=a.read(e.subarray(t)),{read:t,publicParams:{oid:n,Q:i,kdfParams:a}}}case d.publicKey.ed25519:case d.publicKey.x25519:{let n=e.subarray(t,t+32);return t+=n.length,{read:t,publicParams:{A:n}}}default:throw new Jt("Unknown public key encryption algorithm.")}},parsePrivateKeyParams:function(r,e,t){let n=0;switch(r){case d.publicKey.rsaEncrypt:case d.publicKey.rsaEncryptSign:case d.publicKey.rsaSign:{let i=b.readMPI(e.subarray(n));n+=i.length+2;let a=b.readMPI(e.subarray(n));n+=a.length+2;let o=b.readMPI(e.subarray(n));n+=o.length+2;let s=b.readMPI(e.subarray(n));return n+=s.length+2,{read:n,privateParams:{d:i,p:a,q:o,u:s}}}case d.publicKey.dsa:case d.publicKey.elgamal:{let i=b.readMPI(e.subarray(n));return n+=i.length+2,{read:n,privateParams:{x:i}}}case d.publicKey.ecdsa:case d.publicKey.ecdh:{let i=new We(t.oid),a=b.readMPI(e.subarray(n));return n+=a.length+2,a=b.leftPad(a,i.payloadSize),{read:n,privateParams:{d:a}}}case d.publicKey.eddsaLegacy:{let i=new We(t.oid),a=b.readMPI(e.subarray(n));return n+=a.length+2,a=b.leftPad(a,i.payloadSize),{read:n,privateParams:{seed:a}}}case d.publicKey.ed25519:{let i=e.subarray(n,n+32);return n+=i.length,{read:n,privateParams:{seed:i}}}case d.publicKey.x25519:{let i=e.subarray(n,n+32);return n+=i.length,{read:n,privateParams:{k:i}}}default:throw new Jt("Unknown public key encryption algorithm.")}},parseEncSessionKeyParams:function(r,e){let t=0;switch(r){case d.publicKey.rsaEncrypt:case d.publicKey.rsaEncryptSign:return{c:b.readMPI(e.subarray(t))};case d.publicKey.elgamal:{let n=b.readMPI(e.subarray(t));return t+=n.length+2,{c1:n,c2:b.readMPI(e.subarray(t))}}case d.publicKey.ecdh:{let n=b.readMPI(e.subarray(t));t+=n.length+2;let i=new ga;return i.read(e.subarray(t)),{V:n,C:i}}case d.publicKey.x25519:{let n=e.subarray(t,t+32);t+=n.length;let i=new wa;return i.read(e.subarray(t)),{ephemeralPublicKey:n,C:i}}default:throw new Jt("Unknown public key encryption algorithm.")}},serializeParams:function(r,e){let t=new Set([d.publicKey.ed25519,d.publicKey.x25519]),n=Object.keys(e).map(i=>{let a=e[i];return b.isUint8Array(a)?t.has(r)?a:b.uint8ArrayToMPI(a):a.write()});return b.concatUint8Array(n)},generateParams:function(r,e,t){switch(r){case d.publicKey.rsaEncrypt:case d.publicKey.rsaEncryptSign:case d.publicKey.rsaSign:return zt.rsa.generate(e,65537).then(({n,e:i,d:a,p:o,q:s,u:h})=>({privateParams:{d:a,p:o,q:s,u:h},publicParams:{n,e:i}}));case d.publicKey.ecdsa:return zt.elliptic.generate(t).then(({oid:n,Q:i,secret:a})=>({privateParams:{d:a},publicParams:{oid:new er(n),Q:i}}));case d.publicKey.eddsaLegacy:return zt.elliptic.generate(t).then(({oid:n,Q:i,secret:a})=>({privateParams:{seed:a},publicParams:{oid:new er(n),Q:i}}));case d.publicKey.ecdh:return zt.elliptic.generate(t).then(({oid:n,Q:i,secret:a,hash:o,cipher:s})=>({privateParams:{d:a},publicParams:{oid:new er(n),Q:i,kdfParams:new ma({hash:o,cipher:s})}}));case d.publicKey.ed25519:return zt.elliptic.eddsa.generate(r).then(({A:n,seed:i})=>({privateParams:{seed:i},publicParams:{A:n}}));case d.publicKey.x25519:return zt.elliptic.ecdhX.generate(r).then(({A:n,k:i})=>({privateParams:{k:i},publicParams:{A:n}}));case d.publicKey.dsa:case d.publicKey.elgamal:throw Error("Unsupported algorithm for key generation.");default:throw Error("Unknown public key algorithm.")}},validateParams:function(r,e,t){return x(this,null,function*(){if(!e||!t)throw Error("Missing key parameters");switch(r){case d.publicKey.rsaEncrypt:case d.publicKey.rsaEncryptSign:case d.publicKey.rsaSign:{let{n,e:i}=e,{d:a,p:o,q:s,u:h}=t;return zt.rsa.validateParams(n,i,a,o,s,h)}case d.publicKey.dsa:{let{p:n,q:i,g:a,y:o}=e,{x:s}=t;return zt.dsa.validateParams(n,i,a,o,s)}case d.publicKey.elgamal:{let{p:n,g:i,y:a}=e,{x:o}=t;return zt.elgamal.validateParams(n,i,a,o)}case d.publicKey.ecdsa:case d.publicKey.ecdh:{let n=zt.elliptic[d.read(d.publicKey,r)],{oid:i,Q:a}=e,{d:o}=t;return n.validateParams(i,a,o)}case d.publicKey.eddsaLegacy:{let{Q:n,oid:i}=e,{seed:a}=t;return zt.elliptic.eddsaLegacy.validateParams(i,n,a)}case d.publicKey.ed25519:{let{A:n}=e,{seed:i}=t;return zt.elliptic.eddsa.validateParams(r,n,i)}case d.publicKey.x25519:{let{A:n}=e,{k:i}=t;return zt.elliptic.ecdhX.validateParams(r,n,i)}default:throw Error("Unknown public key algorithm.")}})},getPrefixRandom:function(r){return x(this,null,function*(){let{blockSize:e}=cr(r),t=yield Ce(e),n=new Uint8Array([t[t.length-2],t[t.length-1]]);return b.concat([t,n])})},generateSessionKey:function(r){let{keySize:e}=cr(r);return Ce(e)},getAEADMode:function(r){let e=d.read(d.aead,r);return k2[e]},getCipher:cr,getPreferredCurveHashAlgo:function(r,e){switch(r){case d.publicKey.ecdsa:case d.publicKey.eddsaLegacy:return zt.elliptic.getPreferredHashAlgo(e);case d.publicKey.ed25519:return zt.elliptic.eddsa.getPreferredHashAlgo(r);default:throw Error("Unknown elliptic signing algo")}}}),wt={cipher:Ci,hash:Me,mode:k2,publicKey:zt,signature:O3,random:k3,pkcs1:A3,pkcs5:B3,aesKW:T3};Object.assign(wt,F3);var Bi=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function T2(r,e){return r.length===e?r:r.subarray?r.subarray(0,e):(r.length=e,r)}var B2={arraySet:function(r,e,t,n,i){if(e.subarray&&r.subarray)r.set(e.subarray(t,t+n),i);else for(let a=0;a<n;a++)r[i+a]=e[t+a]},flattenChunks:function(r){let e,t,n,i,a;for(n=0,e=0,t=r.length;e<t;e++)n+=r[e].length;let o=new Uint8Array(n);for(i=0,e=0,t=r.length;e<t;e++)a=r[e],o.set(a,i),i+=a.length;return o}},z2={arraySet:function(r,e,t,n,i){for(let a=0;a<n;a++)r[i+a]=e[t+a]},flattenChunks:function(r){return[].concat.apply([],r)}},ir=Bi?Uint8Array:Array,ze=Bi?Uint16Array:Array,ba=Bi?Int32Array:Array,R2=Bi?B2.flattenChunks:z2.flattenChunks,ur=Bi?B2.arraySet:z2.arraySet,lr=0,H3=1,di=2,j3=3,ye=4,Ds=5,$i=6,jt=0,Ar=1,M2=2,se=-2,Js=-3,si=-5,G1=-1,q3=1,Zi=2,G3=3,L2=4,W1=0,V1=1,N2=2,Cn=8;function Rn(r){let e=r.length;for(;--e>=0;)r[e]=0}var W3=0,O2=1,V3=2,t1=29,zi=256,pi=zi+1+t1,Pn=30,e1=19,$1=2*pi+1,Jr=15,os=16,$3=7,r1=256,F2=16,H2=17,j2=18,Cs=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ra=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Z3=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z1=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],wr=Array(2*(pi+2));Rn(wr);var oi=Array(2*Pn);Rn(oi);var fi=Array(512);Rn(fi);var gi=Array(256);Rn(gi);var n1=Array(t1);Rn(n1);var ka=Array(Pn);function cs(r,e,t,n,i){this.static_tree=r,this.extra_bits=e,this.extra_base=t,this.elems=n,this.max_length=i,this.has_stree=r&&r.length}var X1,Q1,Y1;function hs(r,e){this.dyn_tree=r,this.max_code=0,this.stat_desc=e}function q2(r){return r<256?fi[r]:fi[256+(r>>>7)]}function mi(r,e){r.pending_buf[r.pending++]=255&e,r.pending_buf[r.pending++]=e>>>8&255}function _e(r,e,t){r.bi_valid>os-t?(r.bi_buf|=e<<r.bi_valid&65535,mi(r,r.bi_buf),r.bi_buf=e>>os-r.bi_valid,r.bi_valid+=t-os):(r.bi_buf|=e<<r.bi_valid&65535,r.bi_valid+=t)}function rr(r,e,t){_e(r,t[2*e],t[2*e+1])}function G2(r,e){let t=0;do t|=1&r,r>>>=1,t<<=1;while(--e>0);return t>>>1}function W2(r,e,t){let n=Array(Jr+1),i,a,o=0;for(i=1;i<=Jr;i++)n[i]=o=o+t[i-1]<<1;for(a=0;a<=e;a++){let s=r[2*a+1];s!==0&&(r[2*a]=G2(n[s]++,s))}}function V2(r){let e;for(e=0;e<pi;e++)r.dyn_ltree[2*e]=0;for(e=0;e<Pn;e++)r.dyn_dtree[2*e]=0;for(e=0;e<e1;e++)r.bl_tree[2*e]=0;r.dyn_ltree[2*r1]=1,r.opt_len=r.static_len=0,r.last_lit=r.matches=0}function $2(r){r.bi_valid>8?mi(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0}function J1(r,e,t,n){let i=2*e,a=2*t;return r[i]<r[a]||r[i]===r[a]&&n[e]<=n[t]}function us(r,e,t){let n=r.heap[t],i=t<<1;for(;i<=r.heap_len&&(i<r.heap_len&&J1(e,r.heap[i+1],r.heap[i],r.depth)&&i++,!J1(e,n,r.heap[i],r.depth));)r.heap[t]=r.heap[i],t=i,i<<=1;r.heap[t]=n}function t0(r,e,t){let n,i,a,o,s=0;if(r.last_lit!==0)do n=r.pending_buf[r.d_buf+2*s]<<8|r.pending_buf[r.d_buf+2*s+1],i=r.pending_buf[r.l_buf+s],s++,n===0?rr(r,i,e):(a=gi[i],rr(r,a+zi+1,e),o=Cs[a],o!==0&&(i-=n1[a],_e(r,i,o)),n--,a=q2(n),rr(r,a,t),o=ra[a],o!==0&&(n-=ka[a],_e(r,n,o)));while(s<r.last_lit);rr(r,r1,e)}function ls(r,e){let t=e.dyn_tree,n=e.stat_desc.static_tree,i=e.stat_desc.has_stree,a=e.stat_desc.elems,o,s,h,c=-1;for(r.heap_len=0,r.heap_max=$1,o=0;o<a;o++)t[2*o]!==0?(r.heap[++r.heap_len]=c=o,r.depth[o]=0):t[2*o+1]=0;for(;r.heap_len<2;)h=r.heap[++r.heap_len]=c<2?++c:0,t[2*h]=1,r.depth[h]=0,r.opt_len--,i&&(r.static_len-=n[2*h+1]);for(e.max_code=c,o=r.heap_len>>1;o>=1;o--)us(r,t,o);h=a;do o=r.heap[1],r.heap[1]=r.heap[r.heap_len--],us(r,t,1),s=r.heap[1],r.heap[--r.heap_max]=o,r.heap[--r.heap_max]=s,t[2*h]=t[2*o]+t[2*s],r.depth[h]=(r.depth[o]>=r.depth[s]?r.depth[o]:r.depth[s])+1,t[2*o+1]=t[2*s+1]=h,r.heap[1]=h++,us(r,t,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],function(u,y){let m=y.dyn_tree,p=y.max_code,_=y.stat_desc.static_tree,S=y.stat_desc.has_stree,L=y.stat_desc.extra_bits,O=y.stat_desc.extra_base,X=y.stat_desc.max_length,N,K,$,q,j,Z,J=0;for(q=0;q<=Jr;q++)u.bl_count[q]=0;for(m[2*u.heap[u.heap_max]+1]=0,N=u.heap_max+1;N<$1;N++)K=u.heap[N],q=m[2*m[2*K+1]+1]+1,q>X&&(q=X,J++),m[2*K+1]=q,K>p||(u.bl_count[q]++,j=0,K>=O&&(j=L[K-O]),Z=m[2*K],u.opt_len+=Z*(q+j),S&&(u.static_len+=Z*(_[2*K+1]+j)));if(J!==0){do{for(q=X-1;u.bl_count[q]===0;)q--;u.bl_count[q]--,u.bl_count[q+1]+=2,u.bl_count[X]--,J-=2}while(J>0);for(q=X;q!==0;q--)for(K=u.bl_count[q];K!==0;)$=u.heap[--N],$>p||(m[2*$+1]!==q&&(u.opt_len+=(q-m[2*$+1])*m[2*$],m[2*$+1]=q),K--)}}(r,e),W2(t,c,r.bl_count)}function e0(r,e,t){let n,i,a=-1,o=e[1],s=0,h=7,c=4;for(o===0&&(h=138,c=3),e[2*(t+1)+1]=65535,n=0;n<=t;n++)i=o,o=e[2*(n+1)+1],++s<h&&i===o||(s<c?r.bl_tree[2*i]+=s:i!==0?(i!==a&&r.bl_tree[2*i]++,r.bl_tree[2*F2]++):s<=10?r.bl_tree[2*H2]++:r.bl_tree[2*j2]++,s=0,a=i,o===0?(h=138,c=3):i===o?(h=6,c=3):(h=7,c=4))}function r0(r,e,t){let n,i,a=-1,o=e[1],s=0,h=7,c=4;for(o===0&&(h=138,c=3),n=0;n<=t;n++)if(i=o,o=e[2*(n+1)+1],!(++s<h&&i===o)){if(s<c)do rr(r,i,r.bl_tree);while(--s!=0);else i!==0?(i!==a&&(rr(r,i,r.bl_tree),s--),rr(r,F2,r.bl_tree),_e(r,s-3,2)):s<=10?(rr(r,H2,r.bl_tree),_e(r,s-3,3)):(rr(r,j2,r.bl_tree),_e(r,s-11,7));s=0,a=i,o===0?(h=138,c=3):i===o?(h=6,c=3):(h=7,c=4)}}Rn(ka);var n0=!1;function X3(r){n0||(function(){let e,t,n,i,a,o=Array(Jr+1);for(n=0,i=0;i<t1-1;i++)for(n1[i]=n,e=0;e<1<<Cs[i];e++)gi[n++]=i;for(gi[n-1]=i,a=0,i=0;i<16;i++)for(ka[i]=a,e=0;e<1<<ra[i];e++)fi[a++]=i;for(a>>=7;i<Pn;i++)for(ka[i]=a<<7,e=0;e<1<<ra[i]-7;e++)fi[256+a++]=i;for(t=0;t<=Jr;t++)o[t]=0;for(e=0;e<=143;)wr[2*e+1]=8,e++,o[8]++;for(;e<=255;)wr[2*e+1]=9,e++,o[9]++;for(;e<=279;)wr[2*e+1]=7,e++,o[7]++;for(;e<=287;)wr[2*e+1]=8,e++,o[8]++;for(W2(wr,pi+1,o),e=0;e<Pn;e++)oi[2*e+1]=5,oi[2*e]=G2(e,5);X1=new cs(wr,Cs,zi+1,pi,Jr),Q1=new cs(oi,ra,0,Pn,Jr),Y1=new cs([],Z3,0,e1,$3)}(),n0=!0),r.l_desc=new hs(r.dyn_ltree,X1),r.d_desc=new hs(r.dyn_dtree,Q1),r.bl_desc=new hs(r.bl_tree,Y1),r.bi_buf=0,r.bi_valid=0,V2(r)}function Z2(r,e,t,n){_e(r,(W3<<1)+(n?1:0),3),function(i,a,o,s){$2(i),s&&(mi(i,o),mi(i,~o)),ur(i.pending_buf,i.window,a,o,i.pending),i.pending+=o}(r,e,t,!0)}function Q3(r){_e(r,O2<<1,3),rr(r,r1,wr),function(e){e.bi_valid===16?(mi(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(r)}function Y3(r,e,t,n){let i,a,o=0;r.level>0?(r.strm.data_type===N2&&(r.strm.data_type=function(s){let h,c=4093624447;for(h=0;h<=31;h++,c>>>=1)if(1&c&&s.dyn_ltree[2*h]!==0)return W1;if(s.dyn_ltree[18]!==0||s.dyn_ltree[20]!==0||s.dyn_ltree[26]!==0)return V1;for(h=32;h<zi;h++)if(s.dyn_ltree[2*h]!==0)return V1;return W1}(r)),ls(r,r.l_desc),ls(r,r.d_desc),o=function(s){let h;for(e0(s,s.dyn_ltree,s.l_desc.max_code),e0(s,s.dyn_dtree,s.d_desc.max_code),ls(s,s.bl_desc),h=e1-1;h>=3&&s.bl_tree[2*Z1[h]+1]===0;h--);return s.opt_len+=3*(h+1)+5+5+4,h}(r),i=r.opt_len+3+7>>>3,a=r.static_len+3+7>>>3,a<=i&&(i=a)):i=a=t+5,t+4<=i&&e!==-1?Z2(r,e,t,n):r.strategy===L2||a===i?(_e(r,(O2<<1)+(n?1:0),3),t0(r,wr,oi)):(_e(r,(V3<<1)+(n?1:0),3),function(s,h,c,u){let y;for(_e(s,h-257,5),_e(s,c-1,5),_e(s,u-4,4),y=0;y<u;y++)_e(s,s.bl_tree[2*Z1[y]+1],3);r0(s,s.dyn_ltree,h-1),r0(s,s.dyn_dtree,c-1)}(r,r.l_desc.max_code+1,r.d_desc.max_code+1,o+1),t0(r,r.dyn_ltree,r.dyn_dtree)),V2(r),n&&$2(r)}function Fr(r,e,t){return r.pending_buf[r.d_buf+2*r.last_lit]=e>>>8&255,r.pending_buf[r.d_buf+2*r.last_lit+1]=255&e,r.pending_buf[r.l_buf+r.last_lit]=255&t,r.last_lit++,e===0?r.dyn_ltree[2*t]++:(r.matches++,e--,r.dyn_ltree[2*(gi[t]+zi+1)]++,r.dyn_dtree[2*q2(e)]++),r.last_lit===r.lit_bufsize-1}function wi(r,e,t,n){let i=65535&r|0,a=r>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do i=i+e[n++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0}var J3=function(){let r,e=[];for(let t=0;t<256;t++){r=t;for(let n=0;n<8;n++)r=1&r?3988292384^r>>>1:r>>>1;e[t]=r}return e}();function he(r,e,t,n){let i=J3,a=n+t;r^=-1;for(let o=n;o<a;o++)r=r>>>8^i[255&(r^e[o])];return-1^r}var bi={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},tc=9,Rt=3,Nr=258,Ge=Nr+Rt+1,ec=32,va=42,Is=69,na=73,ia=91,aa=103,tn=113,Qn=666,ue=1,ci=2,en=3,Un=4,rc=3;function Or(r,e){return r.msg=bi[e],e}function i0(r){return(r<<1)-(r>4?9:0)}function Rr(r){let e=r.length;for(;--e>=0;)r[e]=0}function Br(r){let e=r.state,t=e.pending;t>r.avail_out&&(t=r.avail_out),t!==0&&(ur(r.output,e.pending_buf,e.pending_out,t,r.next_out),r.next_out+=t,e.pending_out+=t,r.total_out+=t,r.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))}function pe(r,e){Y3(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,e),r.block_start=r.strstart,Br(r.strm)}function Nt(r,e){r.pending_buf[r.pending++]=e}function Hn(r,e){r.pending_buf[r.pending++]=e>>>8&255,r.pending_buf[r.pending++]=255&e}function nc(r,e,t,n){let i=r.avail_in;return i>n&&(i=n),i===0?0:(r.avail_in-=i,ur(e,r.input,r.next_in,i,t),r.state.wrap===1?r.adler=wi(r.adler,e,i,t):r.state.wrap===2&&(r.adler=he(r.adler,e,i,t)),r.next_in+=i,r.total_in+=i,i)}function X2(r,e){let t,n,i=r.max_chain_length,a=r.strstart,o=r.prev_length,s=r.nice_match,h=r.strstart>r.w_size-Ge?r.strstart-(r.w_size-Ge):0,c=r.window,u=r.w_mask,y=r.prev,m=r.strstart+Nr,p=c[a+o-1],_=c[a+o];r.prev_length>=r.good_match&&(i>>=2),s>r.lookahead&&(s=r.lookahead);do if(t=e,c[t+o]===_&&c[t+o-1]===p&&c[t]===c[a]&&c[++t]===c[a+1]){a+=2,t++;do;while(c[++a]===c[++t]&&c[++a]===c[++t]&&c[++a]===c[++t]&&c[++a]===c[++t]&&c[++a]===c[++t]&&c[++a]===c[++t]&&c[++a]===c[++t]&&c[++a]===c[++t]&&a<m);if(n=Nr-(m-a),a=m-Nr,n>o){if(r.match_start=e,o=n,n>=s)break;p=c[a+o-1],_=c[a+o]}}while((e=y[e&u])>h&&--i!=0);return o<=r.lookahead?o:r.lookahead}function cn(r){let e=r.w_size,t,n,i,a,o;do{if(a=r.window_size-r.lookahead-r.strstart,r.strstart>=e+(e-Ge)){ur(r.window,r.window,e,e,0),r.match_start-=e,r.strstart-=e,r.block_start-=e,n=r.hash_size,t=n;do i=r.head[--t],r.head[t]=i>=e?i-e:0;while(--n);n=e,t=n;do i=r.prev[--t],r.prev[t]=i>=e?i-e:0;while(--n);a+=e}if(r.strm.avail_in===0)break;if(n=nc(r.strm,r.window,r.strstart+r.lookahead,a),r.lookahead+=n,r.lookahead+r.insert>=Rt)for(o=r.strstart-r.insert,r.ins_h=r.window[o],r.ins_h=(r.ins_h<<r.hash_shift^r.window[o+1])&r.hash_mask;r.insert&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[o+Rt-1])&r.hash_mask,r.prev[o&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=o,o++,r.insert--,!(r.lookahead+r.insert<Rt)););}while(r.lookahead<Ge&&r.strm.avail_in!==0)}function ys(r,e){let t,n;for(;;){if(r.lookahead<Ge){if(cn(r),r.lookahead<Ge&&e===lr)return ue;if(r.lookahead===0)break}if(t=0,r.lookahead>=Rt&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Rt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),t!==0&&r.strstart-t<=r.w_size-Ge&&(r.match_length=X2(r,t)),r.match_length>=Rt)if(n=Fr(r,r.strstart-r.match_start,r.match_length-Rt),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=Rt){r.match_length--;do r.strstart++,r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Rt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!=0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+1])&r.hash_mask;else n=Fr(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(n&&(pe(r,!1),r.strm.avail_out===0))return ue}return r.insert=r.strstart<Rt-1?r.strstart:Rt-1,e===ye?(pe(r,!0),r.strm.avail_out===0?en:Un):r.last_lit&&(pe(r,!1),r.strm.avail_out===0)?ue:ci}function bn(r,e){let t,n,i;for(;;){if(r.lookahead<Ge){if(cn(r),r.lookahead<Ge&&e===lr)return ue;if(r.lookahead===0)break}if(t=0,r.lookahead>=Rt&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Rt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=Rt-1,t!==0&&r.prev_length<r.max_lazy_match&&r.strstart-t<=r.w_size-Ge&&(r.match_length=X2(r,t),r.match_length<=5&&(r.strategy===q3||r.match_length===Rt&&r.strstart-r.match_start>4096)&&(r.match_length=Rt-1)),r.prev_length>=Rt&&r.match_length<=r.prev_length){i=r.strstart+r.lookahead-Rt,n=Fr(r,r.strstart-1-r.prev_match,r.prev_length-Rt),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=i&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Rt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!=0);if(r.match_available=0,r.match_length=Rt-1,r.strstart++,n&&(pe(r,!1),r.strm.avail_out===0))return ue}else if(r.match_available){if(n=Fr(r,0,r.window[r.strstart-1]),n&&pe(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return ue}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(n=Fr(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<Rt-1?r.strstart:Rt-1,e===ye?(pe(r,!0),r.strm.avail_out===0?en:Un):r.last_lit&&(pe(r,!1),r.strm.avail_out===0)?ue:ci}var Be=class{constructor(e,t,n,i,a){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=a}},Yn=[new Be(0,0,0,0,function(r,e){let t=65535;for(t>r.pending_buf_size-5&&(t=r.pending_buf_size-5);;){if(r.lookahead<=1){if(cn(r),r.lookahead===0&&e===lr)return ue;if(r.lookahead===0)break}r.strstart+=r.lookahead,r.lookahead=0;let n=r.block_start+t;if((r.strstart===0||r.strstart>=n)&&(r.lookahead=r.strstart-n,r.strstart=n,pe(r,!1),r.strm.avail_out===0)||r.strstart-r.block_start>=r.w_size-Ge&&(pe(r,!1),r.strm.avail_out===0))return ue}return r.insert=0,e===ye?(pe(r,!0),r.strm.avail_out===0?en:Un):(r.strstart>r.block_start&&(pe(r,!1),r.strm.avail_out),ue)}),new Be(4,4,8,4,ys),new Be(4,5,16,8,ys),new Be(4,6,32,32,ys),new Be(4,4,16,16,bn),new Be(8,16,32,32,bn),new Be(8,16,128,128,bn),new Be(8,32,128,256,bn),new Be(32,128,258,1024,bn),new Be(32,258,258,4096,bn)],Ts=class{constructor(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Cn,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new ze(1146),this.dyn_dtree=new ze(122),this.bl_tree=new ze(78),Rr(this.dyn_ltree),Rr(this.dyn_dtree),Rr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new ze(16),this.heap=new ze(573),Rr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new ze(573),Rr(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}};function ic(r){let e=function(t){let n;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=N2,n=t.state,n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap?va:tn,t.adler=n.wrap===2?0:1,n.last_flush=lr,X3(n),jt):Or(t,se)}(r);return e===jt&&function(t){t.window_size=2*t.w_size,Rr(t.head),t.max_lazy_match=Yn[t.level].max_lazy,t.good_match=Yn[t.level].good_length,t.nice_match=Yn[t.level].nice_length,t.max_chain_length=Yn[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Rt-1,t.match_available=0,t.ins_h=0}(r.state),e}function ac(r,e){let t,n,i,a;if(!r||!r.state||e>Ds||e<0)return r?Or(r,se):se;if(n=r.state,!r.output||!r.input&&r.avail_in!==0||n.status===Qn&&e!==ye)return Or(r,r.avail_out===0?si:se);if(n.strm=r,t=n.last_flush,n.last_flush=e,n.status===va)if(n.wrap===2)r.adler=0,Nt(n,31),Nt(n,139),Nt(n,8),n.gzhead?(Nt(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Nt(n,255&n.gzhead.time),Nt(n,n.gzhead.time>>8&255),Nt(n,n.gzhead.time>>16&255),Nt(n,n.gzhead.time>>24&255),Nt(n,n.level===9?2:n.strategy>=Zi||n.level<2?4:0),Nt(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Nt(n,255&n.gzhead.extra.length),Nt(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(r.adler=he(r.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=Is):(Nt(n,0),Nt(n,0),Nt(n,0),Nt(n,0),Nt(n,0),Nt(n,n.level===9?2:n.strategy>=Zi||n.level<2?4:0),Nt(n,rc),n.status=tn);else{let s=Cn+(n.w_bits-8<<4)<<8,h=-1;h=n.strategy>=Zi||n.level<2?0:n.level<6?1:n.level===6?2:3,s|=h<<6,n.strstart!==0&&(s|=ec),s+=31-s%31,n.status=tn,Hn(n,s),n.strstart!==0&&(Hn(n,r.adler>>>16),Hn(n,65535&r.adler)),r.adler=1}if(n.status===Is)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(r.adler=he(r.adler,n.pending_buf,n.pending-i,i)),Br(r),i=n.pending,n.pending!==n.pending_buf_size));)Nt(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(r.adler=he(r.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=na)}else n.status=na;if(n.status===na)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(r.adler=he(r.adler,n.pending_buf,n.pending-i,i)),Br(r),i=n.pending,n.pending===n.pending_buf_size)){a=1;break}a=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Nt(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>i&&(r.adler=he(r.adler,n.pending_buf,n.pending-i,i)),a===0&&(n.gzindex=0,n.status=ia)}else n.status=ia;if(n.status===ia)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(r.adler=he(r.adler,n.pending_buf,n.pending-i,i)),Br(r),i=n.pending,n.pending===n.pending_buf_size)){a=1;break}a=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Nt(n,a)}while(a!==0);n.gzhead.hcrc&&n.pending>i&&(r.adler=he(r.adler,n.pending_buf,n.pending-i,i)),a===0&&(n.status=aa)}else n.status=aa;if(n.status===aa&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&Br(r),n.pending+2<=n.pending_buf_size&&(Nt(n,255&r.adler),Nt(n,r.adler>>8&255),r.adler=0,n.status=tn)):n.status=tn),n.pending!==0){if(Br(r),r.avail_out===0)return n.last_flush=-1,jt}else if(r.avail_in===0&&i0(e)<=i0(t)&&e!==ye)return Or(r,si);if(n.status===Qn&&r.avail_in!==0)return Or(r,si);if(r.avail_in!==0||n.lookahead!==0||e!==lr&&n.status!==Qn){var o=n.strategy===Zi?function(s,h){let c;for(;;){if(s.lookahead===0&&(cn(s),s.lookahead===0)){if(h===lr)return ue;break}if(s.match_length=0,c=Fr(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++,c&&(pe(s,!1),s.strm.avail_out===0))return ue}return s.insert=0,h===ye?(pe(s,!0),s.strm.avail_out===0?en:Un):s.last_lit&&(pe(s,!1),s.strm.avail_out===0)?ue:ci}(n,e):n.strategy===G3?function(s,h){let c,u,y,m,p=s.window;for(;;){if(s.lookahead<=Nr){if(cn(s),s.lookahead<=Nr&&h===lr)return ue;if(s.lookahead===0)break}if(s.match_length=0,s.lookahead>=Rt&&s.strstart>0&&(y=s.strstart-1,u=p[y],u===p[++y]&&u===p[++y]&&u===p[++y])){m=s.strstart+Nr;do;while(u===p[++y]&&u===p[++y]&&u===p[++y]&&u===p[++y]&&u===p[++y]&&u===p[++y]&&u===p[++y]&&u===p[++y]&&y<m);s.match_length=Nr-(m-y),s.match_length>s.lookahead&&(s.match_length=s.lookahead)}if(s.match_length>=Rt?(c=Fr(s,1,s.match_length-Rt),s.lookahead-=s.match_length,s.strstart+=s.match_length,s.match_length=0):(c=Fr(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++),c&&(pe(s,!1),s.strm.avail_out===0))return ue}return s.insert=0,h===ye?(pe(s,!0),s.strm.avail_out===0?en:Un):s.last_lit&&(pe(s,!1),s.strm.avail_out===0)?ue:ci}(n,e):Yn[n.level].func(n,e);if(o!==en&&o!==Un||(n.status=Qn),o===ue||o===en)return r.avail_out===0&&(n.last_flush=-1),jt;if(o===ci&&(e===H3?Q3(n):e!==Ds&&(Z2(n,0,0,!1),e===j3&&(Rr(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),Br(r),r.avail_out===0))return n.last_flush=-1,jt}return e!==ye?jt:n.wrap<=0?Ar:(n.wrap===2?(Nt(n,255&r.adler),Nt(n,r.adler>>8&255),Nt(n,r.adler>>16&255),Nt(n,r.adler>>24&255),Nt(n,255&r.total_in),Nt(n,r.total_in>>8&255),Nt(n,r.total_in>>16&255),Nt(n,r.total_in>>24&255)):(Hn(n,r.adler>>>16),Hn(n,65535&r.adler)),Br(r),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?jt:Ar)}try{String.fromCharCode.call(null,0)}catch{}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{}var Bs=new ir(256);for(let r=0;r<256;r++)Bs[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;function zs(r){let e,t,n,i,a=0,o=r.length;for(n=0;n<o;n++)e=r.charCodeAt(n),(64512&e)==55296&&n+1<o&&(t=r.charCodeAt(n+1),(64512&t)==56320&&(e=65536+(e-55296<<10)+(t-56320),n++)),a+=e<128?1:e<2048?2:e<65536?3:4;let s=new ir(a);for(i=0,n=0;i<a;n++)e=r.charCodeAt(n),(64512&e)==55296&&n+1<o&&(t=r.charCodeAt(n+1),(64512&t)==56320&&(e=65536+(e-55296<<10)+(t-56320),n++)),e<128?s[i++]=e:e<2048?(s[i++]=192|e>>>6,s[i++]=128|63&e):e<65536?(s[i++]=224|e>>>12,s[i++]=128|e>>>6&63,s[i++]=128|63&e):(s[i++]=240|e>>>18,s[i++]=128|e>>>12&63,s[i++]=128|e>>>6&63,s[i++]=128|63&e);return s}Bs[254]=Bs[254]=1;var Aa=class{constructor(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},ki=class{constructor(e){this.options=ae({level:G1,method:Cn,chunkSize:16384,windowBits:15,memLevel:8,strategy:0},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Aa,this.strm.avail_out=0;var n,i,a=function(o,s,h,c,u,y){if(!o)return se;let m=1;if(s===G1&&(s=6),c<0?(m=0,c=-c):c>15&&(m=2,c-=16),u<1||u>tc||h!==Cn||c<8||c>15||s<0||s>9||y<0||y>L2)return Or(o,se);c===8&&(c=9);let p=new Ts;return o.state=p,p.strm=o,p.wrap=m,p.gzhead=null,p.w_bits=c,p.w_size=1<<p.w_bits,p.w_mask=p.w_size-1,p.hash_bits=u+7,p.hash_size=1<<p.hash_bits,p.hash_mask=p.hash_size-1,p.hash_shift=~~((p.hash_bits+Rt-1)/Rt),p.window=new ir(2*p.w_size),p.head=new ze(p.hash_size),p.prev=new ze(p.w_size),p.lit_bufsize=1<<u+6,p.pending_buf_size=4*p.lit_bufsize,p.pending_buf=new ir(p.pending_buf_size),p.d_buf=1*p.lit_bufsize,p.l_buf=3*p.lit_bufsize,p.level=s,p.strategy=y,p.method=h,ic(o)}(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(a!==jt)throw Error(bi[a]);if(t.header&&(n=this.strm,i=t.header,n&&n.state&&(n.state.wrap!==2||(n.state.gzhead=i))),t.dictionary){let o;if(o=typeof t.dictionary=="string"?zs(t.dictionary):t.dictionary instanceof ArrayBuffer?new Uint8Array(t.dictionary):t.dictionary,a=function(s,h){let c,u,y,m,p,_,S,L,O=h.length;if(!s||!s.state||(c=s.state,m=c.wrap,m===2||m===1&&c.status!==va||c.lookahead))return se;for(m===1&&(s.adler=wi(s.adler,h,O,0)),c.wrap=0,O>=c.w_size&&(m===0&&(Rr(c.head),c.strstart=0,c.block_start=0,c.insert=0),L=new ir(c.w_size),ur(L,h,O-c.w_size,c.w_size,0),h=L,O=c.w_size),p=s.avail_in,_=s.next_in,S=s.input,s.avail_in=O,s.next_in=0,s.input=h,cn(c);c.lookahead>=Rt;){u=c.strstart,y=c.lookahead-(Rt-1);do c.ins_h=(c.ins_h<<c.hash_shift^c.window[u+Rt-1])&c.hash_mask,c.prev[u&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=u,u++;while(--y);c.strstart=u,c.lookahead=Rt-1,cn(c)}return c.strstart+=c.lookahead,c.block_start=c.strstart,c.insert=c.lookahead,c.lookahead=0,c.match_length=c.prev_length=Rt-1,c.match_available=0,s.next_in=_,s.input=S,s.avail_in=p,c.wrap=m,jt}(this.strm,o),a!==jt)throw Error(bi[a]);this._dict_set=!0}}push(e,t){let{strm:n,options:{chunkSize:i}}=this;var a,o;if(this.ended)return!1;o=t===~~t?t:t===!0?ye:lr,typeof e=="string"?n.input=zs(e):e instanceof ArrayBuffer?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;do{if(n.avail_out===0&&(n.output=new ir(i),n.next_out=0,n.avail_out=i),(a=ac(n,o))!==Ar&&a!==jt)return this.onEnd(a),this.ended=!0,!1;n.avail_out!==0&&(n.avail_in!==0||o!==ye&&o!==di)||this.onData(T2(n.output,n.next_out))}while((n.avail_in>0||n.avail_out===0)&&a!==Ar);return o===ye?(a=function(s){let h;return s&&s.state?(h=s.state.status,h!==va&&h!==Is&&h!==na&&h!==ia&&h!==aa&&h!==tn&&h!==Qn?Or(s,se):(s.state=null,h===tn?Or(s,Js):jt)):se}(this.strm),this.onEnd(a),this.ended=!0,a===jt):o!==di||(this.onEnd(jt),n.avail_out=0,!0)}onData(e){this.chunks.push(e)}onEnd(e){e===jt&&(this.result=R2(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg}},Xi=30,sc=12;function oc(r,e){let t,n,i,a,o,s,h,c,u,y,m=r.state;t=r.next_in;let p=r.input,_=t+(r.avail_in-5);n=r.next_out;let S=r.output,L=n-(e-r.avail_out),O=n+(r.avail_out-257),X=m.dmax,N=m.wsize,K=m.whave,$=m.wnext,q=m.window;i=m.hold,a=m.bits;let j=m.lencode,Z=m.distcode,J=(1<<m.lenbits)-1,rt=(1<<m.distbits)-1;t:do{a<15&&(i+=p[t++]<<a,a+=8,i+=p[t++]<<a,a+=8),o=j[i&J];e:for(;;){if(s=o>>>24,i>>>=s,a-=s,s=o>>>16&255,s===0)S[n++]=65535&o;else{if(!(16&s)){if(!(64&s)){o=j[(65535&o)+(i&(1<<s)-1)];continue e}if(32&s){m.mode=sc;break t}r.msg="invalid literal/length code",m.mode=Xi;break t}h=65535&o,s&=15,s&&(a<s&&(i+=p[t++]<<a,a+=8),h+=i&(1<<s)-1,i>>>=s,a-=s),a<15&&(i+=p[t++]<<a,a+=8,i+=p[t++]<<a,a+=8),o=Z[i&rt];r:for(;;){if(s=o>>>24,i>>>=s,a-=s,s=o>>>16&255,!(16&s)){if(!(64&s)){o=Z[(65535&o)+(i&(1<<s)-1)];continue r}r.msg="invalid distance code",m.mode=Xi;break t}if(c=65535&o,s&=15,a<s&&(i+=p[t++]<<a,a+=8,a<s&&(i+=p[t++]<<a,a+=8)),c+=i&(1<<s)-1,c>X){r.msg="invalid distance too far back",m.mode=Xi;break t}if(i>>>=s,a-=s,s=n-L,c>s){if(s=c-s,s>K&&m.sane){r.msg="invalid distance too far back",m.mode=Xi;break t}if(u=0,y=q,$===0){if(u+=N-s,s<h){h-=s;do S[n++]=q[u++];while(--s);u=n-c,y=S}}else if($<s){if(u+=N+$-s,s-=$,s<h){h-=s;do S[n++]=q[u++];while(--s);if(u=0,$<h){s=$,h-=s;do S[n++]=q[u++];while(--s);u=n-c,y=S}}}else if(u+=$-s,s<h){h-=s;do S[n++]=q[u++];while(--s);u=n-c,y=S}for(;h>2;)S[n++]=y[u++],S[n++]=y[u++],S[n++]=y[u++],h-=3;h&&(S[n++]=y[u++],h>1&&(S[n++]=y[u++]))}else{u=n-c;do S[n++]=S[u++],S[n++]=S[u++],S[n++]=S[u++],h-=3;while(h>2);h&&(S[n++]=S[u++],h>1&&(S[n++]=S[u++]))}break}}break}}while(t<_&&n<O);h=a>>3,t-=h,a-=h<<3,i&=(1<<a)-1,r.next_in=t,r.next_out=n,r.avail_in=t<_?_-t+5:5-(t-_),r.avail_out=n<O?O-n+257:257-(n-O),m.hold=i,m.bits=a}var kn=15,a0=852,s0=592,o0=0,ds=1,c0=2,cc=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],hc=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],uc=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],lc=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function hi(r,e,t,n,i,a,o,s){let h=s.bits,c,u,y,m,p,_=0,S=0,L=0,O=0,X=0,N=0,K=0,$=0,q=0,j=0,Z=null,J=0,rt=new ze(kn+1),yt=new ze(kn+1),pt,kt,at,W=null,Dt=0;for(_=0;_<=kn;_++)rt[_]=0;for(S=0;S<n;S++)rt[e[t+S]]++;for(X=h,O=kn;O>=1&&rt[O]===0;O--);if(X>O&&(X=O),O===0)return i[a++]=20971520,i[a++]=20971520,s.bits=1,0;for(L=1;L<O&&rt[L]===0;L++);for(X<L&&(X=L),$=1,_=1;_<=kn;_++)if($<<=1,$-=rt[_],$<0)return-1;if($>0&&(r===o0||O!==1))return-1;for(yt[1]=0,_=1;_<kn;_++)yt[_+1]=yt[_]+rt[_];for(S=0;S<n;S++)e[t+S]!==0&&(o[yt[e[t+S]]++]=S);r===o0?(Z=W=o,p=19):r===ds?(Z=cc,J-=257,W=hc,Dt-=257,p=256):(Z=uc,W=lc,p=-1),j=0,S=0,_=L,m=a,N=X,K=0,y=-1,q=1<<X;let G=q-1;if(r===ds&&q>a0||r===c0&&q>s0)return 1;for(;;){pt=_-K,o[S]<p?(kt=0,at=o[S]):o[S]>p?(kt=W[Dt+o[S]],at=Z[J+o[S]]):(kt=96,at=0),c=1<<_-K,u=1<<N,L=u;do u-=c,i[m+(j>>K)+u]=pt<<24|kt<<16|at|0;while(u!==0);for(c=1<<_-1;j&c;)c>>=1;if(c!==0?(j&=c-1,j+=c):j=0,S++,--rt[_]==0){if(_===O)break;_=e[t+o[S]]}if(_>X&&(j&G)!==y){for(K===0&&(K=X),m+=L,N=_-K,$=1<<N;N+K<O&&($-=rt[N+K],!($<=0));)N++,$<<=1;if(q+=1<<N,r===ds&&q>a0||r===c0&&q>s0)return 1;y=j&G,i[y]=X<<24|N<<16|m-a|0}}return j!==0&&(i[m+j]=_-K<<24|64<<16|0),s.bits=X,0}var yc=0,Q2=1,Y2=2,J2=1,h0=2,u0=3,l0=4,y0=5,d0=6,p0=7,f0=8,g0=9,m0=10,Ea=11,fr=12,ps=13,w0=14,fs=15,b0=16,k0=17,v0=18,A0=19,Qi=20,Yi=21,E0=22,_0=23,K0=24,S0=25,x0=26,gs=27,P0=28,U0=29,Qt=30,dc=852,pc=592;function D0(r){return(r>>>24&255)+(r>>>8&65280)+((65280&r)<<8)+((255&r)<<24)}var Rs=class{constructor(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new ze(320),this.work=new ze(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}};function fc(r){let e;return r&&r.state?(e=r.state,e.wsize=0,e.whave=0,e.wnext=0,function(t){let n;return t&&t.state?(n=t.state,t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=1&n.wrap),n.mode=J2,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new ba(dc),n.distcode=n.distdyn=new ba(pc),n.sane=1,n.back=-1,jt):se}(r)):se}function gc(r,e){let t,n;return r?(n=new Rs,r.state=n,n.window=null,t=function(i,a){let o,s;return i&&i.state?(s=i.state,a<0?(o=0,a=-a):(o=1+(a>>4),a<48&&(a&=15)),a&&(a<8||a>15)?se:(s.window!==null&&s.wbits!==a&&(s.window=null),s.wrap=o,s.wbits=a,fc(i))):se}(r,e),t!==jt&&(r.state=null),t):se}var ms,ws,C0=!0;function mc(r){if(C0){let e;for(ms=new ba(512),ws=new ba(32),e=0;e<144;)r.lens[e++]=8;for(;e<256;)r.lens[e++]=9;for(;e<280;)r.lens[e++]=7;for(;e<288;)r.lens[e++]=8;for(hi(Q2,r.lens,0,288,ms,0,r.work,{bits:9}),e=0;e<32;)r.lens[e++]=5;hi(Y2,r.lens,0,32,ws,0,r.work,{bits:5}),C0=!1}r.lencode=ms,r.lenbits=9,r.distcode=ws,r.distbits=5}function to(r,e,t,n){let i,a=r.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new ir(a.wsize)),n>=a.wsize?(ur(a.window,e,t-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>n&&(i=n),ur(a.window,e,t-n,i,a.wnext),(n-=i)?(ur(a.window,e,t-n,n,0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0}function wc(r,e){let t,n,i,a,o,s,h,c,u,y,m,p,_,S,L,O,X,N,K,$,q,j,Z,J,rt=0,yt=new ir(4),pt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!r||!r.state||!r.output||!r.input&&r.avail_in!==0)return se;t=r.state,t.mode===fr&&(t.mode=ps),o=r.next_out,i=r.output,h=r.avail_out,a=r.next_in,n=r.input,s=r.avail_in,c=t.hold,u=t.bits,y=s,m=h,j=jt;t:for(;;)switch(t.mode){case J2:if(t.wrap===0){t.mode=ps;break}for(;u<16;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}if(2&t.wrap&&c===35615){t.check=0,yt[0]=255&c,yt[1]=c>>>8&255,t.check=he(t.check,yt,2,0),c=0,u=0,t.mode=h0;break}if(t.flags=0,t.head&&(t.head.done=!1),!(1&t.wrap)||(((255&c)<<8)+(c>>8))%31){r.msg="incorrect header check",t.mode=Qt;break}if((15&c)!==Cn){r.msg="unknown compression method",t.mode=Qt;break}if(c>>>=4,u-=4,q=8+(15&c),t.wbits===0)t.wbits=q;else if(q>t.wbits){r.msg="invalid window size",t.mode=Qt;break}t.dmax=1<<q,r.adler=t.check=1,t.mode=512&c?m0:fr,c=0,u=0;break;case h0:for(;u<16;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}if(t.flags=c,(255&t.flags)!==Cn){r.msg="unknown compression method",t.mode=Qt;break}if(57344&t.flags){r.msg="unknown header flags set",t.mode=Qt;break}t.head&&(t.head.text=c>>8&1),512&t.flags&&(yt[0]=255&c,yt[1]=c>>>8&255,t.check=he(t.check,yt,2,0)),c=0,u=0,t.mode=u0;case u0:for(;u<32;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}t.head&&(t.head.time=c),512&t.flags&&(yt[0]=255&c,yt[1]=c>>>8&255,yt[2]=c>>>16&255,yt[3]=c>>>24&255,t.check=he(t.check,yt,4,0)),c=0,u=0,t.mode=l0;case l0:for(;u<16;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}t.head&&(t.head.xflags=255&c,t.head.os=c>>8),512&t.flags&&(yt[0]=255&c,yt[1]=c>>>8&255,t.check=he(t.check,yt,2,0)),c=0,u=0,t.mode=y0;case y0:if(1024&t.flags){for(;u<16;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}t.length=c,t.head&&(t.head.extra_len=c),512&t.flags&&(yt[0]=255&c,yt[1]=c>>>8&255,t.check=he(t.check,yt,2,0)),c=0,u=0}else t.head&&(t.head.extra=null);t.mode=d0;case d0:if(1024&t.flags&&(p=t.length,p>s&&(p=s),p&&(t.head&&(q=t.head.extra_len-t.length,t.head.extra||(t.head.extra=Array(t.head.extra_len)),ur(t.head.extra,n,a,p,q)),512&t.flags&&(t.check=he(t.check,n,p,a)),s-=p,a+=p,t.length-=p),t.length))break t;t.length=0,t.mode=p0;case p0:if(2048&t.flags){if(s===0)break t;p=0;do q=n[a+p++],t.head&&q&&t.length<65536&&(t.head.name+=String.fromCharCode(q));while(q&&p<s);if(512&t.flags&&(t.check=he(t.check,n,p,a)),s-=p,a+=p,q)break t}else t.head&&(t.head.name=null);t.length=0,t.mode=f0;case f0:if(4096&t.flags){if(s===0)break t;p=0;do q=n[a+p++],t.head&&q&&t.length<65536&&(t.head.comment+=String.fromCharCode(q));while(q&&p<s);if(512&t.flags&&(t.check=he(t.check,n,p,a)),s-=p,a+=p,q)break t}else t.head&&(t.head.comment=null);t.mode=g0;case g0:if(512&t.flags){for(;u<16;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}if(c!==(65535&t.check)){r.msg="header crc mismatch",t.mode=Qt;break}c=0,u=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),r.adler=t.check=0,t.mode=fr;break;case m0:for(;u<32;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}r.adler=t.check=D0(c),c=0,u=0,t.mode=Ea;case Ea:if(t.havedict===0)return r.next_out=o,r.avail_out=h,r.next_in=a,r.avail_in=s,t.hold=c,t.bits=u,M2;r.adler=t.check=1,t.mode=fr;case fr:if(e===Ds||e===$i)break t;case ps:if(t.last){c>>>=7&u,u-=7&u,t.mode=gs;break}for(;u<3;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}switch(t.last=1&c,c>>>=1,u-=1,3&c){case 0:t.mode=w0;break;case 1:if(mc(t),t.mode=Qi,e===$i){c>>>=2,u-=2;break t}break;case 2:t.mode=k0;break;case 3:r.msg="invalid block type",t.mode=Qt}c>>>=2,u-=2;break;case w0:for(c>>>=7&u,u-=7&u;u<32;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){r.msg="invalid stored block lengths",t.mode=Qt;break}if(t.length=65535&c,c=0,u=0,t.mode=fs,e===$i)break t;case fs:t.mode=b0;case b0:if(p=t.length,p){if(p>s&&(p=s),p>h&&(p=h),p===0)break t;ur(i,n,a,p,o),s-=p,a+=p,h-=p,o+=p,t.length-=p;break}t.mode=fr;break;case k0:for(;u<14;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}if(t.nlen=257+(31&c),c>>>=5,u-=5,t.ndist=1+(31&c),c>>>=5,u-=5,t.ncode=4+(15&c),c>>>=4,u-=4,t.nlen>286||t.ndist>30){r.msg="too many length or distance symbols",t.mode=Qt;break}t.have=0,t.mode=v0;case v0:for(;t.have<t.ncode;){for(;u<3;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}t.lens[pt[t.have++]]=7&c,c>>>=3,u-=3}for(;t.have<19;)t.lens[pt[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,Z={bits:t.lenbits},j=hi(yc,t.lens,0,19,t.lencode,0,t.work,Z),t.lenbits=Z.bits,j){r.msg="invalid code lengths set",t.mode=Qt;break}t.have=0,t.mode=A0;case A0:for(;t.have<t.nlen+t.ndist;){for(;rt=t.lencode[c&(1<<t.lenbits)-1],L=rt>>>24,O=rt>>>16&255,X=65535&rt,!(L<=u);){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}if(X<16)c>>>=L,u-=L,t.lens[t.have++]=X;else{if(X===16){for(J=L+2;u<J;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}if(c>>>=L,u-=L,t.have===0){r.msg="invalid bit length repeat",t.mode=Qt;break}q=t.lens[t.have-1],p=3+(3&c),c>>>=2,u-=2}else if(X===17){for(J=L+3;u<J;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}c>>>=L,u-=L,q=0,p=3+(7&c),c>>>=3,u-=3}else{for(J=L+7;u<J;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}c>>>=L,u-=L,q=0,p=11+(127&c),c>>>=7,u-=7}if(t.have+p>t.nlen+t.ndist){r.msg="invalid bit length repeat",t.mode=Qt;break}for(;p--;)t.lens[t.have++]=q}}if(t.mode===Qt)break;if(t.lens[256]===0){r.msg="invalid code -- missing end-of-block",t.mode=Qt;break}if(t.lenbits=9,Z={bits:t.lenbits},j=hi(Q2,t.lens,0,t.nlen,t.lencode,0,t.work,Z),t.lenbits=Z.bits,j){r.msg="invalid literal/lengths set",t.mode=Qt;break}if(t.distbits=6,t.distcode=t.distdyn,Z={bits:t.distbits},j=hi(Y2,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,Z),t.distbits=Z.bits,j){r.msg="invalid distances set",t.mode=Qt;break}if(t.mode=Qi,e===$i)break t;case Qi:t.mode=Yi;case Yi:if(s>=6&&h>=258){r.next_out=o,r.avail_out=h,r.next_in=a,r.avail_in=s,t.hold=c,t.bits=u,oc(r,m),o=r.next_out,i=r.output,h=r.avail_out,a=r.next_in,n=r.input,s=r.avail_in,c=t.hold,u=t.bits,t.mode===fr&&(t.back=-1);break}for(t.back=0;rt=t.lencode[c&(1<<t.lenbits)-1],L=rt>>>24,O=rt>>>16&255,X=65535&rt,!(L<=u);){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}if(O&&!(240&O)){for(N=L,K=O,$=X;rt=t.lencode[$+((c&(1<<N+K)-1)>>N)],L=rt>>>24,O=rt>>>16&255,X=65535&rt,!(N+L<=u);){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}c>>>=N,u-=N,t.back+=N}if(c>>>=L,u-=L,t.back+=L,t.length=X,O===0){t.mode=x0;break}if(32&O){t.back=-1,t.mode=fr;break}if(64&O){r.msg="invalid literal/length code",t.mode=Qt;break}t.extra=15&O,t.mode=E0;case E0:if(t.extra){for(J=t.extra;u<J;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}t.length+=c&(1<<t.extra)-1,c>>>=t.extra,u-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=_0;case _0:for(;rt=t.distcode[c&(1<<t.distbits)-1],L=rt>>>24,O=rt>>>16&255,X=65535&rt,!(L<=u);){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}if(!(240&O)){for(N=L,K=O,$=X;rt=t.distcode[$+((c&(1<<N+K)-1)>>N)],L=rt>>>24,O=rt>>>16&255,X=65535&rt,!(N+L<=u);){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}c>>>=N,u-=N,t.back+=N}if(c>>>=L,u-=L,t.back+=L,64&O){r.msg="invalid distance code",t.mode=Qt;break}t.offset=X,t.extra=15&O,t.mode=K0;case K0:if(t.extra){for(J=t.extra;u<J;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}t.offset+=c&(1<<t.extra)-1,c>>>=t.extra,u-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){r.msg="invalid distance too far back",t.mode=Qt;break}t.mode=S0;case S0:if(h===0)break t;if(p=m-h,t.offset>p){if(p=t.offset-p,p>t.whave&&t.sane){r.msg="invalid distance too far back",t.mode=Qt;break}p>t.wnext?(p-=t.wnext,_=t.wsize-p):_=t.wnext-p,p>t.length&&(p=t.length),S=t.window}else S=i,_=o-t.offset,p=t.length;p>h&&(p=h),h-=p,t.length-=p;do i[o++]=S[_++];while(--p);t.length===0&&(t.mode=Yi);break;case x0:if(h===0)break t;i[o++]=t.length,h--,t.mode=Yi;break;case gs:if(t.wrap){for(;u<32;){if(s===0)break t;s--,c|=n[a++]<<u,u+=8}if(m-=h,r.total_out+=m,t.total+=m,m&&(r.adler=t.check=t.flags?he(t.check,i,m,o-m):wi(t.check,i,m,o-m)),m=h,(t.flags?c:D0(c))!==t.check){r.msg="incorrect data check",t.mode=Qt;break}c=0,u=0}t.mode=P0;case P0:if(t.wrap&&t.flags){for(;u<32;){if(s===0)break t;s--,c+=n[a++]<<u,u+=8}if(c!==(4294967295&t.total)){r.msg="incorrect length check",t.mode=Qt;break}c=0,u=0}t.mode=U0;case U0:j=Ar;break t;case Qt:j=Js;break t;default:return se}return r.next_out=o,r.avail_out=h,r.next_in=a,r.avail_in=s,t.hold=c,t.bits=u,(t.wsize||m!==r.avail_out&&t.mode<Qt&&(t.mode<gs||e!==ye))&&to(r,r.output,r.next_out,m-r.avail_out),y-=r.avail_in,m-=r.avail_out,r.total_in+=y,r.total_out+=m,t.total+=m,t.wrap&&m&&(r.adler=t.check=t.flags?he(t.check,i,m,r.next_out-m):wi(t.check,i,m,r.next_out-m)),r.data_type=t.bits+(t.last?64:0)+(t.mode===fr?128:0)+(t.mode===Qi||t.mode===fs?256:0),(y===0&&m===0||e===ye)&&j===jt&&(j=si),j}function I0(r,e){let t=e.length,n,i;return r&&r.state?(n=r.state,n.wrap!==0&&n.mode!==Ea?se:n.mode===Ea&&(i=1,i=wi(i,e,t,0),i!==n.check)?Js:(to(r,e,t,t),n.havedict=1,jt)):se}var Ms=class{constructor(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},_a=class{constructor(e){this.options=ae({chunkSize:16384,windowBits:0},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Aa,this.strm.avail_out=0;let n=gc(this.strm,t.windowBits);if(n!==jt||(this.header=new Ms,function(i,a){let o;i&&i.state&&(o=i.state,!(2&o.wrap)||(o.head=a,a.done=!1))}(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=zs(t.dictionary):t.dictionary instanceof ArrayBuffer&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=I0(this.strm,t.dictionary),n!==jt))))throw Error(bi[n])}push(e,t){let{strm:n,options:{chunkSize:i,dictionary:a}}=this,o,s,h=!1;if(this.ended)return!1;s=t===~~t?t:t===!0?ye:lr,typeof e=="string"?n.input=function(c){let u=new ir(c.length);for(let y=0,m=u.length;y<m;y++)u[y]=c.charCodeAt(y);return u}(e):e instanceof ArrayBuffer?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;do{if(n.avail_out===0&&(n.output=new ir(i),n.next_out=0,n.avail_out=i),o=wc(n,lr),o===M2&&a&&(o=I0(this.strm,a)),o===si&&h===!0&&(o=jt,h=!1),o!==Ar&&o!==jt)return this.onEnd(o),this.ended=!0,!1;n.next_out&&(n.avail_out!==0&&o!==Ar&&(n.avail_in!==0||s!==ye&&s!==di)||this.onData(T2(n.output,n.next_out))),n.avail_in===0&&n.avail_out===0&&(h=!0)}while((n.avail_in>0||n.avail_out===0)&&o!==Ar);return o===Ar&&(s=ye),s===ye?(o=function(c){if(!c||!c.state)return se;let u=c.state;return u.window&&(u.window=null),c.state=null,jt}(this.strm),this.onEnd(o),this.ended=!0,o===jt):s!==di||(this.onEnd(jt),n.avail_out=0,!0)}onData(e){this.chunks.push(e)}onEnd(e){e===jt&&(this.result=R2(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg}},T0=[0,1,3,7,15,31,63,127,255],Jn=function(r){this.stream=r,this.bitOffset=0,this.curByte=0,this.hasByte=!1};Jn.prototype._ensureByte=function(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)},Jn.prototype.read=function(r){for(var e=0;r>0;){this._ensureByte();var t=8-this.bitOffset;if(r>=t)e<<=t,e|=T0[t]&this.curByte,this.hasByte=!1,this.bitOffset=0,r-=t;else{e<<=r;var n=t-r;e|=(this.curByte&T0[r]<<n)>>n,this.bitOffset+=r,r=0}}return e},Jn.prototype.seek=function(r){var e=r%8,t=(r-e)/8;this.bitOffset=e,this.stream.seek(t),this.hasByte=!1},Jn.prototype.pi=function(){var r,e=new Uint8Array(6);for(r=0;r<e.length;r++)e[r]=this.read(8);return function(t){return Array.prototype.map.call(t,n=>("00"+n.toString(16)).slice(-2)).join("")}(e)};var bc=Jn,Xr=function(){};Xr.prototype.readByte=function(){throw Error("abstract method readByte() not implemented")},Xr.prototype.read=function(r,e,t){for(var n=0;n<t;){var i=this.readByte();if(i<0)return n===0?-1:n;r[e++]=i,n++}return n},Xr.prototype.seek=function(r){throw Error("abstract method seek() not implemented")},Xr.prototype.writeByte=function(r){throw Error("abstract method readByte() not implemented")},Xr.prototype.write=function(r,e,t){var n;for(n=0;n<t;n++)this.writeByte(r[e++]);return t},Xr.prototype.flush=function(){};var bs,eo=Xr,kc=(bs=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),function(){var r=4294967295;this.getCRC=function(){return~r>>>0},this.updateCRC=function(e){r=r<<8^bs[255&(r>>>24^e)]},this.updateCRCRun=function(e,t){for(;t-- >0;)r=r<<8^bs[255&(r>>>24^e)]}}),B0=function(r,e){var t,n=r[e];for(t=e;t>0;t--)r[t]=r[t-1];return r[0]=n,n},Yt={OK:0,LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7,END_OF_BLOCK:-8},zr={};zr[Yt.LAST_BLOCK]="Bad file checksum",zr[Yt.NOT_BZIP_DATA]="Not bzip data",zr[Yt.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",zr[Yt.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",zr[Yt.DATA_ERROR]="Data error",zr[Yt.OUT_OF_MEMORY]="Out of memory",zr[Yt.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";var de=function(r,e){var t=zr[r]||"unknown error";e&&(t+=": "+e);var n=new TypeError(t);throw n.errorCode=r,n},ti=function(r,e){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(r,e)};ti.prototype._init_block=function(){return this._get_next_block()?(this.blockCRC=new kc,!0):(this.writeCount=-1,!1)},ti.prototype._start_bunzip=function(r,e){var t=new Uint8Array(4);r.read(t,0,4)===4&&String.fromCharCode(t[0],t[1],t[2])==="BZh"||de(Yt.NOT_BZIP_DATA,"bad magic");var n=t[3]-48;(n<1||n>9)&&de(Yt.NOT_BZIP_DATA,"level out of range"),this.reader=new bc(r),this.dbufSize=1e5*n,this.nextoutput=0,this.outputStream=e,this.streamCRC=0},ti.prototype._get_next_block=function(){var r,e,t,n=this.reader,i=n.pi();if(i==="177245385090")return!1;i!=="314159265359"&&de(Yt.NOT_BZIP_DATA),this.targetBlockCRC=n.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,n.read(1)&&de(Yt.OBSOLETE_INPUT);var a=n.read(24);a>this.dbufSize&&de(Yt.DATA_ERROR,"initial position out of bounds");var o=n.read(16),s=new Uint8Array(256),h=0;for(r=0;r<16;r++)if(o&1<<15-r){var c=16*r;for(t=n.read(16),e=0;e<16;e++)t&1<<15-e&&(s[h++]=c+e)}var u=n.read(3);(u<2||u>6)&&de(Yt.DATA_ERROR);var y=n.read(15);y===0&&de(Yt.DATA_ERROR);var m=new Uint8Array(256);for(r=0;r<u;r++)m[r]=r;var p=new Uint8Array(y);for(r=0;r<y;r++){for(e=0;n.read(1);e++)e>=u&&de(Yt.DATA_ERROR);p[r]=B0(m,e)}var _,S=h+2,L=[];for(e=0;e<u;e++){var O,X,N=new Uint8Array(S),K=new Uint16Array(21);for(o=n.read(5),r=0;r<S;r++){for(;(o<1||o>20)&&de(Yt.DATA_ERROR),n.read(1);)n.read(1)?o--:o++;N[r]=o}for(O=X=N[0],r=1;r<S;r++)N[r]>X?X=N[r]:N[r]<O&&(O=N[r]);_={},L.push(_),_.permute=new Uint16Array(258),_.limit=new Uint32Array(22),_.base=new Uint32Array(21),_.minLen=O,_.maxLen=X;var $=0;for(r=O;r<=X;r++)for(K[r]=_.limit[r]=0,o=0;o<S;o++)N[o]===r&&(_.permute[$++]=o);for(r=0;r<S;r++)K[N[r]]++;for($=o=0,r=O;r<X;r++)$+=K[r],_.limit[r]=$-1,$<<=1,o+=K[r],_.base[r+1]=$-o;_.limit[X+1]=Number.MAX_VALUE,_.limit[X]=$+K[X]-1,_.base[O]=0}var q=new Uint32Array(256);for(r=0;r<256;r++)m[r]=r;var j,Z=0,J=0,rt=0,yt=this.dbuf=new Uint32Array(this.dbufSize);for(S=0;;){for(S--||(S=49,rt>=y&&de(Yt.DATA_ERROR),_=L[p[rt++]]),r=_.minLen,e=n.read(r);r>_.maxLen&&de(Yt.DATA_ERROR),!(e<=_.limit[r]);r++)e=e<<1|n.read(1);((e-=_.base[r])<0||e>=258)&&de(Yt.DATA_ERROR);var pt=_.permute[e];if(pt!==0&&pt!==1){if(Z)for(Z=0,J+o>this.dbufSize&&de(Yt.DATA_ERROR),q[j=s[m[0]]]+=o;o--;)yt[J++]=j;if(pt>h)break;J>=this.dbufSize&&de(Yt.DATA_ERROR),q[j=s[j=B0(m,r=pt-1)]]++,yt[J++]=j}else Z||(Z=1,o=0),o+=pt===0?Z:2*Z,Z<<=1}for((a<0||a>=J)&&de(Yt.DATA_ERROR),e=0,r=0;r<256;r++)t=e+q[r],q[r]=e,e=t;for(r=0;r<J;r++)yt[q[j=255&yt[r]]]|=r<<8,q[j]++;var kt=0,at=0,W=0;return J&&(at=255&(kt=yt[a]),kt>>=8,W=-1),this.writePos=kt,this.writeCurrent=at,this.writeCount=J,this.writeRun=W,!0},ti.prototype._read_bunzip=function(r,e){var t,n,i;if(this.writeCount<0)return 0;var a=this.dbuf,o=this.writePos,s=this.writeCurrent,h=this.writeCount;this.outputsize;for(var c=this.writeRun;h;){for(h--,n=s,s=255&(o=a[o]),o>>=8,c++==3?(t=s,i=n,s=-1):(t=1,i=s),this.blockCRC.updateCRCRun(i,t);t--;)this.outputStream.writeByte(i),this.nextoutput++;s!=n&&(c=0)}return this.writeCount=h,this.blockCRC.getCRC()!==this.targetBlockCRC&&de(Yt.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput};var vc=function(r){if("readByte"in r)return r;var e=new eo;return e.pos=0,e.readByte=function(){return r[this.pos++]},e.seek=function(t){this.pos=t},e.eof=function(){return this.pos>=r.length},e},Ac=function(r){var e=new eo,t=!0;if(r)if(typeof r=="number")e.buffer=new Uint8Array(r),t=!1;else{if("writeByte"in r)return r;e.buffer=r,t=!1}else e.buffer=new Uint8Array(16384);return e.pos=0,e.writeByte=function(n){if(t&&this.pos>=this.buffer.length){var i=new Uint8Array(2*this.buffer.length);i.set(this.buffer),this.buffer=i}this.buffer[this.pos++]=n},e.getBuffer=function(){if(this.pos!==this.buffer.length){if(!t)throw new TypeError("outputsize does not match decoded input");var n=new Uint8Array(this.pos);n.set(this.buffer.subarray(0,this.pos)),this.buffer=n}return this.buffer},e._coerced=!0,e},z0=function(r,e,t){for(var n=vc(r),i=Ac(e),a=new ti(n,i);!("eof"in n)||!n.eof();)if(a._init_block())a._read_bunzip();else{var o=a.reader.read(32)>>>0;if(o!==a.streamCRC&&de(Yt.DATA_ERROR,"Bad stream CRC (got "+a.streamCRC.toString(16)+" expected "+o.toString(16)+")"),!t||!("eof"in n)||n.eof())break;a._start_bunzip(n,i)}if("getBuffer"in i)return i.getBuffer()},qr=class{static get tag(){return d.packet.literalData}constructor(e=new Date){this.format=d.literal.utf8,this.date=b.normalizeDate(e),this.text=null,this.data=null,this.filename=""}setText(e,t=d.literal.utf8){this.format=t,this.text=e,this.data=null}getText(e=!1){return(this.text===null||b.isStream(this.text))&&(this.text=b.decodeUTF8(b.nativeEOL(this.getBytes(e)))),this.text}setBytes(e,t){this.format=t,this.data=e,this.text=null}getBytes(e=!1){return this.data===null&&(this.data=b.canonicalizeEOL(b.encodeUTF8(this.text))),e?xn(this.data):this.data}setFilename(e){this.filename=e}getFilename(){return this.filename}read(e){return x(this,null,function*(){yield La(e,t=>x(this,null,function*(){let n=yield t.readByte(),i=yield t.readByte();this.filename=b.decodeUTF8(yield t.readBytes(i)),this.date=b.readDate(yield t.readBytes(4));let a=t.remainder();re(a)&&(a=yield ie(a)),this.setBytes(a,n)}))})}writeHeader(){let e=b.encodeUTF8(this.filename),t=new Uint8Array([e.length]),n=new Uint8Array([this.format]),i=b.writeDate(this.date);return b.concatUint8Array([n,t,e,i])}write(){let e=this.writeHeader(),t=this.getBytes();return b.concat([e,t])}},jn=Symbol("verified"),Ec=new Set([d.signatureSubpacket.issuer,d.signatureSubpacket.issuerFingerprint,d.signatureSubpacket.embeddedSignature]),Ae=class r{static get tag(){return d.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.signedHashValue=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new sn,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.revoked=null,this[jn]=null}read(e){let t=0;if(this.version=e[t++],this.version!==4&&this.version!==5)throw new Jt(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=e[t++],this.publicKeyAlgorithm=e[t++],this.hashAlgorithm=e[t++],t+=this.readSubPackets(e.subarray(t,e.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");this.signatureData=e.subarray(0,t),t+=this.readSubPackets(e.subarray(t,e.length),!1),this.signedHashValue=e.subarray(t,t+2),t+=2,this.params=wt.signature.parseSignatureParams(this.publicKeyAlgorithm,e.subarray(t,e.length))}writeParams(){return this.params instanceof Promise?Gr(()=>x(this,null,function*(){return wt.serializeParams(this.publicKeyAlgorithm,yield this.params)})):wt.serializeParams(this.publicKeyAlgorithm,this.params)}write(){let e=[];return e.push(this.signatureData),e.push(this.writeUnhashedSubPackets()),e.push(this.signedHashValue),e.push(this.writeParams()),b.concat(e)}sign(a,o){return x(this,arguments,function*(e,t,n=new Date,i=!1){e.version===5?this.version=5:this.version=4;let s=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];this.created=b.normalizeDate(n),this.issuerKeyVersion=e.version,this.issuerFingerprint=e.getFingerprintBytes(),this.issuerKeyID=e.getKeyID(),s.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=b.concat(s);let h=this.toHash(this.signatureType,t,i),c=yield this.hash(this.signatureType,t,h,i);this.signedHashValue=fe(an(c),0,2);let u=()=>x(this,null,function*(){return wt.signature.sign(this.publicKeyAlgorithm,this.hashAlgorithm,e.publicParams,e.privateParams,h,yield ie(c))});b.isStream(c)?this.params=u():(this.params=yield u(),this[jn]=!0)})}writeHashedSubPackets(){let e=d.signatureSubpacket,t=[],n;if(this.created===null)throw Error("Missing signature creation time");t.push(Xt(e.signatureCreationTime,!0,b.writeDate(this.created))),this.signatureExpirationTime!==null&&t.push(Xt(e.signatureExpirationTime,!0,b.writeNumber(this.signatureExpirationTime,4))),this.exportable!==null&&t.push(Xt(e.exportableCertification,!0,new Uint8Array([this.exportable?1:0]))),this.trustLevel!==null&&(n=new Uint8Array([this.trustLevel,this.trustAmount]),t.push(Xt(e.trustSignature,!0,n))),this.regularExpression!==null&&t.push(Xt(e.regularExpression,!0,this.regularExpression)),this.revocable!==null&&t.push(Xt(e.revocable,!0,new Uint8Array([this.revocable?1:0]))),this.keyExpirationTime!==null&&t.push(Xt(e.keyExpirationTime,!0,b.writeNumber(this.keyExpirationTime,4))),this.preferredSymmetricAlgorithms!==null&&(n=b.stringToUint8Array(b.uint8ArrayToString(this.preferredSymmetricAlgorithms)),t.push(Xt(e.preferredSymmetricAlgorithms,!1,n))),this.revocationKeyClass!==null&&(n=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),n=b.concat([n,this.revocationKeyFingerprint]),t.push(Xt(e.revocationKey,!1,n))),this.issuerKeyID.isNull()||this.issuerKeyVersion===5||t.push(Xt(e.issuer,!0,this.issuerKeyID.write())),this.rawNotations.forEach(({name:o,value:s,humanReadable:h,critical:c})=>{n=[new Uint8Array([h?128:0,0,0,0])];let u=b.encodeUTF8(o);n.push(b.writeNumber(u.length,2)),n.push(b.writeNumber(s.length,2)),n.push(u),n.push(s),n=b.concat(n),t.push(Xt(e.notationData,c,n))}),this.preferredHashAlgorithms!==null&&(n=b.stringToUint8Array(b.uint8ArrayToString(this.preferredHashAlgorithms)),t.push(Xt(e.preferredHashAlgorithms,!1,n))),this.preferredCompressionAlgorithms!==null&&(n=b.stringToUint8Array(b.uint8ArrayToString(this.preferredCompressionAlgorithms)),t.push(Xt(e.preferredCompressionAlgorithms,!1,n))),this.keyServerPreferences!==null&&(n=b.stringToUint8Array(b.uint8ArrayToString(this.keyServerPreferences)),t.push(Xt(e.keyServerPreferences,!1,n))),this.preferredKeyServer!==null&&t.push(Xt(e.preferredKeyServer,!1,b.encodeUTF8(this.preferredKeyServer))),this.isPrimaryUserID!==null&&t.push(Xt(e.primaryUserID,!1,new Uint8Array([this.isPrimaryUserID?1:0]))),this.policyURI!==null&&t.push(Xt(e.policyURI,!1,b.encodeUTF8(this.policyURI))),this.keyFlags!==null&&(n=b.stringToUint8Array(b.uint8ArrayToString(this.keyFlags)),t.push(Xt(e.keyFlags,!0,n))),this.signersUserID!==null&&t.push(Xt(e.signersUserID,!1,b.encodeUTF8(this.signersUserID))),this.reasonForRevocationFlag!==null&&(n=b.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),t.push(Xt(e.reasonForRevocation,!0,n))),this.features!==null&&(n=b.stringToUint8Array(b.uint8ArrayToString(this.features)),t.push(Xt(e.features,!1,n))),this.signatureTargetPublicKeyAlgorithm!==null&&(n=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],n.push(b.stringToUint8Array(this.signatureTargetHash)),n=b.concat(n),t.push(Xt(e.signatureTarget,!0,n))),this.embeddedSignature!==null&&t.push(Xt(e.embeddedSignature,!0,this.embeddedSignature.write())),this.issuerFingerprint!==null&&(n=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],n=b.concat(n),t.push(Xt(e.issuerFingerprint,this.version===5,n))),this.preferredAEADAlgorithms!==null&&(n=b.stringToUint8Array(b.uint8ArrayToString(this.preferredAEADAlgorithms)),t.push(Xt(e.preferredAEADAlgorithms,!1,n)));let i=b.concat(t),a=b.writeNumber(i.length,2);return b.concat([a,i])}writeUnhashedSubPackets(){let e=[];this.unhashedSubpackets.forEach(i=>{e.push(Ti(i.length)),e.push(i)});let t=b.concat(e),n=b.writeNumber(t.length,2);return b.concat([n,t])}readSubPacket(e,t=!0){let n=0,i=!!(128&e[n]),a=127&e[n];if(t||(this.unhashedSubpackets.push(e.subarray(n,e.length)),Ec.has(a)))switch(n++,a){case d.signatureSubpacket.signatureCreationTime:this.created=b.readDate(e.subarray(n,e.length));break;case d.signatureSubpacket.signatureExpirationTime:{let o=b.readNumber(e.subarray(n,e.length));this.signatureNeverExpires=o===0,this.signatureExpirationTime=o;break}case d.signatureSubpacket.exportableCertification:this.exportable=e[n++]===1;break;case d.signatureSubpacket.trustSignature:this.trustLevel=e[n++],this.trustAmount=e[n++];break;case d.signatureSubpacket.regularExpression:this.regularExpression=e[n];break;case d.signatureSubpacket.revocable:this.revocable=e[n++]===1;break;case d.signatureSubpacket.keyExpirationTime:{let o=b.readNumber(e.subarray(n,e.length));this.keyExpirationTime=o,this.keyNeverExpires=o===0;break}case d.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...e.subarray(n,e.length)];break;case d.signatureSubpacket.revocationKey:this.revocationKeyClass=e[n++],this.revocationKeyAlgorithm=e[n++],this.revocationKeyFingerprint=e.subarray(n,n+20);break;case d.signatureSubpacket.issuer:this.issuerKeyID.read(e.subarray(n,e.length));break;case d.signatureSubpacket.notationData:{let o=!!(128&e[n]);n+=4;let s=b.readNumber(e.subarray(n,n+2));n+=2;let h=b.readNumber(e.subarray(n,n+2));n+=2;let c=b.decodeUTF8(e.subarray(n,n+s)),u=e.subarray(n+s,n+s+h);this.rawNotations.push({name:c,humanReadable:o,value:u,critical:i}),o&&(this.notations[c]=b.decodeUTF8(u));break}case d.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...e.subarray(n,e.length)];break;case d.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...e.subarray(n,e.length)];break;case d.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...e.subarray(n,e.length)];break;case d.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=b.decodeUTF8(e.subarray(n,e.length));break;case d.signatureSubpacket.primaryUserID:this.isPrimaryUserID=e[n++]!==0;break;case d.signatureSubpacket.policyURI:this.policyURI=b.decodeUTF8(e.subarray(n,e.length));break;case d.signatureSubpacket.keyFlags:this.keyFlags=[...e.subarray(n,e.length)];break;case d.signatureSubpacket.signersUserID:this.signersUserID=b.decodeUTF8(e.subarray(n,e.length));break;case d.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=e[n++],this.reasonForRevocationString=b.decodeUTF8(e.subarray(n,e.length));break;case d.signatureSubpacket.features:this.features=[...e.subarray(n,e.length)];break;case d.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=e[n++],this.signatureTargetHashAlgorithm=e[n++];let o=wt.getHashByteLength(this.signatureTargetHashAlgorithm);this.signatureTargetHash=b.uint8ArrayToString(e.subarray(n,n+o));break}case d.signatureSubpacket.embeddedSignature:this.embeddedSignature=new r,this.embeddedSignature.read(e.subarray(n,e.length));break;case d.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=e[n++],this.issuerFingerprint=e.subarray(n,e.length),this.issuerKeyVersion===5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case d.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...e.subarray(n,e.length)];break;default:{let o=Error("Unknown signature subpacket type "+a);if(i)throw o;b.printDebug(o)}}}readSubPackets(e,t=!0,n){let i=b.readNumber(e.subarray(0,2)),a=2;for(;a<2+i;){let o=E2(e.subarray(a,e.length));a+=o.offset,this.readSubPacket(e.subarray(a,a+o.len),t,n),a+=o.len}return a}toSign(e,t){let n=d.signature;switch(e){case n.binary:return t.text!==null?b.encodeUTF8(t.getText(!0)):t.getBytes(!0);case n.text:{let i=t.getBytes(!0);return b.canonicalizeEOL(i)}case n.standalone:return new Uint8Array(0);case n.certGeneric:case n.certPersona:case n.certCasual:case n.certPositive:case n.certRevocation:{let i,a;if(t.userID)a=180,i=t.userID;else{if(!t.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");a=209,i=t.userAttribute}let o=i.write();return b.concat([this.toSign(n.key,t),new Uint8Array([a]),b.writeNumber(o.length,4),o])}case n.subkeyBinding:case n.subkeyRevocation:case n.keyBinding:return b.concat([this.toSign(n.key,t),this.toSign(n.key,{key:t.bind})]);case n.key:if(t.key===void 0)throw Error("Key packet is required for this signature.");return t.key.writeForHash(this.version);case n.keyRevocation:return this.toSign(n.key,t);case n.timestamp:return new Uint8Array(0);case n.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(e,t){let n=0;return ee(an(this.signatureData),i=>{n+=i.length},()=>{let i=[];return this.version!==5||this.signatureType!==d.signature.binary&&this.signatureType!==d.signature.text||(t?i.push(new Uint8Array(6)):i.push(e.writeHeader())),i.push(new Uint8Array([this.version,255])),this.version===5&&i.push(new Uint8Array(4)),i.push(b.writeNumber(n,4)),b.concat(i)})}toHash(e,t,n=!1){let i=this.toSign(e,t);return b.concat([i,this.signatureData,this.calculateTrailer(t,n)])}hash(e,t,n,i=!1){return x(this,null,function*(){return n||(n=this.toHash(e,t,i)),wt.hash.digest(this.hashAlgorithm,n)})}verify(s,h,c){return x(this,arguments,function*(e,t,n,i=new Date,a=!1,o=dt){if(!this.issuerKeyID.equals(e.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");let u=t===d.signature.binary||t===d.signature.text;if(!(this[jn]&&!u)){let m,p;if(this.hashed?p=yield this.hashed:(m=this.toHash(t,n,a),p=yield this.hash(t,n,m)),p=yield ie(p),this.signedHashValue[0]!==p[0]||this.signedHashValue[1]!==p[1])throw Error("Signed digest did not match");if(this.params=yield this.params,this[jn]=yield wt.signature.verify(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,e.publicParams,m,p),!this[jn])throw Error("Signature verification failed")}let y=b.normalizeDate(i);if(y&&this.created>y)throw Error("Signature creation time is in the future");if(y&&y>=this.getExpirationTime())throw Error("Signature is expired");if(o.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+d.read(d.hash,this.hashAlgorithm).toUpperCase());if(o.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[d.signature.binary,d.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+d.read(d.hash,this.hashAlgorithm).toUpperCase());if(this.rawNotations.forEach(({name:m,critical:p})=>{if(p&&o.knownNotations.indexOf(m)<0)throw Error("Unknown critical notation: "+m)}),this.revocationKeyClass!==null)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")})}isExpired(e=new Date){let t=b.normalizeDate(e);return t!==null&&!(this.created<=t&&t<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}};function Xt(r,e,t){let n=[];return n.push(Ti(t.length+1)),n.push(new Uint8Array([(e?128:0)|r])),n.push(t),b.concat(n)}var Ie=class{static get tag(){return d.packet.onePassSignature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.issuerKeyID=null,this.flags=null}read(e){let t=0;if(this.version=e[t++],this.version!==3)throw new Jt(`Version ${this.version} of the one-pass signature packet is unsupported.`);return this.signatureType=e[t++],this.hashAlgorithm=e[t++],this.publicKeyAlgorithm=e[t++],this.issuerKeyID=new sn,this.issuerKeyID.read(e.subarray(t,t+8)),t+=8,this.flags=e[t++],this}write(){let e=new Uint8Array([3,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm]),t=new Uint8Array([this.flags]);return b.concatUint8Array([e,this.issuerKeyID.write(),t])}calculateTrailer(...e){return Gr(()=>x(this,null,function*(){return Ae.prototype.calculateTrailer.apply(yield this.correspondingSig,e)}))}verify(){return x(this,arguments,function*(){let e=yield this.correspondingSig;if(!e||e.constructor.tag!==d.packet.signature)throw Error("Corresponding signature packet missing");if(e.signatureType!==this.signatureType||e.hashAlgorithm!==this.hashAlgorithm||e.publicKeyAlgorithm!==this.publicKeyAlgorithm||!e.issuerKeyID.equals(this.issuerKeyID))throw Error("Corresponding signature packet does not match one-pass signature packet");return e.hashed=this.hashed,e.verify.apply(e,arguments)})}};function _c(r,e){if(!e[r]){let t;try{t=d.read(d.packet,r)}catch{throw new Jt("Unknown packet type with tag: "+r)}throw Error("Packet not allowed in this context: "+t)}return new e[r]}Ie.prototype.hash=Ae.prototype.hash,Ie.prototype.toHash=Ae.prototype.toHash,Ie.prototype.toSign=Ae.prototype.toSign;var Gt=class r extends Array{static fromBinary(i,a){return x(this,arguments,function*(e,t,n=dt){let o=new r;return yield o.read(e,t,n),o})}read(i,a){return x(this,arguments,function*(e,t,n=dt){n.additionalAllowedPackets.length&&(t=ae(ae({},t),b.constructAllowedPackets(n.additionalAllowedPackets))),this.stream=_r(e,(s,h)=>x(this,null,function*(){let c=xe(h);try{for(;;)if(yield c.ready,yield S3(s,u=>x(this,null,function*(){try{if(u.tag===d.packet.marker||u.tag===d.packet.trust)return;let y=_c(u.tag,t);y.packets=new r,y.fromStream=b.isStream(u.packet),yield y.read(u.packet,n),yield c.write(y)}catch(y){let m=!n.ignoreUnsupportedPackets&&y instanceof Jt,p=!(n.ignoreMalformedPackets||y instanceof Jt);if(m||p||ta(u.tag))yield c.abort(y);else{let _=new yi(u.tag,u.packet);yield c.write(_)}b.printDebugError(y)}})))return yield c.ready,void(yield c.close())}catch(u){yield c.abort(u)}}));let o=yr(this.stream);for(;;){let{done:s,value:h}=yield o.read();if(s?this.stream=null:this.push(h),s||ta(h.constructor.tag))break}o.releaseLock()})}write(){let e=[];for(let t=0;t<this.length;t++){let n=this[t]instanceof yi?this[t].tag:this[t].constructor.tag,i=this[t].write();if(b.isStream(i)&&ta(this[t].constructor.tag)){let a=[],o=0,s=512;e.push(_2(n)),e.push(ee(i,h=>{if(a.push(h),o+=h.length,o>=s){let c=Math.min(Math.log(o)/Math.LN2|0,30),u=2**c,y=b.concat([K3(c)].concat(a));return a=[y.subarray(1+u)],o=a[0].length,y.subarray(0,1+u)}},()=>b.concat([Ti(o)].concat(a))))}else{if(b.isStream(i)){let a=0;e.push(ee(an(i),o=>{a+=o.length},()=>R1(n,a)))}else e.push(R1(n,i.length));e.push(i)}}return b.concat(e)}filterByTag(...e){let t=new r,n=i=>a=>i===a;for(let i=0;i<this.length;i++)e.some(n(this[i].constructor.tag))&&t.push(this[i]);return t}findPacket(e){return this.find(t=>t.constructor.tag===e)}indexOfTag(...e){let t=[],n=this,i=a=>o=>a===o;for(let a=0;a<this.length;a++)e.some(i(n[a].constructor.tag))&&t.push(a);return t}},Kc=b.constructAllowedPackets([qr,Ie,Ae]),hn=class{static get tag(){return d.packet.compressedData}constructor(e=dt){this.packets=null,this.algorithm=e.preferredCompressionAlgorithm,this.compressed=null,this.deflateLevel=e.deflateLevel}read(n){return x(this,arguments,function*(e,t=dt){yield La(e,i=>x(this,null,function*(){this.algorithm=yield i.readByte(),this.compressed=i.remainder(),yield this.decompress(t)}))})}write(){return this.compressed===null&&this.compress(),b.concat([new Uint8Array([this.algorithm]),this.compressed])}decompress(){return x(this,arguments,function*(e=dt){let t=d.read(d.compression,this.algorithm),n=xc[t];if(!n)throw Error(t+" decompression not supported");this.packets=yield Gt.fromBinary(n(this.compressed),Kc,e)})}compress(){let e=d.read(d.compression,this.algorithm),t=Sc[e];if(!t)throw Error(e+" compression not supported");this.compressed=t(this.packets.write(),this.deflateLevel)}},nr=b.getNodeZlib();function R0(r){return r}function Ka(r,e,t={}){return function(n){return!b.isStream(n)||re(n)?Gr(()=>ie(n).then(i=>new Promise((a,o)=>{r(i,t,(s,h)=>{if(s)return o(s);a(h)})}))):Ma(qs(n).pipe(e(t)))}}function Sa(r,e={}){return function(t){let n=new r(e);return ee(t,i=>{if(i.length)return n.push(i,di),n.result},()=>{if(r===ki)return n.push([],ye),n.result})}}function M0(r){return function(e){return Gr(()=>x(this,null,function*(){return r(yield ie(e))}))}}var Sc=nr?{zip:(r,e)=>Ka(nr.deflateRaw,nr.createDeflateRaw,{level:e})(r),zlib:(r,e)=>Ka(nr.deflate,nr.createDeflate,{level:e})(r)}:{zip:(r,e)=>Sa(ki,{raw:!0,level:e})(r),zlib:(r,e)=>Sa(ki,{level:e})(r)},xc=nr?{uncompressed:R0,zip:Ka(nr.inflateRaw,nr.createInflateRaw),zlib:Ka(nr.inflate,nr.createInflate),bzip2:M0(z0)}:{uncompressed:R0,zip:Sa(_a,{raw:!0}),zlib:Sa(_a),bzip2:M0(z0)},Pc=b.constructAllowedPackets([qr,hn,Ie,Ae]),xa=class{static get tag(){return d.packet.symEncryptedIntegrityProtectedData}constructor(){this.version=1,this.encrypted=null,this.packets=null}read(e){return x(this,null,function*(){yield La(e,t=>x(this,null,function*(){let n=yield t.readByte();if(n!==1)throw new Jt(`Version ${n} of the SEIP packet is unsupported.`);this.encrypted=t.remainder()}))})}write(){return b.concat([new Uint8Array([1]),this.encrypted])}encrypt(i,a){return x(this,arguments,function*(e,t,n=dt){let{blockSize:o}=wt.getCipher(e),s=this.packets.write();re(s)&&(s=yield ie(s));let h=yield wt.getPrefixRandom(e),c=new Uint8Array([211,20]),u=b.concat([h,s,c]),y=yield wt.hash.sha1(xn(u)),m=b.concat([u,y]);return this.encrypted=yield wt.mode.cfb.encrypt(e,t,m,new Uint8Array(o),n),!0})}decrypt(i,a){return x(this,arguments,function*(e,t,n=dt){let{blockSize:o}=wt.getCipher(e),s=an(this.encrypted);re(s)&&(s=yield ie(s));let h=yield wt.mode.cfb.decrypt(e,t,s,new Uint8Array(o)),c=fe(xn(h),-20),u=fe(h,0,-20),y=Promise.all([ie(yield wt.hash.sha1(xn(u))),ie(c)]).then(([_,S])=>{if(!b.equalsUint8Array(_,S))throw Error("Modification detected.");return new Uint8Array}),m=fe(u,o+2),p=fe(m,0,-2);return p=Ke([p,Gr(()=>y)]),b.isStream(s)&&n.allowUnauthenticatedStream||(p=yield ie(p)),this.packets=yield Gt.fromBinary(p,Pc,n),!0})}},Uc=b.constructAllowedPackets([qr,hn,Ie,Ae]),Pa=class r{static get tag(){return d.packet.aeadEncryptedData}constructor(){this.version=1,this.cipherAlgorithm=null,this.aeadAlgorithm=d.aead.eax,this.chunkSizeByte=null,this.iv=null,this.encrypted=null,this.packets=null}read(e){return x(this,null,function*(){yield La(e,t=>x(this,null,function*(){let n=yield t.readByte();if(n!==1)throw new Jt(`Version ${n} of the AEAD-encrypted data packet is not supported.`);this.cipherAlgorithm=yield t.readByte(),this.aeadAlgorithm=yield t.readByte(),this.chunkSizeByte=yield t.readByte();let i=wt.getAEADMode(this.aeadAlgorithm);this.iv=yield t.readBytes(i.ivLength),this.encrypted=t.remainder()}))})}write(){return b.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.iv,this.encrypted])}decrypt(i,a){return x(this,arguments,function*(e,t,n=dt){this.packets=yield Gt.fromBinary(yield this.crypt("decrypt",t,an(this.encrypted)),Uc,n)})}encrypt(i,a){return x(this,arguments,function*(e,t,n=dt){this.cipherAlgorithm=e;let{ivLength:o}=wt.getAEADMode(this.aeadAlgorithm);this.iv=wt.random.getRandomBytes(o),this.chunkSizeByte=n.aeadChunkSizeByte;let s=this.packets.write();this.encrypted=yield this.crypt("encrypt",t,s)})}crypt(e,t,n){return x(this,null,function*(){let i=wt.getAEADMode(this.aeadAlgorithm),a=yield i(this.cipherAlgorithm,t),o=e==="decrypt"?i.tagLength:0,s=e==="encrypt"?i.tagLength:0,h=2**(this.chunkSizeByte+6)+o,c=new ArrayBuffer(21),u=new Uint8Array(c,0,13),y=new Uint8Array(c),m=new DataView(c),p=new Uint8Array(c,5,8);u.set([192|r.tag,this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte],0);let _=0,S=Promise.resolve(),L=0,O=0,X=this.iv;return _r(n,(N,K)=>x(this,null,function*(){if(b.isStream(N)!=="array"){let j=new Dn({},{highWaterMark:b.getHardwareConcurrency()*2**(this.chunkSizeByte+6),size:Z=>Z.length});Hr(j.readable,K),K=j.writable}let $=yr(N),q=xe(K);try{for(;;){let j=(yield $.readBytes(h+o))||new Uint8Array,Z=j.subarray(j.length-o),J,rt;if(j=j.subarray(0,j.length-o),!_||j.length?($.unshift(Z),J=a[e](j,i.getNonce(X,p),u),O+=j.length-o+s):(m.setInt32(17,L),J=a[e](Z,i.getNonce(X,p),y),O+=s,rt=!0),L+=j.length-o,S=S.then(()=>J).then(yt=>x(this,null,function*(){yield q.ready,yield q.write(yt),O-=yt.length})).catch(yt=>q.abort(yt)),(rt||O>q.desiredSize)&&(yield S),rt){yield q.close();break}m.setInt32(9,++_)}}catch(j){yield q.abort(j)}}))})}},vi=class{static get tag(){return d.packet.publicKeyEncryptedSessionKey}constructor(){this.version=3,this.publicKeyID=new sn,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}read(e){let t=0;if(this.version=e[t++],this.version!==3)throw new Jt(`Version ${this.version} of the PKESK packet is unsupported.`);t+=this.publicKeyID.read(e.subarray(t)),this.publicKeyAlgorithm=e[t++],this.encrypted=wt.parseEncSessionKeyParams(this.publicKeyAlgorithm,e.subarray(t),this.version),this.publicKeyAlgorithm===d.publicKey.x25519&&(this.sessionKeyAlgorithm=d.write(d.symmetric,this.encrypted.C.algorithm))}write(){let e=[new Uint8Array([this.version]),this.publicKeyID.write(),new Uint8Array([this.publicKeyAlgorithm]),wt.serializeParams(this.publicKeyAlgorithm,this.encrypted)];return b.concatUint8Array(e)}encrypt(e){return x(this,null,function*(){let t=d.write(d.publicKey,this.publicKeyAlgorithm),n=L0(this.version,t,this.sessionKeyAlgorithm,this.sessionKey);this.encrypted=yield wt.publicKeyEncrypt(t,this.sessionKeyAlgorithm,e.publicParams,n,e.getFingerprintBytes())})}decrypt(e,t){return x(this,null,function*(){if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Decryption error");let n=t?L0(this.version,this.publicKeyAlgorithm,t.sessionKeyAlgorithm,t.sessionKey):null,i=yield wt.publicKeyDecrypt(this.publicKeyAlgorithm,e.publicParams,e.privateParams,this.encrypted,e.getFingerprintBytes(),n),{sessionKey:a,sessionKeyAlgorithm:o}=function(s,h,c,u){switch(h){case d.publicKey.rsaEncrypt:case d.publicKey.rsaEncryptSign:case d.publicKey.elgamal:case d.publicKey.ecdh:{let y=c.subarray(0,c.length-2),m=c.subarray(c.length-2),p=b.writeChecksum(y.subarray(y.length%8)),_=p[0]===m[0]&p[1]===m[1],S={sessionKeyAlgorithm:y[0],sessionKey:y.subarray(1)};if(u){let L=_&S.sessionKeyAlgorithm===u.sessionKeyAlgorithm&S.sessionKey.length===u.sessionKey.length;return{sessionKey:b.selectUint8Array(L,S.sessionKey,u.sessionKey),sessionKeyAlgorithm:b.selectUint8(L,S.sessionKeyAlgorithm,u.sessionKeyAlgorithm)}}if(_&&d.read(d.symmetric,S.sessionKeyAlgorithm))return S;throw Error("Decryption error")}case d.publicKey.x25519:return{sessionKey:c};default:throw Error("Unsupported public key algorithm")}}(this.version,this.publicKeyAlgorithm,i,t);this.publicKeyAlgorithm!==d.publicKey.x25519&&(this.sessionKeyAlgorithm=o),this.sessionKey=a})}};function L0(r,e,t,n){switch(e){case d.publicKey.rsaEncrypt:case d.publicKey.rsaEncryptSign:case d.publicKey.elgamal:case d.publicKey.ecdh:return b.concatUint8Array([new Uint8Array([t]),n,b.writeChecksum(n.subarray(n.length%8))]);case d.publicKey.x25519:return n;default:throw Error("Unsupported public key algorithm")}}var rn=class{constructor(e=dt){this.algorithm=d.hash.sha256,this.type="iterated",this.c=e.s2kIterationCountByte,this.salt=null}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(e){let t=0;try{this.type=d.read(d.s2k,e[t++])}catch{throw new Jt("Unknown S2K type.")}switch(this.algorithm=e[t++],this.type){case"simple":break;case"salted":this.salt=e.subarray(t,t+8),t+=8;break;case"iterated":this.salt=e.subarray(t,t+8),t+=8,this.c=e[t++];break;case"gnu":if(b.uint8ArrayToString(e.subarray(t,t+3))!=="GNU")throw new Jt("Unknown s2k type.");if(t+=3,1e3+e[t++]!==1001)throw new Jt("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw new Jt("Unknown s2k type.")}return t}write(){if(this.type==="gnu-dummy")return new Uint8Array([101,0,...b.stringToUint8Array("GNU"),1]);let e=[new Uint8Array([d.write(d.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":e.push(this.salt);break;case"iterated":e.push(this.salt),e.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return b.concatUint8Array(e)}produceKey(e,t){return x(this,null,function*(){e=b.encodeUTF8(e);let n=[],i=0,a=0;for(;i<t;){let o;switch(this.type){case"simple":o=b.concatUint8Array([new Uint8Array(a),e]);break;case"salted":o=b.concatUint8Array([new Uint8Array(a),this.salt,e]);break;case"iterated":{let h=b.concatUint8Array([this.salt,e]),c=h.length,u=Math.max(this.getCount(),c);o=new Uint8Array(a+u),o.set(h,a);for(let y=a+c;y<u;y+=c,c*=2)o.copyWithin(y,a,y);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}let s=yield wt.hash.digest(this.algorithm,o);n.push(s),i+=s.length,a++}return b.concatUint8Array(n).subarray(0,t)})}},Ai=class r{static get tag(){return d.packet.symEncryptedSessionKey}constructor(e=dt){this.version=e.aeadProtect?5:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=d.symmetric.aes256,this.aeadAlgorithm=d.write(d.aead,e.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(e){let t=0;if(this.version=e[t++],this.version!==4&&this.version!==5)throw new Jt(`Version ${this.version} of the SKESK packet is unsupported.`);let n=e[t++];if(this.version===5&&(this.aeadAlgorithm=e[t++]),this.s2k=new rn,t+=this.s2k.read(e.subarray(t,e.length)),this.version===5){let i=wt.getAEADMode(this.aeadAlgorithm);this.iv=e.subarray(t,t+=i.ivLength)}this.version===5||t<e.length?(this.encrypted=e.subarray(t,e.length),this.sessionKeyEncryptionAlgorithm=n):this.sessionKeyAlgorithm=n}write(){let e=this.encrypted===null?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm,t;return this.version===5?t=b.concatUint8Array([new Uint8Array([this.version,e,this.aeadAlgorithm]),this.s2k.write(),this.iv,this.encrypted]):(t=b.concatUint8Array([new Uint8Array([this.version,e]),this.s2k.write()]),this.encrypted!==null&&(t=b.concatUint8Array([t,this.encrypted]))),t}decrypt(e){return x(this,null,function*(){let t=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm,{blockSize:n,keySize:i}=wt.getCipher(t),a=yield this.s2k.produceKey(e,i);if(this.version===5){let o=wt.getAEADMode(this.aeadAlgorithm),s=new Uint8Array([192|r.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),h=yield o(t,a);this.sessionKey=yield h.decrypt(this.encrypted,this.iv,s)}else if(this.encrypted!==null){let o=yield wt.mode.cfb.decrypt(t,a,this.encrypted,new Uint8Array(n));this.sessionKeyAlgorithm=d.write(d.symmetric,o[0]),this.sessionKey=o.subarray(1,o.length)}else this.sessionKey=a})}encrypt(n){return x(this,arguments,function*(e,t=dt){let i=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm;this.sessionKeyEncryptionAlgorithm=i,this.s2k=new rn(t),this.s2k.salt=wt.random.getRandomBytes(8);let{blockSize:a,keySize:o}=wt.getCipher(i),s=yield this.s2k.produceKey(e,o);if(this.sessionKey===null&&(this.sessionKey=wt.generateSessionKey(this.sessionKeyAlgorithm)),this.version===5){let h=wt.getAEADMode(this.aeadAlgorithm);this.iv=wt.random.getRandomBytes(h.ivLength);let c=new Uint8Array([192|r.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),u=yield h(i,s);this.encrypted=yield u.encrypt(this.sessionKey,this.iv,c)}else{let h=b.concatUint8Array([new Uint8Array([this.sessionKeyAlgorithm]),this.sessionKey]);this.encrypted=yield wt.mode.cfb.encrypt(i,s,h,new Uint8Array(a),t)}})}},ar=class r{static get tag(){return d.packet.publicKey}constructor(e=new Date,t=dt){this.version=t.v5Keys?5:4,this.created=b.normalizeDate(e),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(e){let t=new r,{version:n,created:i,algorithm:a,publicParams:o,keyID:s,fingerprint:h}=e;return t.version=n,t.created=i,t.algorithm=a,t.publicParams=o,t.keyID=s,t.fingerprint=h,t}read(e){return x(this,null,function*(){let t=0;if(this.version=e[t++],this.version===4||this.version===5){this.created=b.readDate(e.subarray(t,t+4)),t+=4,this.algorithm=e[t++],this.version===5&&(t+=4);let{read:n,publicParams:i}=wt.parsePublicKeyParams(this.algorithm,e.subarray(t));return this.publicParams=i,t+=n,yield this.computeFingerprintAndKeyID(),t}throw new Jt(`Version ${this.version} of the key packet is unsupported.`)})}write(){let e=[];e.push(new Uint8Array([this.version])),e.push(b.writeDate(this.created)),e.push(new Uint8Array([this.algorithm]));let t=wt.serializeParams(this.algorithm,this.publicParams);return this.version===5&&e.push(b.writeNumber(t.length,4)),e.push(t),b.concatUint8Array(e)}writeForHash(e){let t=this.writePublicKey();return e===5?b.concatUint8Array([new Uint8Array([154]),b.writeNumber(t.length,4),t]):b.concatUint8Array([new Uint8Array([153]),b.writeNumber(t.length,2),t])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}computeFingerprintAndKeyID(){return x(this,null,function*(){if(yield this.computeFingerprint(),this.keyID=new sn,this.version===5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(this.version!==4)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}})}computeFingerprint(){return x(this,null,function*(){let e=this.writeForHash(this.version);if(this.version===5)this.fingerprint=yield wt.hash.sha256(e);else{if(this.version!==4)throw Error("Unsupported key version");this.fingerprint=yield wt.hash.sha1(e)}})}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return b.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(e){return this.version===e.version&&b.equalsUint8Array(this.writePublicKey(),e.writePublicKey())}getAlgorithmInfo(){let e={};e.algorithm=d.read(d.publicKey,this.algorithm);let t=this.publicParams.n||this.publicParams.p;return t?e.bits=b.uint8ArrayBitLength(t):this.publicParams.oid&&(e.curve=this.publicParams.oid.getName()),e}};ar.prototype.readPublicKey=ar.prototype.read,ar.prototype.writePublicKey=ar.prototype.write;var Dc=b.constructAllowedPackets([qr,hn,Ie,Ae]),Ls=class{static get tag(){return d.packet.symmetricallyEncryptedData}constructor(){this.encrypted=null,this.packets=null}read(e){this.encrypted=e}write(){return this.encrypted}decrypt(i,a){return x(this,arguments,function*(e,t,n=dt){if(!n.allowUnauthenticatedMessages)throw Error("Message is not authenticated.");let{blockSize:o}=wt.getCipher(e),s=yield ie(an(this.encrypted)),h=yield wt.mode.cfb.decrypt(e,t,s.subarray(o+2),s.subarray(2,o+2));this.packets=yield Gt.fromBinary(h,Dc,n)})}encrypt(i,a){return x(this,arguments,function*(e,t,n=dt){let o=this.packets.write(),{blockSize:s}=wt.getCipher(e),h=yield wt.getPrefixRandom(e),c=yield wt.mode.cfb.encrypt(e,t,h,new Uint8Array(s),n),u=yield wt.mode.cfb.encrypt(e,t,o,c.subarray(2),n);this.encrypted=b.concat([c,u])})}};var Ua=class r extends ar{static get tag(){return d.packet.publicSubkey}constructor(e,t){super(e,t)}static fromSecretSubkeyPacket(e){let t=new r,{version:n,created:i,algorithm:a,publicParams:o,keyID:s,fingerprint:h}=e;return t.version=n,t.created=i,t.algorithm=a,t.publicParams=o,t.keyID=s,t.fingerprint=h,t}},Ns=class r{static get tag(){return d.packet.userAttribute}constructor(){this.attributes=[]}read(e){let t=0;for(;t<e.length;){let n=E2(e.subarray(t,e.length));t+=n.offset,this.attributes.push(b.uint8ArrayToString(e.subarray(t,t+n.len))),t+=n.len}}write(){let e=[];for(let t=0;t<this.attributes.length;t++)e.push(Ti(this.attributes[t].length)),e.push(b.stringToUint8Array(this.attributes[t]));return b.concatUint8Array(e)}equals(e){return!!(e&&e instanceof r)&&this.attributes.every(function(t,n){return t===e.attributes[n]})}},Ei=class extends ar{static get tag(){return d.packet.secretKey}constructor(e=new Date,t=dt){super(e,t),this.keyMaterial=null,this.isEncrypted=null,this.s2kUsage=0,this.s2k=null,this.symmetric=null,this.aead=null,this.privateParams=null}read(e){return x(this,null,function*(){let t=yield this.readPublicKey(e),n=t;this.s2kUsage=e[t++],this.version===5&&t++;try{if(this.s2kUsage===255||this.s2kUsage===254||this.s2kUsage===253){if(this.symmetric=e[t++],this.s2kUsage===253&&(this.aead=e[t++]),this.s2k=new rn,t+=this.s2k.read(e.subarray(t,e.length)),this.s2k.type==="gnu-dummy")return}else this.s2kUsage&&(this.symmetric=this.s2kUsage);this.s2kUsage&&(this.iv=e.subarray(t,t+wt.getCipher(this.symmetric).blockSize),t+=this.iv.length)}catch(i){if(!this.s2kUsage)throw i;this.unparseableKeyMaterial=e.subarray(n),this.isEncrypted=!0}if(this.version===5&&(t+=4),this.keyMaterial=e.subarray(t),this.isEncrypted=!!this.s2kUsage,!this.isEncrypted){let i=this.keyMaterial.subarray(0,-2);if(!b.equalsUint8Array(b.writeChecksum(i),this.keyMaterial.subarray(-2)))throw Error("Key checksum mismatch");try{let{privateParams:a}=wt.parsePrivateKeyParams(this.algorithm,i,this.publicParams);this.privateParams=a}catch(a){throw a instanceof Jt?a:Error("Error reading MPIs")}}})}write(){let e=this.writePublicKey();if(this.unparseableKeyMaterial)return b.concatUint8Array([e,this.unparseableKeyMaterial]);let t=[e];t.push(new Uint8Array([this.s2kUsage]));let n=[];return this.s2kUsage!==255&&this.s2kUsage!==254&&this.s2kUsage!==253||(n.push(this.symmetric),this.s2kUsage===253&&n.push(this.aead),n.push(...this.s2k.write())),this.s2kUsage&&this.s2k.type!=="gnu-dummy"&&n.push(...this.iv),this.version===5&&t.push(new Uint8Array([n.length])),t.push(new Uint8Array(n)),this.isDummy()||(this.s2kUsage||(this.keyMaterial=wt.serializeParams(this.algorithm,this.privateParams)),this.version===5&&t.push(b.writeNumber(this.keyMaterial.length,4)),t.push(this.keyMaterial),this.s2kUsage||t.push(b.writeChecksum(this.keyMaterial))),b.concatUint8Array(t)}isDecrypted(){return this.isEncrypted===!1}isMissingSecretKeyMaterial(){return this.unparseableKeyMaterial!==void 0||this.isDummy()}isDummy(){return!(!this.s2k||this.s2k.type!=="gnu-dummy")}makeDummy(e=dt){this.isDummy()||(this.isDecrypted()&&this.clearPrivateParams(),delete this.unparseableKeyMaterial,this.isEncrypted=null,this.keyMaterial=null,this.s2k=new rn(e),this.s2k.algorithm=0,this.s2k.c=0,this.s2k.type="gnu-dummy",this.s2kUsage=254,this.symmetric=d.symmetric.aes256)}encrypt(n){return x(this,arguments,function*(e,t=dt){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key packet is already encrypted");if(!e)throw Error("A non-empty passphrase is required for key encryption.");this.s2k=new rn(t),this.s2k.salt=wt.random.getRandomBytes(8);let i=wt.serializeParams(this.algorithm,this.privateParams);this.symmetric=d.symmetric.aes256;let a=yield N0(this.s2k,e,this.symmetric),{blockSize:o}=wt.getCipher(this.symmetric);if(this.iv=wt.random.getRandomBytes(o),t.aeadProtect){this.s2kUsage=253,this.aead=d.aead.eax;let s=wt.getAEADMode(this.aead),h=yield s(this.symmetric,a);this.keyMaterial=yield h.encrypt(i,this.iv.subarray(0,s.ivLength),new Uint8Array)}else this.s2kUsage=254,this.keyMaterial=yield wt.mode.cfb.encrypt(this.symmetric,a,b.concatUint8Array([i,yield wt.hash.sha1(i,t)]),this.iv,t)})}decrypt(e){return x(this,null,function*(){if(this.isDummy())return!1;if(this.unparseableKeyMaterial)throw Error("Key packet cannot be decrypted: unsupported S2K or cipher algo");if(this.isDecrypted())throw Error("Key packet is already decrypted.");let t,n;if(this.s2kUsage!==254&&this.s2kUsage!==253)throw this.s2kUsage===255?Error("Encrypted private key is authenticated using an insecure two-byte hash"):Error("Private key is encrypted using an insecure S2K function: unsalted MD5");if(t=yield N0(this.s2k,e,this.symmetric),this.s2kUsage===253){let i=wt.getAEADMode(this.aead),a=yield i(this.symmetric,t);try{n=yield a.decrypt(this.keyMaterial,this.iv.subarray(0,i.ivLength),new Uint8Array)}catch(o){throw o.message==="Authentication tag mismatch"?Error("Incorrect key passphrase: "+o.message):o}}else{let i=yield wt.mode.cfb.decrypt(this.symmetric,t,this.keyMaterial,this.iv);n=i.subarray(0,-20);let a=yield wt.hash.sha1(n);if(!b.equalsUint8Array(a,i.subarray(-20)))throw Error("Incorrect key passphrase")}try{let{privateParams:i}=wt.parsePrivateKeyParams(this.algorithm,n,this.publicParams);this.privateParams=i}catch{throw Error("Error reading MPIs")}this.isEncrypted=!1,this.keyMaterial=null,this.s2kUsage=0})}validate(){return x(this,null,function*(){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key is not decrypted");let e;try{e=yield wt.validateParams(this.algorithm,this.publicParams,this.privateParams)}catch{e=!1}if(!e)throw Error("Key is invalid")})}generate(e,t){return x(this,null,function*(){let{privateParams:n,publicParams:i}=yield wt.generateParams(this.algorithm,e,t);this.privateParams=n,this.publicParams=i,this.isEncrypted=!1})}clearPrivateParams(){this.isMissingSecretKeyMaterial()||(Object.keys(this.privateParams).forEach(e=>{this.privateParams[e].fill(0),delete this.privateParams[e]}),this.privateParams=null,this.isEncrypted=!0)}};function N0(r,e,t){return x(this,null,function*(){let{keySize:n}=wt.getCipher(t);return r.produceKey(e,n)})}var Cc=Vs(function(r){(function(e){function t(i){function a(){return St<Wt}function o(){return St}function s(tt){St=tt}function h(){St=0,Wt=Lt.length}function c(tt,et){return{name:tt,tokens:et||"",semantic:et||"",children:[]}}function u(tt,et){var ht;return et===null?null:((ht=c(tt)).tokens=et.tokens,ht.semantic=et.semantic,ht.children.push(et),ht)}function y(tt,et){return et!==null&&(tt.tokens+=et.tokens,tt.semantic+=et.semantic),tt.children.push(et),tt}function m(tt){var et;return a()&&tt(et=Lt[St])?(St+=1,c("token",et)):null}function p(tt){return function(){return u("literal",m(function(et){return et===tt}))}}function _(){var tt=arguments;return function(){var et,ht,At,Et;for(Et=o(),ht=c("and"),et=0;et<tt.length;et+=1){if((At=tt[et]())===null)return s(Et),null;y(ht,At)}return ht}}function S(){var tt=arguments;return function(){var et,ht,At;for(At=o(),et=0;et<tt.length;et+=1){if((ht=tt[et]())!==null)return ht;s(At)}return null}}function L(tt){return function(){var et,ht;return ht=o(),(et=tt())!==null?et:(s(ht),c("opt"))}}function O(tt){return function(){var et=tt();return et!==null&&(et.semantic=""),et}}function X(tt){return function(){var et=tt();return et!==null&&et.semantic.length>0&&(et.semantic=" "),et}}function N(tt,et){return function(){var ht,At,Et,Pt,_t;for(Pt=o(),ht=c("star"),Et=0,_t=et===void 0?0:et;(At=tt())!==null;)Et+=1,y(ht,At);return Et>=_t?ht:(s(Pt),null)}}function K(tt){return tt.charCodeAt(0)>=128}function $(){return u("cr",p("\r")())}function q(){return u("crlf",_($,J)())}function j(){return u("dquote",p('"')())}function Z(){return u("htab",p("	")())}function J(){return u("lf",p(`
`)())}function rt(){return u("sp",p(" ")())}function yt(){return u("vchar",m(function(tt){var et=tt.charCodeAt(0),ht=33<=et&&et<=126;return i.rfc6532&&(ht=ht||K(tt)),ht}))}function pt(){return u("wsp",S(rt,Z)())}function kt(){var tt=u("quoted-pair",S(_(p("\\"),S(yt,pt)),C)());return tt===null?null:(tt.semantic=tt.semantic[1],tt)}function at(){return u("fws",S(B,_(L(_(N(pt),O(q))),N(pt,1)))())}function W(){return u("ctext",S(function(){return m(function(tt){var et=tt.charCodeAt(0),ht=33<=et&&et<=39||42<=et&&et<=91||93<=et&&et<=126;return i.rfc6532&&(ht=ht||K(tt)),ht})},ut)())}function Dt(){return u("ccontent",S(W,kt,G)())}function G(){return u("comment",_(p("("),N(_(L(at),Dt)),L(at),p(")"))())}function nt(){return u("cfws",S(_(N(_(L(at),G),1),L(at)),at)())}function mt(){return u("atext",m(function(tt){var et="a"<=tt&&tt<="z"||"A"<=tt&&tt<="Z"||"0"<=tt&&tt<="9"||["!","#","$","%","&","'","*","+","-","/","=","?","^","_","`","{","|","}","~"].indexOf(tt)>=0;return i.rfc6532&&(et=et||K(tt)),et}))}function bt(){return u("atom",_(X(L(nt)),N(mt,1),X(L(nt)))())}function gt(){var tt,et;return(tt=u("dot-atom-text",N(mt,1)()))===null||(et=N(_(p("."),N(mt,1)))())!==null&&y(tt,et),tt}function ft(){return u("dot-atom",_(O(L(nt)),gt,O(L(nt)))())}function vt(){return u("qtext",S(function(){return m(function(tt){var et=tt.charCodeAt(0),ht=et===33||35<=et&&et<=91||93<=et&&et<=126;return i.rfc6532&&(ht=ht||K(tt)),ht})},ct)())}function st(){return u("qcontent",S(vt,kt)())}function U(){return u("quoted-string",_(O(L(nt)),O(j),N(_(L(X(at)),st)),L(O(at)),O(j),O(L(nt)))())}function F(){return u("word",S(bt,U)())}function H(){return u("address",S(l,Q)())}function l(){return u("mailbox",S(P,lt)())}function P(){return u("name-addr",_(L(Y),V)())}function V(){return u("angle-addr",S(_(O(L(nt)),p("<"),lt,p(">"),O(L(nt))),z)())}function Q(){return u("group",_(Y,p(":"),L(w),p(";"),O(L(nt)))())}function Y(){return u("display-name",((tt=u("phrase",S(I,N(F,1))()))!==null&&(tt.semantic=function(et){return et.replace(/([ \t]|\r\n)+/g," ").replace(/^\s*/,"").replace(/\s*$/,"")}(tt.semantic)),tt));var tt}function g(){return u("mailbox-list",S(_(l,N(_(p(","),l))),k)())}function f(){return u("address-list",S(_(H,N(_(p(","),H))),E)())}function w(){return u("group-list",S(g,O(nt),it)())}function A(){return u("local-part",S(xt,ft,U)())}function T(){return u("dtext",S(function(){return m(function(tt){var et=tt.charCodeAt(0),ht=33<=et&&et<=90||94<=et&&et<=126;return i.rfc6532&&(ht=ht||K(tt)),ht})},Mt)())}function D(){return u("domain-literal",_(O(L(nt)),p("["),N(_(L(at),T)),L(at),p("]"),O(L(nt)))())}function M(){return u("domain",(tt=S(Bt,ft,D)(),i.rejectTLD&&tt&&tt.semantic&&tt.semantic.indexOf(".")<0?null:(tt&&(tt.semantic=tt.semantic.replace(/\s+/g,"")),tt)));var tt}function lt(){return u("addr-spec",_(A,p("@"),M)())}function ot(){return i.strict?null:u("obs-NO-WS-CTL",m(function(tt){var et=tt.charCodeAt(0);return 1<=et&&et<=8||et===11||et===12||14<=et&&et<=31||et===127}))}function ut(){return i.strict?null:u("obs-ctext",ot())}function ct(){return i.strict?null:u("obs-qtext",ot())}function C(){return i.strict?null:u("obs-qp",_(p("\\"),S(p("\0"),ot,J,$))())}function I(){return i.strict?null:i.atInDisplayName?u("obs-phrase",_(F,N(S(F,p("."),p("@"),X(nt))))()):u("obs-phrase",_(F,N(S(F,p("."),X(nt))))())}function B(){return i.strict?null:u("obs-FWS",N(_(O(L(q)),pt),1)())}function z(){return i.strict?null:u("obs-angle-addr",_(O(L(nt)),p("<"),R,lt,p(">"),O(L(nt)))())}function R(){return i.strict?null:u("obs-route",_(v,p(":"))())}function v(){return i.strict?null:u("obs-domain-list",_(N(S(O(nt),p(","))),p("@"),M,N(_(p(","),O(L(nt)),L(_(p("@"),M)))))())}function k(){return i.strict?null:u("obs-mbox-list",_(N(_(O(L(nt)),p(","))),l,N(_(p(","),L(_(l,O(nt))))))())}function E(){return i.strict?null:u("obs-addr-list",_(N(_(O(L(nt)),p(","))),H,N(_(p(","),L(_(H,O(nt))))))())}function it(){return i.strict?null:u("obs-group-list",_(N(_(O(L(nt)),p(",")),1),O(L(nt)))())}function xt(){return i.strict?null:u("obs-local-part",_(F,N(_(p("."),F)))())}function Bt(){return i.strict?null:u("obs-domain",_(bt,N(_(p("."),bt)))())}function Mt(){return i.strict?null:u("obs-dtext",S(ot,kt)())}function It(tt,et){var ht,At,Et;if(et==null)return null;for(At=[et];At.length>0;){if((Et=At.pop()).name===tt)return Et;for(ht=Et.children.length-1;ht>=0;ht-=1)At.push(Et.children[ht])}return null}function Zt(tt,et){var ht,At,Et,Pt,_t;if(et==null)return null;for(At=[et],Pt=[],_t={},ht=0;ht<tt.length;ht+=1)_t[tt[ht]]=!0;for(;At.length>0;)if((Et=At.pop()).name in _t)Pt.push(Et);else for(ht=Et.children.length-1;ht>=0;ht-=1)At.push(Et.children[ht]);return Pt}function te(tt){var et,ht,At,Et,Pt;if(tt===null)return null;for(et=[],ht=Zt(["group","mailbox"],tt),At=0;At<ht.length;At+=1)(Et=ht[At]).name==="group"?et.push(ne(Et)):Et.name==="mailbox"&&et.push(ce(Et));return Pt={ast:tt,addresses:et},i.simple&&(Pt=function(_t){var Ft;if(_t&&_t.addresses)for(Ft=0;Ft<_t.addresses.length;Ft+=1)delete _t.addresses[Ft].node;return _t}(Pt)),i.oneResult?function(_t){return!_t||!i.partial&&_t.addresses.length>1?null:_t.addresses&&_t.addresses[0]}(Pt):i.simple?Pt&&Pt.addresses:Pt}function ne(tt){var et,ht=It("display-name",tt),At=[],Et=Zt(["mailbox"],tt);for(et=0;et<Et.length;et+=1)At.push(ce(Et[et]));return{node:tt,parts:{name:ht},type:tt.name,name:Ct(ht),addresses:At}}function ce(tt){var et=It("display-name",tt),ht=It("addr-spec",tt),At=function(Ft,Vt){var Le,Ne,Oe,Ve;if(Vt==null)return null;for(Ne=[Vt],Ve=[];Ne.length>0;)for((Oe=Ne.pop()).name===Ft&&Ve.push(Oe),Le=Oe.children.length-1;Le>=0;Le-=1)Ne.push(Oe.children[Le]);return Ve}("cfws",tt),Et=Zt(["comment"],tt),Pt=It("local-part",ht),_t=It("domain",ht);return{node:tt,parts:{name:et,address:ht,local:Pt,domain:_t,comments:At},type:tt.name,name:Ct(et),address:Ct(ht),local:Ct(Pt),domain:Ct(_t),comments:Ot(Et),groupName:Ct(tt.groupName)}}function Ct(tt){return tt!=null?tt.semantic:null}function Ot(tt){var et="";if(tt)for(var ht=0;ht<tt.length;ht+=1)et+=Ct(tt[ht]);return et}var Lt,St,Wt,Ht,qt;if((i=n(i,{}))===null)return null;if(Lt=i.input,qt={address:H,"address-list":f,"angle-addr":V,from:function(){return u("from",S(g,f)())},group:Q,mailbox:l,"mailbox-list":g,"reply-to":function(){return u("reply-to",f())},sender:function(){return u("sender",S(l,H)())}}[i.startAt]||f,!i.strict){if(h(),i.strict=!0,Ht=qt(Lt),i.partial||!a())return te(Ht);i.strict=!1}return h(),Ht=qt(Lt),!i.partial&&a()?null:te(Ht)}function n(i,a){function o(u){return Object.prototype.toString.call(u)==="[object String]"}function s(u){return u==null}var h,c;if(o(i))i={input:i};else if(!function(u){return u===Object(u)}(i))return null;if(!o(i.input)||!a)return null;for(c in h={oneResult:!1,partial:!1,rejectTLD:!1,rfc6532:!1,simple:!1,startAt:"address-list",strict:!1,atInDisplayName:!1})s(i[c])&&(i[c]=s(a[c])?h[c]:a[c]);return i}t.parseOneAddress=function(i){return t(n(i,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"address-list"}))},t.parseAddressList=function(i){return t(n(i,{rfc6532:!0,simple:!0,startAt:"address-list"}))},t.parseFrom=function(i){return t(n(i,{rfc6532:!0,simple:!0,startAt:"from"}))},t.parseSender=function(i){return t(n(i,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"sender"}))},t.parseReplyTo=function(i){return t(n(i,{rfc6532:!0,simple:!0,startAt:"reply-to"}))},r.exports=t})()}),Da=class r{static get tag(){return d.packet.userID}constructor(){this.userID="",this.name="",this.email="",this.comment=""}static fromObject(e){if(b.isString(e)||e.name&&!b.isString(e.name)||e.email&&!b.isEmailAddress(e.email)||e.comment&&!b.isString(e.comment))throw Error("Invalid user ID format");let t=new r;Object.assign(t,e);let n=[];return t.name&&n.push(t.name),t.comment&&n.push(`(${t.comment})`),t.email&&n.push(`<${t.email}>`),t.userID=n.join(" "),t}read(e,t=dt){let n=b.decodeUTF8(e);if(n.length>t.maxUserIDLength)throw Error("User ID string is too long");try{let{name:i,address:a,comments:o}=Cc.parseOneAddress({input:n,atInDisplayName:!0});this.comment=o.replace(/^\(|\)$/g,""),this.name=i,this.email=a}catch{}this.userID=n}write(){return b.encodeUTF8(this.userID)}equals(e){return e&&e.userID===this.userID}},Ca=class extends Ei{static get tag(){return d.packet.secretSubkey}constructor(e=new Date,t=dt){super(e,t)}};var Ia=class{constructor(e){this.packets=e||new Gt}write(){return this.packets.write()}armor(e=dt){return Di(d.armor.signature,this.write(),void 0,void 0,void 0,e)}getSigningKeyIDs(){return this.packets.map(e=>e.issuerKeyID)}};function ro(r,e){return x(this,null,function*(){let t=new Ca(r.date,e);return t.packets=null,t.algorithm=d.write(d.publicKey,r.algorithm),yield t.generate(r.rsaBits,r.curve),yield t.computeFingerprintAndKeyID(),t})}function Ic(r,e){return x(this,null,function*(){let t=new Ei(r.date,e);return t.packets=null,t.algorithm=d.write(d.publicKey,r.algorithm),yield t.generate(r.rsaBits,r.curve,r.config),yield t.computeFingerprintAndKeyID(),t})}function Ye(o,s,h,c){return x(this,arguments,function*(r,e,t,n,i=new Date,a){let u,y;for(let m=r.length-1;m>=0;m--)try{(!u||r[m].created>=u.created)&&(yield r[m].verify(e,t,n,i,void 0,a),u=r[m])}catch(p){y=p}if(!u)throw b.wrapError(`Could not find valid ${d.read(d.signature,t)} signature in key ${e.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,(m,p,_)=>p+" "+_.toLowerCase()),y);return u})}function Os(r,e,t=new Date){let n=b.normalizeDate(t);if(n!==null){let i=Ta(r,e);return!(r.created<=n&&n<i)}return!1}function no(r,e,t,n){return x(this,null,function*(){let i={};i.key=e,i.bind=r;let a={signatureType:d.signature.subkeyBinding};return t.sign?(a.keyFlags=[d.keyFlags.signData],a.embeddedSignature=yield xr(i,null,r,{signatureType:d.signature.keyBinding},t.date,void 0,void 0,void 0,n)):a.keyFlags=[d.keyFlags.encryptCommunication|d.keyFlags.encryptStorage],t.keyExpirationTime>0&&(a.keyExpirationTime=t.keyExpirationTime,a.keyNeverExpires=!1),yield xr(i,null,e,a,t.date,void 0,void 0,void 0,n)})}function io(a,o){return x(this,arguments,function*(r,e,t=new Date,n={},i){let s=i.preferredHashAlgorithm,h=s;if(r){let c=yield r.getPrimaryUser(t,n,i);c.selfCertification.preferredHashAlgorithms&&([h]=c.selfCertification.preferredHashAlgorithms,s=wt.hash.getHashByteLength(s)<=wt.hash.getHashByteLength(h)?h:s)}switch(e.algorithm){case d.publicKey.ecdsa:case d.publicKey.eddsaLegacy:case d.publicKey.ed25519:h=wt.getPreferredCurveHashAlgo(e.algorithm,e.publicParams.oid)}return wt.hash.getHashByteLength(s)<=wt.hash.getHashByteLength(h)?h:s})}function Fs(a){return x(this,arguments,function*(r,e=[],t=new Date,n=[],i=dt){let o={symmetric:d.symmetric.aes128,aead:d.aead.eax,compression:d.compression.uncompressed}[r],s={symmetric:i.preferredSymmetricAlgorithm,aead:i.preferredAEADAlgorithm,compression:i.preferredCompressionAlgorithm}[r],h={symmetric:"preferredSymmetricAlgorithms",aead:"preferredAEADAlgorithms",compression:"preferredCompressionAlgorithms"}[r];return(yield Promise.all(e.map(function(c,u){return x(this,null,function*(){let y=(yield c.getPrimaryUser(t,n[u],i)).selfCertification[h];return!!y&&y.indexOf(s)>=0})}))).every(Boolean)?s:o})}function xr(c,u,y,m,p,_){return x(this,arguments,function*(r,e,t,n,i,a,o=[],s=!1,h){if(t.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!t.isDecrypted())throw Error("Signing key is not decrypted.");let S=new Ae;return Object.assign(S,n),S.publicKeyAlgorithm=t.algorithm,S.hashAlgorithm=yield io(e,t,i,a,h),S.rawNotations=o,yield S.sign(t,r,i,s),S})}function nn(a,o,s){return x(this,arguments,function*(r,e,t,n=new Date,i){(r=r[t])&&(e[t].length?yield Promise.all(r.map(function(h){return x(this,null,function*(){h.isExpired(n)||i&&!(yield i(h))||e[t].some(function(c){return b.equalsUint8Array(c.writeParams(),h.writeParams())})||e[t].push(h)})})):e[t]=r)})}function In(h,c,u,y,m,p){return x(this,arguments,function*(r,e,t,n,i,a,o=new Date,s){a=a||r;let _=[];return yield Promise.all(n.map(function(S){return x(this,null,function*(){try{i&&!S.issuerKeyID.equals(i.issuerKeyID)||(yield S.verify(a,e,t,s.revocationsExpire?o:null,!1,s),_.push(S.issuerKeyID))}catch{}})})),i?(i.revoked=!!_.some(S=>S.equals(i.issuerKeyID))||i.revoked||!1,i.revoked):_.length>0})}function Ta(r,e){let t;return e.keyNeverExpires===!1&&(t=r.created.getTime()+1e3*e.keyExpirationTime),t?new Date(t):1/0}function Hs(r,e={}){switch(r.type=r.type||e.type,r.curve=r.curve||e.curve,r.rsaBits=r.rsaBits||e.rsaBits,r.keyExpirationTime=r.keyExpirationTime!==void 0?r.keyExpirationTime:e.keyExpirationTime,r.passphrase=b.isString(r.passphrase)?r.passphrase:e.passphrase,r.date=r.date||e.date,r.sign=r.sign||!1,r.type){case"ecc":try{r.curve=d.write(d.curve,r.curve)}catch{throw Error("Unknown curve")}r.curve!==d.curve.ed25519Legacy&&r.curve!==d.curve.curve25519Legacy||(r.curve=r.sign?d.curve.ed25519Legacy:d.curve.curve25519Legacy),r.sign?r.algorithm=r.curve===d.curve.ed25519Legacy?d.publicKey.eddsaLegacy:d.publicKey.ecdsa:r.algorithm=d.publicKey.ecdh;break;case"rsa":r.algorithm=d.publicKey.rsaEncryptSign;break;default:throw Error("Unsupported key type "+r.type)}return r}function O0(r,e){let t=r.algorithm;return t!==d.publicKey.rsaEncrypt&&t!==d.publicKey.elgamal&&t!==d.publicKey.ecdh&&t!==d.publicKey.x25519&&(!e.keyFlags||(e.keyFlags[0]&d.keyFlags.signData)!=0)}function F0(r,e){let t=r.algorithm;return t!==d.publicKey.dsa&&t!==d.publicKey.rsaSign&&t!==d.publicKey.ecdsa&&t!==d.publicKey.eddsaLegacy&&t!==d.publicKey.ed25519&&(!e.keyFlags||(e.keyFlags[0]&d.keyFlags.encryptCommunication)!=0||(e.keyFlags[0]&d.keyFlags.encryptStorage)!=0)}function H0(r,e){return!!e.allowInsecureDecryptionWithSigningKeys||!r.keyFlags||(r.keyFlags[0]&d.keyFlags.encryptCommunication)!=0||(r.keyFlags[0]&d.keyFlags.encryptStorage)!=0}function Sn(r,e){let t=d.write(d.publicKey,r.algorithm),n=r.getAlgorithmInfo();if(e.rejectPublicKeyAlgorithms.has(t))throw Error(n.algorithm+" keys are considered too weak.");switch(t){case d.publicKey.rsaEncryptSign:case d.publicKey.rsaSign:case d.publicKey.rsaEncrypt:if(n.bits<e.minRSABits)throw Error(`RSA keys shorter than ${e.minRSABits} bits are considered too weak.`);break;case d.publicKey.ecdsa:case d.publicKey.eddsaLegacy:case d.publicKey.ecdh:if(e.rejectCurves.has(n.curve))throw Error(`Support for ${n.algorithm} keys using curve ${n.curve} is disabled.`)}}var js=class r{constructor(e,t){this.userID=e.constructor.tag===d.packet.userID?e:null,this.userAttribute=e.constructor.tag===d.packet.userAttribute?e:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=t}toPacketList(){let e=new Gt;return e.push(this.userID||this.userAttribute),e.push(...this.revocationSignatures),e.push(...this.selfCertifications),e.push(...this.otherCertifications),e}clone(){let e=new r(this.userID||this.userAttribute,this.mainKey);return e.selfCertifications=[...this.selfCertifications],e.otherCertifications=[...this.otherCertifications],e.revocationSignatures=[...this.revocationSignatures],e}certify(e,t,n){return x(this,null,function*(){let i=this.mainKey.keyPacket,a={userID:this.userID,userAttribute:this.userAttribute,key:i},o=new r(a.userID||a.userAttribute,this.mainKey);return o.otherCertifications=yield Promise.all(e.map(function(s){return x(this,null,function*(){if(!s.isPrivate())throw Error("Need private key for signing");if(s.hasSameFingerprintAs(i))throw Error("The user's own key can only be used for self-certifications");let h=yield s.getSigningKey(void 0,t,void 0,n);return xr(a,s,h.keyPacket,{signatureType:d.signature.certGeneric,keyFlags:[d.keyFlags.certifyKeys|d.keyFlags.signData]},t,void 0,void 0,void 0,n)})})),yield o.update(this,t,n),o})}isRevoked(a,o){return x(this,arguments,function*(e,t,n=new Date,i=dt){let s=this.mainKey.keyPacket;return In(s,d.signature.certRevocation,{key:s,userID:this.userID,userAttribute:this.userAttribute},this.revocationSignatures,e,t,n,i)})}verifyCertificate(a,o){return x(this,arguments,function*(e,t,n=new Date,i){let s=this,h=this.mainKey.keyPacket,c={userID:this.userID,userAttribute:this.userAttribute,key:h},{issuerKeyID:u}=e,y=t.filter(m=>m.getKeys(u).length>0);return y.length===0?null:(yield Promise.all(y.map(m=>x(this,null,function*(){let p=yield m.getSigningKey(u,e.created,void 0,i);if(e.revoked||(yield s.isRevoked(e,p.keyPacket,n,i)))throw Error("User certificate is revoked");try{yield e.verify(p.keyPacket,d.signature.certGeneric,c,n,void 0,i)}catch(_){throw b.wrapError("User certificate is invalid",_)}}))),!0)})}verifyAllCertifications(i){return x(this,arguments,function*(e,t=new Date,n){let a=this,o=this.selfCertifications.concat(this.otherCertifications);return Promise.all(o.map(s=>x(this,null,function*(){return{keyID:s.issuerKeyID,valid:yield a.verifyCertificate(s,e,t,n).catch(()=>!1)}})))})}verify(){return x(this,arguments,function*(e=new Date,t){if(!this.selfCertifications.length)throw Error("No self-certifications found");let n=this,i=this.mainKey.keyPacket,a={userID:this.userID,userAttribute:this.userAttribute,key:i},o;for(let s=this.selfCertifications.length-1;s>=0;s--)try{let h=this.selfCertifications[s];if(h.revoked||(yield n.isRevoked(h,void 0,e,t)))throw Error("Self-certification is revoked");try{yield h.verify(i,d.signature.certGeneric,a,e,void 0,t)}catch(c){throw b.wrapError("Self-certification is invalid",c)}return!0}catch(h){o=h}throw o})}update(e,t,n){return x(this,null,function*(){let i=this.mainKey.keyPacket,a={userID:this.userID,userAttribute:this.userAttribute,key:i};yield nn(e,this,"selfCertifications",t,function(o){return x(this,null,function*(){try{return yield o.verify(i,d.signature.certGeneric,a,t,!1,n),!0}catch{return!1}})}),yield nn(e,this,"otherCertifications",t),yield nn(e,this,"revocationSignatures",t,function(o){return In(i,d.signature.certRevocation,a,[o],void 0,void 0,t,n)})})}revoke(o){return x(this,arguments,function*(e,{flag:t=d.reasonForRevocation.noReason,string:n=""}={},i=new Date,a=dt){let s={userID:this.userID,userAttribute:this.userAttribute,key:e},h=new r(s.userID||s.userAttribute,this.mainKey);return h.revocationSignatures.push(yield xr(s,null,e,{signatureType:d.signature.certRevocation,reasonForRevocationFlag:d.write(d.reasonForRevocation,t),reasonForRevocationString:n},i,void 0,void 0,!1,a)),yield h.update(this),h})}},_i=class r{constructor(e,t){this.keyPacket=e,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=t}toPacketList(){let e=new Gt;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.bindingSignatures),e}clone(){let e=new r(this.keyPacket,this.mainKey);return e.bindingSignatures=[...this.bindingSignatures],e.revocationSignatures=[...this.revocationSignatures],e}isRevoked(a,o){return x(this,arguments,function*(e,t,n=new Date,i=dt){let s=this.mainKey.keyPacket;return In(s,d.signature.subkeyRevocation,{key:s,bind:this.keyPacket},this.revocationSignatures,e,t,n,i)})}verify(){return x(this,arguments,function*(e=new Date,t=dt){let n=this.mainKey.keyPacket,i={key:n,bind:this.keyPacket},a=yield Ye(this.bindingSignatures,n,d.signature.subkeyBinding,i,e,t);if(a.revoked||(yield this.isRevoked(a,null,e,t)))throw Error("Subkey is revoked");if(Os(this.keyPacket,a,e))throw Error("Subkey is expired");return a})}getExpirationTime(){return x(this,arguments,function*(e=new Date,t=dt){let n=this.mainKey.keyPacket,i={key:n,bind:this.keyPacket},a;try{a=yield Ye(this.bindingSignatures,n,d.signature.subkeyBinding,i,e,t)}catch{return null}let o=Ta(this.keyPacket,a),s=a.getExpirationTime();return o<s?o:s})}update(i){return x(this,arguments,function*(e,t=new Date,n=dt){let a=this.mainKey.keyPacket;if(!this.hasSameFingerprintAs(e))throw Error("Subkey update method: fingerprints of subkeys not equal");this.keyPacket.constructor.tag===d.packet.publicSubkey&&e.keyPacket.constructor.tag===d.packet.secretSubkey&&(this.keyPacket=e.keyPacket);let o=this,s={key:a,bind:o.keyPacket};yield nn(e,this,"bindingSignatures",t,function(h){return x(this,null,function*(){for(let c=0;c<o.bindingSignatures.length;c++)if(o.bindingSignatures[c].issuerKeyID.equals(h.issuerKeyID))return h.created>o.bindingSignatures[c].created&&(o.bindingSignatures[c]=h),!1;try{return yield h.verify(a,d.signature.subkeyBinding,s,t,void 0,n),!0}catch{return!1}})}),yield nn(e,this,"revocationSignatures",t,function(h){return In(a,d.signature.subkeyRevocation,s,[h],void 0,void 0,t,n)})})}revoke(o){return x(this,arguments,function*(e,{flag:t=d.reasonForRevocation.noReason,string:n=""}={},i=new Date,a=dt){let s={key:e,bind:this.keyPacket},h=new r(this.keyPacket,this.mainKey);return h.revocationSignatures.push(yield xr(s,null,e,{signatureType:d.signature.subkeyRevocation,reasonForRevocationFlag:d.write(d.reasonForRevocation,t),reasonForRevocationString:n},i,void 0,void 0,!1,a)),yield h.update(this),h})}hasSameFingerprintAs(e){return this.keyPacket.hasSameFingerprintAs(e.keyPacket||e)}};["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach(r=>{_i.prototype[r]=function(){return this.keyPacket[r]()}});var Tc=b.constructAllowedPackets([Ae]),j0=new Set([d.packet.publicKey,d.packet.privateKey]),q0=new Set([d.packet.publicKey,d.packet.privateKey,d.packet.publicSubkey,d.packet.privateSubkey]),Ba=class{packetListToStructure(e,t=new Set){let n,i,a,o;for(let s of e){if(s instanceof yi){q0.has(s.tag)&&!o&&(o=j0.has(s.tag)?j0:q0);continue}let h=s.constructor.tag;if(o){if(!o.has(h))continue;o=null}if(t.has(h))throw Error("Unexpected packet type: "+h);switch(h){case d.packet.publicKey:case d.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=s,i=this.getKeyID(),!i)throw Error("Missing Key ID");break;case d.packet.userID:case d.packet.userAttribute:n=new js(s,this),this.users.push(n);break;case d.packet.publicSubkey:case d.packet.secretSubkey:n=null,a=new _i(s,this),this.subkeys.push(a);break;case d.packet.signature:switch(s.signatureType){case d.signature.certGeneric:case d.signature.certPersona:case d.signature.certCasual:case d.signature.certPositive:if(!n){b.printDebug("Dropping certification signatures without preceding user packet");continue}s.issuerKeyID.equals(i)?n.selfCertifications.push(s):n.otherCertifications.push(s);break;case d.signature.certRevocation:n?n.revocationSignatures.push(s):this.directSignatures.push(s);break;case d.signature.key:this.directSignatures.push(s);break;case d.signature.subkeyBinding:if(!a){b.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}a.bindingSignatures.push(s);break;case d.signature.keyRevocation:this.revocationSignatures.push(s);break;case d.signature.subkeyRevocation:if(!a){b.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}a.revocationSignatures.push(s)}}}}toPacketList(){let e=new Gt;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.directSignatures),this.users.map(t=>e.push(...t.toPacketList())),this.subkeys.map(t=>e.push(...t.toPacketList())),e}clone(e=!1){let t=new this.constructor(this.toPacketList());return e&&t.getKeys().forEach(n=>{if(n.keyPacket=Object.create(Object.getPrototypeOf(n.keyPacket),Object.getOwnPropertyDescriptors(n.keyPacket)),!n.keyPacket.isDecrypted())return;let i={};Object.keys(n.keyPacket.privateParams).forEach(a=>{i[a]=new Uint8Array(n.keyPacket.privateParams[a])}),n.keyPacket.privateParams=i}),t}getSubkeys(e=null){return this.subkeys.filter(t=>!e||t.getKeyID().equals(e,!0))}getKeys(e=null){let t=[];return e&&!this.getKeyID().equals(e,!0)||t.push(this),t.concat(this.getSubkeys(e))}getKeyIDs(){return this.getKeys().map(e=>e.getKeyID())}getUserIDs(){return this.users.map(e=>e.userID?e.userID.userID:null).filter(e=>e!==null)}write(){return this.toPacketList().write()}getSigningKey(){return x(this,arguments,function*(e=null,t=new Date,n={},i=dt){yield this.verifyPrimaryKey(t,n,i);let a=this.keyPacket,o=this.subkeys.slice().sort((h,c)=>c.keyPacket.created-h.keyPacket.created),s;for(let h of o)if(!e||h.getKeyID().equals(e))try{yield h.verify(t,i);let c={key:a,bind:h.keyPacket},u=yield Ye(h.bindingSignatures,a,d.signature.subkeyBinding,c,t,i);if(!O0(h.keyPacket,u))continue;if(!u.embeddedSignature)throw Error("Missing embedded signature");return yield Ye([u.embeddedSignature],h.keyPacket,d.signature.keyBinding,c,t,i),Sn(h.keyPacket,i),h}catch(c){s=c}try{let h=yield this.getPrimaryUser(t,n,i);if((!e||a.getKeyID().equals(e))&&O0(a,h.selfCertification))return Sn(a,i),this}catch(h){s=h}throw b.wrapError("Could not find valid signing key packet in key "+this.getKeyID().toHex(),s)})}getEncryptionKey(a){return x(this,arguments,function*(e,t=new Date,n={},i=dt){yield this.verifyPrimaryKey(t,n,i);let o=this.keyPacket,s=this.subkeys.slice().sort((c,u)=>u.keyPacket.created-c.keyPacket.created),h;for(let c of s)if(!e||c.getKeyID().equals(e))try{yield c.verify(t,i);let u={key:o,bind:c.keyPacket},y=yield Ye(c.bindingSignatures,o,d.signature.subkeyBinding,u,t,i);if(F0(c.keyPacket,y))return Sn(c.keyPacket,i),c}catch(u){h=u}try{let c=yield this.getPrimaryUser(t,n,i);if((!e||o.getKeyID().equals(e))&&F0(o,c.selfCertification))return Sn(o,i),this}catch(c){h=c}throw b.wrapError("Could not find valid encryption key packet in key "+this.getKeyID().toHex(),h)})}isRevoked(a,o){return x(this,arguments,function*(e,t,n=new Date,i=dt){return In(this.keyPacket,d.signature.keyRevocation,{key:this.keyPacket},this.revocationSignatures,e,t,n,i)})}verifyPrimaryKey(){return x(this,arguments,function*(e=new Date,t={},n=dt){let i=this.keyPacket;if(yield this.isRevoked(null,null,e,n))throw Error("Primary key is revoked");let{selfCertification:a}=yield this.getPrimaryUser(e,t,n);if(Os(i,a,e))throw Error("Primary key is expired");let o=yield Ye(this.directSignatures,i,d.signature.key,{key:i},e,n).catch(()=>{});if(o&&Os(i,o,e))throw Error("Primary key is expired")})}getExpirationTime(n){return x(this,arguments,function*(e,t=dt){let i;try{let{selfCertification:a}=yield this.getPrimaryUser(null,e,t),o=Ta(this.keyPacket,a),s=a.getExpirationTime(),h=yield Ye(this.directSignatures,this.keyPacket,d.signature.key,{key:this.keyPacket},null,t).catch(()=>{});if(h){let c=Ta(this.keyPacket,h);i=Math.min(o,s,c)}else i=o<s?o:s}catch{i=null}return b.normalizeDate(i)})}getPrimaryUser(){return x(this,arguments,function*(e=new Date,t={},n=dt){let i=this.keyPacket,a=[],o;for(let u=0;u<this.users.length;u++)try{let y=this.users[u];if(!y.userID)continue;if(t.name!==void 0&&y.userID.name!==t.name||t.email!==void 0&&y.userID.email!==t.email||t.comment!==void 0&&y.userID.comment!==t.comment)throw Error("Could not find user that matches that user ID");let m={userID:y.userID,key:i},p=yield Ye(y.selfCertifications,i,d.signature.certGeneric,m,e,n);a.push({index:u,user:y,selfCertification:p})}catch(y){o=y}if(!a.length)throw o||Error("Could not find primary user");yield Promise.all(a.map(function(u){return x(this,null,function*(){return u.selfCertification.revoked||u.user.isRevoked(u.selfCertification,null,e,n)})}));let s=a.sort(function(u,y){let m=u.selfCertification,p=y.selfCertification;return p.revoked-m.revoked||m.isPrimaryUserID-p.isPrimaryUserID||m.created-p.created}).pop(),{user:h,selfCertification:c}=s;if(c.revoked||(yield h.isRevoked(c,null,e,n)))throw Error("Primary user is revoked");return s})}update(i){return x(this,arguments,function*(e,t=new Date,n=dt){if(!this.hasSameFingerprintAs(e))throw Error("Primary key fingerprints must be equal to update the key");if(!this.isPrivate()&&e.isPrivate()){if(!(this.subkeys.length===e.subkeys.length&&this.subkeys.every(o=>e.subkeys.some(s=>o.hasSameFingerprintAs(s)))))throw Error("Cannot update public key with private key if subkeys mismatch");return e.update(this,n)}let a=this.clone();return yield nn(e,a,"revocationSignatures",t,o=>In(a.keyPacket,d.signature.keyRevocation,a,[o],null,e.keyPacket,t,n)),yield nn(e,a,"directSignatures",t),yield Promise.all(e.users.map(o=>x(this,null,function*(){let s=a.users.filter(h=>o.userID&&o.userID.equals(h.userID)||o.userAttribute&&o.userAttribute.equals(h.userAttribute));if(s.length>0)yield Promise.all(s.map(h=>h.update(o,t,n)));else{let h=o.clone();h.mainKey=a,a.users.push(h)}}))),yield Promise.all(e.subkeys.map(o=>x(this,null,function*(){let s=a.subkeys.filter(h=>h.hasSameFingerprintAs(o));if(s.length>0)yield Promise.all(s.map(h=>h.update(o,t,n)));else{let h=o.clone();h.mainKey=a,a.subkeys.push(h)}}))),a})}getRevocationCertificate(){return x(this,arguments,function*(e=new Date,t=dt){let n={key:this.keyPacket},i=yield Ye(this.revocationSignatures,this.keyPacket,d.signature.keyRevocation,n,e,t),a=new Gt;return a.push(i),Di(d.armor.publicKey,a.write(),null,null,"This is a revocation certificate")})}applyRevocationCertificate(i){return x(this,arguments,function*(e,t=new Date,n=dt){let a=yield Ui(e,n),o=(yield Gt.fromBinary(a.data,Tc,n)).findPacket(d.packet.signature);if(!o||o.signatureType!==d.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!o.issuerKeyID.equals(this.getKeyID()))throw Error("Revocation signature does not match key");try{yield o.verify(this.keyPacket,d.signature.keyRevocation,{key:this.keyPacket},t,void 0,n)}catch(h){throw b.wrapError("Could not verify revocation signature",h)}let s=this.clone();return s.revocationSignatures.push(o),s})}signPrimaryUser(a,o,s){return x(this,arguments,function*(e,t,n,i=dt){let{index:h,user:c}=yield this.getPrimaryUser(t,n,i),u=yield c.certify(e,t,i),y=this.clone();return y.users[h]=u,y})}signAllUsers(i){return x(this,arguments,function*(e,t=new Date,n=dt){let a=this.clone();return a.users=yield Promise.all(this.users.map(function(o){return o.certify(e,t,n)})),a})}verifyPrimaryUser(a){return x(this,arguments,function*(e,t=new Date,n,i=dt){let o=this.keyPacket,{user:s}=yield this.getPrimaryUser(t,n,i);return e?yield s.verifyAllCertifications(e,t,i):[{keyID:o.getKeyID(),valid:yield s.verify(t,i).catch(()=>!1)}]})}verifyAllUsers(i){return x(this,arguments,function*(e,t=new Date,n=dt){let a=this.keyPacket,o=[];return yield Promise.all(this.users.map(s=>x(this,null,function*(){let h=e?yield s.verifyAllCertifications(e,t,n):[{keyID:a.getKeyID(),valid:yield s.verify(t,n).catch(()=>!1)}];o.push(...h.map(c=>({userID:s.userID?s.userID.userID:null,userAttribute:s.userAttribute,keyID:c.keyID,valid:c.valid})))}))),o})}};["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach(r=>{Ba.prototype[r]=_i.prototype[r]});var Ki=class extends Ba{constructor(e){if(super(),this.keyPacket=null,this.revocationSignatures=[],this.directSignatures=[],this.users=[],this.subkeys=[],e&&(this.packetListToStructure(e,new Set([d.packet.secretKey,d.packet.secretSubkey])),!this.keyPacket))throw Error("Invalid key: missing public-key packet")}isPrivate(){return!1}toPublic(){return this}armor(e=dt){return Di(d.armor.publicKey,this.toPacketList().write(),void 0,void 0,void 0,e)}},Si=class r extends Ki{constructor(e){if(super(),this.packetListToStructure(e,new Set([d.packet.publicKey,d.packet.publicSubkey])),!this.keyPacket)throw Error("Invalid key: missing private-key packet")}isPrivate(){return!0}toPublic(){let e=new Gt,t=this.toPacketList();for(let n of t)switch(n.constructor.tag){case d.packet.secretKey:{let i=ar.fromSecretKeyPacket(n);e.push(i);break}case d.packet.secretSubkey:{let i=Ua.fromSecretSubkeyPacket(n);e.push(i);break}default:e.push(n)}return new Ki(e)}armor(e=dt){return Di(d.armor.privateKey,this.toPacketList().write(),void 0,void 0,void 0,e)}getDecryptionKeys(a){return x(this,arguments,function*(e,t=new Date,n={},i=dt){let o=this.keyPacket,s=[];for(let c=0;c<this.subkeys.length;c++)if(!e||this.subkeys[c].getKeyID().equals(e,!0))try{let u={key:o,bind:this.subkeys[c].keyPacket};H0(yield Ye(this.subkeys[c].bindingSignatures,o,d.signature.subkeyBinding,u,t,i),i)&&s.push(this.subkeys[c])}catch{}let h=yield this.getPrimaryUser(t,n,i);return e&&!o.getKeyID().equals(e,!0)||!H0(h.selfCertification,i)||s.push(this),s})}isDecrypted(){return this.getKeys().some(({keyPacket:e})=>e.isDecrypted())}validate(){return x(this,arguments,function*(e=dt){if(!this.isPrivate())throw Error("Cannot validate a public key");let t;if(this.keyPacket.isDummy()){let n=yield this.getSigningKey(null,null,void 0,c1(ae({},e),{rejectPublicKeyAlgorithms:new Set,minRSABits:0}));n&&!n.keyPacket.isDummy()&&(t=n.keyPacket)}else t=this.keyPacket;if(t)return t.validate();{let n=this.getKeys();if(n.map(i=>i.keyPacket.isDummy()).every(Boolean))throw Error("Cannot validate an all-gnu-dummy key");return Promise.all(n.map(i=>x(this,null,function*(){return i.keyPacket.validate()})))}})}clearPrivateParams(){this.getKeys().forEach(({keyPacket:e})=>{e.isDecrypted()&&e.clearPrivateParams()})}revoke(){return x(this,arguments,function*({flag:e=d.reasonForRevocation.noReason,string:t=""}={},n=new Date,i=dt){if(!this.isPrivate())throw Error("Need private key for revoking");let a={key:this.keyPacket},o=this.clone();return o.revocationSignatures.push(yield xr(a,null,this.keyPacket,{signatureType:d.signature.keyRevocation,reasonForRevocationFlag:d.write(d.reasonForRevocation,e),reasonForRevocationString:t},n,void 0,void 0,void 0,i)),o})}addSubkey(){return x(this,arguments,function*(e={}){let t=ae(ae({},dt),e.config);if(e.passphrase)throw Error("Subkey could not be encrypted here, please encrypt whole key");if(e.rsaBits<t.minRSABits)throw Error(`rsaBits should be at least ${t.minRSABits}, got: ${e.rsaBits}`);let n=this.keyPacket;if(n.isDummy())throw Error("Cannot add subkey to gnu-dummy primary key");if(!n.isDecrypted())throw Error("Key is not decrypted");let i=n.getAlgorithmInfo();i.type=i.curve?"ecc":"rsa",i.rsaBits=i.bits||4096,i.curve=i.curve||"curve25519",e=Hs(e,i);let a=yield ro(e);Sn(a,t);let o=yield no(a,n,e,t),s=this.toPacketList();return s.push(a,o),new r(s)})}},ao=b.constructAllowedPackets([ar,Ua,Ei,Ca,Da,Ns,Ae]);function Bc(r){for(let e of r)switch(e.constructor.tag){case d.packet.secretKey:return new Si(r);case d.packet.publicKey:return new Ki(r)}throw Error("No key packet found")}function zc(r,e,t,n){return x(this,null,function*(){t.passphrase&&(yield r.encrypt(t.passphrase,n)),yield Promise.all(e.map(function(o,s){return x(this,null,function*(){let h=t.subkeys[s].passphrase;h&&(yield o.encrypt(h,n))})}));let i=new Gt;i.push(r),yield Promise.all(t.userIDs.map(function(o,s){return x(this,null,function*(){function h(m,p){return[p,...m.filter(_=>_!==p)]}let c=Da.fromObject(o),u={};u.userID=c,u.key=r;let y={};return y.signatureType=d.signature.certGeneric,y.keyFlags=[d.keyFlags.certifyKeys|d.keyFlags.signData],y.preferredSymmetricAlgorithms=h([d.symmetric.aes256,d.symmetric.aes128,d.symmetric.aes192],n.preferredSymmetricAlgorithm),n.aeadProtect&&(y.preferredAEADAlgorithms=h([d.aead.eax,d.aead.ocb],n.preferredAEADAlgorithm)),y.preferredHashAlgorithms=h([d.hash.sha256,d.hash.sha512],n.preferredHashAlgorithm),y.preferredCompressionAlgorithms=h([d.compression.zlib,d.compression.zip,d.compression.uncompressed],n.preferredCompressionAlgorithm),s===0&&(y.isPrimaryUserID=!0),y.features=[0],y.features[0]|=d.features.modificationDetection,n.aeadProtect&&(y.features[0]|=d.features.aead),n.v5Keys&&(y.features[0]|=d.features.v5Keys),t.keyExpirationTime>0&&(y.keyExpirationTime=t.keyExpirationTime,y.keyNeverExpires=!1),{userIDPacket:c,signaturePacket:yield xr(u,null,r,y,t.date,void 0,void 0,void 0,n)}})})).then(o=>{o.forEach(({userIDPacket:s,signaturePacket:h})=>{i.push(s),i.push(h)})}),yield Promise.all(e.map(function(o,s){return x(this,null,function*(){let h=t.subkeys[s];return{secretSubkeyPacket:o,subkeySignaturePacket:yield no(o,r,h,n)}})})).then(o=>{o.forEach(({secretSubkeyPacket:s,subkeySignaturePacket:h})=>{i.push(s),i.push(h)})});let a={key:r};return i.push(yield xr(a,null,r,{signatureType:d.signature.keyRevocation,reasonForRevocationFlag:d.reasonForRevocation.noReason,reasonForRevocationString:""},t.date,void 0,void 0,void 0,n)),t.passphrase&&r.clearPrivateParams(),yield Promise.all(e.map(function(o,s){return x(this,null,function*(){t.subkeys[s].passphrase&&o.clearPrivateParams()})})),new Si(i)})}function qc(i){return x(this,null,function*(){var a=i,{armoredKey:r,binaryKey:e,config:t}=a,n=Pr(a,["armoredKey","binaryKey","config"]);if(t=ae(ae({},dt),t),!r&&!e)throw Error("readKey: must pass options object containing `armoredKey` or `binaryKey`");if(r&&!b.isString(r))throw Error("readKey: options.armoredKey must be a string");if(e&&!b.isUint8Array(e))throw Error("readKey: options.binaryKey must be a Uint8Array");let o=Object.keys(n);if(o.length>0)throw Error("Unknown option: "+o.join(", "));let s;if(r){let{type:h,data:c}=yield Ui(r,t);if(h!==d.armor.publicKey&&h!==d.armor.privateKey)throw Error("Armored text not of type key");s=c}else s=e;return Bc(yield Gt.fromBinary(s,ao,t))})}function Gc(i){return x(this,null,function*(){var a=i,{armoredKey:r,binaryKey:e,config:t}=a,n=Pr(a,["armoredKey","binaryKey","config"]);if(t=ae(ae({},dt),t),!r&&!e)throw Error("readPrivateKey: must pass options object containing `armoredKey` or `binaryKey`");if(r&&!b.isString(r))throw Error("readPrivateKey: options.armoredKey must be a string");if(e&&!b.isUint8Array(e))throw Error("readPrivateKey: options.binaryKey must be a Uint8Array");let o=Object.keys(n);if(o.length>0)throw Error("Unknown option: "+o.join(", "));let s;if(r){let{type:c,data:u}=yield Ui(r,t);if(c!==d.armor.privateKey)throw Error("Armored text not of type private key");s=u}else s=e;let h=yield Gt.fromBinary(s,ao,t);return new Si(h)})}var Rc=b.constructAllowedPackets([qr,hn,Pa,xa,Ls,vi,Ai,Ie,Ae]),Mc=b.constructAllowedPackets([Ai]),Lc=b.constructAllowedPackets([Ae]),xi=class r{constructor(e){this.packets=e||new Gt}getEncryptionKeyIDs(){let e=[];return this.packets.filterByTag(d.packet.publicKeyEncryptedSessionKey).forEach(function(t){e.push(t.publicKeyID)}),e}getSigningKeyIDs(){let e=this.unwrapCompressed(),t=e.packets.filterByTag(d.packet.onePassSignature);return t.length>0?t.map(n=>n.issuerKeyID):e.packets.filterByTag(d.packet.signature).map(n=>n.issuerKeyID)}decrypt(o,s,h){return x(this,arguments,function*(e,t,n,i=new Date,a=dt){let c=n||(yield this.decryptSessionKeys(e,t,i,a)),u=this.packets.filterByTag(d.packet.symmetricallyEncryptedData,d.packet.symEncryptedIntegrityProtectedData,d.packet.aeadEncryptedData);if(u.length===0)throw Error("No encrypted data found");let y=u[0],m=null,p=Promise.all(c.map(O=>x(this,[O],function*({algorithm:S,data:L}){if(!b.isUint8Array(L)||!b.isString(S))throw Error("Invalid session key for decryption.");try{let X=d.write(d.symmetric,S);yield y.decrypt(X,L,a)}catch(X){b.printDebugError(X),m=X}})));if(As(y.encrypted),y.encrypted=null,yield p,!y.packets||!y.packets.length)throw m||Error("Decryption failed.");let _=new r(y.packets);return y.packets=new Gt,_})}decryptSessionKeys(a,o){return x(this,arguments,function*(e,t,n=new Date,i=dt){let s,h=[];if(t){let c=this.packets.filterByTag(d.packet.symEncryptedSessionKey);if(c.length===0)throw Error("No symmetrically encrypted session key packet found.");yield Promise.all(t.map(function(u,y){return x(this,null,function*(){let m;m=y?yield Gt.fromBinary(c.write(),Mc,i):c,yield Promise.all(m.map(function(p){return x(this,null,function*(){try{yield p.decrypt(u),h.push(p)}catch(_){b.printDebugError(_)}})}))})}))}else{if(!e)throw Error("No key or password specified.");{let c=this.packets.filterByTag(d.packet.publicKeyEncryptedSessionKey);if(c.length===0)throw Error("No public key encrypted session key packet found.");yield Promise.all(c.map(function(u){return x(this,null,function*(){yield Promise.all(e.map(function(y){return x(this,null,function*(){let m=[d.symmetric.aes256,d.symmetric.aes128,d.symmetric.tripledes,d.symmetric.cast5];try{let _=yield y.getPrimaryUser(n,void 0,i);_.selfCertification.preferredSymmetricAlgorithms&&(m=m.concat(_.selfCertification.preferredSymmetricAlgorithms))}catch{}let p=(yield y.getDecryptionKeys(u.publicKeyID,null,void 0,i)).map(_=>_.keyPacket);yield Promise.all(p.map(function(_){return x(this,null,function*(){if(!(!_||_.isDummy())){if(!_.isDecrypted())throw Error("Decryption key is not decrypted.");if(i.constantTimePKCS1Decryption&&(u.publicKeyAlgorithm===d.publicKey.rsaEncrypt||u.publicKeyAlgorithm===d.publicKey.rsaEncryptSign||u.publicKeyAlgorithm===d.publicKey.rsaSign||u.publicKeyAlgorithm===d.publicKey.elgamal)){let S=u.write();yield Promise.all(Array.from(i.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms).map(L=>x(this,null,function*(){let O=new vi;O.read(S);let X={sessionKeyAlgorithm:L,sessionKey:wt.generateSessionKey(L)};try{yield O.decrypt(_,X),h.push(O)}catch(N){b.printDebugError(N),s=N}})))}else try{if(yield u.decrypt(_),!m.includes(d.write(d.symmetric,u.sessionKeyAlgorithm)))throw Error("A non-preferred symmetric algorithm was used.");h.push(u)}catch(S){b.printDebugError(S),s=S}}})}))})})),As(u.encrypted),u.encrypted=null})}))}}if(h.length>0){if(h.length>1){let c=new Set;h=h.filter(u=>{let y=u.sessionKeyAlgorithm+b.uint8ArrayToString(u.sessionKey);return!c.has(y)&&(c.add(y),!0)})}return h.map(c=>({data:c.sessionKey,algorithm:d.read(d.symmetric,c.sessionKeyAlgorithm)}))}throw s||Error("Session key decryption failed.")})}getLiteralData(){let e=this.unwrapCompressed().packets.findPacket(d.packet.literalData);return e&&e.getBytes()||null}getFilename(){let e=this.unwrapCompressed().packets.findPacket(d.packet.literalData);return e&&e.getFilename()||null}getText(){let e=this.unwrapCompressed().packets.findPacket(d.packet.literalData);return e?e.getText():null}static generateSessionKey(){return x(this,arguments,function*(e=[],t=new Date,n=[],i=dt){let a=yield Fs("symmetric",e,t,n,i),o=d.read(d.symmetric,a),s=i.aeadProtect&&(yield function(m){return x(this,arguments,function*(h,c=new Date,u=[],y=dt){let p=!0;return yield Promise.all(h.map(function(_,S){return x(this,null,function*(){let L=yield _.getPrimaryUser(c,u[S],y);L.selfCertification.features&&L.selfCertification.features[0]&d.features.aead||(p=!1)})})),p})}(e,t,n,i))?d.read(d.aead,yield Fs("aead",e,t,n,i)):void 0;return yield Promise.all(e.map(h=>h.getEncryptionKey().catch(()=>null).then(c=>{if(c&&c.keyPacket.algorithm===d.publicKey.x25519&&!b.isAES(a))throw Error("Could not generate a session key compatible with the given `encryptionKeys`: X22519 keys can only be used to encrypt AES session keys; change `config.preferredSymmetricAlgorithm` accordingly.")}))),{data:wt.generateSessionKey(a),algorithm:o,aeadAlgorithm:s}})}encrypt(c,u,y){return x(this,arguments,function*(e,t,n,i=!1,a=[],o=new Date,s=[],h=dt){if(n){if(!b.isUint8Array(n.data)||!b.isString(n.algorithm))throw Error("Invalid session key for encryption.")}else if(e&&e.length)n=yield r.generateSessionKey(e,o,s,h);else{if(!t||!t.length)throw Error("No keys, passwords, or session key provided.");n=yield r.generateSessionKey(void 0,void 0,void 0,h)}let{data:m,algorithm:p,aeadAlgorithm:_}=n,S=yield r.encryptSessionKey(m,p,_,e,t,i,a,o,s,h),L;_?(L=new Pa,L.aeadAlgorithm=d.write(d.aead,_)):L=new xa,L.packets=this.packets;let O=d.write(d.symmetric,p);return yield L.encrypt(O,m,h),S.packets.push(L),L.packets=new Gt,S})}static encryptSessionKey(y,m,p,_,S){return x(this,arguments,function*(e,t,n,i,a,o=!1,s=[],h=new Date,c=[],u=dt){let L=new Gt,O=d.write(d.symmetric,t),X=n&&d.write(d.aead,n);if(i){let N=yield Promise.all(i.map(function(K,$){return x(this,null,function*(){let q=yield K.getEncryptionKey(s[$],h,c,u),j=new vi;return j.publicKeyID=o?sn.wildcard():q.getKeyID(),j.publicKeyAlgorithm=q.keyPacket.algorithm,j.sessionKey=e,j.sessionKeyAlgorithm=O,yield j.encrypt(q.keyPacket),delete j.sessionKey,j})}));L.push(...N)}if(a){let N=function(j,Z){return x(this,null,function*(){try{return yield j.decrypt(Z),1}catch{return 0}})},K=(j,Z)=>j+Z,$=function(j,Z,J,rt){return x(this,null,function*(){let yt=new Ai(u);return yt.sessionKey=j,yt.sessionKeyAlgorithm=Z,J&&(yt.aeadAlgorithm=J),yield yt.encrypt(rt,u),u.passwordCollisionCheck&&(yield Promise.all(a.map(pt=>N(yt,pt)))).reduce(K)!==1?$(j,Z,rt):(delete yt.sessionKey,yt)})},q=yield Promise.all(a.map(j=>$(e,O,X,j)));L.push(...q)}return new r(L)})}sign(){return x(this,arguments,function*(e=[],t=null,n=[],i=new Date,a=[],o=[],s=dt){let h=new Gt,c=this.packets.findPacket(d.packet.literalData);if(!c)throw Error("No literal data packet to sign.");let u,y,m=c.text===null?d.signature.binary:d.signature.text;if(t)for(y=t.packets.filterByTag(d.packet.signature),u=y.length-1;u>=0;u--){let p=y[u],_=new Ie;_.signatureType=p.signatureType,_.hashAlgorithm=p.hashAlgorithm,_.publicKeyAlgorithm=p.publicKeyAlgorithm,_.issuerKeyID=p.issuerKeyID,e.length||u!==0||(_.flags=1),h.push(_)}return yield Promise.all(Array.from(e).reverse().map(function(p,_){return x(this,null,function*(){if(!p.isPrivate())throw Error("Need private key for signing");let S=n[e.length-1-_],L=yield p.getSigningKey(S,i,a,s),O=new Ie;return O.signatureType=m,O.hashAlgorithm=yield io(p,L.keyPacket,i,a,s),O.publicKeyAlgorithm=L.keyPacket.algorithm,O.issuerKeyID=L.getKeyID(),_===e.length-1&&(O.flags=1),O})})).then(p=>{p.forEach(_=>h.push(_))}),h.push(c),h.push(...yield G0(c,e,t,n,i,a,o,!1,s)),new r(h)})}compress(e,t=dt){if(e===d.compression.uncompressed)return this;let n=new hn(t);n.algorithm=e,n.packets=this.packets;let i=new Gt;return i.push(n),new r(i)}signDetached(){return x(this,arguments,function*(e=[],t=null,n=[],i=new Date,a=[],o=[],s=dt){let h=this.packets.findPacket(d.packet.literalData);if(!h)throw Error("No literal data packet to sign.");return new Ia(yield G0(h,e,t,n,i,a,o,!0,s))})}verify(i){return x(this,arguments,function*(e,t=new Date,n=dt){let a=this.unwrapCompressed(),o=a.packets.filterByTag(d.packet.literalData);if(o.length!==1)throw Error("Can only verify message with one literal data packet.");re(a.packets.stream)&&a.packets.push(...yield ie(a.packets.stream,c=>c||[]));let s=a.packets.filterByTag(d.packet.onePassSignature).reverse(),h=a.packets.filterByTag(d.packet.signature);return s.length&&!h.length&&b.isStream(a.packets.stream)&&!re(a.packets.stream)?(yield Promise.all(s.map(c=>x(this,null,function*(){c.correspondingSig=new Promise((u,y)=>{c.correspondingSigResolve=u,c.correspondingSigReject=y}),c.signatureData=Gr(()=>x(this,null,function*(){return(yield c.correspondingSig).signatureData})),c.hashed=ie(yield c.hash(c.signatureType,o[0],void 0,!1)),c.hashed.catch(()=>{})}))),a.packets.stream=_r(a.packets.stream,(c,u)=>x(this,null,function*(){let y=yr(c),m=xe(u);try{for(let p=0;p<s.length;p++){let{value:_}=yield y.read();s[p].correspondingSigResolve(_)}yield y.readToEnd(),yield m.ready,yield m.close()}catch(p){s.forEach(_=>{_.correspondingSigReject(p)}),yield m.abort(p)}})),ks(s,o,e,t,!1,n)):ks(h,o,e,t,!1,n)})}verifyDetached(e,t,n=new Date,i=dt){let a=this.unwrapCompressed().packets.filterByTag(d.packet.literalData);if(a.length!==1)throw Error("Can only verify message with one literal data packet.");return ks(e.packets.filterByTag(d.packet.signature),a,t,n,!0,i)}unwrapCompressed(){let e=this.packets.filterByTag(d.packet.compressedData);return e.length?new r(e[0].packets):this}appendSignature(n){return x(this,arguments,function*(e,t=dt){yield this.packets.read(b.isUint8Array(e)?e:(yield Ui(e)).data,Lc,t)})}write(){return this.packets.write()}armor(e=dt){return Di(d.armor.message,this.write(),null,null,null,e)}};function G0(c,u){return x(this,arguments,function*(r,e,t=null,n=[],i=new Date,a=[],o=[],s=!1,h=dt){let y=new Gt,m=r.text===null?d.signature.binary:d.signature.text;if(yield Promise.all(e.map((p,_)=>x(this,null,function*(){let S=a[_];if(!p.isPrivate())throw Error("Need private key for signing");let L=yield p.getSigningKey(n[_],i,S,h);return xr(r,p,L.keyPacket,{signatureType:m},i,S,o,s,h)}))).then(p=>{y.push(...p)}),t){let p=t.packets.filterByTag(d.packet.signature);y.push(...p)}return y})}function ks(o,s,h){return x(this,arguments,function*(r,e,t,n=new Date,i=!1,a=dt){return Promise.all(r.filter(function(c){return["text","binary"].includes(d.read(d.signature,c.signatureType))}).map(function(c){return x(this,null,function*(){return function(L,O,X){return x(this,arguments,function*(u,y,m,p=new Date,_=!1,S=dt){let N,K;for(let j of m){let Z=j.getKeys(u.issuerKeyID);if(Z.length>0){N=j,K=Z[0];break}}let $=u instanceof Ie?u.correspondingSig:u,q={keyID:u.issuerKeyID,verified:x(this,null,function*(){if(!K)throw Error("Could not find signing key with key ID "+u.issuerKeyID.toHex());yield u.verify(K.keyPacket,u.signatureType,y[0],p,_,S);let j=yield $;if(K.getCreationTime()>j.created)throw Error("Key is newer than the signature");try{yield N.getSigningKey(K.getKeyID(),j.created,void 0,S)}catch(Z){if(!S.allowInsecureVerificationWithReformattedKeys||!Z.message.match(/Signature creation time is in the future/))throw Z;yield N.getSigningKey(K.getKeyID(),p,void 0,S)}return!0}),signature:x(this,null,function*(){let j=yield $,Z=new Gt;return j&&Z.push(j),new Ia(Z)})};return q.signature.catch(()=>{}),q.verified.catch(()=>{}),q})}(c,e,t,n,i,a)})}))})}function Wc(i){return x(this,null,function*(){var a=i,{armoredMessage:r,binaryMessage:e,config:t}=a,n=Pr(a,["armoredMessage","binaryMessage","config"]);t=ae(ae({},dt),t);let o=r||e;if(!o)throw Error("readMessage: must pass options object containing `armoredMessage` or `binaryMessage`");if(r&&!b.isString(r)&&!b.isStream(r))throw Error("readMessage: options.armoredMessage must be a string or stream");if(e&&!b.isUint8Array(e)&&!b.isStream(e))throw Error("readMessage: options.binaryMessage must be a Uint8Array or stream");let s=Object.keys(n);if(s.length>0)throw Error("Unknown option: "+s.join(", "));let h=b.isStream(o);if(h&&(yield Y0(),o=Pi(o)),r){let{type:y,data:m}=yield Ui(o,t);if(y!==d.armor.message)throw Error("Armored text not of type message");o=m}let c=yield Gt.fromBinary(o,Rc,t),u=new xi(c);return u.fromStream=h,u})}function Vc(o){return x(this,null,function*(){var s=o,{text:r,binary:e,filename:t,date:n=new Date,format:i=r!==void 0?"utf8":"binary"}=s,a=Pr(s,["text","binary","filename","date","format"]);let h=r!==void 0?r:e;if(h===void 0)throw Error("createMessage: must pass options object containing `text` or `binary`");if(r&&!b.isString(r)&&!b.isStream(r))throw Error("createMessage: options.text must be a string or stream");if(e&&!b.isUint8Array(e)&&!b.isStream(e))throw Error("createMessage: options.binary must be a Uint8Array or stream");let c=Object.keys(a);if(c.length>0)throw Error("Unknown option: "+c.join(", "));let u=b.isStream(h);u&&(yield Y0(),h=Pi(h));let y=new qr(n);r!==void 0?y.setText(h,d.write(d.literal,i)):y.setBytes(h,d.write(d.literal,i)),t!==void 0&&y.setFilename(t);let m=new Gt;m.push(y);let p=new xi(m);return p.fromStream=u,p})}function $c(y){return x(this,null,function*(){var m=y,{userIDs:r=[],passphrase:e,type:t="ecc",rsaBits:n=4096,curve:i="curve25519",keyExpirationTime:a=0,date:o=new Date,subkeys:s=[{}],format:h="armored",config:c}=m,u=Pr(m,["userIDs","passphrase","type","rsaBits","curve","keyExpirationTime","date","subkeys","format","config"]);i1(c=ae(ae({},dt),c)),r=Ue(r);let p=Object.keys(u);if(p.length>0)throw Error("Unknown option: "+p.join(", "));if(r.length===0)throw Error("UserIDs are required for key generation");if(t==="rsa"&&n<c.minRSABits)throw Error(`rsaBits should be at least ${c.minRSABits}, got: ${n}`);let _={userIDs:r,passphrase:e,type:t,rsaBits:n,curve:i,keyExpirationTime:a,date:o,subkeys:s};try{let{key:S,revocationCertificate:L}=yield function(O,X){return x(this,null,function*(){O.sign=!0,(O=Hs(O)).subkeys=O.subkeys.map((j,Z)=>Hs(O.subkeys[Z],O));let N=[Ic(O,X)];N=N.concat(O.subkeys.map(j=>ro(j,X)));let K=yield Promise.all(N),$=yield zc(K[0],K.slice(1),O,X),q=yield $.getRevocationCertificate(O.date,X);return $.revocationSignatures=[],{key:$,revocationCertificate:q}})}(_,c);return S.getKeys().forEach(({keyPacket:O})=>Sn(O,c)),{privateKey:W0(S,h,c),publicKey:W0(S.toPublic(),h,c),revocationCertificate:L}}catch(S){throw b.wrapError("Error generating keypair",S)}})}function Zc(L){return x(this,null,function*(){var O=L,{message:r,encryptionKeys:e,signingKeys:t,passwords:n,sessionKey:i,format:a="armored",signature:o=null,wildcard:s=!1,signingKeyIDs:h=[],encryptionKeyIDs:c=[],date:u=new Date,signingUserIDs:y=[],encryptionUserIDs:m=[],signatureNotations:p=[],config:_}=O,S=Pr(O,["message","encryptionKeys","signingKeys","passwords","sessionKey","format","signature","wildcard","signingKeyIDs","encryptionKeyIDs","date","signingUserIDs","encryptionUserIDs","signatureNotations","config"]);if(i1(_=ae(ae({},dt),_)),so(r),Nc(a),e=Ue(e),t=Ue(t),n=Ue(n),h=Ue(h),c=Ue(c),y=Ue(y),m=Ue(m),p=Ue(p),S.detached)throw Error("The `detached` option has been removed from openpgp.encrypt, separately call openpgp.sign instead. Don't forget to remove the `privateKeys` option as well.");if(S.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encrypt, pass `encryptionKeys` instead");if(S.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.encrypt, pass `signingKeys` instead");if(S.armor!==void 0)throw Error("The `armor` option has been removed from openpgp.encrypt, pass `format` instead.");let X=Object.keys(S);if(X.length>0)throw Error("Unknown option: "+X.join(", "));t||(t=[]);let N=r.fromStream;try{if((t.length||o)&&(r=yield r.sign(t,o,h,u,y,p,_)),r=r.compress(yield Fs("compression",e,u,m,_),_),r=yield r.encrypt(e,n,i,s,c,u,m,_),a==="object")return r;let K=a==="armored";return oo(K?r.armor(_):r.write(),N,K?"utf8":"binary")}catch(K){throw b.wrapError("Error encrypting message",K)}})}function Xc(y){return x(this,null,function*(){var m=y,{message:r,decryptionKeys:e,passwords:t,sessionKeys:n,verificationKeys:i,expectSigned:a=!1,format:o="utf8",signature:s=null,date:h=new Date,config:c}=m,u=Pr(m,["message","decryptionKeys","passwords","sessionKeys","verificationKeys","expectSigned","format","signature","date","config"]);if(i1(c=ae(ae({},dt),c)),so(r),i=Ue(i),e=Ue(e),t=Ue(t),n=Ue(n),u.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decrypt, pass `decryptionKeys` instead");if(u.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.decrypt, pass `verificationKeys` instead");let p=Object.keys(u);if(p.length>0)throw Error("Unknown option: "+p.join(", "));try{let _=yield r.decrypt(e,t,n,h,c);i||(i=[]);let S={};if(S.signatures=s?yield _.verifyDetached(s,i,h,c):yield _.verify(i,h,c),S.data=o==="binary"?_.getLiteralData():_.getText(),S.filename=_.getFilename(),Fc(S,r),a){if(i.length===0)throw Error("Verification keys are required to verify message signatures");if(S.signatures.length===0)throw Error("Message is not signed");S.data=Ke([S.data,Gr(()=>x(this,null,function*(){yield b.anyPromise(S.signatures.map(L=>L.verified))}))])}return S.data=yield oo(S.data,r.fromStream,o),S}catch(_){throw b.wrapError("Error decrypting message",_)}})}function so(r){if(!(r instanceof xi))throw Error("Parameter [message] needs to be of type Message")}function Nc(r){if(r!=="armored"&&r!=="binary"&&r!=="object")throw Error("Unsupported format "+r)}var Oc=Object.keys(dt).length;function i1(r){let e=Object.keys(r);if(e.length!==Oc){for(let t of e)if(dt[t]===void 0)throw Error("Unknown config property: "+t)}}function Ue(r){return r&&!b.isArray(r)&&(r=[r]),r}function oo(r,e,t="utf8"){return x(this,null,function*(){let n=b.isStream(r);return n==="array"?ie(r):e==="node"?(r=qs(r),t!=="binary"&&r.setEncoding(t),r):e==="web"&&n==="ponyfill"?X0(r):r})}function Fc(r,e){r.data=_r(e.packets.stream,(t,n)=>x(this,null,function*(){yield Hr(r.data,n,{preventClose:!0});let i=xe(n);try{yield ie(t,a=>a),yield i.close()}catch(a){yield i.abort(a)}}))}function W0(r,e,t){switch(e){case"object":return r;case"armored":return r.armor(t);case"binary":return r.write();default:throw Error("Unsupported format "+e)}}export{Na as a,Hc as b,Vs as c,ko as d,Tt as e,$s as f,Tn as g,d2 as h,Mo as i,Ii as j,e3 as k,jc as l,qc as m,Gc as n,Wc as o,Vc as p,$c as q,Zc as r,Xc as s};
