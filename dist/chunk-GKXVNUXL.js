import{B as nf,C as rf,a as Fe,b as Ye,c as ae,d as Me,e as Ae,f as $e,h as fe,i as me,j as We,k as Je,l as W,m as Qe,n as Xe,p as we,t as Ne,u as _e,v as ef,y as ff,z as tf}from"./chunk-I74WP37C.js";import{a as Q,b as _}from"./chunk-GAL4ENT6.js";var ke=BigInt(0),Ce=BigInt(1);function re(f,t){if(typeof t!="boolean")throw Error(f+" boolean expected, got "+t)}function Be(f){let t=f.toString(16);return 1&t.length?"0"+t:t}function Bf(f){if(typeof f!="string")throw Error("hex string expected, got "+typeof f);return f===""?ke:BigInt("0x"+f)}function ve(f){return Bf(fe(f))}function ie(f){return ae(f),Bf(fe(Uint8Array.from(f).reverse()))}function je(f,t){return me(f.toString(16).padStart(2*t,"0"))}function ye(f,t){return je(f,t).reverse()}function T(f,t,e){let r;if(typeof t=="string")try{r=me(t)}catch(o){throw Error(f+" must be hex string or Uint8Array, cause: "+o)}else{if(!Fe(t))throw Error(f+" must be hex string or Uint8Array");r=Uint8Array.from(t)}let i=r.length;if(typeof e=="number"&&i!==e)throw Error(f+" of length "+e+" expected, got "+i);return r}var Pe=f=>typeof f=="bigint"&&ke<=f;function ee(f,t,e,r){if(!function(i,o,a){return Pe(i)&&Pe(o)&&Pe(a)&&o<=i&&i<a}(t,e,r))throw Error("expected valid "+f+": "+e+" <= n < "+r+", got "+t)}var Re=f=>(Ce<<BigInt(f))-Ce;function ue(f,t,e={}){if(!f||typeof f!="object")throw Error("expected valid options object");function r(i,o,a){let s=f[i];if(a&&s===void 0)return;let b=typeof s;if(b!==o||s===null)throw Error(`param "${i}" is invalid: expected ${o}, got ${b}`)}Object.entries(t).forEach(([i,o])=>r(i,o,!1)),Object.entries(e).forEach(([i,o])=>r(i,o,!0))}function Ie(f){let t=new WeakMap;return(e,...r)=>{let i=t.get(e);if(i!==void 0)return i;let o=f(e,...r);return t.set(e,o),o}}var M=BigInt(0),D=BigInt(1),te=BigInt(2),Tf=BigInt(3),Ef=BigInt(4),xf=BigInt(5),vf=BigInt(8);function L(f,t){let e=f%t;return e>=M?e:t+e}function j(f,t,e){let r=f;for(;t-- >M;)r*=r,r%=e;return r}function of(f,t){if(f===M)throw Error("invert: expected non-zero number");if(t<=M)throw Error("invert: expected positive modulus, got "+t);let e=L(f,t),r=t,i=M,o=D;for(;e!==M;){let a=r%e,s=i-o*(r/e);r=e,e=a,i=o,o=s}if(r!==D)throw Error("invert: does not exist");return L(i,t)}function sf(f,t){let e=(f.ORDER+D)/Ef,r=f.pow(t,e);if(!f.eql(f.sqr(r),t))throw Error("Cannot find square root");return r}function Lf(f,t){let e=(f.ORDER-xf)/vf,r=f.mul(t,te),i=f.pow(r,e),o=f.mul(t,i),a=f.mul(f.mul(o,te),i),s=f.mul(o,f.sub(a,f.ONE));if(!f.eql(f.sqr(s),t))throw Error("Cannot find square root");return s}function Kf(f){return f%Ef===Tf?sf:f%vf===xf?Lf:function(t){if(t<BigInt(3))throw Error("sqrt is not defined for small field");let e=t-D,r=0;for(;e%te===M;)e/=te,r++;let i=te,o=$(t);for(;af(o,i)===1;)if(i++>1e3)throw Error("Cannot find square root: probably non-prime P");if(r===1)return sf;let a=o.pow(i,e),s=(e+D)/te;return function(b,S){if(b.is0(S))return S;if(af(b,S)!==1)throw Error("Cannot find square root");let d=r,y=b.mul(b.ONE,a),R=b.pow(S,e),I=b.pow(S,s);for(;!b.eql(R,b.ONE);){if(b.is0(R))return b.ZERO;let N=1,F=b.sqr(R);for(;!b.eql(F,b.ONE);)if(N++,F=b.sqr(F),N===d)throw Error("Cannot find square root");let l=D<<BigInt(d-N-1),g=b.pow(y,l);d=N,y=b.sqr(g),R=b.mul(R,y),I=b.mul(I,g)}return I}}(f)}var Df=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function If(f,t,e=!1){let r=Array(t.length).fill(e?f.ZERO:void 0),i=t.reduce((a,s,b)=>f.is0(s)?a:(r[b]=a,f.mul(a,s)),f.ONE),o=f.inv(i);return t.reduceRight((a,s,b)=>f.is0(s)?a:(r[b]=f.mul(a,r[b]),f.mul(a,s)),o),r}function af(f,t){let e=(f.ORDER-D)/te,r=f.pow(t,e),i=f.eql(r,f.ONE),o=f.eql(r,f.ZERO),a=f.eql(r,f.neg(f.ONE));if(!i&&!o&&!a)throw Error("invalid Legendre symbol result");return i?1:o?0:-1}function $(f,t,e=!1,r={}){if(f<=M)throw Error("invalid field: expected ORDER > 0, got "+f);let i,o;if(typeof t=="object"&&t!=null){if(r.sqrt||e)throw Error("cannot specify opts in two arguments");let d=t;d.BITS&&(i=d.BITS),d.sqrt&&(o=d.sqrt),typeof d.isLE=="boolean"&&(e=d.isLE)}else typeof t=="number"&&(i=t),r.sqrt&&(o=r.sqrt);let{nBitLength:a,nByteLength:s}=function(d,y){y!==void 0&&Ye(y);let R=y!==void 0?y:d.toString(2).length;return{nBitLength:R,nByteLength:Math.ceil(R/8)}}(f,i);if(s>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let b,S=Object.freeze({ORDER:f,isLE:e,BITS:a,BYTES:s,MASK:Re(a),ZERO:M,ONE:D,create:d=>L(d,f),isValid:d=>{if(typeof d!="bigint")throw Error("invalid field element: expected bigint, got "+typeof d);return M<=d&&d<f},is0:d=>d===M,isValidNot0:d=>!S.is0(d)&&S.isValid(d),isOdd:d=>(d&D)===D,neg:d=>L(-d,f),eql:(d,y)=>d===y,sqr:d=>L(d*d,f),add:(d,y)=>L(d+y,f),sub:(d,y)=>L(d-y,f),mul:(d,y)=>L(d*y,f),pow:(d,y)=>function(R,I,N){if(N<M)throw Error("invalid exponent, negatives unsupported");if(N===M)return R.ONE;if(N===D)return I;let F=R.ONE,l=I;for(;N>M;)N&D&&(F=R.mul(F,l)),l=R.sqr(l),N>>=D;return F}(S,d,y),div:(d,y)=>L(d*of(y,f),f),sqrN:d=>d*d,addN:(d,y)=>d+y,subN:(d,y)=>d-y,mulN:(d,y)=>d*y,inv:d=>of(d,f),sqrt:o||(d=>(b||(b=Kf(f)),b(S,d))),toBytes:d=>e?ye(d,s):je(d,s),fromBytes:d=>{if(d.length!==s)throw Error("Field.fromBytes: expected "+s+" bytes, got "+d.length);return e?ie(d):ve(d)},invertBatch:d=>If(S,d),cmov:(d,y,R)=>R?y:d});return Object.freeze(S)}function Sf(f){if(typeof f!="bigint")throw Error("field order must be bigint");let t=f.toString(2).length;return Math.ceil(t/8)}function cf(f){let t=Sf(f);return t+Math.ceil(t/2)}var Se=class extends Qe{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,Me(t);let r=Je(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(r.length>i?t.create().update(r).digest():r);for(let a=0;a<o.length;a++)o[a]^=54;this.iHash.update(o),this.oHash=t.create();for(let a=0;a<o.length;a++)o[a]^=106;this.oHash.update(o),$e(o)}update(t){return Ae(this),this.iHash.update(t),this}digestInto(t){Ae(this),ae(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:r,finished:i,destroyed:o,blockLen:a,outputLen:s}=this;return t.finished=i,t.destroyed=o,t.blockLen=a,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Of=(f,t,e)=>new Se(f,t).update(e).digest();Of.create=(f,t)=>new Se(f,t);var de=BigInt(0),ne=BigInt(1);function be(f,t){let e=t.negate();return f?e:t}function Rf(f,t,e){let r=t==="pz"?o=>o.pz:o=>o.ez,i=If(f.Fp,e.map(r));return e.map((o,a)=>o.toAffine(i[a])).map(f.fromAffine)}function Ff(f,t){if(!Number.isSafeInteger(f)||f<=0||f>t)throw Error("invalid window size, expected [1.."+t+"], got W="+f)}function qe(f,t){Ff(f,t);let e=2**f;return{windows:Math.ceil(t/f)+1,windowSize:2**(f-1),mask:Re(f),maxNumber:e,shiftBy:BigInt(f)}}function df(f,t,e){let{windowSize:r,mask:i,maxNumber:o,shiftBy:a}=e,s=Number(f&i),b=f>>a;s>r&&(s-=o,b+=ne);let S=t*r;return{nextN:b,offset:S+Math.abs(s)-1,isZero:s===0,isNeg:s<0,isNegF:t%2!=0,offsetF:S}}var ze=new WeakMap,Af=new WeakMap;function He(f){return Af.get(f)||1}function uf(f){if(f!==de)throw Error("invalid wNAF")}function Nf(f,t){return{constTimeNegate:be,hasPrecomputes:e=>He(e)!==1,unsafeLadder(e,r,i=f.ZERO){let o=e;for(;r>de;)r&ne&&(i=i.add(o)),o=o.double(),r>>=ne;return i},precomputeWindow(e,r){let{windows:i,windowSize:o}=qe(r,t),a=[],s=e,b=s;for(let S=0;S<i;S++){b=s,a.push(b);for(let d=1;d<o;d++)b=b.add(s),a.push(b);s=b.double()}return a},wNAF(e,r,i){let o=f.ZERO,a=f.BASE,s=qe(e,t);for(let b=0;b<s.windows;b++){let{nextN:S,offset:d,isZero:y,isNeg:R,isNegF:I,offsetF:N}=df(i,b,s);i=S,y?a=a.add(be(I,r[N])):o=o.add(be(R,r[d]))}return uf(i),{p:o,f:a}},wNAFUnsafe(e,r,i,o=f.ZERO){let a=qe(e,t);for(let s=0;s<a.windows&&i!==de;s++){let{nextN:b,offset:S,isZero:d,isNeg:y}=df(i,s,a);if(i=b,!d){let R=r[S];o=o.add(y?R.negate():R)}}return uf(i),o},getPrecomputes(e,r,i){let o=ze.get(r);return o||(o=this.precomputeWindow(r,e),e!==1&&(typeof i=="function"&&(o=i(o)),ze.set(r,o))),o},wNAFCached(e,r,i){let o=He(e);return this.wNAF(o,this.getPrecomputes(o,e,i),r)},wNAFCachedUnsafe(e,r,i,o){let a=He(e);return a===1?this.unsafeLadder(e,r,o):this.wNAFUnsafe(a,this.getPrecomputes(a,e,i),r,o)},setWindowSize(e,r){Ff(r,t),Af.set(e,r),ze.delete(e)}}}function Pf(f,t,e,r){(function(R,I){if(!Array.isArray(R))throw Error("array expected");R.forEach((N,F)=>{if(!(N instanceof I))throw Error("invalid point at index "+F)})})(e,f),function(R,I){if(!Array.isArray(R))throw Error("array of scalars expected");R.forEach((N,F)=>{if(!I.isValid(N))throw Error("invalid scalar at index "+F)})}(r,t);let i=e.length,o=r.length;if(i!==o)throw Error("arrays of points and scalars must have equal length");let a=f.ZERO,s=function(R){let I;for(I=0;R>ke;R>>=Ce,I+=1);return I}(BigInt(i)),b=1;s>12?b=s-3:s>4?b=s-2:s>0&&(b=2);let S=Re(b),d=Array(Number(S)+1).fill(a),y=a;for(let R=Math.floor((t.BITS-1)/b)*b;R>=0;R-=b){d.fill(a);for(let N=0;N<o;N++){let F=r[N],l=Number(F>>BigInt(R)&S);d[l]=d[l].add(e[N])}let I=a;for(let N=d.length-1,F=a;N>0;N--)F=F.add(d[N]),I=I.add(F);if(y=y.add(I),R!==0)for(let N=0;N<b;N++)y=y.double()}return y}function lf(f,t){if(t){if(t.ORDER!==f)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return function(e){ue(e,Df.reduce((r,i)=>(r[i]="function",r),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"}))}(t),t}return $(f)}function qf(f,t,e={}){if(!t||typeof t!="object")throw Error(`expected valid ${f} CURVE object`);for(let a of["p","n","h"]){let s=t[a];if(!(typeof s=="bigint"&&s>de))throw Error(`CURVE.${a} must be positive bigint`)}let r=lf(t.p,e.Fp),i=lf(t.n,e.Fn),o=["Gx","Gy","a",f==="weierstrass"?"b":"d"];for(let a of o)if(!r.isValid(t[a]))throw Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:i}}function hf(f){f.lowS!==void 0&&re("lowS",f.lowS),f.prehash!==void 0&&re("prehash",f.prehash)}var X={Err:class extends Error{constructor(f=""){super(f)}},_tlv:{encode:(f,t)=>{let{Err:e}=X;if(f<0||f>256)throw new e("tlv.encode: wrong tag");if(1&t.length)throw new e("tlv.encode: unpadded data");let r=t.length/2,i=Be(r);if(i.length/2&128)throw new e("tlv.encode: long form length too big");let o=r>127?Be(i.length/2|128):"";return Be(f)+o+i+t},decode(f,t){let{Err:e}=X,r=0;if(f<0||f>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[r++]!==f)throw new e("tlv.decode: wrong tlv");let i=t[r++],o=0;if(128&i){let s=127&i;if(!s)throw new e("tlv.decode(long): indefinite length not supported");if(s>4)throw new e("tlv.decode(long): byte length is too big");let b=t.subarray(r,r+s);if(b.length!==s)throw new e("tlv.decode: length bytes not complete");if(b[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(let S of b)o=o<<8|S;if(r+=s,o<128)throw new e("tlv.decode(long): not minimal encoding")}else o=i;let a=t.subarray(r,r+o);if(a.length!==o)throw new e("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+o)}}},_int:{encode(f){let{Err:t}=X;if(f<pe)throw new t("integer: negative integers are not allowed");let e=Be(f);if(8&Number.parseInt(e[0],16)&&(e="00"+e),1&e.length)throw new t("unexpected DER parsing assertion: unpadded hex");return e},decode(f){let{Err:t}=X;if(128&f[0])throw new t("invalid signature integer: negative");if(f[0]===0&&!(128&f[1]))throw new t("invalid signature integer: unnecessary leading zero");return ve(f)}},toSig(f){let{Err:t,_int:e,_tlv:r}=X,i=T("signature",f),{v:o,l:a}=r.decode(48,i);if(a.length)throw new t("invalid signature: left bytes after parsing");let{v:s,l:b}=r.decode(2,o),{v:S,l:d}=r.decode(2,b);if(d.length)throw new t("invalid signature: left bytes after parsing");return{r:e.decode(s),s:e.decode(S)}},hexFromSig(f){let{_tlv:t,_int:e}=X,r=t.encode(2,e.encode(f.r))+t.encode(2,e.encode(f.s));return t.encode(48,r)}},pe=BigInt(0),ge=BigInt(1),Yf=BigInt(2),Ee=BigInt(3),Mf=BigInt(4);function zf(f,t,e){let{BYTES:r}=f;return function(i){let o;if(typeof i=="bigint")o=i;else{let a=T("private key",i);if(t){if(!t.includes(2*a.length))throw Error("invalid private key");let s=new Uint8Array(r);s.set(a,s.length-a.length),a=s}try{o=f.fromBytes(a)}catch{throw Error(`invalid private key: expected ui8a of size ${r}, got ${typeof i}`)}}if(e&&(o=f.create(o)),!f.isValidNot0(o))throw Error("invalid private key: out of range [1..N-1]");return o}}function $f(f,t={}){let{Fp:e,Fn:r}=qf("weierstrass",f,t),{h:i,n:o}=f;ue(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:a}=t;if(a&&(!e.is0(f.a)||typeof a.beta!="bigint"||typeof a.splitScalar!="function"))throw Error('invalid endo: expected "beta": bigint and "splitScalar": function');function s(){if(!e.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let b=t.toBytes||function(u,n,c){let{x:h,y:p}=n.toAffine(),E=e.toBytes(h);if(re("isCompressed",c),c){s();let A=!e.isOdd(p);return W(Hf(A),E)}return W(Uint8Array.of(4),E,e.toBytes(p))},S=t.fromBytes||function(u){ae(u);let n=e.BYTES,c=n+1,h=2*n+1,p=u.length,E=u[0],A=u.subarray(1);if(p!==c||E!==2&&E!==3){if(p===h&&E===4){let v=e.fromBytes(A.subarray(0*n,1*n)),w=e.fromBytes(A.subarray(1*n,2*n));if(!y(v,w))throw Error("bad point: is not on curve");return{x:v,y:w}}throw Error(`bad point: got length ${p}, expected compressed=${c} or uncompressed=${h}`)}{let v=e.fromBytes(A);if(!e.isValid(v))throw Error("bad point: is not on curve, wrong x");let w=d(v),x;try{x=e.sqrt(w)}catch(B){let C=B instanceof Error?": "+B.message:"";throw Error("bad point: is not on curve, sqrt error"+C)}return s(),!(1&~E)!==e.isOdd(x)&&(x=e.neg(x)),{x:v,y:x}}},d=function(u,n,c){return function(h){let p=u.sqr(h),E=u.mul(p,h);return u.add(u.add(E,u.mul(h,n)),c)}}(e,f.a,f.b);function y(u,n){let c=e.sqr(n),h=d(u);return e.eql(c,h)}if(!y(f.Gx,f.Gy))throw Error("bad curve params: generator point");let R=e.mul(e.pow(f.a,Ee),Mf),I=e.mul(e.sqr(f.b),BigInt(27));if(e.is0(e.add(R,I)))throw Error("bad curve params: a or b");function N(u,n,c=!1){if(!e.isValid(n)||c&&e.is0(n))throw Error("bad point coordinate "+u);return n}function F(u){if(!(u instanceof m))throw Error("ProjectivePoint expected")}let l=Ie((u,n)=>{let{px:c,py:h,pz:p}=u;if(e.eql(p,e.ONE))return{x:c,y:h};let E=u.is0();n==null&&(n=E?e.ONE:e.inv(p));let A=e.mul(c,n),v=e.mul(h,n),w=e.mul(p,n);if(E)return{x:e.ZERO,y:e.ZERO};if(!e.eql(w,e.ONE))throw Error("invZ was invalid");return{x:A,y:v}}),g=Ie(u=>{if(u.is0()){if(t.allowInfinityPoint&&!e.is0(u.py))return;throw Error("bad point: ZERO")}let{x:n,y:c}=u.toAffine();if(!e.isValid(n)||!e.isValid(c))throw Error("bad point: x or y not field elements");if(!y(n,c))throw Error("bad point: equation left != right");if(!u.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function O(u,n,c,h,p){return c=new m(e.mul(c.px,u),c.py,c.pz),n=be(h,n),c=be(p,c),n.add(c)}class m{constructor(n,c,h){this.px=N("x",n),this.py=N("y",c,!0),this.pz=N("z",h),Object.freeze(this)}static fromAffine(n){let{x:c,y:h}=n||{};if(!n||!e.isValid(c)||!e.isValid(h))throw Error("invalid affine point");if(n instanceof m)throw Error("projective point not allowed");return e.is0(c)&&e.is0(h)?m.ZERO:new m(c,h,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(n){return Rf(m,"pz",n)}static fromBytes(n){return ae(n),m.fromHex(n)}static fromHex(n){let c=m.fromAffine(S(T("pointHex",n)));return c.assertValidity(),c}static fromPrivateKey(n){let c=zf(r,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return m.BASE.multiply(c(n))}static msm(n,c){return Pf(m,r,n,c)}precompute(n=8,c=!0){return U.setWindowSize(this,n),c||this.multiply(Ee),this}_setWindowSize(n){this.precompute(n)}assertValidity(){g(this)}hasEvenY(){let{y:n}=this.toAffine();if(!e.isOdd)throw Error("Field doesn't support isOdd");return!e.isOdd(n)}equals(n){F(n);let{px:c,py:h,pz:p}=this,{px:E,py:A,pz:v}=n,w=e.eql(e.mul(c,v),e.mul(E,p)),x=e.eql(e.mul(h,v),e.mul(A,p));return w&&x}negate(){return new m(this.px,e.neg(this.py),this.pz)}double(){let{a:n,b:c}=f,h=e.mul(c,Ee),{px:p,py:E,pz:A}=this,v=e.ZERO,w=e.ZERO,x=e.ZERO,B=e.mul(p,p),C=e.mul(E,E),q=e.mul(A,A),P=e.mul(p,E);return P=e.add(P,P),x=e.mul(p,A),x=e.add(x,x),v=e.mul(n,x),w=e.mul(h,q),w=e.add(v,w),v=e.sub(C,w),w=e.add(C,w),w=e.mul(v,w),v=e.mul(P,v),x=e.mul(h,x),q=e.mul(n,q),P=e.sub(B,q),P=e.mul(n,P),P=e.add(P,x),x=e.add(B,B),B=e.add(x,B),B=e.add(B,q),B=e.mul(B,P),w=e.add(w,B),q=e.mul(E,A),q=e.add(q,q),B=e.mul(q,P),v=e.sub(v,B),x=e.mul(q,C),x=e.add(x,x),x=e.add(x,x),new m(v,w,x)}add(n){F(n);let{px:c,py:h,pz:p}=this,{px:E,py:A,pz:v}=n,w=e.ZERO,x=e.ZERO,B=e.ZERO,C=f.a,q=e.mul(f.b,Ee),P=e.mul(c,E),Z=e.mul(h,A),V=e.mul(p,v),G=e.add(c,h),z=e.add(E,A);G=e.mul(G,z),z=e.add(P,Z),G=e.sub(G,z),z=e.add(c,p);let k=e.add(E,v);return z=e.mul(z,k),k=e.add(P,V),z=e.sub(z,k),k=e.add(h,p),w=e.add(A,v),k=e.mul(k,w),w=e.add(Z,V),k=e.sub(k,w),B=e.mul(C,z),w=e.mul(q,V),B=e.add(w,B),w=e.sub(Z,B),B=e.add(Z,B),x=e.mul(w,B),Z=e.add(P,P),Z=e.add(Z,P),V=e.mul(C,V),z=e.mul(q,z),Z=e.add(Z,V),V=e.sub(P,V),V=e.mul(C,V),z=e.add(z,V),P=e.mul(Z,z),x=e.add(x,P),P=e.mul(k,z),w=e.mul(G,w),w=e.sub(w,P),P=e.mul(G,Z),B=e.mul(k,B),B=e.add(B,P),new m(w,x,B)}subtract(n){return this.add(n.negate())}is0(){return this.equals(m.ZERO)}multiply(n){let{endo:c}=t;if(!r.isValidNot0(n))throw Error("invalid scalar: out of range");let h,p,E=A=>U.wNAFCached(this,A,m.normalizeZ);if(c){let{k1neg:A,k1:v,k2neg:w,k2:x}=c.splitScalar(n),{p:B,f:C}=E(v),{p:q,f:P}=E(x);p=C.add(P),h=O(c.beta,B,q,A,w)}else{let{p:A,f:v}=E(n);h=A,p=v}return m.normalizeZ([h,p])[0]}multiplyUnsafe(n){let{endo:c}=t,h=this;if(!r.isValid(n))throw Error("invalid scalar: out of range");if(n===pe||h.is0())return m.ZERO;if(n===ge)return h;if(U.hasPrecomputes(this))return this.multiply(n);if(c){let{k1neg:p,k1:E,k2neg:A,k2:v}=c.splitScalar(n),{p1:w,p2:x}=function(B,C,q,P){let Z=C,V=B.ZERO,G=B.ZERO;for(;q>de||P>de;)q&ne&&(V=V.add(Z)),P&ne&&(G=G.add(Z)),Z=Z.double(),q>>=ne,P>>=ne;return{p1:V,p2:G}}(m,h,E,v);return O(c.beta,w,x,p,A)}return U.wNAFCachedUnsafe(h,n)}multiplyAndAddUnsafe(n,c,h){let p=this.multiplyUnsafe(c).add(n.multiplyUnsafe(h));return p.is0()?void 0:p}toAffine(n){return l(this,n)}isTorsionFree(){let{isTorsionFree:n}=t;return i===ge||(n?n(m,this):U.wNAFCachedUnsafe(this,o).is0())}clearCofactor(){let{clearCofactor:n}=t;return i===ge?this:n?n(m,this):this.multiplyUnsafe(i)}toBytes(n=!0){return re("isCompressed",n),this.assertValidity(),b(m,this,n)}toRawBytes(n=!0){return this.toBytes(n)}toHex(n=!0){return fe(this.toBytes(n))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}m.BASE=new m(f.Gx,f.Gy,e.ONE),m.ZERO=new m(e.ZERO,e.ONE,e.ZERO),m.Fp=e,m.Fn=r;let H=r.BITS,U=Nf(m,t.endo?Math.ceil(H/2):H);return m}function Hf(f){return Uint8Array.of(f?2:3)}function Wf(f,t,e={}){ue(t,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let r=t.randomBytes||we,i=t.hmac||((u,...n)=>Of(t.hash,u,W(...n))),{Fp:o,Fn:a}=f,{ORDER:s,BITS:b}=a;function S(u){return u>s>>ge}function d(u,n){if(!a.isValidNot0(n))throw Error(`invalid signature ${u}: out of range 1..CURVE.n`)}class y{constructor(n,c,h){d("r",n),d("s",c),this.r=n,this.s=c,h!=null&&(this.recovery=h),Object.freeze(this)}static fromCompact(n){let c=a.BYTES,h=T("compactSignature",n,2*c);return new y(a.fromBytes(h.subarray(0,c)),a.fromBytes(h.subarray(c,2*c)))}static fromDER(n){let{r:c,s:h}=X.toSig(T("DER",n));return new y(c,h)}assertValidity(){}addRecoveryBit(n){return new y(this.r,this.s,n)}recoverPublicKey(n){let c=o.ORDER,{r:h,s:p,recovery:E}=this;if(E==null||![0,1,2,3].includes(E))throw Error("recovery id invalid");if(s*Yf<c&&E>1)throw Error("recovery id is ambiguous for h>1 curve");let A=E===2||E===3?h+s:h;if(!o.isValid(A))throw Error("recovery id 2 or 3 invalid");let v=o.toBytes(A),w=f.fromHex(W(Hf(!(1&E)),v)),x=a.inv(A),B=l(T("msgHash",n)),C=a.create(-B*x),q=a.create(p*x),P=f.BASE.multiplyUnsafe(C).add(w.multiplyUnsafe(q));if(P.is0())throw Error("point at infinify");return P.assertValidity(),P}hasHighS(){return S(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,a.neg(this.s),this.recovery):this}toBytes(n){if(n==="compact")return W(a.toBytes(this.r),a.toBytes(this.s));if(n==="der")return me(X.hexFromSig(this));throw Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return fe(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return fe(this.toBytes("compact"))}}let R=zf(a,e.allowedPrivateKeyLengths,e.wrapPrivateKey),I={isValidPrivateKey(u){try{return R(u),!0}catch{return!1}},normPrivateKeyToScalar:R,randomPrivateKey:()=>{let u=s;return function(n,c,h=!1){let p=n.length,E=Sf(c),A=cf(c);if(p<16||p<A||p>1024)throw Error("expected "+A+"-1024 bytes of input, got "+p);let v=L(h?ie(n):ve(n),c-D)+D;return h?ye(v,E):je(v,E)}(r(cf(u)),u)},precompute:(u=8,n=f.BASE)=>n.precompute(u,!1)};function N(u){if(typeof u=="bigint")return!1;if(u instanceof f)return!0;let n=T("key",u).length,c=o.BYTES,h=c+1,p=2*c+1;return e.allowedPrivateKeyLengths||a.BYTES===h?void 0:n===h||n===p}let F=t.bits2int||function(u){if(u.length>8192)throw Error("input is too large");let n=ve(u),c=8*u.length-b;return c>0?n>>BigInt(c):n},l=t.bits2int_modN||function(u){return a.create(F(u))},g=Re(b);function O(u){return ee("num < 2^"+b,u,pe,g),a.toBytes(u)}function m(u,n,c=H){if(["recovered","canonical"].some(q=>q in c))throw Error("sign() legacy options not supported");let{hash:h}=t,{lowS:p,prehash:E,extraEntropy:A}=c;p==null&&(p=!0),u=T("msgHash",u),hf(c),E&&(u=T("prehashed msgHash",h(u)));let v=l(u),w=R(n),x=[O(w),O(v)];if(A!=null&&A!==!1){let q=A===!0?r(o.BYTES):A;x.push(T("extraEntropy",q))}let B=W(...x),C=v;return{seed:B,k2sig:function(q){let P=F(q);if(!a.isValidNot0(P))return;let Z=a.inv(P),V=f.BASE.multiply(P).toAffine(),G=a.create(V.x);if(G===pe)return;let z=a.create(Z*a.create(C+G*w));if(z===pe)return;let k=(V.x===G?0:2)|Number(V.y&ge),Y=z;return p&&S(z)&&(Y=function(se){return S(se)?a.neg(se):se}(z),k^=1),new y(G,Y,k)}}}let H={lowS:t.lowS,prehash:!1},U={lowS:t.lowS,prehash:!1};return f.BASE.precompute(8),Object.freeze({getPublicKey:function(u,n=!0){return f.fromPrivateKey(u).toBytes(n)},getSharedSecret:function(u,n,c=!0){if(N(u)===!0)throw Error("first arg must be private key");if(N(n)===!1)throw Error("second arg must be public key");return f.fromHex(n).multiply(R(u)).toBytes(c)},sign:function(u,n,c=H){let{seed:h,k2sig:p}=m(u,n,c);return function(E,A,v){if(typeof E!="number"||E<2)throw Error("hashLen must be a number");if(typeof A!="number"||A<2)throw Error("qByteLen must be a number");if(typeof v!="function")throw Error("hmacFn must be a function");let w=z=>new Uint8Array(z),x=z=>Uint8Array.of(z),B=w(E),C=w(E),q=0,P=()=>{B.fill(1),C.fill(0),q=0},Z=(...z)=>v(C,B,...z),V=(z=w(0))=>{C=Z(x(0),z),B=Z(),z.length!==0&&(C=Z(x(1),z),B=Z())},G=()=>{if(q++>=1e3)throw Error("drbg: tried 1000 values");let z=0,k=[];for(;z<A;){B=Z();let Y=B.slice();k.push(Y),z+=B.length}return W(...k)};return(z,k)=>{let Y;for(P(),V(z);!(Y=k(G()));)V();return P(),Y}}(t.hash.outputLen,a.BYTES,i)(h,p)},verify:function(u,n,c,h=U){let p=u;n=T("msgHash",n),c=T("publicKey",c),hf(h);let{lowS:E,prehash:A,format:v}=h;if("strict"in h)throw Error("options.strict was renamed to lowS");if(v!==void 0&&!["compact","der","js"].includes(v))throw Error('format must be "compact", "der" or "js"');let w=typeof p=="string"||Fe(p),x=!w&&!v&&typeof p=="object"&&p!==null&&typeof p.r=="bigint"&&typeof p.s=="bigint";if(!w&&!x)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");let B,C;try{if(x){if(v!==void 0&&v!=="js")throw Error("invalid format");B=new y(p.r,p.s)}if(w){try{v!=="compact"&&(B=y.fromDER(p))}catch(Y){if(!(Y instanceof X.Err))throw Y}B||v==="der"||(B=y.fromCompact(p))}C=f.fromHex(c)}catch{return!1}if(!B||E&&B.hasHighS())return!1;A&&(n=t.hash(n));let{r:q,s:P}=B,Z=l(n),V=a.inv(P),G=a.create(Z*V),z=a.create(q*V),k=f.BASE.multiplyUnsafe(G).add(C.multiplyUnsafe(z));return!k.is0()&&a.create(k.x)===q},utils:I,Point:f,Signature:y})}function Jf(f){let{CURVE:t,curveOpts:e}=function(r){let i={a:r.a,b:r.b,p:r.Fp.ORDER,n:r.n,h:r.h,Gx:r.Gx,Gy:r.Gy};return{CURVE:i,curveOpts:{Fp:r.Fp,Fn:$(i.n,r.nBitLength),allowedPrivateKeyLengths:r.allowedPrivateKeyLengths,allowInfinityPoint:r.allowInfinityPoint,endo:r.endo,wrapPrivateKey:r.wrapPrivateKey,isTorsionFree:r.isTorsionFree,clearCofactor:r.clearCofactor,fromBytes:r.fromBytes,toBytes:r.toBytes}}}(f);return{CURVE:t,curveOpts:e,ecdsaOpts:{hash:f.hash,hmac:f.hmac,randomBytes:f.randomBytes,lowS:f.lowS,bits2int:f.bits2int,bits2int_modN:f.bits2int_modN}}}function Qf(f){let{CURVE:t,curveOpts:e,ecdsaOpts:r}=Jf(f);return function(i,o){return Object.assign({},o,{ProjectivePoint:o.Point,CURVE:i})}(f,Wf($f(t,e),r,e))}function oe(f,t){let e=r=>Qf(_(Q({},f),{hash:r}));return _(Q({},e(t)),{create:e})}var Uf={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},Cf={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},Zf={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},Xf=$(Uf.p),_f=$(Cf.p),et=$(Zf.p),ft=oe(_(Q({},Uf),{Fp:Xf,lowS:!1}),Ne),tt=oe(_(Q({},Cf),{Fp:_f,lowS:!1}),ef),nt=oe(_(Q({},Zf),{Fp:et,lowS:!1,allowedPrivateKeyLengths:[130,131,132]}),_e),J=BigInt(0),K=BigInt(1),Ue=BigInt(2),rt=BigInt(8),it={zip215:!0};function Vf(f,t={}){let{Fp:e,Fn:r}=qf("edwards",f,t),{h:i,n:o}=f;ue(t,{},{uvRatio:"function"});let a=Ue<<BigInt(8*r.BYTES)-K,s=F=>e.create(F),b=t.uvRatio||((F,l)=>{try{return{isValid:!0,value:e.sqrt(e.div(F,l))}}catch{return{isValid:!1,value:J}}});if(!function(F,l,g,O){let m=F.sqr(g),H=F.sqr(O),U=F.add(F.mul(l.a,m),H),u=F.add(F.ONE,F.mul(l.d,F.mul(m,H)));return F.eql(U,u)}(e,f,f.Gx,f.Gy))throw Error("bad curve params: generator point");function S(F,l,g=!1){return ee("coordinate "+F,l,g?K:J,a),l}function d(F){if(!(F instanceof I))throw Error("ExtendedPoint expected")}let y=Ie((F,l)=>{let{ex:g,ey:O,ez:m}=F,H=F.is0();l==null&&(l=H?rt:e.inv(m));let U=s(g*l),u=s(O*l),n=s(m*l);if(H)return{x:J,y:K};if(n!==K)throw Error("invZ was invalid");return{x:U,y:u}}),R=Ie(F=>{let{a:l,d:g}=f;if(F.is0())throw Error("bad point: ZERO");let{ex:O,ey:m,ez:H,et:U}=F,u=s(O*O),n=s(m*m),c=s(H*H),h=s(c*c),p=s(u*l);if(s(c*s(p+n))!==s(h+s(g*s(u*n))))throw Error("bad point: equation left != right (1)");if(s(O*m)!==s(H*U))throw Error("bad point: equation left != right (2)");return!0});class I{constructor(l,g,O,m){this.ex=S("x",l),this.ey=S("y",g),this.ez=S("z",O,!0),this.et=S("t",m),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(l){if(l instanceof I)throw Error("extended point not allowed");let{x:g,y:O}=l||{};return S("x",g),S("y",O),new I(g,O,K,s(g*O))}static normalizeZ(l){return Rf(I,"ez",l)}static msm(l,g){return Pf(I,r,l,g)}_setWindowSize(l){this.precompute(l)}precompute(l=8,g=!0){return N.setWindowSize(this,l),g||this.multiply(Ue),this}assertValidity(){R(this)}equals(l){d(l);let{ex:g,ey:O,ez:m}=this,{ex:H,ey:U,ez:u}=l,n=s(g*u),c=s(H*m),h=s(O*u),p=s(U*m);return n===c&&h===p}is0(){return this.equals(I.ZERO)}negate(){return new I(s(-this.ex),this.ey,this.ez,s(-this.et))}double(){let{a:l}=f,{ex:g,ey:O,ez:m}=this,H=s(g*g),U=s(O*O),u=s(Ue*s(m*m)),n=s(l*H),c=g+O,h=s(s(c*c)-H-U),p=n+U,E=p-u,A=n-U,v=s(h*E),w=s(p*A),x=s(h*A),B=s(E*p);return new I(v,w,B,x)}add(l){d(l);let{a:g,d:O}=f,{ex:m,ey:H,ez:U,et:u}=this,{ex:n,ey:c,ez:h,et:p}=l,E=s(m*n),A=s(H*c),v=s(u*O*p),w=s(U*h),x=s((m+H)*(n+c)-E-A),B=w-v,C=w+v,q=s(A-g*E),P=s(x*B),Z=s(C*q),V=s(x*q),G=s(B*C);return new I(P,Z,G,V)}subtract(l){return this.add(l.negate())}multiply(l){let g=l;ee("scalar",g,K,o);let{p:O,f:m}=N.wNAFCached(this,g,I.normalizeZ);return I.normalizeZ([O,m])[0]}multiplyUnsafe(l,g=I.ZERO){let O=l;return ee("scalar",O,J,o),O===J?I.ZERO:this.is0()||O===K?this:N.wNAFCachedUnsafe(this,O,I.normalizeZ,g)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}isTorsionFree(){return N.wNAFCachedUnsafe(this,o).is0()}toAffine(l){return y(this,l)}clearCofactor(){return i===K?this:this.multiplyUnsafe(i)}static fromBytes(l,g=!1){return ae(l),this.fromHex(l,g)}static fromHex(l,g=!1){let{d:O,a:m}=f,H=e.BYTES;l=T("pointHex",l,H),re("zip215",g);let U=l.slice(),u=l[H-1];U[H-1]=-129&u;let n=ie(U),c=g?a:e.ORDER;ee("pointHex.y",n,J,c);let h=s(n*n),p=s(h-K),E=s(O*h-m),{isValid:A,value:v}=b(p,E);if(!A)throw Error("Point.fromHex: invalid y coordinate");let w=(v&K)===K,x=!!(128&u);if(!g&&v===J&&x)throw Error("Point.fromHex: x=0 and x_0=1");return x!==w&&(v=s(-v)),I.fromAffine({x:v,y:n})}static fromPrivateScalar(l){return I.BASE.multiply(l)}toBytes(){let{x:l,y:g}=this.toAffine(),O=ye(g,e.BYTES);return O[O.length-1]|=l&K?128:0,O}toRawBytes(){return this.toBytes()}toHex(){return fe(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}I.BASE=new I(f.Gx,f.Gy,K,s(f.Gx*f.Gy)),I.ZERO=new I(J,K,K,J),I.Fp=e,I.Fn=r;let N=Nf(I,8*r.BYTES);return I}function ot(f,t){ue(t,{hash:"function"},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:e,hash:r}=t,{BASE:i,Fp:o,Fn:a}=f,s=a.ORDER,b=t.randomBytes||we,S=t.adjustScalarBytes||(l=>l),d=t.domain||((l,g,O)=>{if(re("phflag",O),g.length||O)throw Error("Contexts/pre-hash are not supported");return l});function y(l){return a.create(l)}function R(l){return y(ie(l))}function I(l){let{head:g,prefix:O,scalar:m}=function(u){let n=o.BYTES;u=T("private key",u,n);let c=T("hashed private key",r(u),2*n),h=S(c.slice(0,n));return{head:h,prefix:c.slice(n,2*n),scalar:R(h)}}(l),H=i.multiply(m),U=H.toBytes();return{head:g,prefix:O,scalar:m,point:H,pointBytes:U}}function N(l=Uint8Array.of(),...g){let O=W(...g);return R(r(d(O,T("context",l),!!e)))}let F=it;return i.precompute(8),{getPublicKey:function(l){return I(l).pointBytes},sign:function(l,g,O={}){l=T("message",l),e&&(l=e(l));let{prefix:m,scalar:H,pointBytes:U}=I(g),u=N(O.context,m,l),n=i.multiply(u).toBytes(),c=y(u+N(O.context,n,U,l)*H);ee("signature.s",c,J,s);let h=o.BYTES;return T("result",W(n,ye(c,h)),2*h)},verify:function(l,g,O,m=F){let{context:H,zip215:U}=m,u=o.BYTES;l=T("signature",l,2*u),g=T("message",g),O=T("publicKey",O,u),U!==void 0&&re("zip215",U),e&&(g=e(g));let n=ie(l.slice(u,2*u)),c,h,p;try{c=f.fromHex(O,U),h=f.fromHex(l.slice(0,u),U),p=i.multiplyUnsafe(n)}catch{return!1}if(!U&&c.isSmallOrder())return!1;let E=N(H,h.toBytes(),c.toBytes(),g);return h.add(c.multiplyUnsafe(E)).subtract(p).clearCofactor().is0()},utils:{getExtendedPublicKey:I,randomPrivateKey:()=>b(o.BYTES),precompute:(l=8,g=f.BASE)=>g.precompute(l,!1)},Point:f}}var he=BigInt(0),ce=BigInt(1),xe=BigInt(2);function st(f){let t=(ue(e=f,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze(Q({},e)));var e;let{P:r,type:i,adjustScalarBytes:o,powPminus2:a,randomBytes:s}=t,b=i==="x25519";if(!b&&i!=="x448")throw Error("invalid type");let S=s||we,d=b?255:448,y=b?32:56,R=BigInt(b?9:5),I=BigInt(b?121665:39081),N=b?xe**BigInt(254):xe**BigInt(447),F=b?BigInt(8)*xe**BigInt(251)-ce:BigInt(4)*xe**BigInt(445)-ce,l=N+F+ce,g=n=>L(n,r),O=m(R);function m(n){return ye(g(n),y)}function H(n,c){let h=function(p,E){ee("u",p,he,r),ee("scalar",E,N,l);let A=E,v=p,w=ce,x=he,B=p,C=ce,q=he;for(let Z=BigInt(d-1);Z>=he;Z--){let V=A>>Z&ce;q^=V,{x_2:w,x_3:B}=u(q,w,B),{x_2:x,x_3:C}=u(q,x,C),q=V;let G=w+x,z=g(G*G),k=w-x,Y=g(k*k),se=z-Y,jf=B+C,Te=g((B-C)*G),Le=g(jf*k),Ke=Te+Le,De=Te-Le;B=g(Ke*Ke),C=g(v*g(De*De)),w=g(z*Y),x=g(se*(z+g(I*se)))}({x_2:w,x_3:B}=u(q,w,B)),{x_2:x,x_3:C}=u(q,x,C);let P=a(x);return g(w*P)}(function(p){let E=T("u coordinate",p,y);return b&&(E[31]&=127),g(ie(E))}(c),function(p){return ie(o(T("scalar",p,y)))}(n));if(h===he)throw Error("invalid private or public key received");return m(h)}function U(n){return H(n,O)}function u(n,c,h){let p=g(n*(c-h));return{x_2:c=g(c-p),x_3:h=g(h+p)}}return{scalarMult:H,scalarMultBase:U,getSharedSecret:(n,c)=>H(n,c),getPublicKey:n=>U(n),utils:{randomPrivateKey:()=>S(y)},GuBytes:O.slice()}}var le={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")};Vf(Object.assign({},le,{d:BigInt("0xd78b4bdc7f0daf19f24f38c29373a2ccad46157242a50f37809b1da3412a12e79ccc9c81264cfe9ad080997058fb61c4243cc32dbaa156b9"),Gx:BigInt("0x79a70b2b70400553ae7c9df416c792c61128751ac92969240c25a07d728bdc93e21f7787ed6972249de732f38496cd11698713093e9c04fc"),Gy:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000001")}));var at=Xe(()=>ff.create({dkLen:114})),ct=BigInt(1),Ze=BigInt(2),bf=BigInt(3);BigInt(4);var dt=BigInt(11),ut=BigInt(22),pf=BigInt(44),lt=BigInt(88),ht=BigInt(223);function Gf(f){let t=le.p,e=f*f*f%t,r=e*e*f%t,i=j(r,bf,t)*r%t,o=j(i,bf,t)*r%t,a=j(o,Ze,t)*e%t,s=j(a,dt,t)*a%t,b=j(s,ut,t)*s%t,S=j(b,pf,t)*b%t,d=j(S,lt,t)*S%t,y=j(d,pf,t)*b%t,R=j(y,Ze,t)*e%t,I=j(R,ct,t)*f%t;return j(I,ht,t)*R%t}function kf(f){return f[0]&=252,f[55]|=128,f[56]=0,f}function bt(f,t){let e=le.p,r=L(f*f*t,e),i=L(r*f,e),o=L(i*r*t,e),a=L(i*Gf(o),e),s=L(a*a,e);return{isValid:L(s*t,e)===f,value:a}}var pt=$(le.p,456,!0),gt=function(f){let{CURVE:t,curveOpts:e,eddsaOpts:r}=function(i){let o={a:i.a,d:i.d,p:i.Fp.ORDER,n:i.n,h:i.h,Gx:i.Gx,Gy:i.Gy};return{CURVE:o,curveOpts:{Fp:i.Fp,Fn:$(o.n,i.nBitLength,!0),uvRatio:i.uvRatio},eddsaOpts:{hash:i.hash,randomBytes:i.randomBytes,adjustScalarBytes:i.adjustScalarBytes,domain:i.domain,prehash:i.prehash,mapToCurve:i.mapToCurve}}}(f);return function(i,o){return Object.assign({},o,{ExtendedPoint:o.Point,CURVE:i})}(f,ot(Vf(t,e),r))}(_(Q({},le),{Fp:pt,nBitLength:456,hash:at,adjustScalarBytes:kf,domain:(f,t,e)=>{if(t.length>255)throw Error("context must be smaller than 255, got: "+t.length);return W(We("SigEd448"),new Uint8Array([e?1:0,t.length]),t,f)},uvRatio:bt})),yt=(()=>{let f=le.p;return st({P:f,type:"x448",powPminus2:t=>L(j(Gf(t),Ze,f)*t,f),adjustScalarBytes:kf})})(),Oe={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")};BigInt(0);var mt=BigInt(1),Ve=BigInt(2),gf=(f,t)=>(f+t/Ve)/t,Ge=$(Oe.p,void 0,void 0,{sqrt:function(f){let t=Oe.p,e=BigInt(3),r=BigInt(6),i=BigInt(11),o=BigInt(22),a=BigInt(23),s=BigInt(44),b=BigInt(88),S=f*f*f%t,d=S*S*f%t,y=j(d,e,t)*d%t,R=j(y,e,t)*d%t,I=j(R,Ve,t)*S%t,N=j(I,i,t)*I%t,F=j(N,o,t)*N%t,l=j(F,s,t)*F%t,g=j(l,b,t)*l%t,O=j(g,s,t)*F%t,m=j(O,e,t)*d%t,H=j(m,a,t)*N%t,U=j(H,r,t)*S%t,u=j(U,Ve,t);if(!Ge.eql(Ge.sqr(u),f))throw Error("Cannot find square root");return u}}),wt=oe(_(Q({},Oe),{Fp:Ge,lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:f=>{let t=Oe.n,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-mt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=e,a=BigInt("0x100000000000000000000000000000000"),s=gf(o*f,t),b=gf(-r*f,t),S=L(f-s*e-b*i,t),d=L(-s*r-b*o,t),y=S>a,R=d>a;if(y&&(S=t-S),R&&(d=t-d),S>a||d>a)throw Error("splitScalar: Endomorphism failed, k="+f);return{k1neg:y,k1:S,k2neg:R,k2:d}}}}),Ne),yf=$(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),Bt=oe({a:yf.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:yf,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},tf),mf=$(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),Et=oe({a:mf.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:mf,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},rf),wf=$(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),xt=oe({a:wf.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:wf,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},nf),It=new Map(Object.entries({nistP256:ft,nistP384:tt,nistP521:nt,brainpoolP256r1:Bt,brainpoolP384r1:Et,brainpoolP512r1:xt,secp256k1:wt,x448:yt,ed448:gt}));export{It as nobleCurves};
