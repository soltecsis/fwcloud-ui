import{A as ue,B as le,a as Et,b as fe,c as Rt,d as Vt,e as Ct,f as re,h as nt,i as xt,j as ne,k as Q,l as oe,m as ie,o as vt,s as Tt,t as se,u as ce,x as ae,y as de}from"./chunk-WSZH6Q2Y.js";import{a as tt,b as rt}from"./chunk-GAL4ENT6.js";var Wt=BigInt(0),zt=BigInt(1);function at(f,t=""){if(typeof f!="boolean")throw Error((t&&`"${t}"`)+"expected boolean, got type="+typeof f);return f}function _(f,t,r=""){let e=Et(f),n=f?.length,o=t!==void 0;if(!e||o&&n!==t)throw Error((r&&`"${r}" `)+"expected Uint8Array"+(o?" of length "+t:"")+", got "+(e?"length="+n:"type="+typeof f));return f}function Ft(f){let t=f.toString(16);return 1&t.length?"0"+t:t}function qe(f){if(typeof f!="string")throw Error("hex string expected, got "+typeof f);return f===""?Wt:BigInt("0x"+f)}function Ut(f){return qe(nt(f))}function dt(f){return Rt(f),qe(nt(Uint8Array.from(f).reverse()))}function Jt(f,t){return xt(f.toString(16).padStart(2*t,"0"))}function Qt(f,t){return Jt(f,t).reverse()}function Y(f,t,r){let e;if(typeof t=="string")try{e=xt(t)}catch(o){throw Error(f+" must be hex string or Uint8Array, cause: "+o)}else{if(!Et(t))throw Error(f+" must be hex string or Uint8Array");e=Uint8Array.from(t)}let n=e.length;if(typeof r=="number"&&n!==r)throw Error(f+" of length "+r+" expected, got "+n);return e}function he(f){return Uint8Array.from(f)}var kt=f=>typeof f=="bigint"&&Wt<=f;function Ot(f,t,r,e){if(!function(n,o,c){return kt(n)&&kt(o)&&kt(c)&&o<=n&&n<c}(t,r,e))throw Error("expected valid "+f+": "+r+" <= n < "+e+", got "+t)}function Ze(f){let t;for(t=0;f>Wt;f>>=zt,t+=1);return t}var St=f=>(zt<<BigInt(f))-zt;function mt(f,t,r={}){if(!f||typeof f!="object")throw Error("expected valid options object");function e(n,o,c){let d=f[n];if(c&&d===void 0)return;let i=typeof d;if(i!==o||d===null)throw Error(`param "${n}" is invalid: expected ${o}, got ${i}`)}Object.entries(t).forEach(([n,o])=>e(n,o,!1)),Object.entries(r).forEach(([n,o])=>e(n,o,!0))}function Zt(f){let t=new WeakMap;return(r,...e)=>{let n=t.get(r);if(n!==void 0)return n;let o=f(r,...e);return t.set(r,o),o}}var W=BigInt(0),$=BigInt(1),it=BigInt(2),Pe=BigInt(3),Ke=BigInt(4),Ne=BigInt(5),tf=BigInt(7),Ue=BigInt(8),ef=BigInt(9),be=BigInt(16);function D(f,t){let r=f%t;return r>=W?r:t+r}function H(f,t,r){let e=f;for(;t-- >W;)e*=e,e%=r;return e}function ge(f,t){if(f===W)throw Error("invert: expected non-zero number");if(t<=W)throw Error("invert: expected positive modulus, got "+t);let r=D(f,t),e=t,n=W,o=$;for(;r!==W;){let c=e%r,d=n-o*(e/r);e=r,r=c,n=o,o=d}if(e!==$)throw Error("invert: does not exist");return D(n,t)}function _t(f,t,r){if(!f.eql(f.sqr(t),r))throw Error("Cannot find square root")}function Ve(f,t){let r=(f.ORDER+$)/Ke,e=f.pow(t,r);return _t(f,e,t),e}function ff(f,t){let r=(f.ORDER-Ne)/Ue,e=f.mul(t,it),n=f.pow(e,r),o=f.mul(t,n),c=f.mul(f.mul(o,it),n),d=f.mul(o,f.sub(c,f.ONE));return _t(f,d,t),d}function pe(f){if(f<Pe)throw Error("sqrt is not defined for small field");let t=f-$,r=0;for(;t%it===W;)t/=it,r++;let e=it,n=J(f);for(;ye(n,e)===1;)if(e++>1e3)throw Error("Cannot find square root: probably non-prime P");if(r===1)return Ve;let o=n.pow(e,t),c=(t+$)/it;return function(d,i){if(d.is0(i))return i;if(ye(d,i)!==1)throw Error("Cannot find square root");let K=r,E=d.mul(d.ONE,o),w=d.pow(i,t),a=d.pow(i,c);for(;!d.eql(w,d.ONE);){if(d.is0(w))return d.ZERO;let O=1,b=d.sqr(w);for(;!d.eql(b,d.ONE);)if(O++,b=d.sqr(b),O===K)throw Error("Cannot find square root");let V=$<<BigInt(K-O-1),q=d.pow(E,V);K=O,E=d.sqr(q),w=d.mul(w,E),a=d.mul(a,q)}return a}}function rf(f){return f%Ke===Pe?Ve:f%Ue===Ne?ff:f%be===ef?function(t){let r=J(t),e=pe(t),n=e(r,r.neg(r.ONE)),o=e(r,n),c=e(r,r.neg(n)),d=(t+tf)/be;return(i,K)=>{let E=i.pow(K,d),w=i.mul(E,n),a=i.mul(E,o),O=i.mul(E,c),b=i.eql(i.sqr(w),K),V=i.eql(i.sqr(a),K);E=i.cmov(E,w,b),w=i.cmov(O,a,V);let q=i.eql(i.sqr(w),K),u=i.cmov(E,w,q);return _t(i,u,K),u}}(f):pe(f)}var nf=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ce(f,t,r=!1){let e=Array(t.length).fill(r?f.ZERO:void 0),n=t.reduce((c,d,i)=>f.is0(d)?c:(e[i]=c,f.mul(c,d)),f.ONE),o=f.inv(n);return t.reduceRight((c,d,i)=>f.is0(d)?c:(e[i]=f.mul(c,e[i]),f.mul(c,d)),o),e}function ye(f,t){let r=(f.ORDER-$)/it,e=f.pow(t,r),n=f.eql(e,f.ONE),o=f.eql(e,f.ZERO),c=f.eql(e,f.neg(f.ONE));if(!n&&!o&&!c)throw Error("invalid Legendre symbol result");return n?1:o?0:-1}function Te(f,t){t!==void 0&&fe(t);let r=t!==void 0?t:f.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function J(f,t,r=!1,e={}){if(f<=W)throw Error("invalid field: expected ORDER > 0, got "+f);let n,o,c,d=!1;if(typeof t=="object"&&t!=null){if(e.sqrt||r)throw Error("cannot specify opts in two arguments");let a=t;a.BITS&&(n=a.BITS),a.sqrt&&(o=a.sqrt),typeof a.isLE=="boolean"&&(r=a.isLE),typeof a.modFromBytes=="boolean"&&(d=a.modFromBytes),c=a.allowedLengths}else typeof t=="number"&&(n=t),e.sqrt&&(o=e.sqrt);let{nBitLength:i,nByteLength:K}=Te(f,n);if(K>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let E,w=Object.freeze({ORDER:f,isLE:r,BITS:i,BYTES:K,MASK:St(i),ZERO:W,ONE:$,allowedLengths:c,create:a=>D(a,f),isValid:a=>{if(typeof a!="bigint")throw Error("invalid field element: expected bigint, got "+typeof a);return W<=a&&a<f},is0:a=>a===W,isValidNot0:a=>!w.is0(a)&&w.isValid(a),isOdd:a=>(a&$)===$,neg:a=>D(-a,f),eql:(a,O)=>a===O,sqr:a=>D(a*a,f),add:(a,O)=>D(a+O,f),sub:(a,O)=>D(a-O,f),mul:(a,O)=>D(a*O,f),pow:(a,O)=>function(b,V,q){if(q<W)throw Error("invalid exponent, negatives unsupported");if(q===W)return b.ONE;if(q===$)return V;let u=b.ONE,v=V;for(;q>W;)q&$&&(u=b.mul(u,v)),v=b.sqr(v),q>>=$;return u}(w,a,O),div:(a,O)=>D(a*ge(O,f),f),sqrN:a=>a*a,addN:(a,O)=>a+O,subN:(a,O)=>a-O,mulN:(a,O)=>a*O,inv:a=>ge(a,f),sqrt:o||(a=>(E||(E=rf(f)),E(w,a))),toBytes:a=>r?Qt(a,K):Jt(a,K),fromBytes:(a,O=!0)=>{if(c){if(!c.includes(a.length)||a.length>K)throw Error("Field.fromBytes: expected "+c+" bytes, got "+a.length);let V=new Uint8Array(K);V.set(a,r?0:V.length-a.length),a=V}if(a.length!==K)throw Error("Field.fromBytes: expected "+K+" bytes, got "+a.length);let b=r?dt(a):Ut(a);if(d&&(b=D(b,f)),!O&&!w.isValid(b))throw Error("invalid field element: outside of range 0..ORDER");return b},invertBatch:a=>Ce(w,a),cmov:(a,O,b)=>b?O:a});return Object.freeze(w)}function ke(f){if(typeof f!="bigint")throw Error("field order must be bigint");let t=f.toString(2).length;return Math.ceil(t/8)}function me(f){let t=ke(f);return t+Math.ceil(t/2)}var Pt=class extends oe{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,Vt(t);let e=ne(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let n=this.blockLen,o=new Uint8Array(n);o.set(e.length>n?t.create().update(e).digest():e);for(let c=0;c<o.length;c++)o[c]^=54;this.iHash.update(o),this.oHash=t.create();for(let c=0;c<o.length;c++)o[c]^=106;this.oHash.update(o),re(o)}update(t){return Ct(this),this.iHash.update(t),this}digestInto(t){Ct(this),Rt(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:e,finished:n,destroyed:o,blockLen:c,outputLen:d}=this;return t.finished=n,t.destroyed=o,t.blockLen=c,t.outputLen=d,t.oHash=r._cloneInto(t.oHash),t.iHash=e._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},je=(f,t,r)=>new Pt(f,t).update(r).digest();je.create=(f,t)=>new Pt(f,t);var yt=BigInt(0),st=BigInt(1);function Kt(f,t){let r=t.negate();return f?r:t}function ct(f,t){let r=Ce(f.Fp,t.map(e=>e.Z));return t.map((e,n)=>f.fromAffine(e.toAffine(r[n])))}function Le(f,t){if(!Number.isSafeInteger(f)||f<=0||f>t)throw Error("invalid window size, expected [1.."+t+"], got W="+f)}function jt(f,t){Le(f,t);let r=2**f;return{windows:Math.ceil(t/f)+1,windowSize:2**(f-1),mask:St(f),maxNumber:r,shiftBy:BigInt(f)}}function Be(f,t,r){let{windowSize:e,mask:n,maxNumber:o,shiftBy:c}=r,d=Number(f&n),i=f>>c;d>e&&(d-=o,i+=st);let K=t*e;return{nextN:i,offset:K+Math.abs(d)-1,isZero:d===0,isNeg:d<0,isNegF:t%2!=0,offsetF:K}}var Lt=new WeakMap,Ge=new WeakMap;function Gt(f){return Ge.get(f)||1}function we(f){if(f!==yt)throw Error("invalid wNAF")}var Nt=class{constructor(t,r){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=r}_unsafeLadder(t,r,e=this.ZERO){let n=t;for(;r>yt;)r&st&&(e=e.add(n)),n=n.double(),r>>=st;return e}precomputeWindow(t,r){let{windows:e,windowSize:n}=jt(r,this.bits),o=[],c=t,d=c;for(let i=0;i<e;i++){d=c,o.push(d);for(let K=1;K<n;K++)d=d.add(c),o.push(d);c=d.double()}return o}wNAF(t,r,e){if(!this.Fn.isValid(e))throw Error("invalid scalar");let n=this.ZERO,o=this.BASE,c=jt(t,this.bits);for(let d=0;d<c.windows;d++){let{nextN:i,offset:K,isZero:E,isNeg:w,isNegF:a,offsetF:O}=Be(e,d,c);e=i,E?o=o.add(Kt(a,r[O])):n=n.add(Kt(w,r[K]))}return we(e),{p:n,f:o}}wNAFUnsafe(t,r,e,n=this.ZERO){let o=jt(t,this.bits);for(let c=0;c<o.windows&&e!==yt;c++){let{nextN:d,offset:i,isZero:K,isNeg:E}=Be(e,c,o);if(e=d,!K){let w=r[i];n=n.add(E?w.negate():w)}}return we(e),n}getPrecomputes(t,r,e){let n=Lt.get(r);return n||(n=this.precomputeWindow(r,t),t!==1&&(typeof e=="function"&&(n=e(n)),Lt.set(r,n))),n}cached(t,r,e){let n=Gt(t);return this.wNAF(n,this.getPrecomputes(n,t,e),r)}unsafe(t,r,e,n){let o=Gt(t);return o===1?this._unsafeLadder(t,r,n):this.wNAFUnsafe(o,this.getPrecomputes(o,t,e),r,n)}createCache(t,r){Le(r,this.bits),Ge.set(t,r),Lt.delete(t)}hasCache(t){return Gt(t)!==1}};function He(f,t,r,e){(function(a,O){if(!Array.isArray(a))throw Error("array expected");a.forEach((b,V)=>{if(!(b instanceof O))throw Error("invalid point at index "+V)})})(r,f),function(a,O){if(!Array.isArray(a))throw Error("array of scalars expected");a.forEach((b,V)=>{if(!O.isValid(b))throw Error("invalid scalar at index "+V)})}(e,t);let n=r.length,o=e.length;if(n!==o)throw Error("arrays of points and scalars must have equal length");let c=f.ZERO,d=Ze(BigInt(n)),i=1;d>12?i=d-3:d>4?i=d-2:d>0&&(i=2);let K=St(i),E=Array(Number(K)+1).fill(c),w=c;for(let a=Math.floor((t.BITS-1)/i)*i;a>=0;a-=i){E.fill(c);for(let b=0;b<o;b++){let V=e[b],q=Number(V>>BigInt(a)&K);E[q]=E[q].add(r[b])}let O=c;for(let b=E.length-1,V=c;b>0;b--)V=V.add(E[b]),O=O.add(V);if(w=w.add(O),a!==0)for(let b=0;b<i;b++)w=w.double()}return w}function Ee(f,t,r){if(t){if(t.ORDER!==f)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return function(e){mt(e,nf.reduce((n,o)=>(n[o]="function",n),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"}))}(t),t}return J(f,{isLE:r})}function Ye(f,t,r={},e){if(e===void 0&&(e=f==="edwards"),!t||typeof t!="object")throw Error(`expected valid ${f} CURVE object`);for(let d of["p","n","h"]){let i=t[d];if(!(typeof i=="bigint"&&i>yt))throw Error(`CURVE.${d} must be positive bigint`)}let n=Ee(t.p,r.Fp,e),o=Ee(t.n,r.Fn,e),c=["Gx","Gy","a",f==="weierstrass"?"b":"d"];for(let d of c)if(!n.isValid(t[d]))throw Error(`CURVE.${d} must be valid field element of CURVE.Fp`);return{CURVE:t=Object.freeze(Object.assign({},t)),Fp:n,Fn:o}}var xe=(f,t)=>(f+(f>=0?t:-t)/ze)/t;function Dt(f){if(!["compact","recovered","der"].includes(f))throw Error('Signature format must be "compact", "recovered", or "der"');return f}function Ht(f,t){let r={};for(let e of Object.keys(t))r[e]=f[e]===void 0?t[e]:f[e];return at(r.lowS,"lowS"),at(r.prehash,"prehash"),r.format!==void 0&&Dt(r.format),r}var et={Err:class extends Error{constructor(f=""){super(f)}},_tlv:{encode:(f,t)=>{let{Err:r}=et;if(f<0||f>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");let e=t.length/2,n=Ft(e);if(n.length/2&128)throw new r("tlv.encode: long form length too big");let o=e>127?Ft(n.length/2|128):"";return Ft(f)+o+n+t},decode(f,t){let{Err:r}=et,e=0;if(f<0||f>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[e++]!==f)throw new r("tlv.decode: wrong tlv");let n=t[e++],o=0;if(128&n){let d=127&n;if(!d)throw new r("tlv.decode(long): indefinite length not supported");if(d>4)throw new r("tlv.decode(long): byte length is too big");let i=t.subarray(e,e+d);if(i.length!==d)throw new r("tlv.decode: length bytes not complete");if(i[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(let K of i)o=o<<8|K;if(e+=d,o<128)throw new r("tlv.decode(long): not minimal encoding")}else o=n;let c=t.subarray(e,e+o);if(c.length!==o)throw new r("tlv.decode: wrong value length");return{v:c,l:t.subarray(e+o)}}},_int:{encode(f){let{Err:t}=et;if(f<ft)throw new t("integer: negative integers are not allowed");let r=Ft(f);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(f){let{Err:t}=et;if(128&f[0])throw new t("invalid signature integer: negative");if(f[0]===0&&!(128&f[1]))throw new t("invalid signature integer: unnecessary leading zero");return Ut(f)}},toSig(f){let{Err:t,_int:r,_tlv:e}=et,n=Y("signature",f),{v:o,l:c}=e.decode(48,n);if(c.length)throw new t("invalid signature: left bytes after parsing");let{v:d,l:i}=e.decode(2,o),{v:K,l:E}=e.decode(2,i);if(E.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(d),s:r.decode(K)}},hexFromSig(f){let{_tlv:t,_int:r}=et,e=t.encode(2,r.encode(f.r))+t.encode(2,r.encode(f.s));return t.encode(48,e)}},ft=BigInt(0),gt=BigInt(1),ze=BigInt(2),At=BigInt(3),of=BigInt(4);function pt(f,t){let{BYTES:r}=f,e;if(typeof t=="bigint")e=t;else{let n=Y("private key",t);try{e=f.fromBytes(n)}catch{throw Error(`invalid private key: expected ui8a of size ${r}, got ${typeof t}`)}}if(!f.isValidNot0(e))throw Error("invalid private key: out of range [1..N-1]");return e}function sf(f,t={}){let r=Ye("weierstrass",f,t),{Fp:e,Fn:n}=r,o=r.CURVE,{h:c,n:d}=o;mt(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:i}=t;if(i&&(!e.is0(o.a)||typeof i.beta!="bigint"||!Array.isArray(i.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');let K=Xe(e,n);function E(){if(!e.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let w=t.toBytes||function(g,s,h){let{x:y,y:I}=s.toAffine(),P=e.toBytes(y);if(at(h,"isCompressed"),h){E();let m=!e.isOdd(I);return Q(De(m),P)}return Q(Uint8Array.of(4),P,e.toBytes(I))},a=t.fromBytes||function(g){_(g,void 0,"Point");let{publicKey:s,publicKeyUncompressed:h}=K,y=g.length,I=g[0],P=g.subarray(1);if(y!==s||I!==2&&I!==3){if(y===h&&I===4){let m=e.BYTES,x=e.fromBytes(P.subarray(0,m)),B=e.fromBytes(P.subarray(m,2*m));if(!b(x,B))throw Error("bad point: is not on curve");return{x,y:B}}throw Error(`bad point: got length ${y}, expected compressed=${s} or uncompressed=${h}`)}{let m=e.fromBytes(P);if(!e.isValid(m))throw Error("bad point: is not on curve, wrong x");let x=O(m),B;try{B=e.sqrt(x)}catch(Z){let F=Z instanceof Error?": "+Z.message:"";throw Error("bad point: is not on curve, sqrt error"+F)}return E(),!(1&~I)!==e.isOdd(B)&&(B=e.neg(B)),{x:m,y:B}}};function O(g){let s=e.sqr(g),h=e.mul(s,g);return e.add(e.add(h,e.mul(g,o.a)),o.b)}function b(g,s){let h=e.sqr(s),y=O(g);return e.eql(h,y)}if(!b(o.Gx,o.Gy))throw Error("bad curve params: generator point");let V=e.mul(e.pow(o.a,At),of),q=e.mul(e.sqr(o.b),BigInt(27));if(e.is0(e.add(V,q)))throw Error("bad curve params: a or b");function u(g,s,h=!1){if(!e.isValid(s)||h&&e.is0(s))throw Error("bad point coordinate "+g);return s}function v(g){if(!(g instanceof R))throw Error("ProjectivePoint expected")}function p(g){if(!i||!i.basises)throw Error("no endo");return function(s,h,y){let[[I,P],[m,x]]=h,B=xe(x*s,y),Z=xe(-P*s,y),F=s-B*I-Z*m,j=-B*P-Z*x,T=F<ft,U=j<ft;T&&(F=-F),U&&(j=-j);let L=St(Math.ceil(Ze(y)/2))+gt;if(F<ft||F>=L||j<ft||j>=L)throw Error("splitScalar (endomorphism): failed, k="+s);return{k1neg:T,k1:F,k2neg:U,k2:j}}(g,i.basises,n.ORDER)}let S=Zt((g,s)=>{let{X:h,Y:y,Z:I}=g;if(e.eql(I,e.ONE))return{x:h,y};let P=g.is0();s==null&&(s=P?e.ONE:e.inv(I));let m=e.mul(h,s),x=e.mul(y,s),B=e.mul(I,s);if(P)return{x:e.ZERO,y:e.ZERO};if(!e.eql(B,e.ONE))throw Error("invZ was invalid");return{x:m,y:x}}),N=Zt(g=>{if(g.is0()){if(t.allowInfinityPoint&&!e.is0(g.Y))return;throw Error("bad point: ZERO")}let{x:s,y:h}=g.toAffine();if(!e.isValid(s)||!e.isValid(h))throw Error("bad point: x or y not field elements");if(!b(s,h))throw Error("bad point: equation left != right");if(!g.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function C(g,s,h,y,I){return h=new R(e.mul(h.X,g),h.Y,h.Z),s=Kt(y,s),h=Kt(I,h),s.add(h)}class R{constructor(s,h,y){this.X=u("x",s),this.Y=u("y",h,!0),this.Z=u("z",y),Object.freeze(this)}static CURVE(){return o}static fromAffine(s){let{x:h,y}=s||{};if(!s||!e.isValid(h)||!e.isValid(y))throw Error("invalid affine point");if(s instanceof R)throw Error("projective point not allowed");return e.is0(h)&&e.is0(y)?R.ZERO:new R(h,y,e.ONE)}static fromBytes(s){let h=R.fromAffine(a(_(s,void 0,"point")));return h.assertValidity(),h}static fromHex(s){return R.fromBytes(Y("pointHex",s))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(s=8,h=!0){return l.createCache(this,s),h||this.multiply(At),this}assertValidity(){N(this)}hasEvenY(){let{y:s}=this.toAffine();if(!e.isOdd)throw Error("Field doesn't support isOdd");return!e.isOdd(s)}equals(s){v(s);let{X:h,Y:y,Z:I}=this,{X:P,Y:m,Z:x}=s,B=e.eql(e.mul(h,x),e.mul(P,I)),Z=e.eql(e.mul(y,x),e.mul(m,I));return B&&Z}negate(){return new R(this.X,e.neg(this.Y),this.Z)}double(){let{a:s,b:h}=o,y=e.mul(h,At),{X:I,Y:P,Z:m}=this,x=e.ZERO,B=e.ZERO,Z=e.ZERO,F=e.mul(I,I),j=e.mul(P,P),T=e.mul(m,m),U=e.mul(I,P);return U=e.add(U,U),Z=e.mul(I,m),Z=e.add(Z,Z),x=e.mul(s,Z),B=e.mul(y,T),B=e.add(x,B),x=e.sub(j,B),B=e.add(j,B),B=e.mul(x,B),x=e.mul(U,x),Z=e.mul(y,Z),T=e.mul(s,T),U=e.sub(F,T),U=e.mul(s,U),U=e.add(U,Z),Z=e.add(F,F),F=e.add(Z,F),F=e.add(F,T),F=e.mul(F,U),B=e.add(B,F),T=e.mul(P,m),T=e.add(T,T),F=e.mul(T,U),x=e.sub(x,F),Z=e.mul(T,j),Z=e.add(Z,Z),Z=e.add(Z,Z),new R(x,B,Z)}add(s){v(s);let{X:h,Y:y,Z:I}=this,{X:P,Y:m,Z:x}=s,B=e.ZERO,Z=e.ZERO,F=e.ZERO,j=o.a,T=e.mul(o.b,At),U=e.mul(h,P),L=e.mul(y,m),k=e.mul(I,x),z=e.add(h,y),G=e.add(P,m);z=e.mul(z,G),G=e.add(U,L),z=e.sub(z,G),G=e.add(h,I);let X=e.add(P,x);return G=e.mul(G,X),X=e.add(U,k),G=e.sub(G,X),X=e.add(y,I),B=e.add(m,x),X=e.mul(X,B),B=e.add(L,k),X=e.sub(X,B),F=e.mul(j,G),B=e.mul(T,k),F=e.add(B,F),B=e.sub(L,F),F=e.add(L,F),Z=e.mul(B,F),L=e.add(U,U),L=e.add(L,U),k=e.mul(j,k),G=e.mul(T,G),L=e.add(L,k),k=e.sub(U,k),k=e.mul(j,k),G=e.add(G,k),U=e.mul(L,G),Z=e.add(Z,U),U=e.mul(X,G),B=e.mul(z,B),B=e.sub(B,U),U=e.mul(z,L),F=e.mul(X,F),F=e.add(F,U),new R(B,Z,F)}subtract(s){return this.add(s.negate())}is0(){return this.equals(R.ZERO)}multiply(s){let{endo:h}=t;if(!n.isValidNot0(s))throw Error("invalid scalar: out of range");let y,I,P=m=>l.cached(this,m,x=>ct(R,x));if(h){let{k1neg:m,k1:x,k2neg:B,k2:Z}=p(s),{p:F,f:j}=P(x),{p:T,f:U}=P(Z);I=j.add(U),y=C(h.beta,F,T,m,B)}else{let{p:m,f:x}=P(s);y=m,I=x}return ct(R,[y,I])[0]}multiplyUnsafe(s){let{endo:h}=t,y=this;if(!n.isValid(s))throw Error("invalid scalar: out of range");if(s===ft||y.is0())return R.ZERO;if(s===gt)return y;if(l.hasCache(this))return this.multiply(s);if(h){let{k1neg:I,k1:P,k2neg:m,k2:x}=p(s),{p1:B,p2:Z}=function(F,j,T,U){let L=j,k=F.ZERO,z=F.ZERO;for(;T>yt||U>yt;)T&st&&(k=k.add(L)),U&st&&(z=z.add(L)),L=L.double(),T>>=st,U>>=st;return{p1:k,p2:z}}(R,y,P,x);return C(h.beta,B,Z,I,m)}return l.unsafe(y,s)}multiplyAndAddUnsafe(s,h,y){let I=this.multiplyUnsafe(h).add(s.multiplyUnsafe(y));return I.is0()?void 0:I}toAffine(s){return S(this,s)}isTorsionFree(){let{isTorsionFree:s}=t;return c===gt||(s?s(R,this):l.unsafe(this,d).is0())}clearCofactor(){let{clearCofactor:s}=t;return c===gt?this:s?s(R,this):this.multiplyUnsafe(c)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}toBytes(s=!0){return at(s,"isCompressed"),this.assertValidity(),w(R,this,s)}toHex(s=!0){return nt(this.toBytes(s))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(s=!0){return this.toBytes(s)}_setWindowSize(s){this.precompute(s)}static normalizeZ(s){return ct(R,s)}static msm(s,h){return He(R,n,s,h)}static fromPrivateKey(s){return R.BASE.multiply(pt(n,s))}}R.BASE=new R(o.Gx,o.Gy,e.ONE),R.ZERO=new R(e.ZERO,e.ONE,e.ZERO),R.Fp=e,R.Fn=n;let A=n.BITS,l=new Nt(R,t.endo?Math.ceil(A/2):A);return R.BASE.precompute(8),R}function De(f){return Uint8Array.of(f?2:3)}function Xe(f,t){return{secretKey:t.BYTES,publicKey:1+f.BYTES,publicKeyUncompressed:1+2*f.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function cf(f,t={}){let{Fn:r}=f,e=t.randomBytes||vt,n=Object.assign(Xe(f.Fp,r),{seed:me(r.ORDER)});function o(E){try{return!!pt(r,E)}catch{return!1}}function c(E=e(n.seed)){return function(w,a,O=!1){let b=w.length,V=ke(a),q=me(a);if(b<16||b<q||b>1024)throw Error("expected "+q+"-1024 bytes of input, got "+b);let u=D(O?dt(w):Ut(w),a-$)+$;return O?Qt(u,V):Jt(u,V)}(_(E,n.seed,"seed"),r.ORDER)}function d(E,w=!0){return f.BASE.multiply(pt(r,E)).toBytes(w)}function i(E){if(typeof E=="bigint")return!1;if(E instanceof f)return!0;let{secretKey:w,publicKey:a,publicKeyUncompressed:O}=n;if(r.allowedLengths||w===a)return;let b=Y("key",E).length;return b===a||b===O}return Object.freeze({getPublicKey:d,getSharedSecret:function(E,w,a=!0){if(i(E)===!0)throw Error("first arg must be private key");if(i(w)===!1)throw Error("second arg must be public key");let O=pt(r,E);return f.fromHex(w).multiply(O).toBytes(a)},keygen:function(E){let w=c(E);return{secretKey:w,publicKey:d(w)}},Point:f,utils:{isValidSecretKey:o,isValidPublicKey:function(E,w){let{publicKey:a,publicKeyUncompressed:O}=n;try{let b=E.length;return(w!==!0||b===a)&&(w!==!1||b===O)&&!!f.fromBytes(E)}catch{return!1}},randomSecretKey:c,isValidPrivateKey:o,randomPrivateKey:c,normPrivateKeyToScalar:E=>pt(r,E),precompute:(E=8,w=f.BASE)=>w.precompute(E,!1)},lengths:n})}function af(f,t,r={}){Vt(t),mt(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let e=r.randomBytes||vt,n=r.hmac||((A,...l)=>je(t,A,Q(...l))),{Fp:o,Fn:c}=f,{ORDER:d,BITS:i}=c,{keygen:K,getPublicKey:E,getSharedSecret:w,utils:a,lengths:O}=cf(f,r),b={prehash:!1,lowS:typeof r.lowS=="boolean"&&r.lowS,format:void 0,extraEntropy:!1},V="compact";function q(A){return A>d>>gt}function u(A,l){if(!c.isValidNot0(l))throw Error(`invalid signature ${A}: out of range 1..Point.Fn.ORDER`);return l}class v{constructor(l,g,s){this.r=u("r",l),this.s=u("s",g),s!=null&&(this.recovery=s),Object.freeze(this)}static fromBytes(l,g=V){let s;if(function(P,m){Dt(m);let x=O.signature;_(P,m==="compact"?x:m==="recovered"?x+1:void 0,m+" signature")}(l,g),g==="der"){let{r:P,s:m}=et.toSig(_(l));return new v(P,m)}g==="recovered"&&(s=l[0],g="compact",l=l.subarray(1));let h=c.BYTES,y=l.subarray(0,h),I=l.subarray(h,2*h);return new v(c.fromBytes(y),c.fromBytes(I),s)}static fromHex(l,g){return this.fromBytes(xt(l),g)}addRecoveryBit(l){return new v(this.r,this.s,l)}recoverPublicKey(l){let g=o.ORDER,{r:s,s:h,recovery:y}=this;if(y==null||![0,1,2,3].includes(y))throw Error("recovery id invalid");if(d*ze<g&&y>1)throw Error("recovery id is ambiguous for h>1 curve");let I=y===2||y===3?s+d:s;if(!o.isValid(I))throw Error("recovery id 2 or 3 invalid");let P=o.toBytes(I),m=f.fromBytes(Q(De(!(1&y)),P)),x=c.inv(I),B=S(Y("msgHash",l)),Z=c.create(-B*x),F=c.create(h*x),j=f.BASE.multiplyUnsafe(Z).add(m.multiplyUnsafe(F));if(j.is0())throw Error("point at infinify");return j.assertValidity(),j}hasHighS(){return q(this.s)}toBytes(l=V){if(Dt(l),l==="der")return xt(et.hexFromSig(this));let g=c.toBytes(this.r),s=c.toBytes(this.s);if(l==="recovered"){if(this.recovery==null)throw Error("recovery bit must be present");return Q(Uint8Array.of(this.recovery),g,s)}return Q(g,s)}toHex(l){return nt(this.toBytes(l))}assertValidity(){}static fromCompact(l){return v.fromBytes(Y("sig",l),"compact")}static fromDER(l){return v.fromBytes(Y("sig",l),"der")}normalizeS(){return this.hasHighS()?new v(this.r,c.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return nt(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return nt(this.toBytes("compact"))}}let p=r.bits2int||function(A){if(A.length>8192)throw Error("input is too large");let l=Ut(A),g=8*A.length-i;return g>0?l>>BigInt(g):l},S=r.bits2int_modN||function(A){return c.create(p(A))},N=St(i);function C(A){return Ot("num < 2^"+i,A,ft,N),c.toBytes(A)}function R(A,l){return _(A,void 0,"message"),l?_(t(A),void 0,"prehashed message"):A}return Object.freeze({keygen:K,getPublicKey:E,getSharedSecret:w,utils:a,lengths:O,Point:f,sign:function(A,l,g={}){A=Y("message",A);let{seed:s,k2sig:h}=function(y,I,P){if(["recovered","canonical"].some(L=>L in P))throw Error("sign() legacy options not supported");let{lowS:m,prehash:x,extraEntropy:B}=Ht(P,b);y=R(y,x);let Z=S(y),F=pt(c,I),j=[C(F),C(Z)];if(B!=null&&B!==!1){let L=B===!0?e(O.secretKey):B;j.push(Y("extraEntropy",L))}let T=Q(...j),U=Z;return{seed:T,k2sig:function(L){let k=p(L);if(!c.isValidNot0(k))return;let z=c.inv(k),G=f.BASE.multiply(k).toAffine(),X=c.create(G.x);if(X===ft)return;let ht=c.create(z*c.create(U+X*F));if(ht===ft)return;let Bt=(G.x===X?0:2)|Number(G.y&gt),wt=ht;return m&&q(ht)&&(wt=c.neg(ht),Bt^=1),new v(X,wt,Bt)}}}(A,l,g);return function(y,I,P){if(typeof y!="number"||y<2)throw Error("hashLen must be a number");if(typeof I!="number"||I<2)throw Error("qByteLen must be a number");if(typeof P!="function")throw Error("hmacFn must be a function");let m=k=>new Uint8Array(k),x=k=>Uint8Array.of(k),B=m(y),Z=m(y),F=0,j=()=>{B.fill(1),Z.fill(0),F=0},T=(...k)=>P(Z,B,...k),U=(k=m(0))=>{Z=T(x(0),k),B=T(),k.length!==0&&(Z=T(x(1),k),B=T())},L=()=>{if(F++>=1e3)throw Error("drbg: tried 1000 values");let k=0,z=[];for(;k<I;){B=T();let G=B.slice();z.push(G),k+=B.length}return Q(...z)};return(k,z)=>{let G;for(j(),U(k);!(G=z(L()));)U();return j(),G}}(t.outputLen,c.BYTES,n)(s,h)},verify:function(A,l,g,s={}){let{lowS:h,prehash:y,format:I}=Ht(s,b);if(g=Y("publicKey",g),l=R(Y("message",l),y),"strict"in s)throw Error("options.strict was renamed to lowS");let P=I===void 0?function(m){let x,B=typeof m=="string"||Et(m),Z=!B&&m!==null&&typeof m=="object"&&typeof m.r=="bigint"&&typeof m.s=="bigint";if(!B&&!Z)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(Z)x=new v(m.r,m.s);else if(B){try{x=v.fromBytes(Y("sig",m),"der")}catch(F){if(!(F instanceof et.Err))throw F}if(!x)try{x=v.fromBytes(Y("sig",m),"compact")}catch{return!1}}return x||!1}(A):v.fromBytes(Y("sig",A),I);if(P===!1)return!1;try{let m=f.fromBytes(g);if(h&&P.hasHighS())return!1;let{r:x,s:B}=P,Z=S(l),F=c.inv(B),j=c.create(Z*F),T=c.create(x*F),U=f.BASE.multiplyUnsafe(j).add(m.multiplyUnsafe(T));return U.is0()?!1:c.create(U.x)===x}catch{return!1}},recoverPublicKey:function(A,l,g={}){let{prehash:s}=Ht(g,b);return l=R(l,s),v.fromBytes(A,"recovered").recoverPublicKey(l).toBytes()},Signature:v,hash:t})}function df(f){let{CURVE:t,curveOpts:r}=function(n){let o={a:n.a,b:n.b,p:n.Fp.ORDER,n:n.n,h:n.h,Gx:n.Gx,Gy:n.Gy},c=n.Fp,d=n.allowedPrivateKeyLengths?Array.from(new Set(n.allowedPrivateKeyLengths.map(i=>Math.ceil(i/2)))):void 0;return{CURVE:o,curveOpts:{Fp:c,Fn:J(o.n,{BITS:n.nBitLength,allowedLengths:d,modFromBytes:n.wrapPrivateKey}),allowInfinityPoint:n.allowInfinityPoint,endo:n.endo,isTorsionFree:n.isTorsionFree,clearCofactor:n.clearCofactor,fromBytes:n.fromBytes,toBytes:n.toBytes}}}(f),e={hmac:f.hmac,randomBytes:f.randomBytes,lowS:f.lowS,bits2int:f.bits2int,bits2int_modN:f.bits2int_modN};return{CURVE:t,curveOpts:r,hash:f.hash,ecdsaOpts:e}}function uf(f){let{CURVE:t,curveOpts:r,hash:e,ecdsaOpts:n}=df(f);return function(o,c){let d=c.Point;return Object.assign({},c,{ProjectivePoint:d,CURVE:Object.assign({},o,Te(d.Fn.ORDER,d.Fn.BITS))})}(f,af(sf(t,r),e,n))}function ut(f,t){let r=e=>uf(rt(tt({},f),{hash:e}));return rt(tt({},r(t)),{create:r})}var Me={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},$e={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},We={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},lf=J(Me.p),hf=J($e.p),bf=J(We.p),gf=ut(rt(tt({},Me),{Fp:lf,lowS:!1}),Tt),pf=ut(rt(tt({},$e),{Fp:hf,lowS:!1}),ce),yf=ut(rt(tt({},We),{Fp:bf,lowS:!1,allowedPrivateKeyLengths:[130,131,132]}),se),ot=BigInt(0),M=BigInt(1),Yt=BigInt(2),mf=BigInt(8);function Je(f,t={}){let r=Ye("edwards",f,t,t.FpFnLE),{Fp:e,Fn:n}=r,o=r.CURVE,{h:c}=o;mt(t,{},{uvRatio:"function"});let d=Yt<<BigInt(8*n.BYTES)-M,i=q=>e.create(q),K=t.uvRatio||((q,u)=>{try{return{isValid:!0,value:e.sqrt(e.div(q,u))}}catch{return{isValid:!1,value:ot}}});if(!function(q,u,v,p){let S=q.sqr(v),N=q.sqr(p),C=q.add(q.mul(u.a,S),N),R=q.add(q.ONE,q.mul(u.d,q.mul(S,N)));return q.eql(C,R)}(e,o,o.Gx,o.Gy))throw Error("bad curve params: generator point");function E(q,u,v=!1){return Ot("coordinate "+q,u,v?M:ot,d),u}function w(q){if(!(q instanceof b))throw Error("ExtendedPoint expected")}let a=Zt((q,u)=>{let{X:v,Y:p,Z:S}=q,N=q.is0();u==null&&(u=N?mf:e.inv(S));let C=i(v*u),R=i(p*u),A=e.mul(S,u);if(N)return{x:ot,y:M};if(A!==M)throw Error("invZ was invalid");return{x:C,y:R}}),O=Zt(q=>{let{a:u,d:v}=o;if(q.is0())throw Error("bad point: ZERO");let{X:p,Y:S,Z:N,T:C}=q,R=i(p*p),A=i(S*S),l=i(N*N),g=i(l*l),s=i(R*u);if(i(l*i(s+A))!==i(g+i(v*i(R*A))))throw Error("bad point: equation left != right (1)");if(i(p*S)!==i(N*C))throw Error("bad point: equation left != right (2)");return!0});class b{constructor(u,v,p,S){this.X=E("x",u),this.Y=E("y",v),this.Z=E("z",p,!0),this.T=E("t",S),Object.freeze(this)}static CURVE(){return o}static fromAffine(u){if(u instanceof b)throw Error("extended point not allowed");let{x:v,y:p}=u||{};return E("x",v),E("y",p),new b(v,p,M,i(v*p))}static fromBytes(u,v=!1){let p=e.BYTES,{a:S,d:N}=o;u=he(_(u,p,"point")),at(v,"zip215");let C=he(u),R=u[p-1];C[p-1]=-129&R;let A=dt(C),l=v?d:e.ORDER;Ot("point.y",A,ot,l);let g=i(A*A),s=i(g-M),h=i(N*g-S),{isValid:y,value:I}=K(s,h);if(!y)throw Error("bad point: invalid y coordinate");let P=(I&M)===M,m=!!(128&R);if(!v&&I===ot&&m)throw Error("bad point: x=0 and x_0=1");return m!==P&&(I=i(-I)),b.fromAffine({x:I,y:A})}static fromHex(u,v=!1){return b.fromBytes(Y("point",u),v)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(u=8,v=!0){return V.createCache(this,u),v||this.multiply(Yt),this}assertValidity(){O(this)}equals(u){w(u);let{X:v,Y:p,Z:S}=this,{X:N,Y:C,Z:R}=u,A=i(v*R),l=i(N*S),g=i(p*R),s=i(C*S);return A===l&&g===s}is0(){return this.equals(b.ZERO)}negate(){return new b(i(-this.X),this.Y,this.Z,i(-this.T))}double(){let{a:u}=o,{X:v,Y:p,Z:S}=this,N=i(v*v),C=i(p*p),R=i(Yt*i(S*S)),A=i(u*N),l=v+p,g=i(i(l*l)-N-C),s=A+C,h=s-R,y=A-C,I=i(g*h),P=i(s*y),m=i(g*y),x=i(h*s);return new b(I,P,x,m)}add(u){w(u);let{a:v,d:p}=o,{X:S,Y:N,Z:C,T:R}=this,{X:A,Y:l,Z:g,T:s}=u,h=i(S*A),y=i(N*l),I=i(R*p*s),P=i(C*g),m=i((S+N)*(A+l)-h-y),x=P-I,B=P+I,Z=i(y-v*h),F=i(m*x),j=i(B*Z),T=i(m*Z),U=i(x*B);return new b(F,j,U,T)}subtract(u){return this.add(u.negate())}multiply(u){if(!n.isValidNot0(u))throw Error("invalid scalar: expected 1 <= sc < curve.n");let{p:v,f:p}=V.cached(this,u,S=>ct(b,S));return ct(b,[v,p])[0]}multiplyUnsafe(u,v=b.ZERO){if(!n.isValid(u))throw Error("invalid scalar: expected 0 <= sc < curve.n");return u===ot?b.ZERO:this.is0()||u===M?this:V.unsafe(this,u,p=>ct(b,p),v)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return V.unsafe(this,o.n).is0()}toAffine(u){return a(this,u)}clearCofactor(){return c===M?this:this.multiplyUnsafe(c)}toBytes(){let{x:u,y:v}=this.toAffine(),p=e.toBytes(v);return p[p.length-1]|=u&M?128:0,p}toHex(){return nt(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(u){return ct(b,u)}static msm(u,v){return He(b,n,u,v)}_setWindowSize(u){this.precompute(u)}toRawBytes(){return this.toBytes()}}b.BASE=new b(o.Gx,o.Gy,M,i(o.Gx*o.Gy)),b.ZERO=new b(ot,M,M,ot),b.Fp=e,b.Fn=n;let V=new Nt(b,n.BITS);return b.BASE.precompute(8),b}function Bf(f,t,r={}){if(typeof t!="function")throw Error('"hash" function param is required');mt(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:e}=r,{BASE:n,Fp:o,Fn:c}=f,d=r.randomBytes||vt,i=r.adjustScalarBytes||(p=>p),K=r.domain||((p,S,N)=>{if(at(N,"phflag"),S.length||N)throw Error("Contexts/pre-hash are not supported");return p});function E(p){return c.create(dt(p))}function w(p){let{head:S,prefix:N,scalar:C}=function(l){let g=q.secretKey;l=Y("private key",l,g);let s=Y("hashed private key",t(l),2*g),h=i(s.slice(0,g));return{head:h,prefix:s.slice(g,2*g),scalar:E(h)}}(p),R=n.multiply(C),A=R.toBytes();return{head:S,prefix:N,scalar:C,point:R,pointBytes:A}}function a(p){return w(p).pointBytes}function O(p=Uint8Array.of(),...S){let N=Q(...S);return E(t(K(N,Y("context",p),!!e)))}let b={zip215:!0},V=o.BYTES,q={secretKey:V,publicKey:V,signature:2*V,seed:V};function u(p=d(q.seed)){return _(p,q.seed,"seed")}let v={getExtendedPublicKey:w,randomSecretKey:u,isValidSecretKey:function(p){return Et(p)&&p.length===c.BYTES},isValidPublicKey:function(p,S){try{return!!f.fromBytes(p,S)}catch{return!1}},toMontgomery(p){let{y:S}=f.fromBytes(p),N=q.publicKey,C=N===32;if(!C&&N!==57)throw Error("only defined for 25519 and 448");let R=C?o.div(M+S,M-S):o.div(S-M,S+M);return o.toBytes(R)},toMontgomeryPriv(p){let S=q.secretKey;_(p,S);let N=t(p.subarray(0,S));return i(N).subarray(0,S)},randomPrivateKey:u,precompute:(p=8,S=f.BASE)=>S.precompute(p,!1)};return Object.freeze({keygen:function(p){let S=v.randomSecretKey(p);return{secretKey:S,publicKey:a(S)}},getPublicKey:a,sign:function(p,S,N={}){p=Y("message",p),e&&(p=e(p));let{prefix:C,scalar:R,pointBytes:A}=w(S),l=O(N.context,C,p),g=n.multiply(l).toBytes(),s=O(N.context,g,A,p),h=c.create(l+s*R);if(!c.isValid(h))throw Error("sign failed: invalid s");return _(Q(g,c.toBytes(h)),q.signature,"result")},verify:function(p,S,N,C=b){let{context:R,zip215:A}=C,l=q.signature;p=Y("signature",p,l),S=Y("message",S),N=Y("publicKey",N,q.publicKey),A!==void 0&&at(A,"zip215"),e&&(S=e(S));let g=l/2,s=p.subarray(0,g),h=dt(p.subarray(g,l)),y,I,P;try{y=f.fromBytes(N,A),I=f.fromBytes(s,A),P=n.multiplyUnsafe(h)}catch{return!1}if(!A&&y.isSmallOrder())return!1;let m=O(R,I.toBytes(),y.toBytes(),S);return I.add(y.multiplyUnsafe(m)).subtract(P).clearCofactor().is0()},utils:v,Point:f,lengths:q})}var It=BigInt(0),bt=BigInt(1),qt=BigInt(2);function wf(f){let t=(mt(r=f,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze(tt({},r)));var r;let{P:e,type:n,adjustScalarBytes:o,powPminus2:c,randomBytes:d}=t,i=n==="x25519";if(!i&&n!=="x448")throw Error("invalid type");let K=d||vt,E=i?255:448,w=i?32:56,a=BigInt(i?9:5),O=BigInt(i?121665:39081),b=i?qt**BigInt(254):qt**BigInt(447),V=i?BigInt(8)*qt**BigInt(251)-bt:BigInt(4)*qt**BigInt(445)-bt,q=b+V+bt,u=l=>D(l,e),v=p(a);function p(l){return Qt(u(l),w)}function S(l,g){let s=function(h,y){Ot("u",h,It,e),Ot("scalar",y,b,q);let I=y,P=h,m=bt,x=It,B=h,Z=bt,F=It;for(let T=BigInt(E-1);T>=It;T--){let U=I>>T&bt;F^=U,{x_2:m,x_3:B}=C(F,m,B),{x_2:x,x_3:Z}=C(F,x,Z),F=U;let L=m+x,k=u(L*L),z=m-x,G=u(z*z),X=k-G,ht=B+Z,Bt=u((B-Z)*L),wt=u(ht*z),te=Bt+wt,ee=Bt-wt;B=u(te*te),Z=u(P*u(ee*ee)),m=u(k*G),x=u(X*(k+u(O*X)))}({x_2:m,x_3:B}=C(F,m,B)),{x_2:x,x_3:Z}=C(F,x,Z);let j=c(x);return u(m*j)}(function(h){let y=Y("u coordinate",h,w);return i&&(y[31]&=127),u(dt(y))}(g),function(h){return dt(o(Y("scalar",h,w)))}(l));if(s===It)throw Error("invalid private or public key received");return p(s)}function N(l){return S(l,v)}function C(l,g,s){let h=u(l*(g-s));return{x_2:g=u(g-h),x_3:s=u(s+h)}}let R={secretKey:w,publicKey:w,seed:w},A=(l=K(w))=>(Rt(l,R.seed),l);return{keygen:function(l){let g=A(l);return{secretKey:g,publicKey:N(g)}},getSharedSecret:(l,g)=>S(l,g),getPublicKey:l=>N(l),scalarMult:S,scalarMultBase:N,utils:{randomSecretKey:A,randomPrivateKey:A},GuBytes:v.slice(),lengths:R}}var lt={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")},Ef=Object.assign({},lt,{d:BigInt("0xd78b4bdc7f0daf19f24f38c29373a2ccad46157242a50f37809b1da3412a12e79ccc9c81264cfe9ad080997058fb61c4243cc32dbaa156b9"),Gx:BigInt("0x79a70b2b70400553ae7c9df416c792c61128751ac92969240c25a07d728bdc93e21f7787ed6972249de732f38496cd11698713093e9c04fc"),Gy:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000001")}),xf=ie(()=>ae.create({dkLen:114})),vf=BigInt(1),Xt=BigInt(2),ve=BigInt(3);BigInt(4);var If=BigInt(11),Of=BigInt(22),Ie=BigInt(44),Sf=BigInt(88),Rf=BigInt(223);function Qe(f){let t=lt.p,r=f*f*f%t,e=r*r*f%t,n=H(e,ve,t)*e%t,o=H(n,ve,t)*e%t,c=H(o,Xt,t)*r%t,d=H(c,If,t)*c%t,i=H(d,Of,t)*d%t,K=H(i,Ie,t)*i%t,E=H(K,Sf,t)*K%t,w=H(E,Ie,t)*i%t,a=H(w,Xt,t)*r%t,O=H(a,vf,t)*f%t;return H(O,Rf,t)*a%t}function _e(f){return f[0]&=252,f[55]|=128,f[56]=0,f}function Ff(f,t){let r=lt.p,e=D(f*f*t,r),n=D(e*f,r),o=D(n*e*t,r),c=D(n*Qe(o),r),d=D(c*c,r);return{isValid:D(d*t,r)===f,value:c}}var Af=J(lt.p,{BITS:456,isLE:!0}),Oe=J(lt.n,{BITS:456,isLE:!0});function qf(f,t,r){if(t.length>255)throw Error("context must be smaller than 255, got: "+t.length);return Q((e="SigEd448",Uint8Array.from(e,(n,o)=>{let c=n.charCodeAt(0);if(n.length!==1||c>127)throw Error(`string contains non-ASCII character "${e[o]}" with code ${c} at position ${o}`);return c})),new Uint8Array([r?1:0,t.length]),t,f);var e}var Zf=function(f){let{CURVE:t,curveOpts:r,hash:e,eddsaOpts:n}=function(o){let c={a:o.a,d:o.d,p:o.Fp.ORDER,n:o.n,h:o.h,Gx:o.Gx,Gy:o.Gy},d={Fp:o.Fp,Fn:J(c.n,o.nBitLength,!0),uvRatio:o.uvRatio},i={randomBytes:o.randomBytes,adjustScalarBytes:o.adjustScalarBytes,domain:o.domain,prehash:o.prehash,mapToCurve:o.mapToCurve};return{CURVE:c,curveOpts:d,hash:o.hash,eddsaOpts:i}}(f);return function(o,c){let d=c.Point;return Object.assign({},c,{ExtendedPoint:d,CURVE:o,nBitLength:d.Fn.BITS,nByteLength:d.Fn.BYTES})}(f,Bf(Je(t,r),e,n))}(rt(tt({},lt),{Fp:Af,Fn:Oe,nBitLength:Oe.BITS,hash:xf,adjustScalarBytes:_e,domain:qf,uvRatio:Ff}));Je(Ef);var Pf=(()=>{let f=lt.p;return wf({P:f,type:"x448",powPminus2:t=>D(H(Qe(t),Xt,f)*t,f),adjustScalarBytes:_e})})(),Mt={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},Kf={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},Se=BigInt(2);var $t=J(Mt.p,{sqrt:function(f){let t=Mt.p,r=BigInt(3),e=BigInt(6),n=BigInt(11),o=BigInt(22),c=BigInt(23),d=BigInt(44),i=BigInt(88),K=f*f*f%t,E=K*K*f%t,w=H(E,r,t)*E%t,a=H(w,r,t)*E%t,O=H(a,Se,t)*K%t,b=H(O,n,t)*O%t,V=H(b,o,t)*b%t,q=H(V,d,t)*V%t,u=H(q,i,t)*q%t,v=H(u,d,t)*V%t,p=H(v,r,t)*E%t,S=H(p,c,t)*b%t,N=H(S,e,t)*K%t,C=H(N,Se,t);if(!$t.eql($t.sqr(C),f))throw Error("Cannot find square root");return C}}),Nf=ut(rt(tt({},Mt),{Fp:$t,lowS:!0,endo:Kf}),Tt),Re=J(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),Uf=ut({a:Re.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:Re,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},de),Fe=J(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),Vf=ut({a:Fe.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:Fe,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},le),Ae=J(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),Cf=ut({a:Ae.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:Ae,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},ue),kf=new Map(Object.entries({nistP256:gf,nistP384:pf,nistP521:yf,brainpoolP256r1:Uf,brainpoolP384r1:Vf,brainpoolP512r1:Cf,secp256k1:Nf,x448:Pf,ed448:Zf}));export{kf as nobleCurves};
