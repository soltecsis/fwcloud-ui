import{a as st,b as at,c as Le,e as ct,f as dt,g as Ne,h as ut,i as Te,j as Ae,n as Oe,p as Fe,q as Ze,t as $e}from"./chunk-HYJVFA4B.js";import{a as Q,b as Se}from"./chunk-GAL4ENT6.js";var qe=class extends ut{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,at(e);let r=dt(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let c=this.blockLen,i=new Uint8Array(c);i.set(r.length>c?e.create().update(r).digest():r);for(let g=0;g<i.length;g++)i[g]^=54;this.iHash.update(i),this.oHash=e.create();for(let g=0;g<i.length;g++)i[g]^=106;this.oHash.update(i),i.fill(0)}update(e){return Le(this),this.iHash.update(e),this}digestInto(e){Le(this),st(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:c,destroyed:i,blockLen:g,outputLen:d}=this;return e.finished=c,e.destroyed=i,e.blockLen=g,e.outputLen=d,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Pt=(n,e,t)=>new qe(n,e).update(t).digest();Pt.create=(n,e)=>new qe(n,e);var De=BigInt(0),ze=BigInt(1),Jt=BigInt(2);function de(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function ve(n){if(!de(n))throw Error("Uint8Array expected")}function oe(n,e){if(typeof e!="boolean")throw Error(`${n} must be valid boolean, got "${e}".`)}var Qt=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function ue(n){ve(n);let e="";for(let t=0;t<n.length;t++)e+=Qt[n[t]];return e}function me(n){let e=n.toString(16);return 1&e.length?"0"+e:e}function _e(n){if(typeof n!="string")throw Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":"0x"+n)}var ne={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function lt(n){return n>=ne._0&&n<=ne._9?n-ne._0:n>=ne._A&&n<=ne._F?n-(ne._A-10):n>=ne._a&&n<=ne._f?n-(ne._a-10):void 0}function we(n){if(typeof n!="string")throw Error("hex string expected, got "+typeof n);let e=n.length,t=e/2;if(e%2)throw Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(t);for(let c=0,i=0;c<t;c++,i+=2){let g=lt(n.charCodeAt(i)),d=lt(n.charCodeAt(i+1));if(g===void 0||d===void 0){let s=n[i]+n[i+1];throw Error('hex string expected, got non-hex character "'+s+'" at index '+i)}r[c]=16*g+d}return r}function ce(n){return _e(ue(n))}function ie(n){return ve(n),_e(ue(Uint8Array.from(n).reverse()))}function Be(n,e){return we(n.toString(16).padStart(2*e,"0"))}function Ee(n,e){return Be(n,e).reverse()}function j(n,e,t){let r;if(typeof e=="string")try{r=we(e)}catch(i){throw Error(`${n} must be valid hex string, got "${e}". Cause: ${i}`)}else{if(!de(e))throw Error(n+" must be hex string or Uint8Array");r=Uint8Array.from(e)}let c=r.length;if(typeof t=="number"&&c!==t)throw Error(`${n} expected ${t} bytes, got ${c}`);return r}function le(...n){let e=0;for(let r=0;r<n.length;r++){let c=n[r];ve(c),e+=c.length}let t=new Uint8Array(e);for(let r=0,c=0;r<n.length;r++){let i=n[r];t.set(i,c),c+=i.length}return t}var ke=n=>typeof n=="bigint"&&De<=n;function Pe(n,e,t){return ke(n)&&ke(e)&&ke(t)&&e<=n&&n<t}function J(n,e,t,r){if(!Pe(e,t,r))throw Error(`expected valid ${n}: ${t} <= n < ${r}, got ${typeof e} ${e}`)}function Ht(n){let e;for(e=0;n>De;n>>=ze,e+=1);return e}var Je=n=>(Jt<<BigInt(n-1))-ze,Ge=n=>new Uint8Array(n),ht=n=>Uint8Array.from(n);function Lt(n,e,t){if(typeof n!="number"||n<2)throw Error("hashLen must be a number");if(typeof e!="number"||e<2)throw Error("qByteLen must be a number");if(typeof t!="function")throw Error("hmacFn must be a function");let r=Ge(n),c=Ge(n),i=0,g=()=>{r.fill(1),c.fill(0),i=0},d=(...o)=>t(c,r,...o),s=(o=Ge())=>{c=d(ht([0]),o),r=d(),o.length!==0&&(c=d(ht([1]),o),r=d())},y=()=>{if(i++>=1e3)throw Error("drbg: tried 1000 values");let o=0,B=[];for(;o<e;){r=d();let A=r.slice();B.push(A),o+=r.length}return le(...B)};return(o,B)=>{let A;for(g(),s(o);!(A=B(y()));)s();return g(),A}}var Xt={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||de(n),isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,e)=>e.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function he(n,e,t={}){let r=(c,i,g)=>{let d=Xt[i];if(typeof d!="function")throw Error(`Invalid validator "${i}", expected function`);let s=n[c];if(!(g&&s===void 0||d(s,n)))throw Error(`Invalid param ${c+""}=${s} (${typeof s}), expected ${i}`)};for(let[c,i]of Object.entries(e))r(c,i,!1);for(let[c,i]of Object.entries(t))r(c,i,!0);return n}function xe(n){let e=new WeakMap;return(t,...r)=>{let c=e.get(t);if(c!==void 0)return c;let i=n(t,...r);return e.set(t,i),i}}var en=Object.freeze({__proto__:null,aInRange:J,abool:oe,abytes:ve,bitGet:function(n,e){return n>>BigInt(e)&ze},bitLen:Ht,bitMask:Je,bitSet:function(n,e,t){return n|(t?ze:De)<<BigInt(e)},bytesToHex:ue,bytesToNumberBE:ce,bytesToNumberLE:ie,concatBytes:le,createHmacDrbg:Lt,ensureBytes:j,equalBytes:function(n,e){if(n.length!==e.length)return!1;let t=0;for(let r=0;r<n.length;r++)t|=n[r]^e[r];return t===0},hexToBytes:we,hexToNumber:_e,inRange:Pe,isBytes:de,memoized:xe,notImplemented:()=>{throw Error("not implemented")},numberToBytesBE:Be,numberToBytesLE:Ee,numberToHexUnpadded:me,numberToVarBytesBE:function(n){return we(me(n))},utf8ToBytes:function(n){if(typeof n!="string")throw Error("utf8ToBytes expected string, got "+typeof n);return new Uint8Array(new TextEncoder().encode(n))},validateObject:he});var M=BigInt(0),V=BigInt(1),ae=BigInt(2),tn=BigInt(3),Ue=BigInt(4),gt=BigInt(5),bt=BigInt(8);function G(n,e){let t=n%e;return t>=M?t:e+t}function Nt(n,e,t){if(t<=M||e<M)throw Error("Expected power/modulo > 0");if(t===V)return M;let r=V;for(;e>M;)e&V&&(r=r*n%t),n=n*n%t,e>>=V;return r}function k(n,e,t){let r=n;for(;e-- >M;)r*=r,r%=t;return r}function Ke(n,e){if(n===M||e<=M)throw Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=G(n,e),r=e,c=M,i=V;for(;t!==M;){let g=r%t,d=c-i*(r/t);r=t,t=g,c=i,i=d}if(r!==V)throw Error("invert: does not exist");return G(c,e)}function nn(n){if(n%Ue===tn){let e=(n+V)/Ue;return function(t,r){let c=t.pow(r,e);if(!t.eql(t.sqr(c),r))throw Error("Cannot find square root");return c}}if(n%bt===gt){let e=(n-gt)/bt;return function(t,r){let c=t.mul(r,ae),i=t.pow(c,e),g=t.mul(r,i),d=t.mul(t.mul(g,ae),i),s=t.mul(g,t.sub(d,t.ONE));if(!t.eql(t.sqr(s),r))throw Error("Cannot find square root");return s}}return function(e){let t=(e-V)/ae,r,c,i;for(r=e-V,c=0;r%ae===M;r/=ae,c++);for(i=ae;i<e&&Nt(i,t,e)!==e-V;i++);if(c===1){let d=(e+V)/Ue;return function(s,y){let o=s.pow(y,d);if(!s.eql(s.sqr(o),y))throw Error("Cannot find square root");return o}}let g=(r+V)/ae;return function(d,s){if(d.pow(s,t)===d.neg(d.ONE))throw Error("Cannot find square root");let y=c,o=d.pow(d.mul(d.ONE,i),r),B=d.pow(s,g),A=d.pow(s,r);for(;!d.eql(A,d.ONE);){if(d.eql(A,d.ZERO))return d.ZERO;let P=1;for(let a=d.sqr(A);P<y&&!d.eql(a,d.ONE);P++)a=d.sqr(a);let I=d.pow(o,V<<BigInt(y-P-1));o=d.sqr(I),B=d.mul(B,I),A=d.mul(A,o),y=P}return B}}(n)}BigInt(9),BigInt(16);var rn=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Tt(n,e){let t=e!==void 0?e:n.toString(2).length;return{nBitLength:t,nByteLength:Math.ceil(t/8)}}function te(n,e,t=!1,r={}){if(n<=M)throw Error("Expected Field ORDER > 0, got "+n);let{nBitLength:c,nByteLength:i}=Tt(n,e);if(i>2048)throw Error("Field lengths over 2048 bytes are not supported");let g=nn(n),d=Object.freeze({ORDER:n,BITS:c,BYTES:i,MASK:Je(c),ZERO:M,ONE:V,create:s=>G(s,n),isValid:s=>{if(typeof s!="bigint")throw Error("Invalid field element: expected bigint, got "+typeof s);return M<=s&&s<n},is0:s=>s===M,isOdd:s=>(s&V)===V,neg:s=>G(-s,n),eql:(s,y)=>s===y,sqr:s=>G(s*s,n),add:(s,y)=>G(s+y,n),sub:(s,y)=>G(s-y,n),mul:(s,y)=>G(s*y,n),pow:(s,y)=>function(o,B,A){if(A<M)throw Error("Expected power > 0");if(A===M)return o.ONE;if(A===V)return B;let P=o.ONE,I=B;for(;A>M;)A&V&&(P=o.mul(P,I)),I=o.sqr(I),A>>=V;return P}(d,s,y),div:(s,y)=>G(s*Ke(y,n),n),sqrN:s=>s*s,addN:(s,y)=>s+y,subN:(s,y)=>s-y,mulN:(s,y)=>s*y,inv:s=>Ke(s,n),sqrt:r.sqrt||(s=>g(d,s)),invertBatch:s=>function(y,o){let B=Array(o.length),A=o.reduce((I,a,l)=>y.is0(a)?I:(B[l]=I,y.mul(I,a)),y.ONE),P=y.inv(A);return o.reduceRight((I,a,l)=>y.is0(a)?I:(B[l]=y.mul(I,B[l]),y.mul(I,a)),P),B}(d,s),cmov:(s,y,o)=>o?y:s,toBytes:s=>t?Ee(s,i):Be(s,i),fromBytes:s=>{if(s.length!==i)throw Error(`Fp.fromBytes: expected ${i}, got ${s.length}`);return t?ie(s):ce(s)}});return Object.freeze(d)}function Ft(n){if(typeof n!="bigint")throw Error("field order must be bigint");let e=n.toString(2).length;return Math.ceil(e/8)}function yt(n){let e=Ft(n);return e+Math.ceil(e/2)}var fn=BigInt(0),Ce=BigInt(1),je=new WeakMap,pt=new WeakMap;function Zt(n,e){let t=(i,g)=>{let d=g.negate();return i?d:g},r=i=>{if(!Number.isSafeInteger(i)||i<=0||i>e)throw Error(`Wrong window size=${i}, should be [1..${e}]`)},c=i=>(r(i),{windows:Math.ceil(e/i)+1,windowSize:2**(i-1)});return{constTimeNegate:t,unsafeLadder(i,g){let d=n.ZERO,s=i;for(;g>fn;)g&Ce&&(d=d.add(s)),s=s.double(),g>>=Ce;return d},precomputeWindow(i,g){let{windows:d,windowSize:s}=c(g),y=[],o=i,B=o;for(let A=0;A<d;A++){B=o,y.push(B);for(let P=1;P<s;P++)B=B.add(o),y.push(B);o=B.double()}return y},wNAF(i,g,d){let{windows:s,windowSize:y}=c(i),o=n.ZERO,B=n.BASE,A=BigInt(2**i-1),P=2**i,I=BigInt(i);for(let a=0;a<s;a++){let l=a*y,v=Number(d&A);d>>=I,v>y&&(v-=P,d+=Ce);let O=l,E=l+Math.abs(v)-1,N=a%2!=0,q=v<0;v===0?B=B.add(t(N,g[O])):o=o.add(t(q,g[E]))}return{p:o,f:B}},wNAFCached(i,g,d){let s=pt.get(i)||1,y=je.get(i);return y||(y=this.precomputeWindow(i,s),s!==1&&je.set(i,d(y))),this.wNAF(s,y,g)},setWindowSize(i,g){r(g),pt.set(i,g),je.delete(i)}}}function $t(n,e,t,r){if(!Array.isArray(t)||!Array.isArray(r)||r.length!==t.length)throw Error("arrays of points and scalars must have equal length");r.forEach((o,B)=>{if(!e.isValid(o))throw Error("wrong scalar at index "+B)}),t.forEach((o,B)=>{if(!(o instanceof n))throw Error("wrong point at index "+B)});let c=Ht(BigInt(t.length)),i=c>12?c-3:c>4?c-2:c?2:1,g=(1<<i)-1,d=Array(g+1).fill(n.ZERO),s=Math.floor((e.BITS-1)/i)*i,y=n.ZERO;for(let o=s;o>=0;o-=i){d.fill(n.ZERO);for(let A=0;A<r.length;A++){let P=r[A],I=Number(P>>BigInt(o)&BigInt(g));d[I]=d[I].add(t[A])}let B=n.ZERO;for(let A=d.length-1,P=n.ZERO;A>0;A--)P=P.add(d[A]),B=B.add(P);if(y=y.add(B),o!==0)for(let A=0;A<i;A++)y=y.double()}return y}function Qe(n){return he(n.Fp,rn.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),he(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze(Se(Q(Q({},Tt(n.n,n.nBitLength)),n),{p:n.Fp.ORDER}))}function mt(n){n.lowS!==void 0&&oe("lowS",n.lowS),n.prehash!==void 0&&oe("prehash",n.prehash)}var{bytesToNumberBE:on,hexToBytes:sn}=en,re={Err:class extends Error{constructor(n=""){super(n)}},_tlv:{encode:(n,e)=>{let{Err:t}=re;if(n<0||n>256)throw new t("tlv.encode: wrong tag");if(1&e.length)throw new t("tlv.encode: unpadded data");let r=e.length/2,c=me(r);if(c.length/2&128)throw new t("tlv.encode: long form length too big");let i=r>127?me(c.length/2|128):"";return`${me(n)}${i}${c}${e}`},decode(n,e){let{Err:t}=re,r=0;if(n<0||n>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[r++]!==n)throw new t("tlv.decode: wrong tlv");let c=e[r++],i=0;if(128&c){let d=127&c;if(!d)throw new t("tlv.decode(long): indefinite length not supported");if(d>4)throw new t("tlv.decode(long): byte length is too big");let s=e.subarray(r,r+d);if(s.length!==d)throw new t("tlv.decode: length bytes not complete");if(s[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(let y of s)i=i<<8|y;if(r+=d,i<128)throw new t("tlv.decode(long): not minimal encoding")}else i=c;let g=e.subarray(r,r+i);if(g.length!==i)throw new t("tlv.decode: wrong value length");return{v:g,l:e.subarray(r+i)}}},_int:{encode(n){let{Err:e}=re;if(n<fe)throw new e("integer: negative integers are not allowed");let t=me(n);if(8&Number.parseInt(t[0],16)&&(t="00"+t),1&t.length)throw new e("unexpected assertion");return t},decode(n){let{Err:e}=re;if(128&n[0])throw new e("Invalid signature integer: negative");if(n[0]===0&&!(128&n[1]))throw new e("Invalid signature integer: unnecessary leading zero");return on(n)}},toSig(n){let{Err:e,_int:t,_tlv:r}=re,c=typeof n=="string"?sn(n):n;ve(c);let{v:i,l:g}=r.decode(48,c);if(g.length)throw new e("Invalid signature: left bytes after parsing");let{v:d,l:s}=r.decode(2,i),{v:y,l:o}=r.decode(2,s);if(o.length)throw new e("Invalid signature: left bytes after parsing");return{r:t.decode(d),s:t.decode(y)}},hexFromSig(n){let{_tlv:e,_int:t}=re,r=`${e.encode(2,t.encode(n.r))}${e.encode(2,t.encode(n.s))}`;return e.encode(48,r)}},fe=BigInt(0),Y=BigInt(1);BigInt(2);var Bt=BigInt(3);function an(n){let e=function(I){let a=Qe(I);he(a,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:l,Fp:v,a:O}=a;if(l){if(!v.eql(O,v.ZERO))throw Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof l!="object"||typeof l.beta!="bigint"||typeof l.splitScalar!="function")throw Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze(Q({},a))}(n),{Fp:t}=e,r=te(e.n,e.nBitLength),c=e.toBytes||((I,a,l)=>{let v=a.toAffine();return le(Uint8Array.from([4]),t.toBytes(v.x),t.toBytes(v.y))}),i=e.fromBytes||(I=>{let a=I.subarray(1);return{x:t.fromBytes(a.subarray(0,t.BYTES)),y:t.fromBytes(a.subarray(t.BYTES,2*t.BYTES))}});function g(I){let{a,b:l}=e,v=t.sqr(I),O=t.mul(v,I);return t.add(t.add(O,t.mul(I,a)),l)}if(!t.eql(t.sqr(e.Gy),g(e.Gx)))throw Error("bad generator point: equation left != right");function d(I){let{allowedPrivateKeyLengths:a,nByteLength:l,wrapPrivateKey:v,n:O}=e;if(a&&typeof I!="bigint"){if(de(I)&&(I=ue(I)),typeof I!="string"||!a.includes(I.length))throw Error("Invalid key");I=I.padStart(2*l,"0")}let E;try{E=typeof I=="bigint"?I:ce(j("private key",I,l))}catch{throw Error(`private key must be ${l} bytes, hex or bigint, not ${typeof I}`)}return v&&(E=G(E,O)),J("private key",E,Y,O),E}function s(I){if(!(I instanceof B))throw Error("ProjectivePoint expected")}let y=xe((I,a)=>{let{px:l,py:v,pz:O}=I;if(t.eql(O,t.ONE))return{x:l,y:v};let E=I.is0();a==null&&(a=E?t.ONE:t.inv(O));let N=t.mul(l,a),q=t.mul(v,a),S=t.mul(O,a);if(E)return{x:t.ZERO,y:t.ZERO};if(!t.eql(S,t.ONE))throw Error("invZ was invalid");return{x:N,y:q}}),o=xe(I=>{if(I.is0()){if(e.allowInfinityPoint&&!t.is0(I.py))return;throw Error("bad point: ZERO")}let{x:a,y:l}=I.toAffine();if(!t.isValid(a)||!t.isValid(l))throw Error("bad point: x or y not FE");let v=t.sqr(l),O=g(a);if(!t.eql(v,O))throw Error("bad point: equation left != right");if(!I.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class B{constructor(a,l,v){if(this.px=a,this.py=l,this.pz=v,a==null||!t.isValid(a))throw Error("x required");if(l==null||!t.isValid(l))throw Error("y required");if(v==null||!t.isValid(v))throw Error("z required");Object.freeze(this)}static fromAffine(a){let{x:l,y:v}=a||{};if(!a||!t.isValid(l)||!t.isValid(v))throw Error("invalid affine point");if(a instanceof B)throw Error("projective point not allowed");let O=E=>t.eql(E,t.ZERO);return O(l)&&O(v)?B.ZERO:new B(l,v,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(a){let l=t.invertBatch(a.map(v=>v.pz));return a.map((v,O)=>v.toAffine(l[O])).map(B.fromAffine)}static fromHex(a){let l=B.fromAffine(i(j("pointHex",a)));return l.assertValidity(),l}static fromPrivateKey(a){return B.BASE.multiply(d(a))}static msm(a,l){return $t(B,r,a,l)}_setWindowSize(a){P.setWindowSize(this,a)}assertValidity(){o(this)}hasEvenY(){let{y:a}=this.toAffine();if(t.isOdd)return!t.isOdd(a);throw Error("Field doesn't support isOdd")}equals(a){s(a);let{px:l,py:v,pz:O}=this,{px:E,py:N,pz:q}=a,S=t.eql(t.mul(l,q),t.mul(E,O)),R=t.eql(t.mul(v,q),t.mul(N,O));return S&&R}negate(){return new B(this.px,t.neg(this.py),this.pz)}double(){let{a,b:l}=e,v=t.mul(l,Bt),{px:O,py:E,pz:N}=this,q=t.ZERO,S=t.ZERO,R=t.ZERO,H=t.mul(O,O),m=t.mul(E,E),h=t.mul(N,N),p=t.mul(O,E);return p=t.add(p,p),R=t.mul(O,N),R=t.add(R,R),q=t.mul(a,R),S=t.mul(v,h),S=t.add(q,S),q=t.sub(m,S),S=t.add(m,S),S=t.mul(q,S),q=t.mul(p,q),R=t.mul(v,R),h=t.mul(a,h),p=t.sub(H,h),p=t.mul(a,p),p=t.add(p,R),R=t.add(H,H),H=t.add(R,H),H=t.add(H,h),H=t.mul(H,p),S=t.add(S,H),h=t.mul(E,N),h=t.add(h,h),H=t.mul(h,p),q=t.sub(q,H),R=t.mul(h,m),R=t.add(R,R),R=t.add(R,R),new B(q,S,R)}add(a){s(a);let{px:l,py:v,pz:O}=this,{px:E,py:N,pz:q}=a,S=t.ZERO,R=t.ZERO,H=t.ZERO,m=e.a,h=t.mul(e.b,Bt),p=t.mul(l,E),u=t.mul(v,N),f=t.mul(O,q),b=t.add(l,v),w=t.add(E,N);b=t.mul(b,w),w=t.add(p,u),b=t.sub(b,w),w=t.add(l,O);let x=t.add(E,q);return w=t.mul(w,x),x=t.add(p,f),w=t.sub(w,x),x=t.add(v,O),S=t.add(N,q),x=t.mul(x,S),S=t.add(u,f),x=t.sub(x,S),H=t.mul(m,w),S=t.mul(h,f),H=t.add(S,H),S=t.sub(u,H),H=t.add(u,H),R=t.mul(S,H),u=t.add(p,p),u=t.add(u,p),f=t.mul(m,f),w=t.mul(h,w),u=t.add(u,f),f=t.sub(p,f),f=t.mul(m,f),w=t.add(w,f),p=t.mul(u,w),R=t.add(R,p),p=t.mul(x,w),S=t.mul(b,S),S=t.sub(S,p),p=t.mul(b,u),H=t.mul(x,H),H=t.add(H,p),new B(S,R,H)}subtract(a){return this.add(a.negate())}is0(){return this.equals(B.ZERO)}wNAF(a){return P.wNAFCached(this,a,B.normalizeZ)}multiplyUnsafe(a){J("scalar",a,fe,e.n);let l=B.ZERO;if(a===fe)return l;if(a===Y)return this;let{endo:v}=e;if(!v)return P.unsafeLadder(this,a);let{k1neg:O,k1:E,k2neg:N,k2:q}=v.splitScalar(a),S=l,R=l,H=this;for(;E>fe||q>fe;)E&Y&&(S=S.add(H)),q&Y&&(R=R.add(H)),H=H.double(),E>>=Y,q>>=Y;return O&&(S=S.negate()),N&&(R=R.negate()),R=new B(t.mul(R.px,v.beta),R.py,R.pz),S.add(R)}multiply(a){let{endo:l,n:v}=e,O,E;if(J("scalar",a,Y,v),l){let{k1neg:N,k1:q,k2neg:S,k2:R}=l.splitScalar(a),{p:H,f:m}=this.wNAF(q),{p:h,f:p}=this.wNAF(R);H=P.constTimeNegate(N,H),h=P.constTimeNegate(S,h),h=new B(t.mul(h.px,l.beta),h.py,h.pz),O=H.add(h),E=m.add(p)}else{let{p:N,f:q}=this.wNAF(a);O=N,E=q}return B.normalizeZ([O,E])[0]}multiplyAndAddUnsafe(a,l,v){let O=B.BASE,E=(q,S)=>S!==fe&&S!==Y&&q.equals(O)?q.multiply(S):q.multiplyUnsafe(S),N=E(this,l).add(E(a,v));return N.is0()?void 0:N}toAffine(a){return y(this,a)}isTorsionFree(){let{h:a,isTorsionFree:l}=e;if(a===Y)return!0;if(l)return l(B,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:a,clearCofactor:l}=e;return a===Y?this:l?l(B,this):this.multiplyUnsafe(e.h)}toRawBytes(a=!0){return oe("isCompressed",a),this.assertValidity(),c(B,this,a)}toHex(a=!0){return oe("isCompressed",a),ue(this.toRawBytes(a))}}B.BASE=new B(e.Gx,e.Gy,t.ONE),B.ZERO=new B(t.ZERO,t.ONE,t.ZERO);let A=e.nBitLength,P=Zt(B,e.endo?Math.ceil(A/2):A);return{CURVE:e,ProjectivePoint:B,normPrivateKeyToScalar:d,weierstrassEquation:g,isWithinCurveOrder:function(I){return Pe(I,Y,e.n)}}}function cn(n){let e=function(m){let h=Qe(m);return he(h,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze(Q({lowS:!0},h))}(n),{Fp:t,n:r}=e,c=t.BYTES+1,i=2*t.BYTES+1;function g(m){return G(m,r)}function d(m){return Ke(m,r)}let{ProjectivePoint:s,normPrivateKeyToScalar:y,weierstrassEquation:o,isWithinCurveOrder:B}=an(Se(Q({},e),{toBytes(m,h,p){let u=h.toAffine(),f=t.toBytes(u.x),b=le;return oe("isCompressed",p),p?b(Uint8Array.from([h.hasEvenY()?2:3]),f):b(Uint8Array.from([4]),f,t.toBytes(u.y))},fromBytes(m){let h=m.length,p=m[0],u=m.subarray(1);if(h!==c||p!==2&&p!==3){if(h===i&&p===4)return{x:t.fromBytes(u.subarray(0,t.BYTES)),y:t.fromBytes(u.subarray(t.BYTES,2*t.BYTES))};throw Error(`Point of length ${h} was invalid. Expected ${c} compressed bytes or ${i} uncompressed bytes`)}{let f=ce(u);if(!Pe(f,Y,t.ORDER))throw Error("Point is not on curve");let b=o(f),w;try{w=t.sqrt(b)}catch(x){let z=x instanceof Error?": "+x.message:"";throw Error("Point is not on curve"+z)}return!(1&~p)!=((w&Y)===Y)&&(w=t.neg(w)),{x:f,y:w}}}})),A=m=>ue(Be(m,e.nByteLength));function P(m){return m>r>>Y}let I=(m,h,p)=>ce(m.slice(h,p));class a{constructor(h,p,u){this.r=h,this.s=p,this.recovery=u,this.assertValidity()}static fromCompact(h){let p=e.nByteLength;return h=j("compactSignature",h,2*p),new a(I(h,0,p),I(h,p,2*p))}static fromDER(h){let{r:p,s:u}=re.toSig(j("DER",h));return new a(p,u)}assertValidity(){J("r",this.r,Y,r),J("s",this.s,Y,r)}addRecoveryBit(h){return new a(this.r,this.s,h)}recoverPublicKey(h){let{r:p,s:u,recovery:f}=this,b=E(j("msgHash",h));if(f==null||![0,1,2,3].includes(f))throw Error("recovery id invalid");let w=f===2||f===3?p+e.n:p;if(w>=t.ORDER)throw Error("recovery id 2 or 3 invalid");let x=1&f?"03":"02",z=s.fromHex(x+A(w)),L=d(w),F=g(-b*L),T=g(u*L),Z=s.BASE.multiplyAndAddUnsafe(z,F,T);if(!Z)throw Error("point at infinify");return Z.assertValidity(),Z}hasHighS(){return P(this.s)}normalizeS(){return this.hasHighS()?new a(this.r,g(-this.s),this.recovery):this}toDERRawBytes(){return we(this.toDERHex())}toDERHex(){return re.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return we(this.toCompactHex())}toCompactHex(){return A(this.r)+A(this.s)}}let l={isValidPrivateKey(m){try{return y(m),!0}catch{return!1}},normPrivateKeyToScalar:y,randomPrivateKey:()=>{let m=yt(e.n);return function(h,p,u=!1){let f=h.length,b=Ft(p),w=yt(p);if(f<16||f<w||f>1024)throw Error(`expected ${w}-1024 bytes of input, got ${f}`);let x=G(u?ce(h):ie(h),p-V)+V;return u?Ee(x,b):Be(x,b)}(e.randomBytes(m),e.n)},precompute:(m=8,h=s.BASE)=>(h._setWindowSize(m),h.multiply(BigInt(3)),h)};function v(m){let h=de(m),p=typeof m=="string",u=(h||p)&&m.length;return h?u===c||u===i:p?u===2*c||u===2*i:m instanceof s}let O=e.bits2int||function(m){let h=ce(m),p=8*m.length-e.nBitLength;return p>0?h>>BigInt(p):h},E=e.bits2int_modN||function(m){return g(O(m))},N=Je(e.nBitLength);function q(m){return J("num < 2^"+e.nBitLength,m,fe,N),Be(m,e.nByteLength)}function S(m,h,p=R){if(["recovered","canonical"].some($=>$ in p))throw Error("sign() legacy options not supported");let{hash:u,randomBytes:f}=e,{lowS:b,prehash:w,extraEntropy:x}=p;b==null&&(b=!0),m=j("msgHash",m),mt(p),w&&(m=j("prehashed msgHash",u(m)));let z=E(m),L=y(h),F=[q(L),q(z)];if(x!=null&&x!==!1){let $=x===!0?f(t.BYTES):x;F.push(j("extraEntropy",$))}let T=le(...F),Z=z;return{seed:T,k2sig:function($){let U=O($);if(!B(U))return;let W=d(U),C=s.BASE.multiply(U).toAffine(),K=g(C.x);if(K===fe)return;let D=g(W*g(Z+K*L));if(D===fe)return;let ee=(C.x===K?0:2)|Number(C.y&Y),se=D;return b&&P(D)&&(se=function(be){return P(be)?g(-be):be}(D),ee^=1),new a(K,se,ee)}}}let R={lowS:e.lowS,prehash:!1},H={lowS:e.lowS,prehash:!1};return s.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(m,h=!0){return s.fromPrivateKey(m).toRawBytes(h)},getSharedSecret:function(m,h,p=!0){if(v(m))throw Error("first arg must be private key");if(!v(h))throw Error("second arg must be public key");return s.fromHex(h).multiply(y(m)).toRawBytes(p)},sign:function(m,h,p=R){let{seed:u,k2sig:f}=S(m,h,p),b=e;return Lt(b.hash.outputLen,b.nByteLength,b.hmac)(u,f)},verify:function(m,h,p,u=H){let f=m;if(h=j("msgHash",h),p=j("publicKey",p),"strict"in u)throw Error("options.strict was renamed to lowS");mt(u);let{lowS:b,prehash:w}=u,x,z;try{if(typeof f=="string"||de(f))try{x=a.fromDER(f)}catch(C){if(!(C instanceof re.Err))throw C;x=a.fromCompact(f)}else{if(typeof f!="object"||typeof f.r!="bigint"||typeof f.s!="bigint")throw Error("PARSE");{let{r:C,s:K}=f;x=new a(C,K)}}z=s.fromHex(p)}catch(C){if(C.message==="PARSE")throw Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(b&&x.hasHighS())return!1;w&&(h=e.hash(h));let{r:L,s:F}=x,T=E(h),Z=d(F),$=g(T*Z),U=g(L*Z),W=s.BASE.multiplyAndAddUnsafe(z,$,U)?.toAffine();return!!W&&g(W.x)===L},ProjectivePoint:s,Signature:a,utils:l}}function dn(n){return{hash:n,hmac:(e,...t)=>Pt(n,e,Ne(...t)),randomBytes:Ae}}function ge(n,e){let t=r=>cn(Q(Q({},n),dn(r)));return Object.freeze(Se(Q({},t(e)),{create:t}))}BigInt(4);var wt=te(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),un=ge({a:wt.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:wt,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},Oe),Et=te(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),ln=ge({a:Et.create(BigInt("-3")),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Fp:Et,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},Ze),Ye=te(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),ye={a:Ye.create(BigInt("-3")),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Fp:Ye,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1)},hn=ge({a:ye.a,b:ye.b,Fp:Ye,n:ye.n,Gx:ye.Gx,Gy:ye.Gy,h:ye.h,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},Fe),X=BigInt(0),_=BigInt(1),Re=BigInt(2),gn=BigInt(8),bn={zip215:!0};function yn(n){let e=function(u){let f=Qe(u);return he(u,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze(Q({},f))}(n),{Fp:t,n:r,prehash:c,hash:i,randomBytes:g,nByteLength:d,h:s}=e,y=Re<<BigInt(8*d)-_,o=t.create,B=te(e.n,e.nBitLength),A=e.uvRatio||((u,f)=>{try{return{isValid:!0,value:t.sqrt(u*t.inv(f))}}catch{return{isValid:!1,value:X}}}),P=e.adjustScalarBytes||(u=>u),I=e.domain||((u,f,b)=>{if(oe("phflag",b),f.length||b)throw Error("Contexts/pre-hash are not supported");return u});function a(u,f){J("coordinate "+u,f,X,y)}function l(u){if(!(u instanceof E))throw Error("ExtendedPoint expected")}let v=xe((u,f)=>{let{ex:b,ey:w,ez:x}=u,z=u.is0();f==null&&(f=z?gn:t.inv(x));let L=o(b*f),F=o(w*f),T=o(x*f);if(z)return{x:X,y:_};if(T!==_)throw Error("invZ was invalid");return{x:L,y:F}}),O=xe(u=>{let{a:f,d:b}=e;if(u.is0())throw Error("bad point: ZERO");let{ex:w,ey:x,ez:z,et:L}=u,F=o(w*w),T=o(x*x),Z=o(z*z),$=o(Z*Z),U=o(F*f);if(o(Z*o(U+T))!==o($+o(b*o(F*T))))throw Error("bad point: equation left != right (1)");if(o(w*x)!==o(z*L))throw Error("bad point: equation left != right (2)");return!0});class E{constructor(f,b,w,x){this.ex=f,this.ey=b,this.ez=w,this.et=x,a("x",f),a("y",b),a("z",w),a("t",x),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(f){if(f instanceof E)throw Error("extended point not allowed");let{x:b,y:w}=f||{};return a("x",b),a("y",w),new E(b,w,_,o(b*w))}static normalizeZ(f){let b=t.invertBatch(f.map(w=>w.ez));return f.map((w,x)=>w.toAffine(b[x])).map(E.fromAffine)}static msm(f,b){return $t(E,B,f,b)}_setWindowSize(f){S.setWindowSize(this,f)}assertValidity(){O(this)}equals(f){l(f);let{ex:b,ey:w,ez:x}=this,{ex:z,ey:L,ez:F}=f,T=o(b*F),Z=o(z*x),$=o(w*F),U=o(L*x);return T===Z&&$===U}is0(){return this.equals(E.ZERO)}negate(){return new E(o(-this.ex),this.ey,this.ez,o(-this.et))}double(){let{a:f}=e,{ex:b,ey:w,ez:x}=this,z=o(b*b),L=o(w*w),F=o(Re*o(x*x)),T=o(f*z),Z=b+w,$=o(o(Z*Z)-z-L),U=T+L,W=U-F,C=T-L,K=o($*W),D=o(U*C),ee=o($*C),se=o(W*U);return new E(K,D,se,ee)}add(f){l(f);let{a:b,d:w}=e,{ex:x,ey:z,ez:L,et:F}=this,{ex:T,ey:Z,ez:$,et:U}=f;if(b===BigInt(-1)){let et=o((z-x)*(Z+T)),tt=o((z+x)*(Z-T)),He=o(tt-et);if(He===X)return this.double();let nt=o(L*Re*U),rt=o(F*Re*$),ft=rt+nt,ot=tt+et,it=rt-nt,Mt=o(ft*He),Wt=o(ot*it),Dt=o(ft*it),_t=o(He*ot);return new E(Mt,Wt,_t,Dt)}let W=o(x*T),C=o(z*Z),K=o(F*w*U),D=o(L*$),ee=o((x+z)*(T+Z)-W-C),se=D-K,be=D+K,Xe=o(C-b*W),jt=o(ee*se),Vt=o(be*Xe),Kt=o(ee*Xe),Yt=o(se*be);return new E(jt,Vt,Yt,Kt)}subtract(f){return this.add(f.negate())}wNAF(f){return S.wNAFCached(this,f,E.normalizeZ)}multiply(f){let b=f;J("scalar",b,_,r);let{p:w,f:x}=this.wNAF(b);return E.normalizeZ([w,x])[0]}multiplyUnsafe(f){let b=f;return J("scalar",b,X,r),b===X?q:this.equals(q)||b===_?this:this.equals(N)?this.wNAF(b).p:S.unsafeLadder(this,b)}isSmallOrder(){return this.multiplyUnsafe(s).is0()}isTorsionFree(){return S.unsafeLadder(this,r).is0()}toAffine(f){return v(this,f)}clearCofactor(){let{h:f}=e;return f===_?this:this.multiplyUnsafe(f)}static fromHex(f,b=!1){let{d:w,a:x}=e,z=t.BYTES;f=j("pointHex",f,z),oe("zip215",b);let L=f.slice(),F=f[z-1];L[z-1]=-129&F;let T=ie(L),Z=b?y:t.ORDER;J("pointHex.y",T,X,Z);let $=o(T*T),U=o($-_),W=o(w*$-x),{isValid:C,value:K}=A(U,W);if(!C)throw Error("Point.fromHex: invalid y coordinate");let D=(K&_)===_,ee=!!(128&F);if(!b&&K===X&&ee)throw Error("Point.fromHex: x=0 and x_0=1");return ee!==D&&(K=o(-K)),E.fromAffine({x:K,y:T})}static fromPrivateKey(f){return m(f).point}toRawBytes(){let{x:f,y:b}=this.toAffine(),w=Ee(b,t.BYTES);return w[w.length-1]|=f&_?128:0,w}toHex(){return ue(this.toRawBytes())}}E.BASE=new E(e.Gx,e.Gy,_,o(e.Gx*e.Gy)),E.ZERO=new E(X,_,_,X);let{BASE:N,ZERO:q}=E,S=Zt(E,8*d);function R(u){return G(u,r)}function H(u){return R(ie(u))}function m(u){let f=d;u=j("private key",u,f);let b=j("hashed private key",i(u),2*f),w=P(b.slice(0,f)),x=b.slice(f,2*f),z=H(w),L=N.multiply(z),F=L.toRawBytes();return{head:w,prefix:x,scalar:z,point:L,pointBytes:F}}function h(u=new Uint8Array,...f){let b=le(...f);return H(i(I(b,j("context",u),!!c)))}let p=bn;return N._setWindowSize(8),{CURVE:e,getPublicKey:function(u){return m(u).pointBytes},sign:function(u,f,b={}){u=j("message",u),c&&(u=c(u));let{prefix:w,scalar:x,pointBytes:z}=m(f),L=h(b.context,w,u),F=N.multiply(L).toRawBytes(),T=R(L+h(b.context,F,z,u)*x);return J("signature.s",T,X,r),j("result",le(F,Ee(T,t.BYTES)),2*d)},verify:function(u,f,b,w=p){let{context:x,zip215:z}=w,L=t.BYTES;u=j("signature",u,2*L),f=j("message",f),z!==void 0&&oe("zip215",z),c&&(f=c(f));let F=ie(u.slice(L,2*L)),T,Z,$;try{T=E.fromHex(b,z),Z=E.fromHex(u.slice(0,L),z),$=N.multiplyUnsafe(F)}catch{return!1}if(!z&&T.isSmallOrder())return!1;let U=h(x,Z.toRawBytes(),T.toRawBytes(),f);return Z.add(T.multiplyUnsafe(U)).subtract($).clearCofactor().equals(E.ZERO)},ExtendedPoint:E,utils:{getExtendedPublicKey:m,randomPrivateKey:()=>g(t.BYTES),precompute:(u=8,f=E.BASE)=>(f._setWindowSize(u),f.multiply(BigInt(3)),f)}}}var pe=BigInt(0),Ve=BigInt(1);function pn(n){let e=(he(t=n,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze(Q({},t)));var t;let{P:r}=e,c=l=>G(l,r),i=e.montgomeryBits,g=Math.ceil(i/8),d=e.nByteLength,s=e.adjustScalarBytes||(l=>l),y=e.powPminus2||(l=>Nt(l,r-BigInt(2),r));function o(l,v,O){let E=c(l*(v-O));return[v=c(v-E),O=c(O+E)]}let B=(e.a-BigInt(2))/BigInt(4);function A(l){return Ee(c(l),g)}function P(l,v){let O=function(q){let S=j("u coordinate",q,g);return d===32&&(S[31]&=127),ie(S)}(v),E=function(q){let S=j("scalar",q),R=S.length;if(R!==g&&R!==d)throw Error(`Expected ${g} or ${d} bytes, got ${R}`);return ie(s(S))}(l),N=function(q,S){J("u",q,pe,r),J("scalar",S,pe,r);let R=S,H=q,m,h=Ve,p=pe,u=q,f=Ve,b=pe;for(let x=BigInt(i-1);x>=pe;x--){let z=R>>x&Ve;b^=z,m=o(b,h,u),h=m[0],u=m[1],m=o(b,p,f),p=m[0],f=m[1],b=z;let L=h+p,F=c(L*L),T=h-p,Z=c(T*T),$=F-Z,U=u+f,W=c((u-f)*L),C=c(U*T),K=W+C,D=W-C;u=c(K*K),f=c(H*c(D*D)),h=c(F*Z),p=c($*(F+c(B*$)))}m=o(b,h,u),h=m[0],u=m[1],m=o(b,p,f),p=m[0],f=m[1];let w=y(p);return c(h*w)}(O,E);if(N===pe)throw Error("Invalid private or public key received");return A(N)}let I=A(e.Gu);function a(l){return P(l,I)}return{scalarMult:P,scalarMultBase:a,getSharedSecret:(l,v)=>P(l,v),getPublicKey:l=>a(l),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:I}}var mn=Te(()=>$e.create({dkLen:114})),Ie=(Te(()=>$e.create({dkLen:64})),BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439")),Bn=BigInt(1),xt=BigInt(2),It=BigInt(3);BigInt(4);var wn=BigInt(11),En=BigInt(22),vt=BigInt(44),xn=BigInt(88),In=BigInt(223);function kt(n){let e=Ie,t=n*n*n%e,r=t*t*n%e,c=k(r,It,e)*r%e,i=k(c,It,e)*r%e,g=k(i,xt,e)*t%e,d=k(g,wn,e)*g%e,s=k(d,En,e)*d%e,y=k(s,vt,e)*s%e,o=k(y,xn,e)*y%e,B=k(o,vt,e)*s%e,A=k(B,xt,e)*t%e,P=k(A,Bn,e)*n%e;return k(P,In,e)*A%e}function Gt(n){return n[0]&=252,n[55]|=128,n[56]=0,n}var Ut=te(Ie,456,!0),vn={a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:Ut,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:mn,randomBytes:Ae,adjustScalarBytes:Gt,domain:(n,e,t)=>{if(e.length>255)throw Error("Context is too big: "+e.length);return Ne(ct("SigEd448"),new Uint8Array([t?1:0,e.length]),e,n)},uvRatio:function(n,e){let t=Ie,r=G(n*n*e,t),c=G(r*n,t),i=G(c*r*e,t),g=G(c*kt(i),t),d=G(g*g,t);return{isValid:G(d*e,t)===n,value:g}}},Sn=yn(vn),An=pn({a:BigInt(156326),montgomeryBits:448,nByteLength:56,P:Ie,Gu:BigInt(5),powPminus2:n=>{let e=Ie;return G(k(kt(n),BigInt(2),e)*n,e)},adjustScalarBytes:Gt,randomBytes:Ae});Ut.ORDER,BigInt(3),BigInt(4),BigInt(156326),BigInt("39082"),BigInt("78163"),BigInt("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214"),BigInt("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716"),BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var St=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),At=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),On=BigInt(1),Me=BigInt(2),Ot=(n,e)=>(n+e/Me)/e,We=te(St,void 0,void 0,{sqrt:function(n){let e=St,t=BigInt(3),r=BigInt(6),c=BigInt(11),i=BigInt(22),g=BigInt(23),d=BigInt(44),s=BigInt(88),y=n*n*n%e,o=y*y*n%e,B=k(o,t,e)*o%e,A=k(B,t,e)*o%e,P=k(A,Me,e)*y%e,I=k(P,c,e)*P%e,a=k(I,i,e)*I%e,l=k(a,d,e)*a%e,v=k(l,s,e)*l%e,O=k(v,d,e)*a%e,E=k(O,t,e)*o%e,N=k(E,g,e)*I%e,q=k(N,r,e)*y%e,S=k(q,Me,e);if(!We.eql(We.sqr(S),n))throw Error("Cannot find square root");return S}}),Ct=ge({a:BigInt(0),b:BigInt(7),Fp:We,n:At,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{let e=At,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-On*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),c=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=t,g=BigInt("0x100000000000000000000000000000000"),d=Ot(i*n,e),s=Ot(-r*n,e),y=G(n-d*t-s*c,e),o=G(-d*r-s*i,e),B=y>g,A=o>g;if(B&&(y=e-y),A&&(o=e-o),y>g||o>g)throw Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:B,k1:y,k2neg:A,k2:o}}}},Oe);BigInt(0),Ct.ProjectivePoint;var Rt=te(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),Rn=ge({a:Rt.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:Rt,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},Oe),qt=te(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),qn=ge({a:qt.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:qt,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},Ze),zt=te(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),zn=ge({a:zt.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:zt,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},Fe),Hn=new Map(Object.entries({nistP256:un,nistP384:ln,nistP521:hn,brainpoolP256r1:Rn,brainpoolP384r1:qn,brainpoolP512r1:zn,secp256k1:Ct,x448:An,ed448:Sn}));export{Hn as nobleCurves};
