<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VPN | FWCloud-UI</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="User's manual">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/manual/assets/css/0.styles.e6812339.css" as="style"><link rel="preload" href="/manual/assets/js/app.53c3d789.js" as="script"><link rel="preload" href="/manual/assets/js/2.54df04f9.js" as="script"><link rel="preload" href="/manual/assets/js/32.b9ade830.js" as="script"><link rel="prefetch" href="/manual/assets/js/10.ccb59c47.js"><link rel="prefetch" href="/manual/assets/js/11.864c09e2.js"><link rel="prefetch" href="/manual/assets/js/12.4bdd302c.js"><link rel="prefetch" href="/manual/assets/js/13.ad6c88d1.js"><link rel="prefetch" href="/manual/assets/js/14.7d42c5dd.js"><link rel="prefetch" href="/manual/assets/js/15.da03431a.js"><link rel="prefetch" href="/manual/assets/js/16.1144c5d3.js"><link rel="prefetch" href="/manual/assets/js/17.d3f75cca.js"><link rel="prefetch" href="/manual/assets/js/18.d248b91b.js"><link rel="prefetch" href="/manual/assets/js/19.a55f569b.js"><link rel="prefetch" href="/manual/assets/js/20.1c187dcc.js"><link rel="prefetch" href="/manual/assets/js/21.e5aa3362.js"><link rel="prefetch" href="/manual/assets/js/22.0e6057df.js"><link rel="prefetch" href="/manual/assets/js/23.8c470481.js"><link rel="prefetch" href="/manual/assets/js/24.594401c2.js"><link rel="prefetch" href="/manual/assets/js/25.91948c8c.js"><link rel="prefetch" href="/manual/assets/js/26.27e505a1.js"><link rel="prefetch" href="/manual/assets/js/27.fa53f384.js"><link rel="prefetch" href="/manual/assets/js/28.50dddc9b.js"><link rel="prefetch" href="/manual/assets/js/29.a8705af7.js"><link rel="prefetch" href="/manual/assets/js/3.1f1b6128.js"><link rel="prefetch" href="/manual/assets/js/30.0d317808.js"><link rel="prefetch" href="/manual/assets/js/31.6fa268a9.js"><link rel="prefetch" href="/manual/assets/js/33.4f98b856.js"><link rel="prefetch" href="/manual/assets/js/4.5ed19beb.js"><link rel="prefetch" href="/manual/assets/js/5.63a34ce8.js"><link rel="prefetch" href="/manual/assets/js/6.fb974913.js"><link rel="prefetch" href="/manual/assets/js/7.a29ba178.js"><link rel="prefetch" href="/manual/assets/js/8.778963a1.js"><link rel="prefetch" href="/manual/assets/js/9.b6b5c002.js">
    <link rel="stylesheet" href="/manual/assets/css/0.styles.e6812339.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/manual/" class="home-link router-link-active"><img src="/manual/assets/img/fwcloud_q.png" alt="FWCloud-UI" class="logo"> <span class="site-name can-hide">FWCloud-UI</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/manual/docs/Sections/Introduction/" class="nav-link">
  Introduction
</a></div><div class="nav-item"><a href="/manual/docs/Sections/Overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/manual/docs/Sections/Configuration/" class="nav-link">
  Configuration
</a></div><div class="nav-item"><a href="/manual/docs/Sections/FWClouds/" class="nav-link">
  FWClouds
</a></div><div class="nav-item"><a href="/manual/docs/Sections/Firewalls/" class="nav-link">
  Firewalls
</a></div><div class="nav-item"><a href="/manual/docs/Sections/Agent/" class="nav-link">
  Agent
</a></div><div class="nav-item"><a href="/manual/docs/Sections/Objects/" class="nav-link">
  Objects
</a></div><div class="nav-item"><a href="/manual/docs/Sections/Policy/" class="nav-link">
  Policy
</a></div><div class="nav-item"><a href="/manual/docs/Sections/VPN/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  VPN
</a></div><div class="nav-item"><a href="/manual/docs/Sections/Routing/" class="nav-link">
  Routing
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/manual/docs/Sections/Introduction/" class="nav-link">
  Introduction
</a></div><div class="nav-item"><a href="/manual/docs/Sections/Overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/manual/docs/Sections/Configuration/" class="nav-link">
  Configuration
</a></div><div class="nav-item"><a href="/manual/docs/Sections/FWClouds/" class="nav-link">
  FWClouds
</a></div><div class="nav-item"><a href="/manual/docs/Sections/Firewalls/" class="nav-link">
  Firewalls
</a></div><div class="nav-item"><a href="/manual/docs/Sections/Agent/" class="nav-link">
  Agent
</a></div><div class="nav-item"><a href="/manual/docs/Sections/Objects/" class="nav-link">
  Objects
</a></div><div class="nav-item"><a href="/manual/docs/Sections/Policy/" class="nav-link">
  Policy
</a></div><div class="nav-item"><a href="/manual/docs/Sections/VPN/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  VPN
</a></div><div class="nav-item"><a href="/manual/docs/Sections/Routing/" class="nav-link">
  Routing
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>VPN</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/manual/docs/Sections/VPN/" aria-current="page" class="active sidebar-link">VPN</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#ca" class="sidebar-link">CA</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#new-ca" class="sidebar-link">New CA</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#view" class="sidebar-link">View</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#delete" class="sidebar-link">Delete</a></li></ul></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#certificates" class="sidebar-link">Certificates</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#new-server-certificate" class="sidebar-link">New Server Certificate</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#new-client-certificate" class="sidebar-link">New Client Certificate</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#view-2" class="sidebar-link">View</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#prefixes" class="sidebar-link">Prefixes</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#delete-2" class="sidebar-link">Delete</a></li></ul></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#openvpn" class="sidebar-link">OpenVPN</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#server-configuration" class="sidebar-link">Server Configuration</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#install-sever-configuration" class="sidebar-link">Install Sever Configuration</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#client-configuration" class="sidebar-link">Client Configuration</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#install-client-configuration" class="sidebar-link">Install Client Configuration</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#prefixes-2" class="sidebar-link">Prefixes</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#server-config-file" class="sidebar-link">Server Config File</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#clients-config-file" class="sidebar-link">Clients Config File</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#edit-configurations" class="sidebar-link">Edit Configurations</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#synchronize-ccd-files" class="sidebar-link">Synchronize CCD files</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#block-unblock-client-configurations" class="sidebar-link">Block / Unblock Client Configurations</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#uninstall-configurations" class="sidebar-link">Uninstall Configurations</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#delete-configurations" class="sidebar-link">Delete Configurations</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#windows-installer" class="sidebar-link">Windows Installer</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#vpn-status" class="sidebar-link">VPN Status</a></li><li class="sidebar-sub-header"><a href="/manual/docs/Sections/VPN/#vpn-connection-history" class="sidebar-link">VPN Connection history</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vpn"><a href="#vpn" class="header-anchor">#</a> VPN</h1> <p>FWCloud has full integration between VPN and secure Policy. From FWCloud-UI you can create and manage your Public Key Infrastructure (PKI).</p> <h2 id="ca"><a href="#ca" class="header-anchor">#</a> CA</h2> <p>In order to be able to issue and revoke certificates you need to have Certificate Authority (CA). It is the trusted entity that gives legitimacy to the relationship of a public key with the identity of a user or a service.</p> <h3 id="new-ca"><a href="#new-ca" class="header-anchor">#</a> New CA</h3> <p>In the PKI area right click on the icon and select <code>New CA</code></p> <p><img src="/manual/assets/img/ca_new.png" alt="New CA"><br></p> <p>You need to provide a name and the valid period for the new CA.</p> <p><img src="/manual/assets/img/ca_new-form.png" alt="New CA Form "><br></p> <p>The process of generating a new CA can last a little bit. It is carried out in the background, you can continue working with FCloud-UI.</p> <p><img src="/manual/assets/img/ca_generation.png" alt="New CA Process"><br></p> <h3 id="view"><a href="#view" class="header-anchor">#</a> View</h3> <p>The settings of a CA can be reviewed by double clicking over the CA name or right click and select <code>View CA</code>.</p> <p><img src="/manual/assets/img/ca_view.png" alt="View CA"><br></p> <p>The information displayed cannot be modified.</p> <h3 id="delete"><a href="#delete" class="header-anchor">#</a> Delete</h3> <p>In order to remove a CA, right click over the CA name and select <code>Delete CA</code>.</p> <p><img src="/manual/assets/img/ca_delete.png" alt="Delete CA"><br></p> <p>If you try to delete a CA that has issued certificates than has not been removed yet you will receive a warning and the deletion will not be carried out.</p> <p><img src="/manual/assets/img/ca_delete-form-not.png" alt="Delete CA Not Allowed"><br></p> <p>In case the deletion is possible first you will be asked for confirmation.</p> <p><img src="/manual/assets/img/ca_delete-form.png" alt="Delete CA Confirmation"><br></p> <h2 id="certificates"><a href="#certificates" class="header-anchor">#</a> Certificates</h2> <p>One of the objectives of the PKI is configuring VPN connections. You will need a certificate for the VPN server and a certificate for any of the clients that will connect to that server.</p> <h3 id="new-server-certificate"><a href="#new-server-certificate" class="header-anchor">#</a> New Server Certificate</h3> <p>New certificates can be issued from the CA.</p> <p><img src="/manual/assets/img/ca_new_cert.png" alt="New Cert"><br></p> <p>For a server certificate select Server as the type of the certificate in the drop down selection box.</p> <p><img src="/manual/assets/img/ca_cert_server.png" alt="New Cert"><br></p> <h3 id="new-client-certificate"><a href="#new-client-certificate" class="header-anchor">#</a> New Client Certificate</h3> <p>The process for issuing a client certificate is almost the same as for a server certificate. From the CA select <code>New certificate</code> and select <code>Client</code> as the type of the certificate in the displayed form.</p> <p>The form changes proposing a style for the name of the certificate that includes the name of the company, the country, the department, the name to whom the certificate is issued and a number in the event that more than one certificate is issued for the same person.</p> <p><img src="/manual/assets/img/ca_cert_client-wizard.png" alt="New Client Cert"><br></p> <p>You can follow this nomenclature or hide this wizard by clicking on the &quot;Wizard&quot; button and directly write the name of the certificate.</p> <p><img src="/manual/assets/img/ca_cert_client-nowizard.png" alt="New Client Cert"><br></p> <p>You must fill the name and the validity period and save the changes. If every goes fine you will see a message in the right top corner of FWCloud-UI.</p> <p><img src="/manual/assets/img/cert_client-success.png" alt="Client Cert Success"><br></p> <p>As a good practice, if the certificate is issued for a person, we recommend to include his name in the name of the certicate. Also, consider to append a number at the end of name of the certificate. If the client needs another certificate in the future just increase that number.</p> <h3 id="view-2"><a href="#view-2" class="header-anchor">#</a> View</h3> <p>Server and client certificates can be reviewed by double clicking over the certificate name or right click and select <code>View certificate</code>.</p> <p><img src="/manual/assets/img/cert_view.png" alt="View Cert"><br></p> <p>The information displayed cannot be modified.</p> <h3 id="prefixes"><a href="#prefixes" class="header-anchor">#</a> Prefixes</h3> <p>In order to keep the certificates ordered you can create a folders. This are called <code>Prefix</code> in FWCloud-UI terms. All certificates which their name start with that prefix name will be automatically included inside this folder. The prefixes group the certificates under one name. They can be created in the PKI section.</p> <p><img src="/manual/assets/img/cert_prefix-pki.png" alt="VPN PKI Prefix"><br></p> <p><img src="/manual/assets/img/cert_prefix-form.png" alt="VPN Prefix Form"><br></p> <h3 id="delete-2"><a href="#delete-2" class="header-anchor">#</a> Delete</h3> <p>When a certificate is no longer needed, it can be removed. Right click over the certificate name and select <code>Delete certificate</code>.</p> <p><img src="/manual/assets/img/cert_delete.png" alt="Delete Cert"><br></p> <p>FWCloud-UI does not allow to delete certificates if they are in use. First remove any of the VPN settings that make use of them.</p> <h2 id="openvpn"><a href="#openvpn" class="header-anchor">#</a> OpenVPN</h2> <h3 id="server-configuration"><a href="#server-configuration" class="header-anchor">#</a> Server Configuration</h3> <p>To use the server certificate drag it and drop it over the name of the firewall that is going to be the VPN server.</p> <p><img src="/manual/assets/img/cert_server-drag.png" alt="Server Drag"><br></p> <p><img src="/manual/assets/img/cert_server-drop.png" alt="Server Drop"><br></p> <p>Automatically a new form is opened. You need write down the network and the mask of the network the VPN server is going to hand IP addresses from. This object is called LAN-VPN-xxxx by default, where xxxx is the name of the Sever Certificate. The name of the object can be modified if you double click the name of the Sever Certificate on the right panel or if you right click and select <code>Edit configuration</code>.
Although the configuration in this form is enough for the VPN Sever configuration you can modify these settings and modify, add or delete the allowed options, like the name of the file that will store this configuration or its folder or other options like verbosity level.</p> <p><img src="/manual/assets/img/cert_server-form.png" alt="Server Form"><br></p> <p>For reference, next are the allowed options: server, port, proto, dev topology, ifconfig-pool-persist, ccd-exlusive, client-config-dir, keepalive, cipher, user, group, persist-key, persist-tun, status, verb, multihome, askpass, auth-nocache, auth-retry, auth-user-pass-verify, auth-user-pass, auth, bcast-buffers, ca, ccd-exclusive, cd, cert, chroot, client-cert-not-required, client-disconnect, client-to-client, client, connect-freq, comp-lzo, compress, connect-retry, crl-verify, cryptoapicert, daemon, dev-node, dev-type, dh, dhcp-option, dhcp-release, dhcp-renew, disable-occ, disable, down-pre, down, duplicate-cn, echo, engine, explicit-exit-notify, fast-io, float, fragment, hand-window, hash-size, http-proxy-option, http-proxy-retry, http-proxy-timeout, http-proxy-server, ifconfig-noexec, ifconfig-nowarn, ifconfig-pool-linear, ifconfig-pool, ifconfig-push, ifconfig, inactive, inetd, ip-win32-method, ipchange, iroute, key-method, key, key-size, learn-address, link-mtu, local, log-appeend, log, suppress-timestamps, lport, management-hold, management-log-cache, management-query-passwords, management, max-clients, max-routes-per-client, mktun, mlock, mode, mssfix, mtu-disc, mtu-test, mute-replay-warnings, mute, nice, no-iv, no-replay, nobind, ns-cert-type, passtos, pause-exit, persist-local-ip, persist-remote-ip, ping-exit, ping-restart, ping-timer-rem, ping, pkcs12, plugin, pull, push-reset, rcvbuf, reidrect-gateway, remap-usrl, remote-cert-tls, remote-random, reneg-bytes, reneg-pkts, reneg-sec, replay-persist, replay-window, resolv-retry, rmtun, route-delay, route-gateway, route-method, route-noexec, route, rport, secret, server-bridge, show-adapters, show-ciphers, show-digests, show-net-up, show-net, show-tls, show-valid-subnets, single-session, sndbuf, socks-proxy-retry, socks-proxy, status-vesion, syslog, tap-sleep, tcp-queue-limit, test-crypto, tls-auth, tls-cipher, tls-client, tls-exit, tls-remote, tls-server, tls-timeout, tls-verify, tls-version-min, tls-version-max, tmp-dir, tran-window, tun-ipv6, tun-mtu-extra, tun-mtu, txqueuelen, up-delay, up-restart, up-cmd, username-as-commond-name and writepid. More information about the options can be found in <a href="https://openvpn.net/community-resources/reference-manual-for-openvpn-2-4/" target="_blank" rel="noopener noreferrer"> OpenVPN options <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="install-sever-configuration"><a href="#install-sever-configuration" class="header-anchor">#</a> Install Sever Configuration</h3> <p>Once the VPN Server configuration is created, it needs to be installed in the firewall. Right click over the server certificate and select <code>Install Configuration</code>.</p> <p><img src="/manual/assets/img/cert_server_install.png" alt="Server Install"><br></p> <p>A pop up windows will ask for the credentials to access the firewall using the SSH protocol.</p> <p><img src="/manual/assets/img/cert_server_install-form.png" alt="Server Install Form"><br></p> <p>FWCloud-UI needs to have access by SSH to the firewall. The user provided also needs to be able to execute &quot;sudo&quot; commands, otherwise the next error will occur:</p> <p><img src="/manual/assets/img/cert_server_install-error.png" alt="Server Install Error"><br></p> <p>If no problems occur the VPN Server configuration will be installed on the target firewall</p> <p><img src="/manual/assets/img/vpn_server_install-success.png" alt="Server Install Success"><br></p> <h3 id="client-configuration"><a href="#client-configuration" class="header-anchor">#</a> Client Configuration</h3> <p>To use the client certificate drag it and drop it over the name of the VPN server. Note that the VPN server background turns green we you hover the certificate over it.</p> <p><img src="/manual/assets/img/cert_client-drag.png" alt="Client Drag"><br></p> <p><img src="/manual/assets/img/cert_client-drop.png" alt="Client Drop"><br></p> <p>If the VPN server already has another certificate with the same name you will receive a warning and the certificate will not be moved to the server. The name of the certificates must be unique within the VPN server scope.</p> <p><img src="/manual/assets/img/cert_drop-error.png" alt="Client Drop Error"><br></p> <p>If this the first certificate you drop, automatically a new form is opened where you can configure the OpenVPN options for the client.</p> <p><img src="/manual/assets/img/cert_client-form.png" alt="Client Form"><br></p> <p>The most important option in this form you have to fill in is <code>remote</code>. It makes reference to the IP address the VPN clients connect to stablish the VPN tunnel. This is normally the public IP address you use to reach the firewall. You can write it in the <code>Value</code> field or use the magnifier <img src="/manual/assets/img/mag.glass-grey.png" alt="Glass"> icon in the Remote section.</p> <p><img src="/manual/assets/img/cert_client_remote-glass.png" alt="Client Cert Glass"><br></p> <p>When you click that icon a new menu displays the IP addresses configured in FWCloud-UI in tree way. Select the appropriate one and click the <img src="/manual/assets/img/tick.png" alt="Tick"> icon. Then modify the port if VPN server is not listening in the default one and finally click on the <code>+</code> icon next to the port number.</p> <p>More than one remote option can be added and they will be used sequentially to connect if the others fail to connect.</p> <p>In the VPN client configuration form you can also add delete or modify other options like: remote, client, dev, proto, resolv-retry, nobind, user, group, persist-key, persist-tun, chipher, auth, auth-nocache, tls-client, verb, float and remote-cert-tls.</p> <p>If routes needs to be pushed to the client or added in the server, this can be done using the CCD options that are included in the bottom left side of this form.</p> <p><img src="/manual/assets/img/cert_client_CCD.png" alt="CCD Options"><br></p> <p>The options available here are: push, push-reset, iroute, iroute-ipv6, ifconfig-push, ifconfig-ipv6-push, disable, config, max-routes-per-client and comp-lzo.</p> <p>As the most used options in this section are push and iroute, there are two buttons that simplify the work.
If you push <code>New route</code> button you get a piece of the FWCloud-UI object tree where you can select the IP or network addresses configured in FWCloud-UI. Then the push option will be added with the selected address and with the proper network mask configured. The same is for the <code>New iroute</code> button. Note that the syntax of these options is different.</p> <p><img src="/manual/assets/img/vpn_iroute.png" alt="CCD iroute"><br></p> <p>When you have the VPN client configuration ready press <code>Save changes</code> button in right bottom side of the form. The new client certificate appears in the FIREWALLS/CLUSTER side with an <img src="/manual/assets/img/I.png" alt="I"> icon by his name. This indicates this certificate is not yet installed in the firewall.</p> <p>When you drop the client certificate in the VPN server, if this already have other client certificates you will be asked if you want to clone the configuration from another client VPN configuration.</p> <p><img src="/manual/assets/img/cert_client-clone.png" alt="Clone Client Cert"><br></p> <p>In this form you can choose from the drop down field which client configuration you want to copy its options from. When you are configuring multiple clients this save you a lot of time and avoid mistakes. After that the client configuration form will be opened.</p> <h3 id="install-client-configuration"><a href="#install-client-configuration" class="header-anchor">#</a> Install Client Configuration</h3> <p>Once the VPN Client configuration is created, it needs to be installed in the firewall. Right click on the client configuration name and select <code>Install Configuration</code>.</p> <p><img src="/manual/assets/img/cert_client_install.png" alt="Client Install"><br></p> <p>A pop up windows will ask for the credentials to access the firewall.</p> <p><img src="/manual/assets/img/cert_client_install-form.png" alt="Client Install Form"><br></p> <p>When the certificate is installed in the firewall the <img src="/manual/assets/img/I.png" alt="I"> icon by his name will be cleared.</p> <h3 id="prefixes-2"><a href="#prefixes-2" class="header-anchor">#</a> Prefixes</h3> <p>Prefixes can also be created in the FIREWALL/CLUSTER section.</p> <p><img src="/manual/assets/img/cert_prefix-fws.png" alt="VPN FW Prefix"><br></p> <p><img src="/manual/assets/img/ovpn_prefix-form.png" alt="VPN Prefix Form"><br></p> <div class="custom-block warning"><p class="custom-block-title">Do not confuse with PKI prefixes</p> <p>PKI prefixed are for organizational purposes only while OpenVPN server prefixes can be used in the security policy.</p></div> <p>In the next figure you can see PKI prefixes on the left side are represented by <img src="/manual/assets/img/pki_prefix-icon.png" alt="PKI Prefix Icon"> while the prefixes created in the OpenVPN server have a different <img src="/manual/assets/img/ovpn_prefix-icon.png" alt="OpenVPN Prefix Icon"> icon.</p> <p><img src="/manual/assets/img/prefix-types.png" alt="Prefix types"><br></p> <p>You can use the <code>Prefix</code> when creating the policy rules. Instead of needing to add all IP addresses of every VPN connections of any client which his certificate name starts with a common part (the prefix), you can add that <code>Prefix</code> in the rule. The prefix can be dragged and dropped in the rule fields. FWCloud-UI will display the prefixes in the Policy section when you expand the OpenVPN branch inside the firewalls in the Firewalls group.
Only OpenVPN server prefixes will be displayed here.</p> <p><img src="/manual/assets/img/cert_prefix_policy.png" alt="VPN Prefix Policy"><br></p> <p>Here you have an example with two rules using prefixes</p> <p><img src="/manual/assets/img/vpn_prefix-rule.png" alt="VPN Prefix Policy Rule"><br></p> <p>In this case since we have two VPN client configurations with the prefix ENGINEERS, the rule number 10 refers to any connections established from this two VPN clients</p> <p><img src="/manual/assets/img/vpn_prefix-tree.png" alt="VPN Prefix Policy Rule"><br></p> <p>The use of prefixes makes the security policy more clear and easy to read. Also when you create new VPN client configurations with the same prefix you do not need to modify or create new rules. Although the policy needs to be compiled and installed again, since when it was installed in the firewall it did not yet have the new clients configurations.</p> <h3 id="server-config-file"><a href="#server-config-file" class="header-anchor">#</a> Server Config File</h3> <p>Although the VPN server configuration can be installed on the firewall from the FWCloud-UI, also you can get access to the file that stores this configuration, just right click and select <code>Configuration file</code>.</p> <p><img src="/manual/assets/img/vpn_server_file.png" alt="Server VPN file"><br></p> <p>A new form is opened where you can download or copy the content of the file to the clipboard.</p> <p><img src="/manual/assets/img/vpn_server_config_file.png" alt="Server VPN Config File"><br></p> <h3 id="clients-config-file"><a href="#clients-config-file" class="header-anchor">#</a> Clients Config File</h3> <p>The configuration file of the VPN clients can also be obtained by right clicking on the client configuration name and select <code>Configuration file</code>.</p> <p><img src="/manual/assets/img/vpn_client_file.png" alt="Client VPN file"><br></p> <p>A new form is opened where you can download or copy the content of the file to the clipboard.</p> <p><img src="/manual/assets/img/vnp_client_config_file.png" alt="Client VPN Config File"><br></p> <p>If you copy it to the clipboard a popup message in the right top corner will indicate when the copy has finished.</p> <p><img src="/manual/assets/img/vpn_client_copied.png" alt="Client VPN File Copied"><br></p> <p>This file will be needed if you want to install the a VPN connection in the client equipment. This configuration file is ready to be use with the majority VPN client programs like Tunnelblick on OSX based systems or OpenVPN-Gui on Windows based systems.</p> <p>For Windows based systems you can use the FWCloud-UI Windows installer feature that will provide an installer that bundles the VPN client program and the configuration file.</p> <h3 id="edit-configurations"><a href="#edit-configurations" class="header-anchor">#</a> Edit Configurations</h3> <p>In order to edit the VPN server configuration right click on the VPN server name and select <code>Edit configuration</code>.</p> <p><img src="/manual/assets/img/vpn_server_edit.png" alt="Edit VPN Server"><br></p> <p>The configuration form for the server is opened and you can make any notifications to it.</p> <p><img src="/manual/assets/img/cert_server-form.png" alt="Server Form"><br></p> <p>Also the VPN configuration of a client can be edited if you right click on the client configuration name and select <code>Edit configuration</code>.</p> <p><img src="/manual/assets/img/vpn_client_edit.png" alt="Edit VPN Client"><br></p> <p>The configuration form for the client is opened.</p> <p><img src="/manual/assets/img/cert_client-form2.png" alt="Client Form"><br></p> <h3 id="synchronize-ccd-files"><a href="#synchronize-ccd-files" class="header-anchor">#</a> Synchronize CCD files</h3> <p>You can reinstall all client VPN configurations into the VPN server.</p> <p><img src="/manual/assets/img/vpn_server_sync.png" alt="VPN Server Sync"><br></p> <p>This option is useful if you have several client configurations pending to be installed.</p> <h3 id="block-unblock-client-configurations"><a href="#block-unblock-client-configurations" class="header-anchor">#</a> Block / Unblock Client Configurations</h3> <p>When a VPN connection is not going to be used for a temporal period it can be blocked, not allowing the connection to be established</p> <p><img src="/manual/assets/img/vpn-block.png" alt="Block VPN"><br></p> <p>The process will install the CCD in the server to start to blocking the connection. If the password of the the firewall is not stored it will be required.</p> <p>A message informs the connection has been successfully blocked:</p> <p><img src="/manual/assets/img/vpn-block-msg.png" alt="Block VPN Message"><br></p> <p>VPN connections blocked are displayed in gray text and the icons change to reflect that.</p> <p><img src="/manual/assets/img/vpn-blocked.png" alt="Blocked VPN connections"><br></p> <p>Any blocked VPN connection can the unblocked from the context menu:</p> <p><img src="/manual/assets/img/vpn-unblock.png" alt="Unblock VPN"><br>
Again the modified client configuration will be installed in the firewall, and a message will inform it has been unblocked:</p> <p><img src="/manual/assets/img/vpn-unblock-msg.png" alt="Unblock VPN Message"><br></p> <h3 id="uninstall-configurations"><a href="#uninstall-configurations" class="header-anchor">#</a> Uninstall Configurations</h3> <p>The VPN server configuration can be uninstalled from the firewall. All client configuration of the VPN server must be uninstalled first.</p> <p><img src="/manual/assets/img/vpn_server_uninstall.png" alt="Server VPN Uninstall"><br></p> <p>FWCloud will check if there are client configurations for the server configuration. In that case it will not proceed and will show an error message.</p> <p><img src="/manual/assets/img/vpn_server_uninstall-warn.png" alt="Server VPN Uninstall Warn"><br></p> <p>To uninstall a client configuration, right click over the name and select <code>Uninstall configuration</code>.</p> <p><img src="/manual/assets/img/vpn_client-uninstall.png" alt="Client VPN Uninstall"><br></p> <p>FWCloud-UI will ask for the credentials to access the firewall.</p> <p><img src="/manual/assets/img/vpn_client_uninstall-form.png" alt="Client VPN Uninstall Form"><br></p> <p>If the <code>ccd-exclusive</code> option is configured in the OpenVPN server, when a VPN client configuration is unstalled that client will no longer be able to connect to the VPN server. This option is configured by default when an OpenVPN server is configured in FWCloud-UI.</p> <p><img src="/manual/assets/img/ccd-exclusive.png" alt="Sever VPN ccd-exclusive option"><br></p> <p>This a very fast and ease way to block a VPN user.</p> <h3 id="delete-configurations"><a href="#delete-configurations" class="header-anchor">#</a> Delete Configurations</h3> <p>If a VPN configuration is no longer needed it can be removed. This can be done from the context menu of the configuration name. Right click and select <code>Delete configuration</code>.</p> <p><img src="/manual/assets/img/vpn_server_delete.png" alt="VPN Server Delete"><br></p> <p>A server configuration can only be deleted if there are no client configurations. FWCloud will detect if client configurations exist.</p> <p><img src="/manual/assets/img/vpn_server_delete-warn.png" alt="VPN Server Delete Warn"><br></p> <p>To delete a client configuration select <code>Delete configuration</code> from the client context menu.</p> <p><img src="/manual/assets/img/vpn_client_delete.png" alt="Client VPN Delete"><br></p> <p>Again FWCloud will check first if there is any conflict that not allows the deletion and it will warn if that is the case.</p> <p><img src="/manual/assets/img/vpn_client_delete-error.png" alt="Client VPN Delete Error"><br></p> <p>You can uninstall the configuration first and remove it later or do both actions at the same time by marking the box <code>Uninstall configuration first</code>.</p> <p><img src="/manual/assets/img/vpn_client_delete-form.png" alt="Client VPN Delete Form"><br></p> <h3 id="windows-installer"><a href="#windows-installer" class="header-anchor">#</a> Windows Installer</h3> <p>Directly from the VPN client configuration you can obtain a wizard that will guide you installing a VPN client on Windows systems. Select <code>WindowS installer</code>.</p> <p><img src="/manual/assets/img/vpn_client_win-installer.png" alt="Client VPN Windows Installer"><br></p> <p>FWCloud-UI will generate a Windows executable program for the selected client. By default it is name after the client connection name by you can modify this name, then press the bottom <code>Generate file</code> to continue.</p> <p><img src="/manual/assets/img/vpn_client_win-installer-form.png" alt="Client VPN Windows Installer Form"><br></p> <p>A new form indicates the generation is in progress.</p> <p><img src="/manual/assets/img/vpn_client_win-installer-progress.png" alt="Client VPN Windows Installer Progress"><br></p> <p>Once the program it is ready it will be automatically downloaded from your browser.</p> <p><img src="/manual/assets/img/vpn_client_win-installer-success.png" alt="Client VPN Windows Installer Success"><br></p> <p>Save this program and copy in the Windows computer you want to install the VPN client connection. For the installation process no Internet access is required. Just execute the generated installer and click next. It will guide you screen by screen.
This program will install or upgrade OpenVPN-GUI and create a new VPN connection for the client it was generated for against the VPN server. It will ask if you want to run it after the installation is finished.</p> <p><img src="/manual/assets/img/vpn_client_installer.png" alt="Client VPN Windows Installer Run"><br></p> <h3 id="vpn-status"><a href="#vpn-status" class="header-anchor">#</a> VPN Status</h3> <p>FWCloud allows you to see the status of the VPN connections established in the firewalls.
To do this you must go to the VPN tab and in the &quot;FIREWALLS / CLUSTERS&quot; section, on the right of the screen, right click on the VPN server you want to see the connections for and select <code>Get status</code>.</p> <p><img src="/manual/assets/img/vpn_server-get-status2.png" alt="VPN Get status"><br></p> <p>At the bottom of the screen all the active connections at the current moment will be shown. At the bottom left there is a table indicating the common name (CN), the virtual IP address assigned to the VPN connection, the real IP and the port used, the traffic received, the traffic sent and the date on the the connection was established. The rows can be sorted by any of the fields displayed by clicking on the column name.
The content of the table is dynamic and changes depending on whether the VPNs are connected or disconnected on the analyzed server.</p> <p><img src="/manual/assets/img/vpn_status-screen.png" alt="VPN status"><br></p> <p>On the right side next to the table the status of the connection selected in the table is graphically represented. In the graph we have two curves, one for the traffic sent and the other for the received. The graph is updated according to the refresh period.</p> <p>Further to the right we have 3 boxes indicating the values of the total number of connections and the total traffic received and sent.</p> <p>It is possible to configure the update period of the table or deactivate it completely by clicking the <img src="/manual/assets/img/arrow-down.png" alt="down arrow"> button.</p> <p><img src="/manual/assets/img/vpn_status-refresh-period.png" alt="VPN refresh period"><br></p> <p>Likewise, you can force an immediate refreshment by clicking <img src="/manual/assets/img/refresh_icon.png" alt="refresh"> button</p> <p><img src="/manual/assets/img/vpn_status-refresh.png" alt="VPN status refresh"><br></p> <p>In the event that there are many established connections, it is convenient to filter the results by some common pattern, for example parts of the CN. When naming VPN connections, we recommend that they start with the name of the company, followed by a dash, the country, dash, department name, dash, full name of the person or employee who uses it, dash and finally, a numeric identifier to be able to distinguish between them in the case of having more than one for the same employee.
To filter the results, click on <img src="/manual/assets/img/mag.glass-green.png" alt="the magnifying glass"> and write the pattern in the text field.</p> <p><img src="/manual/assets/img/vpn_status-filter.png" alt="VPN status filter"><br></p> <h3 id="vpn-connection-history"><a href="#vpn-connection-history" class="header-anchor">#</a> VPN Connection history</h3> <p>To analyze a specific problem, sometimes it is useful not only to see the current state of the connection, but also its connection history.</p> <p>Thanks to the <a href="/manual/docs/Sections/Agent/"> FWcloud-Agent </a>, this information is periodically collected and stored in the FWCloud database, so that it is available for later consultation, even if the connection between FWCloud and the analyzed firewall is not possible at that time.</p> <p><img src="/manual/assets/img/vpn_server-see-history2.png" alt="VPN See history"><br></p> <p>You will see a table with the history of all VPN connections. We can order the table by clicking on any column name. Next the VPN connections are ordered by Name.</p> <p><img src="/manual/assets/img/vpn_history-table-sorted.png" alt="VPN history"><br></p> <p>If you scroll down the pane at the bottom of the table there are two graphs representing the traffic Volume and the Speed of the VPN connections.</p> <p><img src="/manual/assets/img/vpn_history-graphs.png" alt="VPN history graphs"><br></p> <p>The results can be filtered by the VPN connection name:</p> <p><img src="/manual/assets/img/vpn_history-filtered.png" alt="VPN history"><br></p> <p>The data can be shorted by selecting a specific period like 'Last day', 'Last week', 'Last month' or a 'Custom rage'. In the last case you can pick the starting and the ending day of the period to be showed.</p> <p><img src="/manual/assets/img/vpn_history-custom-range.png" alt="VPN history"><br></p> <p>If you are interested only in the connection history of a specific VPN, you can obtain this information directly from the contextual menu of the connection and thus not have to filter the results by the name of the connection.</p> <p><img src="/manual/assets/img/vpn_client-see-history2.png" alt="VPN Client See history"><br></p> <p>You can also select the appropriate interest period using the form fields described above.</p> <p><img src="/manual/assets/img/vpn_client-history-screen.png" alt="VPN client history"><br></p> <p>To speed up the work, both the obtaining of the status of the VPN connections and their history can be consulted directly from the &quot;Policy&quot; panel in which the policy rules are configured. Just look for the VPN server or individual connections in the hierarchical structure on the left by following the path &quot;FIREWALLS&quot; - &lt;Name of the firewall or cluster&gt;  - &quot;OpenVPN&quot; - &lt;VPN server&gt; [- &lt;VPN connection&gt;] and press with the right button to obtain the contextual menu and select the option &quot;Get status&quot; or &quot;See history&quot; as appropriate.</p> <p><img src="/manual/assets/img/vpn_history-policyPanel.png" alt="VPN server history-policyPanel"><br></p> <p>Below you can watch a video showing the use of VPN connection history:</p> <iframe width="740" height="475" src="https://www.youtube.com/embed/PzjVgjM7A24" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen="allowfullscreen"></iframe></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/manual/assets/js/app.53c3d789.js" defer></script><script src="/manual/assets/js/2.54df04f9.js" defer></script><script src="/manual/assets/js/32.b9ade830.js" defer></script>
  </body>
</html>
