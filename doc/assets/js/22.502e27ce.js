(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{340:function(t,e,a){"use strict";a.r(e);var s=a(28),n=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"fwcloud-agent"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#fwcloud-agent"}},[t._v("#")]),t._v(" FWCloud-Agent")]),t._v(" "),e("h2",{attrs:{id:"introduction"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[t._v("#")]),t._v(" Introduction")]),t._v(" "),e("p",[t._v("FWCloud allows you to centrally manage Linux-based firewalls that can be located anywhere. You can have your FWCloud console at the headquarters of your company and the firewalls managed from it scattered over remote locations throughout the world.")]),t._v(" "),e("p",[t._v("Therefore, you need a way to communicate your FWCloud console with the firewalls it manages to carry out actions on them such as loading the security policy, obtaining the network configuration, managing VPN configuration, blocking VPN connections, etc.")]),t._v(" "),e("p",[t._v("This FWCloud – Firewalls communication can be carried out in two ways:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Communication methods")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("SSH")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("FWCloud-Agent")])])])]),t._v(" "),e("p",[t._v("Communication via "),e("code",[t._v("SSH protocol")]),t._v(" is the simplest since it does not require you to carry out any installation on the firewall to be managed, but it has the disadvantage that you are using a service such as SSH that allows full access to the managed firewall. In addition to that, if you do not want to save the access credentials in FWCloud for security, every time you have to carry out some action on the firewall, you have to enter these credentials.")]),t._v(" "),e("p",[t._v("The communication option through "),e("code",[t._v("FWCloud-Agent")]),t._v(" is the most recommended, since it simplifies and optimizes communication with the managed firewall. It is a service that is installed on the firewall through which the FWCloud console carries out the necessary actions on the managed firewalls. This service is installed using the .deb or .rpm packages corresponding to the Linux distribution that you are using.")]),t._v(" "),e("p",[t._v("FWCloud-Agent improves security in the FWCloud – FireWalls interaction, since it does not require SSH credentials, instead of it an automatically generated during the package installation process in the firewall API Key is used. In addition, it is possible to restrict access to this service only to the IP of the FWCloud console.")]),t._v(" "),e("p",[t._v("Using FWCloud-Agent instead of SSH also means that you restrict the actions that can be done on the firewall only to those that the FWCloud-Agent service allows. That is, you are not using a general scope protocol like SSH that allows you to do much more than what is needed in the FWCloud – FireWalls communication.")]),t._v(" "),e("p",[t._v("It also optimizes and improves the interaction with the firewalls, since it is not necessary to establish an SSH connection every time you have to do something with the target firewall.")]),t._v(" "),e("p",[t._v("In addition, thanks to FWCloud-Agent you can do many more things that are not feasible through SSH communication, such as maintaining a history of the status of VPN connections.")]),t._v(" "),e("p",[t._v("FWCloud-Agent is a service that optimizes communication with firewalls managed from FWCloud, also improves security and allows additional functionalities")]),t._v(" "),e("h2",{attrs:{id:"installation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[t._v("#")]),t._v(" Installation")]),t._v(" "),e("p",[t._v("FWCloud-Agent is an application programmed in  Rust, highly optimized and that requires very few resources to run on the firewall in which it is installed. Thanks to this, it is possible to run it on computers with very few hardware resources.")]),t._v(" "),e("p",[t._v("Installation is very simple, you just need to install our repositories and use the distribution tools to install new packages.")]),t._v(" "),e("p",[t._v("Let’s see  an example of how to install it in Ubuntu/Debian distributions.")]),t._v(" "),e("p",[t._v("First installing the repository:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" https://packagecloud.io/install/repositories/SOLTECSIS/FWCloud/script.deb.sh?any"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v("\n")])])]),e("p",[t._v("We can now install packages from this new repository:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" fwcloud-agent\n")])])]),e("p",[t._v("Similarly we can also install it in Fedora/Red-Hat/CentOS distributions.")]),t._v(" "),e("p",[t._v("First we install the repository:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" https://packagecloud.io/install/repositories/SOLTECSIS/FWCloud/script.rpm.sh?any"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v("\n")])])]),e("p",[t._v("And then we use the installation tools for installing the package:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" fwcloud-agent\n\nor\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" dnf "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" fwcloud-agent\n")])])]),e("p",[t._v("As part of the installation process, a pair of self-signed keys are generated for secure communication with FWCloud and a random API Key, which is stored in the .env file inside the installation folder: /opt/fwcloud/agent")]),t._v(" "),e("p",[t._v("You will need this API Key to be able to connect the firewall in which you have just installed FWCloud-Agent with your FWCloud console. You can find out the API Key generated using the next command:")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"API_KEY"')]),t._v(" /opt/fwcloud/agent/.env\n")])])]),e("p",[t._v("When editing or adding a new firewall you will have to select the FWCloud-Agent communication option and indicate in such configuration the API Key of the FWCloud-Agent server. This is process is detailed in "),e("RouterLink",{attrs:{to:"/docs/Sections/Firewalls/#new-firewall-cluster"}},[t._v(" Firewall section ")]),t._v(" of this manual.")],1),t._v(" "),e("p",[t._v("In the .env file you have the configuration options that you can customize explained as well as their default values.")]),t._v(" "),e("p",[t._v("Among these you have the ALLOWED_IPS option, which consists of a list of IPs separated by spaces by means of which you can restrict the IPs from which access to FWCloud-Agent will be allowed. In this list you can only put the IP of your FWCloud console to improve security.")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ALLOWED_IPS")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10.10.10.1"')]),t._v("\n")])])]),e("p",[t._v("In the /opt/fwcloud/agent/etc directory you have the files cert.pem and key.pem, generated as part of the installation process of the FWCloud-Agent package that constitute the self-signed certificate used to encrypt the communication between FWCloud and FWCloud-Agent .")]),t._v(" "),e("p",[t._v("In the /opt/fwcloud/agent/log directory you have the log file fwcloud-agent.log where you can see the logs issued by the FWCloud-Agent service. This file is managed by logrotate to prevent it from growing indefinitely.")]),t._v(" "),e("p",[t._v("You can manage the FWCloud-Agent service through systemctl, in order to stop, start and see its status.")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl status fwcloud-agent\n\n● fwcloud-agent.service – fwcloud-agent\n     Loaded: loaded "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("/lib/systemd/system/fwcloud-agent.service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" enabled"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" vendor preset: enabled"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     Active: active "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("running"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" since Tue "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2021")]),t._v("-11-16 "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v(":07:43 UTC"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" 2h 9min ago\n   Main PID: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("34582")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fwcloud-agent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      Tasks: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("limit: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1071")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     Memory: "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(".0M\n     CGroup: /system.slice/fwcloud-agent.service\n             └─34582 /opt/fwcloud/agent/fwcloud-agent\n")])])]),e("h2",{attrs:{id:"how-it-works"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-it-works"}},[t._v("#")]),t._v(" How it works")]),t._v(" "),e("p",[t._v("Once you have FWCloud-Agent installed in your firewall and connected to your FWCloud console, it is now possible to manage it. But how does the communication between your FWCloud console and the FWCloud-Agent service installed on your firewall work?")]),t._v(" "),e("p",[t._v("Such communication actually takes place between the FWCloud-API and the FWCloud-Agent service installed on the firewall. For example, when from FWCloud-UI you request to install the policy on a firewall, this request is relayed by FWCloud-API to the FWCloud-Agent on the firewall.")]),t._v(" "),e("p",[t._v("Just as the communication between FWCloud-UI and FWCloud-API is carried out through an API, the communication between FWCloud-API and FWCloud-Agent, is also carried out via an API, the FWCloud-Agent API.")]),t._v(" "),e("p",[t._v("To understand this better, let’s see an example of how you can communicate with the FWCloud-Agent API using the curl command.")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-k")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-i")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-X")]),t._v(" PUT "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-H")]),t._v(" ‘X-API-Key: LofKtOxLjBRfxQqKhxLaG8xxPdVCuMSBhnGnYoUtuSBQx9xP0fPKPxE5xGHO40q8’ https://192.168.56.108:33033/api/v1/ping\n")])])]),e("p",[t._v("You use the ping call of the FWCloud-Agent API to which it will respond with an HTTP 200 code if all goes well.")]),t._v(" "),e("p",[t._v("If you look at the URL https://192.168.56.108:33033/api/v1/ping that you use to communicate with the FWCloud-Agent you can see several things. You are using secure communication through HTTPS, for that reason the self-signed certificate that is generated during the installation process is necessary.")]),t._v(" "),e("p",[t._v("Next you have the IP (192.168.56.108) and TCP port (33033) through which you can communicate with FWCloud-Agent. And the path for the API call (/api/v1/ping) that defines the service you are requesting.")]),t._v(" "),e("p",[t._v("Keep in mind that the API Key that you are using in this example must be modified by the one generated in your FWCloud-Agent server.")]),t._v(" "),e("p",[t._v("Next you can see a small video demonstration of the procedure for installing and using FWCloud-Agent:")]),t._v(" "),e("iframe",{attrs:{width:"740",height:"475",src:"https://www.youtube.com/embed/O_gu3Olu6Jo",frameborder:"0",allow:"autoplay; encrypted-media",allowfullscreen:""}})])}),[],!1,null,null,null);e.default=n.exports}}]);